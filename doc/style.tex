\documentclass[11pt,a4paper,oneside]{book}
\pagestyle{empty}

\usepackage{fancyhdr,lastpage}
\usepackage{graphicx}
\usepackage[inline]{asymptote}
\usepackage[section]{placeins}

\usepackage{xunicode}
\usepackage{xltxtra}
\usepackage{ulem}
\usepackage{color}
\usepackage{xcolor}

\usepackage[colorlinks=false,pdfborder=000]{hyperref}
\usepackage{fontspec}
%\setmainfont[Mapping=tex-text]{SimSun}
\setmainfont{SimSun}
%\setmainfont{WenQuanYi Zen Hei}
\usepackage[Lenny]{fncychap}

\renewcommand{\contentsname}{目录}
%\renewcommand{\chaptermark}[1]{\markboth{\normalfont 第~\thechapter~章~~#1}{}}
%\renewcommand{\chaptername}{第~\thechapter~章}
\hbadness=10000
\tolerance=10000
\hfuzz=150pt

\usepackage{caption}
\captionsetup{hypcap=true}

\usepackage{tocloft}
\tocloftpagestyle{empty}
\makeatletter


\usepackage{indentfirst}
\setlength{\parindent}{2em}
\setlength{\parskip}{1em}
\setlength{\headheight}{15pt}
\linespread{1.2}

\XeTeXlinebreaklocale "zh"
\XeTeXlinebreakskip = 0pt plus 1pt minus 0.1pt

\usepackage{listings}
\lstset{language=[ANSI]{C},
    %backgroundcolor=\color{lightgray},
    backgroundcolor=\color[rgb]{0.95,0.95,0.95},
    basicstyle=\footnotesize,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    commentstyle=\color{olive},
    directivestyle=\color{blue},
    extendedchars=false,
    frame=single,
    %frame=shadowbox,
    framerule=1pt,
    %keywordstyle=\color{blue}\bfseries,
    %morekeywords={*,define,*,include...},
    numbersep=5pt,
    rulesepcolor=\color{red!20!green!20!blue!20},
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    stepnumber=2,
    %numbers=right,
    %numberstyle=\tiny,
    stringstyle=\color{purple},
    tabsize=4,
    title=\lstname
}
