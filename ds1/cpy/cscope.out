cscope 15 $HOME/d2imdev/ds1/cpy               0000732798
	@anim.c

1 
	~<°rög.h
>

2 
	~"°ru˘s.h
"

3 
	~"dccöfo.h
"

4 
	~"misc.h
"

5 
	~"dc6öfo.h
"

6 
	~"™imd©a.h
"

7 
	~"™im.h
"

12 
	$™im_lﬂd_dcc
(

13 * 
«me
,

14 
COF_S
 * 
cof
,

15 
œy_idx
,

16 
u£r_dú
,

17 
UBYTE
 * 
∑lshi·


20 
LAY_INF_S
 * 
œy
;

21 
DCC_S
 * 
dcc
;

22 
íåy
, 
i
, 
size
, 
w
, 
h
, 
x
, 
y
;

23 * 
buff
;

24 
dú
 = 0, 
Àn
;

27 i‡((
cof
 =
NULL
Ë|| (
œy_idx
 >
COMPOSIT_NB
))

29 
œy
 = & 
cof
->
œy_öf
[
œy_idx
];

32 
íåy
 = 
	`misc_lﬂd_mpq_fûe
(
«me
, & 
buff
, & 
Àn
, 
FALSE
);

33 i‡(
íåy
 == -1)

37 
dcc
 = 
	`dcc_mem_lﬂd
(
buff
, 
Àn
);

38 
	`‰ì
(
buff
);

39 i‡(
dcc
 =
NULL
)

43 
cof
->
dú
)

45 1 : 
dú
 = 
glb_ds1edô
.
√w_dú1
[
u£r_dú
]; ;

46 4 : 
dú
 = 
glb_ds1edô
.
√w_dú4
[
u£r_dú
]; ;

47 8 : 
dú
 = 
glb_ds1edô
.
√w_dú8
[
u£r_dú
]; ;

48 16 : 
dú
 = 
glb_ds1edô
.
√w_dú16
[
u£r_dú
]; ;

49 32 : 
dú
 = 
glb_ds1edô
.
√w_dú32
[
u£r_dú
]; ;

53 i‡(
	`dcc_decode
(
dcc
, 1 << 
dú
))

55 
	`dcc_de°roy
(
dcc
);

60 
size
 = 
dcc
->
hódî
.
‰ames_≥r_dú
 * (
BITMAP
 *);

61 
œy
->
bmp_num
 = 
dcc
->
hódî
.
‰ames_≥r_dú
;

62 
œy
->
bmp
 = (
BITMAP
 **Ë
	`mÆloc
(
size
);

63 i‡(
œy
->
bmp
 =
NULL
)

65 
	`dcc_de°roy
(
dcc
);

68 
	`mem£t
(
œy
->
bmp
, 0, 
size
);

71 
w
 = 
dcc
->
‰ame
[
dú
][0].
bmp
->w;

72 
h
 = 
dcc
->
‰ame
[
dú
][0].
bmp
->h;

73 
œy
->
off_x
 = 
dcc
->
dúe˘i⁄
[
dú
].
box
.
xmö
;

74 
œy
->
off_y
 = 
dcc
->
dúe˘i⁄
[
dú
].
box
.
ymö
;

75 
i
=0; i < 
dcc
->
hódî
.
‰ames_≥r_dú
; i++)

77 
œy
->
bmp
[
i
] = 
	`¸óã_bôm≠
(
w
, 
h
);

78 i‡(
œy
->
bmp
[
i
] =
NULL
)

80 
i
)

82 
i
--;

83 
	`de°roy_bôm≠
(
œy
->
bmp
[
i
]);

85 
	`dcc_de°roy
(
dcc
);

88 i‡(
∑lshi·
)

90 
y
=0; y<
h
; y++)

91 
x
=0; x<
w
; x++)

92 
	`puçixñ
(
œy
->
bmp
[
i
], 
x
, 
y
, 
∑lshi·
[

93 
	`gëpixñ
(
dcc
->
‰ame
[
dú
][
i
].
bmp
, 
x
, 
y
)]);

96 
	`blô
(
dcc
->
‰ame
[
dú
][
i
].
bmp
, 
œy
->bmp[i], 0, 0, 0, 0, 
w
, 
h
);

100 
	`dcc_de°roy
(
dcc
);

102 
	}
}

106 
COF_S
 * 
	$™im_lﬂd_cof
(* 
ba£
, * 
tok
, * 
mod
, * 
˛as
,

107 
u£r_dú
, 
obj_löe
, 
¥ogªss
)

109 
TXT_S
 * 
txt
 = 
glb_ds1edô
.
obj_buff
,

110 * 
txt2
 = 
glb_ds1edô
.
obje˘s_buff
;

111 
COF_S
 * 
cof
;

112 * 
buff
, * 
b±r
, * 
•å
, * 
∑l_«me
, * 
∑l_buff
;

113 
™imd©a_«me
[80];

114 * 
Õå
, 
∑l_idx
=0, 
∑l_Àn
, 
id
, 
löe
, 
™imd©a_Âd
, 
™imd©a_•ìd
, 
Àn
;

115 
i
, 
size
, 
íåy
, 
idx
, 
d⁄e
, 
mode
;

116 
comp_°r
[
COMPOSIT_NB
][3] = {

119 
«me
[256];

122 i‡(
¥ogªss
)

123 
	`¥ötf
("\n");

126 
∑l_buff
 = 
NULL
;

127 i‡(
txt
->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJ
, "Cﬁ‹m≠")].
size
 &&

128 
txt
->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJ
, "Index")].
size
)

130 
∑l_«me
 = 
txt
->
d©a
 + (
obj_löe
 *Åxt->
löe_size
) +

131 
txt
->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJ
, "Cﬁ‹m≠")].
off£t
;

132 
•å
 = 
txt
->
d©a
 + (
obj_löe
 *Åxt->
löe_size
) +

133 
txt
->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJ
, "Index")].
off£t
;

134 
∑l_idx
 = * ((*Ë
•å
);

135 i‡(
∑l_«me
[0] && 
∑l_idx
)

137 i‡(
¥ogªss
)

139 
	`¥ötf
("load colormap <%s>, will use index %li\n",

140 
∑l_«me
, 
∑l_idx
);

141 
	`fÊush
(
°dout
);

143 
íåy
 = 
	`misc_lﬂd_mpq_fûe
(
∑l_«me
, & 
∑l_buff
, & 
∑l_Àn
, 
¥ogªss
);

144 i‡(
íåy
 != -1)

146 
∑l_idx
 = (pal_idx - 1) * 256;

147 i‡((
∑l_idx
 + 255Ë>
∑l_Àn
)

149 
	`‰ì
(
∑l_buff
);

150 
∑l_buff
 = 
NULL
;

153 i‡(
¥ogªss
)

155 
	`¥ötf
(" (couldn'tÜoadÅhe colormap)\n");

156 
	`fÊush
(
°dout
);

162 
	`•rötf
(

163 
«me
,

164 "%s\\%s\\Cof\\%s%s%s.cof", 
ba£
, 
tok
,Åok, 
mod
, 
˛as


166 i‡(
¥ogªss
)

168 
	`¥ötf
("\∆ﬂd COF <%s>\n", 
«me
);

169 
	`fÊush
(
°dout
);

171 
íåy
 = 
	`misc_lﬂd_mpq_fûe
(
«me
, & 
buff
, & 
Àn
, 
¥ogªss
);

172 i‡(
íåy
 == -1)

173  
NULL
;

176 
size
 = (
COF_S
);

177 
cof
 = (
COF_S
 *Ë
	`mÆloc
(
size
);

178 i‡(
cof
 =
NULL
)

180 
	`‰ì
(
buff
);

181  
NULL
;

183 
	`mem£t
(
cof
, 0, 
size
);

187 
cof
->
cur_dú
 = 
u£r_dú
;

189 
b±r
 = 
buff
;

192 
cof
->
œy
 = * 
b±r
;

193 
b±r
++;

196 
cof
->
Âd
 = * 
b±r
;

197 
cof
->
cur_‰ame
 = 
	`ønd
(Ë% cof->
Âd
;

198 
b±r
++;

201 
cof
->
dú
 = * 
b±r
;

202 
b±r
++;

205 
b±r
 += 25;

208 
i
=0; i < 
cof
->
œy
; i++)

211 
idx
 = * 
b±r
;

212 
b±r
++;

215 
cof
->
œy_öf
[
idx
].
shad_a
 = * 
b±r
;

216 
b±r
++;

217 
cof
->
œy_öf
[
idx
].
shad_b
 = * 
b±r
;

218 
b±r
++;

221 
cof
->
œy_öf
[
idx
].
å™s_a
 = * 
b±r
;

222 
b±r
++;

223 
cof
->
œy_öf
[
idx
].
å™s_b
 = * 
b±r
;

224 
b±r
++;

227 
	`mem˝y
(
cof
->
œy_öf
[
idx
].
w˛ass
, 
b±r
, 4);

228 
b±r
 += 4;

231 
•å
 = 
txt
->
d©a
 + (
obj_löe
 *Åxt->
löe_size
) +

232 
txt
->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJ
, "HD"Ë+ 
idx
].
off£t
;

233 
	`•rötf
(
«me
, "%s\\%s\\%s\\%s%s%s%s%s.dcc",

234 
ba£
,

235 
tok
,

236 
comp_°r
[
idx
],

237 
tok
,

238 
comp_°r
[
idx
],

239 
•å
,

240 
mod
,

241 
cof
->
œy_öf
[
idx
].
w˛ass


244 i‡(
¥ogªss
)

246 
	`¥ötf
("\∆ﬂd DCC <%s>\n", 
«me
);

247 
	`fÊush
(
°dout
);

250 i‡(
	`°æí
(
«me
))

252 i‡((
∑l_buff
 !
NULL
Ë&& (
cof
->
œy_öf
[
idx
].
å™s_a
 == 0))

256 i‡(
	`™im_lﬂd_dcc
(
«me
, 
cof
, 
idx
, 
u£r_dú
, (
UBYTE
 *Ë(
∑l_buff
 + 
∑l_idx
)))

259 
«me
[
	`°æí
(name) - 1] = '6';

260 
	`™im_lﬂd_dc6
(
«me
, 
cof
, 
idx
, 
u£r_dú
, (
UBYTE
 *Ë(
∑l_buff
 + 
∑l_idx
));

266 i‡(
	`™im_lﬂd_dcc
(
«me
, 
cof
, 
idx
, 
u£r_dú
, 
NULL
))

269 
«me
[
	`°æí
(name) - 1] = '6';

270 
	`™im_lﬂd_dc6
(
«me
, 
cof
, 
idx
, 
u£r_dú
, 
NULL
);

277 
b±r
 +
cof
->
Âd
;

282 
size
 = 
cof
->
dú
 * cof->
Âd
 * cof->
œy
;

283 
cof
->
¥i‹ôy
 = (
UBYTE
 *Ë
	`mÆloc
(
size
);

284 i‡(
cof
->
¥i‹ôy
 =
NULL
)

286 
	`‰ì
(
cof
);

287 
	`‰ì
(
buff
);

288  
NULL
;

292 
	`mem˝y
(
cof
->
¥i‹ôy
, 
b±r
, 
size
);

295 
cof
->
•d_mul
 = 1;

296 
cof
->
•d_div
 = 256;

299 
cof
->
xoff£t
 = cof->
yoff£t
 = 0;

302 
	`•rötf
(
™imd©a_«me
, "%s%s%s", 
tok
, 
mod
, 
˛as
);

303 i‡(
	`™imd©a_gë_cof_öfo
(
™imd©a_«me
, & 
™imd©a_Âd
, & 
™imd©a_•ìd
) == 0)

307 
cof
->
•d_mul
 = 
™imd©a_•ìd
;

308 
cof
->
•d_div
 = 256;

312 
•å
 = 
txt
->
d©a
 +

313 (
obj_löe
 * 
txt
->
löe_size
) +

314 
txt
->
cﬁ
[
glb_ds1edô
.
cﬁ_obj_id
].
off£t
;

315 
Õå
 = (*Ë
•å
;

316 
id
 = * 
Õå
;

317 
	`¥ötf
("obje˘ %†ID = %li\n", 
«me
, 
id
);

321 i‡(
	`°ricmp
(
mod
, "NU") == 0)

322 
mode
 = 0;

323 i‡(
	`°ricmp
(
mod
, "OP") == 0)

324 
mode
 = 1;

325 i‡(
	`°ricmp
(
mod
, "ON") == 0)

326 
mode
 = 2;

327 i‡(
	`°ricmp
(
mod
, "S1") == 0)

328 
mode
 = 3;

329 i‡(
	`°ricmp
(
mod
, "S2") == 0)

330 
mode
 = 4;

331 i‡(
	`°ricmp
(
mod
, "S3") == 0)

332 
mode
 = 5;

333 i‡(
	`°ricmp
(
mod
, "S4") == 0)

334 
mode
 = 6;

335 i‡(
	`°ricmp
(
mod
, "S5") == 0)

336 
mode
 = 7;

341 
	`‰ì
(
buff
);

342 i‡(
∑l_buff
)

343 
	`‰ì
(
∑l_buff
);

344  
cof
;

348 i‡(
id
)

350 
d⁄e
 = 
FALSE
;

351 
i
 = 0;

352 
löe
 = 0;

353 
glb_ds1edô
.
obj_desc
[
obj_löe
].
obje˘s_löe
 = -1;

354  ! 
d⁄e
)

356 
•å
 = 
txt2
->
d©a
 +

357 (
i
 * 
txt2
->
löe_size
) +

358 
txt2
->
cﬁ
[
glb_ds1edô
.
cﬁ_obje˘s_id
].
off£t
;

359 
Õå
 = (*Ë
•å
;

360 i‡–(* 
Õå
Ë=
id
)

362 
d⁄e
 = 
TRUE
;

363 
löe
 = 
i
;

367 
i
++;

368 i‡(
i
 >
txt2
->
löe_num
)

371 
	`‰ì
(
buff
);

372 i‡(
∑l_buff
)

373 
	`‰ì
(
∑l_buff
);

374  
cof
;

378 
glb_ds1edô
.
obj_desc
[
obj_löe
].
obje˘s_löe
 = 
löe
;

381 
•å
 =

382 
txt2
->
d©a
 +

383 (
löe
 * 
txt2
->
löe_size
) +

384 
txt2
->
cﬁ
[
glb_ds1edô
.
cﬁ_‰ame_dñè
[
mode
]].
off£t
;

385 
Õå
 = (*Ë
•å
;

386 
cof
->
•d_mul
 = (* 
Õå
) == 0 ? 256 : (*Üptr);

389 
cof
->
•d_div
 = 256;

392 i‡(
txt2
->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJECTS
, "Xoff£t")].
size
)

394 
•å
 = 
txt2
->
d©a
 + (
löe
 *Åxt2->
löe_size
) +

395 
txt2
->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJECTS
, "Xoff£t")].
off£t
;

396 
Õå
 = (*Ë
•å
;

397 
cof
->
xoff£t
 = * 
Õå
;

399 i‡(
txt2
->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJECTS
, "Yoff£t")].
size
)

401 
•å
 = 
txt2
->
d©a
 + (
löe
 *Åxt2->
löe_size
) +

402 
txt2
->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJECTS
, "Yoff£t")].
off£t
;

403 
Õå
 = (*Ë
•å
;

404 
cof
->
yoff£t
 = * 
Õå
;

408 i‡(
txt2
->
cﬁ
[
glb_ds1edô
.
cﬁ_‹dîÊag
[
mode
]].
size
)

410 
•å
 =

411 
txt2
->
d©a
 +

412 (
löe
 * 
txt2
->
löe_size
) +

413 
txt2
->
cﬁ
[
glb_ds1edô
.
cﬁ_‹dîÊag
[
mode
]].
off£t
;

414 
Õå
 = (*Ë
•å
;

415 
cof
->
‹dîÊag
 = * 
Õå
;

419 i‡–* 
Õå
 == 0)

421 i‡(
txt2
->
cﬁ
[
glb_ds1edô
.
cﬁ_‹dîÊag
[0]].
size
)

423 
•å
 =

424 
txt2
->
d©a
 +

425 (
löe
 * 
txt2
->
löe_size
) +

426 
txt2
->
cﬁ
[
glb_ds1edô
.
cﬁ_‹dîÊag
[0]].
off£t
;

427 
Õå
 = (*Ë
•å
;

428 
cof
->
‹dîÊag
 = * 
Õå
;

432 
	`¥ötf
("obje˘ %†‹dîÊag = %li\n", 
«me
, 
cof
->
‹dîÊag
);

437 
	`‰ì
(
buff
);

438 i‡(
∑l_buff
)

439 
	`‰ì
(
∑l_buff
);

440  
cof
;

441 
	}
}

445 
COF_S
 * 
	$™im_lﬂd_desc_gfx
(
i
, 
¥ogªss
)

447 
TXT_S
 * 
txt
 = 
glb_ds1edô
.
obj_buff
;

448 
COF_S
 * 
cof
 = 
NULL
;

449 * 
ba£
, * 
tok
, * 
mod
, * 
˛as
, *
•å
;

450 * 
dú±r
, 
dú
;

453 i‡(
txt
 =
NULL
)

454  
NULL
;

456 
ba£
 = 
txt
->
d©a
 + (
i
 *Åxt->
löe_size
Ë+Åxt->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJ
, "Ba£")].
off£t
;

457 
tok
 = 
txt
->
d©a
 + (
i
 *Åxt->
löe_size
Ë+Åxt->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJ
, "Tokí")].
off£t
;

458 
mod
 = 
txt
->
d©a
 + (
i
 *Åxt->
löe_size
Ë+Åxt->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJ
, "Mode")].
off£t
;

459 
˛as
 = 
txt
->
d©a
 + (
i
 *Åxt->
löe_size
Ë+Åxt->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJ
, "Cœss")].
off£t
;

460 
•å
 = 
txt
->
d©a
 + (
i
 *Åxt->
löe_size
Ë+Åxt->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJ
, "Dúe˘i⁄")].
off£t
;

461 
dú±r
 = (*Ë
•å
;

463 
dú
 = 0;

464 i‡(
txt
->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJ
, "Dúe˘i⁄")].
size
)

465 
dú
 = * 
dú±r
;

467 i‡(
ba£
[0] && 
tok
[0] && 
mod
[0] && 
˛as
[0])

468 
cof
 = 
	`™im_lﬂd_cof
(
ba£
, 
tok
, 
mod
, 
˛as
, 
dú
, 
i
, 
¥ogªss
);

470  
cof
;

471 
	}
}

475 
	$™im_de°roy_cof
(
COF_S
 * 
cof
)

477 
BITMAP
 ** 
bmp
;

478 
b
, 
max_b
, 
c
, 
size
 = 0;

480 i‡(
cof
 =
NULL
)

484 
c
=0; c < 
COMPOSIT_NB
; c++)

486 
bmp
 = 
cof
->
œy_öf
[
c
].bmp;

487 i‡(
bmp
 !
NULL
)

489 
max_b
 = 
cof
->
œy_öf
[
c
].
bmp_num
;

490 
b
=0; b < 
max_b
; b++)

492 i‡(
bmp
[
b
] !
NULL
)

494 
size
 +(
BITMAP
);

495 
size
 +
bmp
[
b
]->
w
 * bmp[b]->
h
;

496 
	`de°roy_bôm≠
(
bmp
[
b
]);

499 
size
 +
max_b
 *  (
BITMAP
 *);

500 
	`‰ì
(
bmp
);

505 i‡(
cof
->
¥i‹ôy
 !
NULL
)

507 
size
 +
cof
->
dú
 * cof->
Âd
 * cof->
œy
;

508 
	`‰ì
(
cof
->
¥i‹ôy
);

512 
size
 +(
COF_S
);

513 
	`‰ì
(
cof
);

516  
size
;

517 
	}
}

521 
	$™im_upd©e_gfx
(
¥ogªss
)

523 
TXT_S
 * 
txt
 = 
glb_ds1edô
.
obj_buff
;

524 
COF_S
 * 
cof
;

525 
d
, 
od
, 
o
, 
idx
, 
ds1_™im_u£d
;

527 i‡(
txt
 =
NULL
)

533 
od
=0; od < 
txt
->
löe_num
; od++)

534 
glb_ds1edô
.
obj_desc
[
od
].
ußge_cou¡
 = 0;

537 
d
=0; d < 
DS1_MAX
; d++)

539 i‡(
glb_ds1
[
d
].
«me
[0] == 0)

541 
o
=0; o < 
glb_ds1
[
d
].
obj_num
; o++)

543 
idx
 = 
glb_ds1
[
d
].
obj
[
o
].
desc_idx
;

544 i‡(
idx
 != -1)

545 
glb_ds1edô
.
obj_desc
[
idx
].
ußge_cou¡
++;

550 
od
=0; od < 
txt
->
löe_num
; od++)

552 
cof
 = 
glb_ds1edô
.
obj_desc
[
od
].cof;

553 i‡(
glb_ds1edô
.
obj_desc
[
od
].
ußge_cou¡
 == 0)

556 i‡(
cof
 !
NULL
)

559 
	`™im_de°roy_cof
(
cof
);

560 
glb_ds1edô
.
obj_desc
[
od
].
cof
 = 
NULL
;

566 i‡(
cof
 =
NULL
)

569 
glb_ds1edô
.
obj_desc
[
od
].
cof
 = 
	`™im_lﬂd_desc_gfx
(od, 
¥ogªss
);

570 i‡(
¥ogªss
)

572 
	`Ârötf
(
°dîr
, ".");

573 
	`fÊush
(
°dîr
);

580 
d
=0; d < 
DS1_MAX
; d++)

582 i‡(
glb_ds1
[
d
].
«me
[0] == 0)

584 
ds1_™im_u£d
 = 
FALSE
;

585 
o
=0; o < 
glb_ds1
[
d
].
obj_num
; o++)

587 
idx
 = 
glb_ds1
[
d
].
obj
[
o
].
desc_idx
;

588 i‡(
idx
 != -1)

590 i‡(
glb_ds1edô
.
obj_desc
[
idx
].
cof
 !
NULL
)

592 
ds1_™im_u£d
 = 
TRUE
;

593 
o
 = 
glb_ds1
[
d
].
obj_num
;

597 i‡(
ds1_™im_u£d
 =
FALSE
)

598 
glb_ds1
[
d
].
™im©i⁄s_œyî_mask
 = 0;

600 
	}
}

604 
	$™im_exô
()

606 
TXT_S
 * 
txt
 = 
glb_ds1edô
.
obj_buff
;

607 
COF_S
 * 
cof
;

608 
i
, 
size
 = 0;

611 i‡(
txt
 =
NULL
)

613 i‡(
glb_ds1edô
.
obj_desc
 =
NULL
)

616 
i
=0; i < 
txt
->
löe_num
; i++)

618 
cof
 = 
glb_ds1edô
.
obj_desc
[
i
].cof;

619 i‡(
cof
 !
NULL
)

621 
size
 +
	`™im_de°roy_cof
(
cof
);

622 
glb_ds1edô
.
obj_desc
[
i
].
cof
 = 
NULL
;

625  
size
;

626 
	}
}

	@anim.h

1 #i‚de‡
_ANIM_H_


3 
	#_ANIM_H_


	)

5 
™im_lﬂd_dcc
 (* 
«me
, 
COF_S
 * 
cof
, 
œy_idx
, 
u£r_dú
, 
UBYTE
 * 
∑lshi·
);

6 
COF_S
 * 
™im_lﬂd_cof
 (* 
ba£
, * 
tok
, * 
mod
, * 
˛as
, 
u£r_dú
, 
obj_löe
, 
¥ogªss
);

7 
COF_S
 * 
™im_lﬂd_desc_gfx
 (
i
, 
¥ogªss
);

8 
™im_de°roy_cof
 (
COF_S
 * 
cof
);

9 
™im_upd©e_gfx
 (
¥ogªss
);

10 
™im_exô
 ();

	@animdata.c

1 
	~<°rög.h
>

2 
	~<˘y≥.h
>

3 
	~"°ru˘s.h
"

4 
	~"misc.h
"

5 
	~"™imd©a.h
"

9 
UBYTE
 
	$™imd©a_hash_vÆue
(* 
«me
)

11 
i
, 
nb
 = 
	`°æí
(
«me
);

12 
UBYTE
 
hash
 = 0;

14 
i
=0; i < 
	`°æí
(
«me
); i++)

16 i‡(
«me
[
i
] == '.')

17 
nb
 = 
i
;

19 
i
=0; i < 
nb
; i++)

20 
hash
 +
	`touµî
(
«me
[
i
]);

21  
hash
;

22 
	}
}

26 
	$™imd©a_lﬂd
()

28 * 
«me
 = "D©a\\GlobÆ\\AnimD©a.d2", 
™imd©a_«me
[10];

29 
íåy
, 
d⁄e
 = 
FALSE
, 
cuº_block
 = 0;

30 * 
Õå
, 
nb_ªc
;

31 
ANIM_DATA_RECORD_S
 * 
ªc_±r
 = 
NULL
;

32 
UBYTE
 
hash
;

36 i‡(
glb_ds1edô
.
™im_d©a
.
buf„r
 !
NULL
)

37 
	`‰ì
(
glb_ds1edô
.
™im_d©a
.
buf„r
);

40 
	`mem£t
–& 
glb_ds1edô
.
™im_d©a
, 0, (glb_ds1edit.anim_data));

41 
íåy
 = 
	`misc_lﬂd_mpq_fûe
(

42 
«me
,

43 (**Ë& 
glb_ds1edô
.
™im_d©a
.
buf„r
,

44 & 
glb_ds1edô
.
™im_d©a
.
buf„r_size
,

45 
FALSE


47 i‡((
íåy
 =-1Ë|| (
glb_ds1edô
.
™im_d©a
.
buf„r_size
 <= 4))

49 
	`¥ötf
("îr‹ : couldn'àlﬂd <%s>\n", 
«me
);

53 
	`¥ötf
("ok, <%s> found\n", 
«me
);

56 
Õå
 = ((*Ë
glb_ds1edô
.
™im_d©a
.
buf„r
);

57  ! 
d⁄e
)

59 
nb_ªc
 = * 
Õå
;

60 
Õå
++;

62 i‡(
nb_ªc
)

64 
ªc_±r
 = (
ANIM_DATA_RECORD_S
 *Ë
Õå
;

65 
	`mem£t
(
™imd©a_«me
, 0, (animdata_name));

66 
	`°∫˝y
(
™imd©a_«me
, 
ªc_±r
->
cof_«me
, 8);

67 
hash
 = 
	`™imd©a_hash_vÆue
(
™imd©a_«me
);

70 
hash
 = 0;

73 
	`¥ötf
(" block %3i, hash = %3i, #Ñec‹d†%li\n", 
cuº_block
, 
hash
, 
nb_ªc
);

74 
	`fÊush
(
°dout
);

75 
cuº_block
++;

78 i‡(
nb_ªc
)

80 
glb_ds1edô
.
™im_d©a
.
block_poöãr
[
hash
] = 
ªc_±r
;

81 
glb_ds1edô
.
™im_d©a
.
nb_ªc‹ds
[
hash
] = 
nb_ªc
;

85 
Õå
 +40 * 
nb_ªc
;

86 i‡–(
UBYTE
 *Ë
Õå
 >=

87 ((
UBYTE
 *Ë
glb_ds1edô
.
™im_d©a
.
buf„r
 + glb_ds1edô.™im_d©a.
buf„r_size
)

90 
d⁄e
 = 
TRUE
;

93 
	`¥ötf
("\n");

94 
	}
}

100 
	$™imd©a_gë_cof_öfo
(* 
«me
, * 
Âd
, * 
•ìd
)

102 
ANIM_DATA_RECORD_S
 * 
ªc_±r
;

103 
UBYTE
 
hash
;

104 
i
;

105 
ªc_«me
[80];

108 
hash
 = 
	`™imd©a_hash_vÆue
(
«me
);

109 
	`¥ötf
("%†i†hash %i", 
«me
, 
hash
);

110 i‡(
glb_ds1edô
.
™im_d©a
.
block_poöãr
[
hash
])

112 
ªc_±r
 = 
glb_ds1edô
.
™im_d©a
.
block_poöãr
[
hash
];

113 
i
=0; i < 
glb_ds1edô
.
™im_d©a
.
nb_ªc‹ds
[
hash
]; i++)

115 
	`mem£t
(
ªc_«me
, 0, (rec_name));

116 
	`°∫˝y
(
ªc_«me
, 
ªc_±r
[
i
].
cof_«me
, 8);

117 i‡(
	`°ricmp
(
ªc_«me
, 
«me
) == 0)

119 * 
Âd
 = 
ªc_±r
[
i
].
‰ames_≥r_dú
;

120 * 
•ìd
 = 
ªc_±r
[
i
].speed;

121 
	`¥ötf
(",Ñec‹d %òöÅh© block\n", 
i
);

122 
	`fÊush
(
°dout
);

127 * 
Âd
 = 0;

128 * 
•ìd
 = 0;

129 
	`¥ötf
(", butÉrror :Çot found inÅhere\n");

130 
	`fÊush
(
°dout
);

132 
	}
}

	@animdata.h

1 #i‚de‡
_ANIMDATA_H_


3 
	#_ANIMDATA_H_


	)

5 
UBYTE
 
™imd©a_hash_vÆue
 (* 
«me
);

6 
™imd©a_lﬂd
 ();

7 
™imd©a_gë_cof_öfo
 (* 
«me
, * 
Âd
, * 
•ìd
);

	@dc6info.c

1 
	~"°ru˘s.h
"

2 
	~"misc.h
"

3 
	~"dc6öfo.h
"

7 
	$dc6_decomp_n‹m
(* 
§c
, 
BITMAP
 * 
d°
, 
size
, 
x0
, 
y0
)

9 
UBYTE
 * 
±r
 = (UBYTE *Ë
§c
;

10 
i
;

11 
i2
, 
x
=
x0
, 
y
=
y0
, 
c
, 
c2
;

14 
i
=0; i<
size
; i++)

16 
c
 = * (
±r
 ++);

18 i‡(
c
 == 0x80)

20 
x
 = 
x0
;

21 
y
--;

23 i‡(
c
 & 0x80)

24 
x
 +
c
 & 0x7F;

27 
i2
=0; i2<
c
; i2++)

29 
c2
 = * (
±r
 ++);

30 
i
++;

31 
	`puçixñ
(
d°
, 
x
, 
y
, 
c2
);

32 
x
++;

36 
	}
}

41 
	$dc6_decomp_cm≠
(* 
§c
, 
BITMAP
 * 
d°
, 
size
, 
x0
, 
y0
,

42 
UBYTE
 * 
cm≠
)

44 
UBYTE
 * 
±r
 = (UBYTE *Ë
§c
;

45 
i
;

46 
i2
, 
x
=
x0
, 
y
=
y0
, 
c
, 
c2
;

49 
i
=0; i<
size
; i++)

51 
c
 = * (
±r
 ++);

53 i‡(
c
 == 0x80)

55 
x
 = 
x0
;

56 
y
--;

58 i‡(
c
 & 0x80)

59 
x
 +
c
 & 0x7F;

62 
i2
=0; i2<
c
; i2++)

64 
c2
 = * (
±r
 ++);

65 
i
++;

66 
	`puçixñ
(
d°
, 
x
, 
y
, 
cm≠
[
c2
]);

67 
x
++;

71 
	}
}

75 
	$™im_lﬂd_dc6
(* 
«me
, 
COF_S
 * 
cof
, 
œy_idx
, 
u£r_dú
,

76 
UBYTE
 * 
∑lshi·
)

78 
LAY_INF_S
 * 
œy
;

79 
íåy
, 
i
, 
size
, 
w
, 
h
, 
x1
, 
y1
, 
x2
, 
y2
;

80 * 
buff
;

81 
dú
 = 0, * 
Õå
, 
off£t
, 
Àn
;

82 
dc6_vî
, 
dc6_unk1
, 
dc6_unk2
, 
dc6_dú
, 
dc6_Âd
, * 
dc6_Âå
,

83 
f_w
, 
f_h
, 
f_offx
, 
f_offy
, 
f_x1
, 
f_x2
, 
f_y1
, 
f_y2
,

84 
f_Àn
;

85 
UBYTE
 * 
f_d©a
;

88 i‡((
cof
 =
NULL
Ë|| (
œy_idx
 >
COMPOSIT_NB
))

90 
œy
 = & 
cof
->
œy_öf
[
œy_idx
];

93 
íåy
 = 
	`misc_lﬂd_mpq_fûe
(
«me
, & 
buff
, & 
Àn
, 
FALSE
);

94 i‡(
íåy
 == -1)

98 
Õå
 = (*Ë
buff
;

99 
dc6_vî
 = 
Õå
[0];

100 
dc6_unk1
 = 
Õå
[1];

101 
dc6_unk2
 = 
Õå
[2];

102 
dc6_dú
 = 
Õå
[4];

103 
dc6_Âd
 = 
Õå
[5];

104 
dc6_Âå
 = & 
Õå
[6];

105 i‡((
dc6_vî
 !6Ë|| (
dc6_unk1
 !1Ë|| (
dc6_unk2
 != 0))

107 
	`‰ì
(
buff
);

112 i‡(
dc6_dú
 !
cof
->
dú
)

114 
	`‰ì
(
buff
);

119 
cof
->
dú
)

121 1 : 
dú
 = 
glb_ds1edô
.
√w_dú1
[
u£r_dú
]; ;

122 4 : 
dú
 = 
glb_ds1edô
.
√w_dú4
[
u£r_dú
]; ;

123 8 : 
dú
 = 
glb_ds1edô
.
√w_dú8
[
u£r_dú
]; ;

124 16 : 
dú
 = 
glb_ds1edô
.
√w_dú16
[
u£r_dú
]; ;

125 32 : 
dú
 = 
glb_ds1edô
.
√w_dú32
[
u£r_dú
]; ;

131 
x1
 = 
y1
 = 0x7FFFFFFFL;

132 
x2
 = 
y2
 = 0x80000000L;

133 
i
=0; i < 
dc6_Âd
; i++)

136 
off£t
 = 
dc6_Âå
[
dú
 * 
dc6_Âd
 + 
i
];

137 i‡(
off£t
 >
Àn
)

139 
	`‰ì
(
buff
);

142 
Õå
 = (*Ë(
buff
 + 
off£t
);

145 
f_w
 = 
Õå
[1];

146 
f_h
 = 
Õå
[2];

147 
f_offx
 = 
Õå
[3];

148 
f_offy
 = 
Õå
[4];

150 
f_x1
 = 
f_offx
;

151 
f_x2
 = 
f_x1
 + 
f_w
 - 1;

152 
f_y2
 = 
f_offy
;

153 
f_y1
 = 
f_y2
 - 
f_h
 + 1;

155 i‡(
f_x1
 < 
x1
)

156 
x1
 = 
f_x1
;

157 i‡(
f_x2
 > 
x2
)

158 
x2
 = 
f_x2
;

159 i‡(
f_y1
 < 
y1
)

160 
y1
 = 
f_y1
;

161 i‡(
f_y2
 > 
y2
)

162 
y2
 = 
f_y2
;

164 
w
 = 
x2
 - 
x1
 + 1;

165 
h
 = 
y2
 - 
y1
 + 1;

167 i‡((
w
 <0Ë|| (
h
 <= 0))

169 
	`‰ì
(
buff
);

173 
œy
->
off_x
 = 
x1
;

174 
œy
->
off_y
 = 
y1
;

177 
size
 = 
dc6_Âd
 * (
BITMAP
 *);

178 
œy
->
bmp_num
 = 
dc6_Âd
;

179 
œy
->
bmp
 = (
BITMAP
 **Ë
	`mÆloc
(
size
);

180 i‡(
œy
->
bmp
 =
NULL
)

182 
	`‰ì
(
buff
);

185 
	`mem£t
(
œy
->
bmp
, 0, 
size
);

188 
i
=0; i < 
dc6_Âd
; i++)

191 
off£t
 = 
dc6_Âå
[
dú
 * 
dc6_Âd
 + 
i
];

192 i‡(
off£t
 >
Àn
)

194 
i
)

196 
i
--;

197 
	`de°roy_bôm≠
(
œy
->
bmp
[
i
]);

199 
	`‰ì
(
buff
);

202 
Õå
 = (*Ë(
buff
 + 
off£t
);

205 
f_w
 = 
Õå
[1];

206 
f_h
 = 
Õå
[2];

207 
f_offx
 = 
Õå
[3];

208 
f_offy
 = 
Õå
[4];

209 
f_Àn
 = 
Õå
[7];

210 
f_d©a
 = (
UBYTE
 *Ë(& 
Õå
[8]);

213 
œy
->
bmp
[
i
] = 
	`¸óã_bôm≠
(
w
, 
h
);

214 i‡(
œy
->
bmp
[
i
] =
NULL
)

216 
i
)

218 
i
--;

219 
	`de°roy_bôm≠
(
œy
->
bmp
[
i
]);

221 
	`‰ì
(
buff
);

224 
	`˛ór
(
œy
->
bmp
[
i
]);

227 i‡(
∑lshi·
 =
NULL
)

229 
	`dc6_decomp_n‹m
(

230 
f_d©a
,

231 
œy
->
bmp
[
i
],

232 
f_Àn
,

233 
f_offx
 - 
x1
,

234 
h
 - 1 + 
f_offy
 - 
y2


239 
	`dc6_decomp_cm≠
(

240 
f_d©a
,

241 
œy
->
bmp
[
i
],

242 
f_Àn
,

243 
f_offx
 - 
x1
,

244 
h
 - 1 + 
f_offy
 - 
y2
,

245 
∑lshi·


249 
	`‰ì
(
buff
);

251 
	}
}

	@dc6info.h

1 #i‚de‡
_DC6_INFO_H_


3 
	#_DC6_INFO_H_


	)

5 
dc6_decomp_n‹m
 (* 
§c
, 
BITMAP
 * 
d°
, 
size
, 
x0
, 
y0
);

6 
dc6_decomp_cm≠
 (* 
§c
, 
BITMAP
 * 
d°
, 
size
, 
x0
, 
y0
, 
UBYTE
 * 
cm≠
);

7 
™im_lﬂd_dc6
 (* 
«me
, 
COF_S
 * 
cof
, 
œy_idx
, 
u£r_dú
, 
UBYTE
 * 
∑lshi·
);

	@dccinfo.c

1 
	~<°dio.h
>

2 
	~<°rög.h
>

3 
	~"ty≥s.h
"

5 #ifde‡
WIN32


6 #¥agm®
w¨nög
 (
push
)

7 #¥agm®
w¨nög
 (
dißbÀ
 : 4312 )

10 
	~<ÆÀgro.h
>

12 #ifde‡
WIN32


13 #¥agm®
w¨nög
 (
p›
)

16 
	~"dccöfo.h
"

18 
	#DCCINFO_SAVE_PCX


	)

23 
	$dcc_öô
()

25 
i
,

26 
ãmp
[16] = {0, 1, 2, 4, 6, 8, 10, 12, 14, 16, 20, 24, 26, 28, 30, 32};

28 
i
=0; i<16; i++)

29 
dcc_bôs_width_èbÀ
[
i
] = 
ãmp
[i];

31 
	`mem£t
(
dcc_îr‹
, 0, (dcc_error));

32 
	}
}

39 
	$dcc_ªad_byãs
(
DCC_BITSTREAM_S
 * 
bs
, 
byãs_numbî
, * 
de°
)

41 
i
;

44 i‡(
bs
->
cur_bô
)

46 
	`•rötf
(
dcc_îr‹
, "dcc_read_bytes() : bytesÑeading must beáligned "

47 "⁄á byã bound¨y (cur_bô = %i)\n", 
bs
->
cur_bô
);

52 
i
=0; i < 
byãs_numbî
; i++)

54 i‡(
bs
->
cur_bô_num
 >bs->
size
)

56 
	`•rötf
(
dcc_îr‹
, "dcc_read_bytes() : wantÅoÑead behind "

58 
bs
->
cur_bô_num
, bs->
size
);

61 * (((
UBYTE
 *Ë
de°
Ë+ 
i
Ë
bs
->
d©a
[bs->
cur_byã
];

62 
bs
->
cur_byã
 ++;

63 
bs
->
cur_bô_num
 += 8;

68 
	}
}

77 
	$dcc_ªad_bôs
(
DCC_BITSTREAM_S
 * 
bs
, 
bôs_numbî
, 
is_sig√d
,

78 
UDWORD
 * 
de°
 )

80 
b
, 
de°_bô
 = 0, 
de°_byã
 = 0;

84 * 
de°
 = 0;

98 i‡(
bôs_numbî
 < 0)

100 
	`•rötf
(
dcc_îr‹
, "dcc_read_bits() : can'tÑead %i bits\n",

101 
bôs_numbî
);

105 i‡(
bôs_numbî
 > 32)

107 
	`•rötf
(
dcc_îr‹
, "dcc_read_bits() : can'tÑead moreÅhan 32 bits "

113 
b
=0; b < 
bôs_numbî
; b++)

115 i‡(
bs
->
cur_bô_num
 >bs->
size
)

117 
	`•rötf
(
dcc_îr‹
, "dcc_read_bits() : wantÅoÑead behind "

119 
bs
->
cur_bô_num
, bs->
size
);

124 i‡–
bs
->
d©a
[bs->
cur_byã
] & (1 << bs->
cur_bô
) )

125 * (((
UBYTE
 *Ë
de°
Ë+ 
de°_byã
Ë|(1 << 
de°_bô
);

128 
de°_bô
++;

129 i‡(
de°_bô
 >= 8)

131 
de°_bô
 = 0;

132 
de°_byã
++;

134 
bs
->
cur_bô
++;

135 
bs
->
cur_bô_num
++;

136 i‡(
bs
->
cur_bô
 >= 8)

138 
bs
->
cur_bô
 = 0;

139 
bs
->
cur_byã
++;

144 i‡(
is_sig√d
 =
FALSE
)

149 i‡((* 
de°
Ë& (1 << (
bôs_numbî
-1)) )

152 (* 
de°
Ë|~ ((1 << 
bôs_numbî
) - 1);

156 
	}
}

162 
	$dcc_‰ame_hódî_bô°ªam
(
DCC_S
 *
dcc
, 
DCC_BITSTREAM_S
 *
bs
, 
d
, 
f
)

164 
DCC_DIRECTION_S
 * 
dú
 = & 
dcc
->
dúe˘i⁄
[
d
];

165 
DCC_FRAME_S
 * 
‰m
 = & 
dcc
->
‰ame
[
d
][
f
];

166 
sign
, 
width
=0, 
i
;

167 * 
±r
 = 
NULL
;

168 
add_îr‹
[80], 
°r
[30];

172 
i
=0; i<8; i++)

174 
sign
 = 
FALSE
;

175 
i
)

178 
width
 = 
dú
->
v¨übÀ0_bôs
;

179 
±r
 = & 
‰m
->
v¨übÀ0
;

180 
	`°r˝y
(
°r
, "variable0");

184 
width
 = 
dú
->
width_bôs
;

185 
±r
 = & 
‰m
->
width
;

186 
	`°r˝y
(
°r
, "width");

190 
width
 = 
dú
->
height_bôs
;

191 
±r
 = & 
‰m
->
height
;

192 
	`°r˝y
(
°r
, "height");

196 
sign
 = 
TRUE
;

197 
width
 = 
dú
->
xoff£t_bôs
;

198 
±r
 = & 
‰m
->
xoff£t
;

199 
	`°r˝y
(
°r
, "xoffset");

203 
sign
 = 
TRUE
;

204 
width
 = 
dú
->
yoff£t_bôs
;

205 
±r
 = & 
‰m
->
yoff£t
;

206 
	`°r˝y
(
°r
, "yoffset");

210 
width
 = 
dú
->
›ti⁄Æ_byãs_bôs
;

211 
±r
 = & 
‰m
->
›ti⁄Æ_byãs
;

212 
	`°r˝y
(
°r
, "optional_bytes");

216 
width
 = 
dú
->
coded_byãs_bôs
;

217 
±r
 = & 
‰m
->
coded_byãs
;

218 
	`°r˝y
(
°r
, "coded_bytes");

222 
width
 = 1;

223 
±r
 = & 
‰m
->
bŸtom_up
;

224 
	`°r˝y
(
°r
, "bottom_up");

227 i‡(
	`dcc_ªad_bôs
(
bs
, 
dcc_bôs_width_èbÀ
[
width
], 
sign
, 
±r
))

229 
	`•rötf
(
add_îr‹
, "‰amêhódî %i, %s\n", 
f
, 
°r
);

230 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

236 
dcc
->
‰ame
[
d
][
f
].
box
.
xmö
 = dcc->‰ame[d][f].
xoff£t
;

237 
dcc
->
‰ame
[
d
][
f
].
box
.
xmax
 =

238 
dcc
->
‰ame
[
d
][
f
].
box
.
xmö
 + dcc->‰ame[d][f].
width
 - 1;

240 i‡(
dcc
->
‰ame
[
d
][
f
].
bŸtom_up
)

242 
dcc
->
‰ame
[
d
][
f
].
box
.
ymö
 = dcc->‰ame[d][f].
yoff£t
;

243 
dcc
->
‰ame
[
d
][
f
].
box
.
ymax
 =

244 
dcc
->
‰ame
[
d
][
f
].
box
.
ymö
 + dcc->‰ame[d][f].
height
 - 1;

248 
dcc
->
‰ame
[
d
][
f
].
box
.
ymax
 = dcc->‰ame[d][f].
yoff£t
;

249 
dcc
->
‰ame
[
d
][
f
].
box
.
ymö
 =

250 
dcc
->
‰ame
[
d
][
f
].
box
.
ymax
 - dcc->‰ame[d][f].
height
 + 1;

252 
dcc
->
‰ame
[
d
][
f
].
box
.
width
 =

253 
dcc
->
‰ame
[
d
][
f
].
box
.
xmax
 - dcc->‰ame[d][f].box.
xmö
 + 1;

254 
dcc
->
‰ame
[
d
][
f
].
box
.
height
 =

255 
dcc
->
‰ame
[
d
][
f
].
box
.
ymax
 - dcc->‰ame[d][f].box.
ymö
 + 1;

259 
	}
}

264 
	$dcc_öô_dú_bô°ªam
(
DCC_S
 * 
dcc
, 
DCC_BITSTREAM_S
 * 
bs
, 
d
)

266 
DCC_BITSTREAM_S
 * 
ec
, * 
pm
, * 
ë
, * 
Ω
, * 
pcd
;

267 
UDWORD
 
glb_bô
 = (
bs
->
cur_byã
 * 8Ë+ bs->
cur_bô
;

271 
ec
 = & 
dcc
->
dúe˘i⁄
[
d
].
equÆ_˚Œ_bô°ªam
;

272 
pm
 = & 
dcc
->
dúe˘i⁄
[
d
].
pixñ_mask_bô°ªam
;

273 
ë
 = & 
dcc
->
dúe˘i⁄
[
d
].
ícodög_ty≥_bô°ªam
;

274 
Ω
 = & 
dcc
->
dúe˘i⁄
[
d
].
øw_pixñ_bô°ªam
;

275 
pcd
 = & 
dcc
->
dúe˘i⁄
[
d
].
pixñ_code_™d_di•œcmít_bô°ªam
;

278 i‡(
dcc
->
dúe˘i⁄
[
d
].
com¥essi⁄_Êag
 & 0x02)

280 
ec
->
d©a
 = 
bs
->d©®+ (
glb_bô
 / 8);

281 
ec
->
cur_bô
 = (
UBYTE
Ë(
glb_bô
 % 8);

282 
ec
->
cur_bô_num
 = 0;

283 
ec
->
cur_byã
 = 0;

284 
ec
->
size
 = 
dcc
->
dúe˘i⁄
[
d
].
equÆ_˚Œ_bô°ªam_size
;

285 
glb_bô
 +
ec
->
size
;

289 
pm
->
d©a
 = 
bs
->d©®+ (
glb_bô
 / 8);

290 
pm
->
cur_bô
 = (
UBYTE
Ë(
glb_bô
 % 8);

291 
pm
->
cur_bô_num
 = 0;

292 
pm
->
cur_byã
 = 0;

293 
pm
->
size
 = 
dcc
->
dúe˘i⁄
[
d
].
pixñ_mask_bô°ªam_size
;

294 
glb_bô
 +
pm
->
size
;

296 i‡(
dcc
->
dúe˘i⁄
[
d
].
com¥essi⁄_Êag
 & 0x01)

299 
ë
->
d©a
 = 
bs
->d©®+ (
glb_bô
 / 8);

300 
ë
->
cur_bô
 = (
UBYTE
Ë(
glb_bô
 % 8);

301 
ë
->
cur_bô_num
 = 0;

302 
ë
->
cur_byã
 = 0;

303 
ë
->
size
 = 
dcc
->
dúe˘i⁄
[
d
].
ícodög_ty≥_bô°ªam_size
;

304 
glb_bô
 +
ë
->
size
;

307 
Ω
->
d©a
 = 
bs
->d©®+ (
glb_bô
 / 8);

308 
Ω
->
cur_bô
 = (
UBYTE
Ë(
glb_bô
 % 8);

309 
Ω
->
cur_bô_num
 = 0;

310 
Ω
->
cur_byã
 = 0;

311 
Ω
->
size
 = 
dcc
->
dúe˘i⁄
[
d
].
øw_pixñ_bô°ªam_size
;

312 
glb_bô
 +
Ω
->
size
;

316 
pcd
->
d©a
 = 
bs
->d©®+ (
glb_bô
 / 8);

317 
pcd
->
cur_bô
 = (
UBYTE
Ë(
glb_bô
 % 8);

318 
pcd
->
cur_bô_num
 = 0;

319 
pcd
->
cur_byã
 = 0;

320 
pcd
->
size
 = 
bs
->sizê- 
glb_bô
;

366 
	}
}

372 
	$dcc_›ti⁄Æ_d©as
(
DCC_S
 * 
dcc
, 
DCC_BITSTREAM_S
 * 
bs
, 
d
)

374 
UDWORD
 
size
 = 0;

375 
f
;

376 
add_îr‹
[80];

380 
f
=0; f < 
dcc
->
hódî
.
‰ames_≥r_dú
; f++)

381 
size
 +
dcc
->
‰ame
[
d
][
f
].
›ti⁄Æ_byãs
;

382 i‡(
size
 == 0)

386 i‡(
bs
->
cur_bô
)

389 
bs
->
cur_bô_num
 +8 - bs->
cur_bô
;

390 
bs
->
cur_bô
 = 0;

391 
bs
->
cur_byã
 ++;

395 
f
=0; f < 
dcc
->
hódî
.
‰ames_≥r_dú
; f++)

397 
size
 = 
dcc
->
‰ame
[
d
][
f
].
›ti⁄Æ_byãs
;

398 i‡(
size
)

401 
dcc
->
‰ame
[
d
][
f
].
›ti⁄Æ_byãs_d©a
 = (
UBYTE
 *Ë
	`mÆloc
 (
size
);

402 i‡(
dcc
->
‰ame
[
d
][
f
].
›ti⁄Æ_byãs_d©a
 =
NULL
)

404 
	`•rötf
(
dcc_îr‹
,

408 
size
, 
d
, 
f
);

413 i‡(
	`dcc_ªad_byãs
(
bs
, 
size
, 
dcc
->
‰ame
[
d
][
f
].
›ti⁄Æ_byãs_d©a
))

415 
	`•rötf
(
add_îr‹
, "dúe˘i⁄ %i, fømê%i\n", 
d
, 
f
);

416 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

424 
	}
}

430 
	$dcc_Ÿhî_bô°ªam_size
(
DCC_S
 * 
dcc
, 
DCC_BITSTREAM_S
 * 
bs
, 
d
)

432 
add_îr‹
[80];

436 i‡(
dcc
->
dúe˘i⁄
[
d
].
com¥essi⁄_Êag
 & 0x02)

438 i‡(
	`dcc_ªad_bôs
(
bs
, 20, 
FALSE
,

439 & 
dcc
->
dúe˘i⁄
[
d
].
equÆ_˚Œ_bô°ªam_size
))

441 
	`•rötf
(
add_îr‹
,

442 "dúe˘i⁄ %i,ÉquÆ_˚Œ_bô°ªam_size\n", 
d
);

443 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

449 i‡(
	`dcc_ªad_bôs
(
bs
, 20, 
FALSE
,

450 & 
dcc
->
dúe˘i⁄
[
d
].
pixñ_mask_bô°ªam_size
))

452 
	`•rötf
(
add_îr‹
,

453 "dúe˘i⁄ %i,Öixñ_mask_bô°ªam_size\n", 
d
);

454 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

458 i‡(
dcc
->
dúe˘i⁄
[
d
].
com¥essi⁄_Êag
 & 0x01)

461 i‡(
	`dcc_ªad_bôs
(
bs
, 20, 
FALSE
,

462 & 
dcc
->
dúe˘i⁄
[
d
].
ícodög_ty≥_bô°ªam_size
))

464 
	`•rötf
(
add_îr‹
,

465 "dúe˘i⁄ %i,Éncodög_ty≥_bô°ªam_size\n", 
d
);

466 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

471 i‡(
	`dcc_ªad_bôs
(
bs
, 20, 
FALSE
,

472 & 
dcc
->
dúe˘i⁄
[
d
].
øw_pixñ_bô°ªam_size
))

474 
	`•rötf
(
add_îr‹
,

475 "dúe˘i⁄ %i,Ñaw_pixñ_bô°ªam_size\n", 
d
);

476 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

483 
	}
}

491 
	$dcc_pixñ_vÆues_key
(
DCC_S
 * 
dcc
, 
DCC_BITSTREAM_S
 * 
bs
, 
d
)

493 
add_îr‹
[80];

494 
i
, 
idx
 = 0;

495 
UDWORD
 
tmp
;

497 
i
=0; i<256; i++)

499 i‡(
	`dcc_ªad_bôs
(
bs
, 1, 
FALSE
, & 
tmp
))

501 
	`•rötf
(
add_îr‹
,

502 "dúe˘i⁄ %i,Öixñ_vÆue†%i\n", 
d
, 
i
);

503 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

506 i‡(
tmp
)

507 
dcc
->
dúe˘i⁄
[
d
].
pixñ_vÆues
[
idx
++] = (
UBYTE
Ë
i
;

512 
	}
}

518 
	$dcc_¥ï¨e_buf„r_˚Œs
(
DCC_S
 * 
dcc
, 
d
)

520 
DCC_DIRECTION_S
 * 
dú
 = & 
dcc
->
dúe˘i⁄
[
d
];

521 
DCC_CELL_S
 * 
˚Œ
;

522 
buf„r_w
, 
buf„r_h
, 
tmp
, 
nb_˚Œ_w
, 
nb_˚Œ_h
, 
nb_˚Œ
,

523 
size
, * 
˚Œ_w
, * 
˚Œ_h
, 
i
, 
x0
, 
y0
, 
x
, 
y
;

525 
buf„r_w
 = 
dú
->
box
.
width
;

526 
buf„r_h
 = 
dú
->
box
.
height
;

529 
tmp
 = 
buf„r_w
 - 1;

530 
nb_˚Œ_w
 = 1 + (
tmp
 / 4);

532 
tmp
 = 
buf„r_h
 - 1;

533 
nb_˚Œ_h
 = 1 + (
tmp
 / 4);

535 
nb_˚Œ
 = 
nb_˚Œ_w
 * 
nb_˚Œ_h
;

536 
size
 = 
nb_˚Œ
 * (
DCC_CELL_S
);

537 
dú
->
buf„r_±r
 = (
DCC_CELL_S
 *Ë
	`mÆloc
(
size
);

538 i‡(
dú
->
buf„r_±r
 =
NULL
)

540 
	`•rötf
(
dcc_îr‹
, "dcc_prepare_buffer_cells() :\n"

542 
size
);

545 
	`mem£t
(
dú
->
buf„r_±r
, 0, 
size
);

547 
size
 = 
nb_˚Œ_w
 * ();

548 
˚Œ_w
 = (*Ë
	`mÆloc
(
size
);

549 i‡(
˚Œ_w
 =
NULL
)

551 
	`•rötf
(
dcc_îr‹
, "dcc_prepare_buffer_cells() :\n"

553 
size
);

557 
size
 = 
nb_˚Œ_h
 * ();

558 
˚Œ_h
 = (*Ë
	`mÆloc
(
size
);

559 i‡(
˚Œ_h
 =
NULL
)

561 
	`‰ì
(
˚Œ_w
);

562 
	`•rötf
(
dcc_îr‹
, "dcc_prepare_buffer_cells() :\n"

564 
size
);

568 i‡(
nb_˚Œ_w
 == 1)

569 
˚Œ_w
[0] = 
buf„r_w
;

572 
i
=0; i < (
nb_˚Œ_w
 - 1); i++)

573 
˚Œ_w
[
i
] = 4;

574 
˚Œ_w
[
nb_˚Œ_w
 - 1] = 
buf„r_w
 - (4 * (nb_cell_w - 1));

577 i‡(
nb_˚Œ_h
 == 1)

578 
˚Œ_h
[0] = 
buf„r_h
;

581 
i
=0; i < (
nb_˚Œ_h
 - 1); i++)

582 
˚Œ_h
[
i
] = 4;

583 
˚Œ_h
[
nb_˚Œ_h
 - 1] = 
buf„r_h
 - (4 * (nb_cell_h - 1));

586 
dú
->
nb_˚Œs_w
 = 
nb_˚Œ_w
;

587 
dú
->
nb_˚Œs_h
 = 
nb_˚Œ_h
;

589 
y0
 = 0;

590 
y
=0; y < 
nb_˚Œ_h
; y++)

592 
x0
 = 0;

593 
x
=0; x < 
nb_˚Œ_w
; x++)

595 
˚Œ
 = & 
dú
->
buf„r_±r
[
x
 + (
y
 * 
nb_˚Œ_w
)];

596 
˚Œ
->
w
 = 
˚Œ_w
[
x
];

597 
˚Œ
->
h
 = 
˚Œ_h
[
y
];

598 
˚Œ
->
bmp
 = 
	`¸óã_sub_bôm≠
(
dú
->bmp, 
x0
, 
y0
, cñl->
w
, cñl->
h
);

599 i‡(
˚Œ
->
bmp
 =
NULL
)

601 
	`•rötf
(
dcc_îr‹
, "dcc_prepare_buffer_cells() :\n"

603 
x0
, 
y0
);

606 
x0
 += 4;

608 
y0
 += 4;

611 
	`‰ì
(
˚Œ_w
);

612 
	`‰ì
(
˚Œ_h
);

615 
	}
}

622 
	$dcc_¥ï¨e_‰ame_˚Œs
(
DCC_S
 * 
dcc
, 
d
, 
f
)

624 
DCC_DIRECTION_S
 * 
dú
 = & 
dcc
->
dúe˘i⁄
[
d
];

625 
DCC_FRAME_S
 * 
‰ame
 = & 
dcc
->‰ame[
d
][
f
];

626 
DCC_CELL_S
 * 
˚Œ
 = 
NULL
;

627 
‰ame_w
, 
‰ame_h
, 
w
, 
h
, 
tmp
,

628 
nb_˚Œ_w
, 
nb_˚Œ_h
, 
nb_˚Œ
,

629 
size
, * 
˚Œ_w
, * 
˚Œ_h
, 
i
, 
x0
, 
y0
, 
x
, 
y
;

631 
‰ame_w
 = 
‰ame
->
box
.
width
;

632 
‰ame_h
 = 
‰ame
->
box
.
height
;

635 
w
 = 4 - ((
‰ame
->
box
.
xmö
 - 
dú
->box.xmin) % 4);

637 i‡((
‰ame_w
 - 
w
) <= 1)

638 
nb_˚Œ_w
 = 1;

642 
tmp
 = 
‰ame_w
 - 
w
 - 1;

643 
nb_˚Œ_w
 = 2 + (
tmp
 / 4);

644 i‡((
tmp
 % 4) == 0)

645 
nb_˚Œ_w
--;

648 
h
 = 4 - ((
‰ame
->
box
.
ymö
 - 
dú
->box.ymin) % 4);

649 i‡((
‰ame_h
 - 
h
) <= 1)

650 
nb_˚Œ_h
 = 1;

653 
tmp
 = 
‰ame_h
 - 
h
 - 1;

654 
nb_˚Œ_h
 = 2 + (
tmp
 / 4);

655 i‡((
tmp
 % 4) == 0)

656 
nb_˚Œ_h
--;

659 
nb_˚Œ
 = 
nb_˚Œ_w
 * 
nb_˚Œ_h
;

660 
size
 = 
nb_˚Œ
 * (
DCC_CELL_S
);

661 
‰ame
->
˚Œ
 = (
DCC_CELL_S
 *Ë
	`mÆloc
(
size
);

662 i‡(
‰ame
->
˚Œ
 =
NULL
)

664 
	`•rötf
(
dcc_îr‹
, "dcc_prepare_frame_cells() :\n"

666 
size
);

669 
	`mem£t
(
‰ame
->
˚Œ
, 0, 
size
);

671 
size
 = 
nb_˚Œ_w
 * ();

672 
˚Œ_w
 = (*Ë
	`mÆloc
(
size
);

673 i‡(
˚Œ_w
 =
NULL
)

675 
	`•rötf
(
dcc_îr‹
, "dcc_prepare_frame_cells() :\n"

677 
size
);

681 
size
 = 
nb_˚Œ_h
 * ();

682 
˚Œ_h
 = (*Ë
	`mÆloc
(
size
);

683 i‡(
˚Œ_h
 =
NULL
)

685 
	`‰ì
(
˚Œ_w
);

686 
	`•rötf
(
dcc_îr‹
, "dcc_prepare_frame_cells() :\n"

688 
size
);

692 i‡(
nb_˚Œ_w
 == 1)

693 
˚Œ_w
[0] = 
‰ame_w
;

696 
˚Œ_w
[0] = 
w
;

697 
i
=1; i < (
nb_˚Œ_w
 - 1); i++)

698 
˚Œ_w
[
i
] = 4;

699 
˚Œ_w
[
nb_˚Œ_w
 - 1] = 
‰ame_w
 - 
w
 - (4 * (nb_cell_w - 2));

702 i‡(
nb_˚Œ_h
 == 1)

703 
˚Œ_h
[0] = 
‰ame_h
;

706 
˚Œ_h
[0] = 
h
;

707 
i
=1; i < (
nb_˚Œ_h
 - 1); i++)

708 
˚Œ_h
[
i
] = 4;

709 
˚Œ_h
[
nb_˚Œ_h
 - 1] = 
‰ame_h
 - 
h
 - (4 * (nb_cell_h - 2));

712 
‰ame
->
nb_˚Œs_w
 = 
nb_˚Œ_w
;

713 
‰ame
->
nb_˚Œs_h
 = 
nb_˚Œ_h
;

715 
y0
 = 
‰ame
->
box
.
ymö
 - 
dú
->box.ymin;

716 
y
=0; y < 
nb_˚Œ_h
; y++)

718 
x0
 = 
‰ame
->
box
.
xmö
 - 
dú
->box.xmin;

719 
x
=0; x < 
nb_˚Œ_w
; x++)

721 
˚Œ
 = & 
‰ame
->˚Œ[
x
 + (
y
 * 
nb_˚Œ_w
)];

722 
˚Œ
->
x0
 = x0;

723 
˚Œ
->
y0
 = y0;

724 
˚Œ
->
w
 = 
˚Œ_w
[
x
];

725 
˚Œ
->
h
 = 
˚Œ_h
[
y
];

726 
˚Œ
->
bmp
 = 
	`¸óã_sub_bôm≠
(
dú
->bmp, 
x0
, 
y0
, cñl->
w
, cñl->
h
);

727 
x0
 +
˚Œ
->
w
;

729 
y0
 +
˚Œ
->
h
;

732 
	`‰ì
(
˚Œ_w
);

733 
	`‰ì
(
˚Œ_h
);

736 
	}
}

742 
	$dcc_fûl_pixñ_buf„r
(
DCC_S
 * 
dcc
, 
d
)

744 
DCC_DIRECTION_S
 * 
dú
 = & 
dcc
->
dúe˘i⁄
[
d
];

745 
DCC_FRAME_S
 * 
‰ame
;

746 
DCC_PB_ENTRY_S
 * 
ﬁd_íåy
, * 
√w_íåy
;

747 
˚Œ0_x
, 
˚Œ0_y
, 
˚Œ_w
, 
˚Œ_h
;

748 
UDWORD
 
tmp
, 
pixñ_mask
=0, 
ícodög_ty≥
, 
œ°_pixñ
, 
ªad_pixñ
[4],

749 
pix_di•l
;

750 
nb_˚Œ
, 
size
;

751 
i
, 
f
, 
cuº_˚Œ_x
, 
cuº_˚Œ_y
, 
cuº_˚Œ
;

752 
nb_pix_èbÀ
[16] =

754 
x
, 
y
, 
nb_pix
, 
√xt_˚Œ
, 
cuº_idx
,

755 
pb_idx
 = -1;

756 
DCC_PB_ENTRY_S
 ** 
˚Œ_buf„r
;

757 
buff_w
, 
buff_h
, 
decoded_pix
;

758 
add_îr‹
[256];

762 
size
 = 
DCC_MAX_PB_ENTRY
 * (
DCC_PB_ENTRY_S
);

763 
dú
->
pixñ_buf„r
 = (
DCC_PB_ENTRY_S
 *Ë
	`mÆloc
(
size
);

764 i‡(
dú
->
pixñ_buf„r
 =
NULL
)

766 
	`•rötf
(
dcc_îr‹
, "dcc_fill_pixel_buffer() : can'tállocate "

768 
size
, 
DCC_MAX_PB_ENTRY
);

771 
	`mem£t
(
dú
->
pixñ_buf„r
, 0, 
size
);

772 
i
=0; i < 
DCC_MAX_PB_ENTRY
; i++)

774 
dú
->
pixñ_buf„r
[
i
].
‰ame
 = -1;

775 
dú
->
pixñ_buf„r
[
i
].
‰ame_˚Œ_ödex
 = -1;

779 
dú
->
bmp
 = 
	`¸óã_bôm≠
(dú->
box
.
width
, dú->box.
height
);

780 i‡(
dú
->
bmp
 =
NULL
)

782 
	`•rötf
(
dcc_îr‹
, "dcc_fill_pixel_buffer() : can't create buffer bitmap "

784 
dú
->
box
.
width
, dú->box.
height
);

787 
	`˛ór
(
dú
->
bmp
);

790 i‡(
	`dcc_¥ï¨e_buf„r_˚Œs
(
dcc
, 
d
))

796 
buff_w
 = 
dú
->
nb_˚Œs_w
;

797 
buff_h
 = 
dú
->
nb_˚Œs_h
;

798 
nb_˚Œ
 = 
buff_w
 * 
buff_h
;

799 
size
 = 
nb_˚Œ
 * (
DCC_PB_ENTRY_S
 *);

800 
˚Œ_buf„r
 = (
DCC_PB_ENTRY_S
 **Ë
	`mÆloc
(
size
);

801 i‡(
˚Œ_buf„r
 =
NULL
)

803 
	`•rötf
(
dcc_îr‹
, "dcc_fill_pixel_buffer() : can'tállocate "

805 
size
, 
nb_˚Œ
);

808 
	`mem£t
(
˚Œ_buf„r
, 0, 
size
);

811 
f
=0; f < 
dcc
->
hódî
.
‰ames_≥r_dú
; f++)

814 i‡(
	`dcc_¥ï¨e_‰ame_˚Œs
(
dcc
, 
d
, 
f
))

816 
	`‰ì
(
˚Œ_buf„r
);

820 
‰ame
 = & 
dcc
->‰ame[
d
][
f
];

821 
˚Œ_w
 = 
‰ame
->
nb_˚Œs_w
;

822 
˚Œ_h
 = 
‰ame
->
nb_˚Œs_h
;

823 
˚Œ0_x
 = (
‰ame
->
box
.
xmö
 - 
dú
->box.xmin) / 4;

824 
˚Œ0_y
 = (
‰ame
->
box
.
ymö
 - 
dú
->box.ymin) / 4;

827 
y
=0; y < 
˚Œ_h
; y++)

829 
cuº_˚Œ_y
 = 
˚Œ0_y
 + 
y
;

830 
x
=0; x < 
˚Œ_w
; x++)

832 
cuº_˚Œ_x
 = 
˚Œ0_x
 + 
x
;

833 
cuº_˚Œ
 = 
cuº_˚Œ_x
 + (
cuº_˚Œ_y
 * 
buff_w
);

834 i‡(
cuº_˚Œ
 >
nb_˚Œ
)

836 
	`•rötf
(
dcc_îr‹
, "dcc_fill_pixel_buffer() : "

840 
cuº_˚Œ
, 
nb_˚Œ
,

841 
d
, 
f
, 
x
, 
y
);

842 
	`‰ì
(
˚Œ_buf„r
);

847 
√xt_˚Œ
 = 
FALSE
;

848 i‡(
˚Œ_buf„r
[
cuº_˚Œ
] !
NULL
)

850 i‡(
dú
->
equÆ_˚Œ_bô°ªam_size
)

852 i‡(
	`dcc_ªad_bôs
–& 
dú
->
equÆ_˚Œ_bô°ªam
,

853 1, 
FALSE
, & 
tmp
))

855 
	`•rötf
(
add_îr‹
, "dcc_fill_pixel_buffer() : "

858 
d
, 
f
, 
cuº_˚Œ
);

859 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

860 
	`‰ì
(
˚Œ_buf„r
);

865 
tmp
 = 0;

866 i‡(
tmp
 == 0)

868 i‡(
	`dcc_ªad_bôs
–& 
dú
->
pixñ_mask_bô°ªam
,

869 4, 
FALSE
, & 
pixñ_mask
))

871 
	`•rötf
(
add_îr‹
, "dcc_fill_pixel_buffer() : "

875 
d
, 
f
, 
cuº_˚Œ
, 
x
, 
y
);

876 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

877 
	`‰ì
(
˚Œ_buf„r
);

883 
√xt_˚Œ
 = 
TRUE
;

886 
pixñ_mask
 = 0x0F;

888 i‡(
√xt_˚Œ
 =
FALSE
)

893 
ªad_pixñ
[0] =Ñead_pixel[1] = 0;

894 
ªad_pixñ
[2] =Ñead_pixel[3] = 0;

895 
œ°_pixñ
 = 0;

896 
nb_pix
 = 
nb_pix_èbÀ
[
pixñ_mask
];

897 i‡(
nb_pix
 && 
dú
->
ícodög_ty≥_bô°ªam_size
)

899 i‡(
	`dcc_ªad_bôs
–& 
dú
->
ícodög_ty≥_bô°ªam
,

900 1, 
FALSE
, & 
ícodög_ty≥
))

902 
	`•rötf
(
add_îr‹
, "dcc_fill_pixel_buffer() :\n "

906 
d
, 
f
, 
cuº_˚Œ
, 
nb_pix
, 
cuº_˚Œ_x
, 
cuº_˚Œ_y
);

907 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

908 
	`‰ì
(
˚Œ_buf„r
);

913 
ícodög_ty≥
 = 0;

914 
decoded_pix
 = 0;

915 
i
=0; i < 
nb_pix
; i++)

917 i‡(
ícodög_ty≥
)

919 i‡(
	`dcc_ªad_bôs
–& 
dú
->
øw_pixñ_bô°ªam
,

920 8, 
FALSE
, & 
ªad_pixñ
[
i
]))

922 
	`•rötf
(
add_îr‹
, "dcc_fill_pixel_buffer() :\n "

926 
d
, 
f
, 
cuº_˚Œ
, 
nb_pix
, 
cuº_˚Œ_x
, 
cuº_˚Œ_y
);

927 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

928 
	`‰ì
(
˚Œ_buf„r
);

934 
ªad_pixñ
[
i
] = 
œ°_pixñ
;

935 i‡(
	`dcc_ªad_bôs
(

936 & 
dú
->
pixñ_code_™d_di•œcmít_bô°ªam
,

937 4, 
FALSE
, & 
pix_di•l
))

939 
	`•rötf
(
add_îr‹
, "dcc_fill_pixel_buffer() :\n "

942 
d
, 
f
, 
cuº_˚Œ
);

943 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

944 
	`‰ì
(
˚Œ_buf„r
);

947 
ªad_pixñ
[
i
] +
pix_di•l
;

948 
pix_di•l
 == 15)

950 i‡(
	`dcc_ªad_bôs
(

951 & 
dú
->
pixñ_code_™d_di•œcmít_bô°ªam
,

952 4, 
FALSE
, & 
pix_di•l
))

954 
	`•rötf
(
add_îr‹
, "dcc_fill_pixel_buffer() :\n "

957 
d
, 
f
, 
cuº_˚Œ
);

958 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

959 
	`‰ì
(
˚Œ_buf„r
);

962 
ªad_pixñ
[
i
] +
pix_di•l
;

965 i‡(
ªad_pixñ
[
i
] =
œ°_pixñ
)

967 
ªad_pixñ
[
i
] = 0;

968 
i
 = 
nb_pix
;

972 
œ°_pixñ
 = 
ªad_pixñ
[
i
];

973 
decoded_pix
++;

978 
ﬁd_íåy
 = 
˚Œ_buf„r
[
cuº_˚Œ
];

979 
pb_idx
++;

980 i‡(
pb_idx
 >
DCC_MAX_PB_ENTRY
)

982 
	`•rötf
(
dcc_îr‹
, "dcc_fill_pixel_buffer() : "

986 
DCC_MAX_PB_ENTRY
, 
d
, 
f
, 
cuº_˚Œ
, 
nb_pix
,

987 
cuº_˚Œ_x
, 
cuº_˚Œ_y
);

988 
	`‰ì
(
˚Œ_buf„r
);

991 
√w_íåy
 = & 
dú
->
pixñ_buf„r
[
pb_idx
];

992 
cuº_idx
 = 
decoded_pix
 - 1;

993 
i
=0; i<4; i++)

995 i‡(
pixñ_mask
 & (1 << 
i
))

997 i‡(
cuº_idx
 >= 0)

998 
√w_íåy
->
vÆ
[
i
] = (
UBYTE
Ë
ªad_pixñ
[
cuº_idx
--];

1000 
√w_íåy
->
vÆ
[
i
] = 0;

1003 
√w_íåy
->
vÆ
[
i
] = 
ﬁd_íåy
->val[i];

1005 
˚Œ_buf„r
[
cuº_˚Œ
] = 
√w_íåy
;

1006 
√w_íåy
->
‰ame
 = 
f
;

1007 
√w_íåy
->
‰ame_˚Œ_ödex
 = 
x
 + (
y
 * 
˚Œ_w
);

1015 
i
=0; i <
pb_idx
; i++)

1017 
x
=0; x<4; x++)

1019 
y
 = 
dú
->
pixñ_buf„r
[
i
].
vÆ
[
x
];

1020 
dú
->
pixñ_buf„r
[
i
].
vÆ
[
x
] = dú->
pixñ_vÆues
[
y
];

1025 
dú
->
pb_nb_íåy
 = 
pb_idx
 + 1;

1026 
	`‰ì
(
˚Œ_buf„r
);

1028 
	}
}

1032 
	$dcc_ßve_‰ame
(
DCC_S
 * 
dcc
, 
d
, 
f
, 
BITMAP
 * 
‰m_bmp
)

1034 
DCC_FRAME_S
 * 
Âå
 = & 
dcc
->
‰ame
[
d
][
f
];

1036 
Âå
->
bmp
 = 
	`¸óã_bôm≠
(
‰m_bmp
->
w
, frm_bmp->
h
);

1037 i‡(
Âå
->
bmp
 =
NULL
)

1039 
	`•rötf
(
dcc_îr‹
, "dcc_save_frame() : can't create final frame "

1041 
‰m_bmp
->
w
, frm_bmp->
h
);

1044 
	`blô
(
‰m_bmp
, 
Âå
->
bmp
, 0, 0, 0, 0, frm_bmp->
w
, frm_bmp->
h
);

1047 #ifde‡
DCCINFO_SAVE_PCX


1049 
tmp
[30];

1050 
PALETTE
 
tmµÆ
;

1051 
FILE
 * 
ö
;

1052 
i
;

1054 
ö
 = 
	`f›í
("act1.dat", "rb");

1055 i‡(
ö
 !
NULL
)

1057 
i
=0; i<256; i++)

1059 
tmµÆ
[
i
].
b
 = (
UBYTE
Ë
	`fgëc
(
ö
) >> 2;

1060 
tmµÆ
[
i
].
g
 = (
UBYTE
Ë
	`fgëc
(
ö
) >> 2;

1061 
tmµÆ
[
i
].
r
 = (
UBYTE
Ë
	`fgëc
(
ö
) >> 2;

1063 
	`f˛o£
(
ö
);

1064 
	`•rötf
(
tmp
, "d%02i-f%03i.pcx", 
d
, 
f
);

1065 
	`ßve_pcx
(
tmp
, 
‰m_bmp
, 
tmµÆ
);

1073 
	}
}

1079 
	$dcc_make_‰ames
(
DCC_S
 * 
dcc
, 
d
)

1081 
DCC_DIRECTION_S
 * 
dú
 = & 
dcc
->
dúe˘i⁄
[
d
];

1082 
DCC_PB_ENTRY_S
 * 
pbe
 = 
dú
->
pixñ_buf„r
;

1083 
DCC_FRAME_S
 * 
‰ame
;

1084 
DCC_CELL_S
 * 
buff_˚Œ
, * 
˚Œ
;

1085 
UDWORD
 
pix
;

1086 
nb_˚Œ
, 
nb_bô
,

1087 
˚Œ_x
, 
˚Œ_y
, 
˚Œ_idx
,

1088 
x
, 
y
, 
f
, 
c
;

1089 
BITMAP
 * 
‰m_bmp
;

1090 
add_îr‹
[256];

1094 
c
=0; c < 
dú
->
nb_˚Œs_w
 * dú->
nb_˚Œs_h
; c++)

1096 
dú
->
buf„r_±r
[
c
].
œ°_w
 = -1;

1097 
dú
->
buf„r_±r
[
c
].
œ°_h
 = -1;

1101 
‰m_bmp
 = 
	`¸óã_bôm≠
(
dú
->
box
.
width
, dú->box.
height
);

1102 i‡(
‰m_bmp
 =
NULL
)

1104 
	`•rötf
(
dcc_îr‹
, "dcc_make_frames() : can't createÅmp frame "

1106 
dú
->
box
.
width
, dú->box.
height


1112 
f
=0; f < 
dcc
->
hódî
.
‰ames_≥r_dú
; f++)

1114 
	`˛ór
(
‰m_bmp
);

1115 
‰ame
 = & 
dcc
->‰ame[
d
][
f
];

1116 
nb_˚Œ
 = 
‰ame
->
nb_˚Œs_w
 * føme->
nb_˚Œs_h
;

1119 
c
=0; c < 
nb_˚Œ
; c++)

1122 
˚Œ
 = & 
‰ame
->˚Œ[
c
];

1125 
˚Œ_x
 = 
˚Œ
->
x0
 / 4;

1126 
˚Œ_y
 = 
˚Œ
->
y0
 / 4;

1127 
˚Œ_idx
 = 
˚Œ_x
 + (
˚Œ_y
 * 
dú
->
nb_˚Œs_w
);

1128 
buff_˚Œ
 = & 
dú
->
buf„r_±r
[
˚Œ_idx
];

1131 i‡((
pbe
->
‰ame
 !
f
Ë|| (pbe->
‰ame_˚Œ_ödex
 !
c
))

1136 i‡((
˚Œ
->
w
 !
buff_˚Œ
->
œ°_w
Ë|| (˚Œ->
h
 !buff_˚Œ->
œ°_h
))

1139 
	`˛ór
(
˚Œ
->
bmp
);

1146 
	`blô
(
dú
->
bmp
, dir->bmp,

1147 
buff_˚Œ
->
œ°_x0
, buff_˚Œ->
œ°_y0
,

1148 
˚Œ
->
x0
, cñl->
y0
,

1149 
˚Œ
->
w
, cñl->
h


1153 
	`blô
(
˚Œ
->
bmp
, 
‰m_bmp
,

1155 
˚Œ
->
x0
, cñl->
y0
,

1156 
˚Œ
->
w
, cñl->
h


1164 i‡(
pbe
->
vÆ
[0] ==Öbe->val[1])

1167 
	`˛ór_to_cﬁ‹
(
˚Œ
->
bmp
, 
pbe
->
vÆ
[0]);

1171 i‡(
pbe
->
vÆ
[1] ==Öbe->val[2])

1172 
nb_bô
 = 1;

1174 
nb_bô
 = 2;

1177 
y
=0; y < 
˚Œ
->
h
; y++)

1179 
x
=0; x < 
˚Œ
->
w
; x++)

1181 i‡(
	`dcc_ªad_bôs
(

1182 & 
dcc
->
dúe˘i⁄
[
d
].
pixñ_code_™d_di•œcmít_bô°ªam
,

1183 
nb_bô
, 
FALSE
, & 
pix
))

1185 
	`•rötf
(
add_îr‹
, "dcc_make_frame() :\n "

1188 
d
, 
pbe
->
‰ame
,Öbe->
‰ame_˚Œ_ödex
);

1189 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

1192 
	`puçixñ
(
˚Œ
->
bmp
, 
x
, 
y
, 
pbe
->
vÆ
[
pix
]);

1198 
	`blô
(
˚Œ
->
bmp
, 
‰m_bmp
,

1200 
˚Œ
->
x0
, cñl->
y0
,

1201 
˚Œ
->
w
, cñl->
h


1205 
pbe
++;

1211 
buff_˚Œ
->
œ°_w
 = 
˚Œ
->
w
;

1212 
buff_˚Œ
->
œ°_h
 = 
˚Œ
->
h
;

1215 
buff_˚Œ
->
œ°_x0
 = 
˚Œ
->
x0
;

1216 
buff_˚Œ
->
œ°_y0
 = 
˚Œ
->
y0
;

1220 
	`dcc_ßve_‰ame
(
dcc
, 
d
, 
f
, 
‰m_bmp
);

1224 
	`de°roy_bôm≠
(
‰m_bmp
);

1226 
	}
}

1232 
	$dcc_dú_bô°ªam
(
DCC_S
 * 
dcc
, 
d
)

1234 
DCC_BITSTREAM_S
 
bs
;

1235 
f
;

1236 
add_îr‹
[80];

1239 i‡(
dcc
->
dúe˘i⁄
[
d
].
bmp
 !
NULL
)

1243 i‡((
d
 < 0Ë|| (d >
dcc
->
hódî
.
dúe˘i⁄s
))

1245 
	`•rötf
(
dcc_îr‹
, "dcc_dir_bitstream() : invalid direction, %i is "

1247 
d
, 
dcc
->
hódî
.
dúe˘i⁄s
);

1252 
bs
.
cur_bô
 = 0;

1253 
bs
.
cur_bô_num
 = 0;

1254 
bs
.
cur_byã
 = 0;

1255 
bs
.
d©a
 = 
dcc
->
±r
 + dcc->
hódî
.
dú_off£t
[
d
];

1256 i‡(
d
 =
dcc
->
hódî
.
dúe˘i⁄s
 - 1)

1257 
bs
.
size
 = 8 * (
dcc
->sizê- dcc->
hódî
.
dú_off£t
[
d
]);

1259 
bs
.
size
 = 8 * (
dcc
->
hódî
.
dú_off£t
[
d
 + 1] -

1260 
dcc
->
hódî
.
dú_off£t
[
d
]);

1263 i‡(
	`dcc_ªad_bôs
–& 
bs
, 32, 
FALSE
, & 
dcc
->
dúe˘i⁄
[
d
].
outsize_coded
))

1265 
	`•rötf
(
add_îr‹
, "dúe˘i⁄ %i, outsize_coded\n", 
d
);

1266 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

1270 i‡(
	`dcc_ªad_bôs
–& 
bs
, 2, 
FALSE
, & 
dcc
->
dúe˘i⁄
[
d
].
com¥essi⁄_Êag
))

1272 
	`•rötf
(
add_îr‹
, "dúe˘i⁄ %i, com¥essi⁄_Êag\n", 
d
);

1273 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

1277 i‡(
	`dcc_ªad_bôs
–& 
bs
, 4, 
FALSE
, & 
dcc
->
dúe˘i⁄
[
d
].
v¨übÀ0_bôs
))

1279 
	`•rötf
(
add_îr‹
, "dúe˘i⁄ %i, v¨übÀ0_bôs\n", 
d
);

1280 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

1284 i‡(
	`dcc_ªad_bôs
–& 
bs
, 4, 
FALSE
, & 
dcc
->
dúe˘i⁄
[
d
].
width_bôs
))

1286 
	`•rötf
(
add_îr‹
, "dúe˘i⁄ %i, width_bôs\n", 
d
);

1287 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

1291 i‡(
	`dcc_ªad_bôs
–& 
bs
, 4, 
FALSE
, & 
dcc
->
dúe˘i⁄
[
d
].
height_bôs
))

1293 
	`•rötf
(
add_îr‹
, "dúe˘i⁄ %i, height_bôs\n", 
d
);

1294 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

1298 i‡(
	`dcc_ªad_bôs
–& 
bs
, 4, 
FALSE
, & 
dcc
->
dúe˘i⁄
[
d
].
xoff£t_bôs
))

1300 
	`•rötf
(
add_îr‹
, "dúe˘i⁄ %i, xoff£t_bôs\n", 
d
);

1301 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

1305 i‡(
	`dcc_ªad_bôs
–& 
bs
, 4, 
FALSE
, & 
dcc
->
dúe˘i⁄
[
d
].
yoff£t_bôs
))

1307 
	`•rötf
(
add_îr‹
, "dúe˘i⁄ %i, yoff£t_bôs\n", 
d
);

1308 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

1312 i‡(
	`dcc_ªad_bôs
–& 
bs
, 4, 
FALSE
, & 
dcc
->
dúe˘i⁄
[
d
].
›ti⁄Æ_byãs_bôs
))

1314 
	`•rötf
(
add_îr‹
, "dúe˘i⁄ %i, o±i⁄Æ_byãs_bôs\n", 
d
);

1315 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

1319 i‡(
	`dcc_ªad_bôs
–& 
bs
, 4, 
FALSE
, & 
dcc
->
dúe˘i⁄
[
d
].
coded_byãs_bôs
))

1321 
	`•rötf
(
add_îr‹
, "dúe˘i⁄ %i, coded_byãs_bôs\n", 
d
);

1322 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

1328 
dcc
->
dúe˘i⁄
[
d
].
box
.
xmö
 = dcc->dúe˘i⁄[d].box.
ymö
 = 0x7FFFFFFFL;

1329 
dcc
->
dúe˘i⁄
[
d
].
box
.
xmax
 = dcc->dúe˘i⁄[d].box.
ymax
 = 0x80000000L;

1333 
f
=0; f < 
dcc
->
hódî
.
‰ames_≥r_dú
; f++)

1335 i‡(
	`dcc_‰ame_hódî_bô°ªam
(
dcc
, & 
bs
, 
d
, 
f
))

1337 
	`•rötf
(
add_îr‹
, "dúe˘i⁄ %i, føme†hódî\n", 
d
);

1338 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

1343 i‡(
dcc
->
‰ame
[
d
][
f
].
box
.
xmö
 < dcc->
dúe˘i⁄
[d].box.xmin)

1344 
dcc
->
dúe˘i⁄
[
d
].
box
.
xmö
 = dcc->
‰ame
[d][
f
].box.xmin;

1346 i‡(
dcc
->
‰ame
[
d
][
f
].
box
.
ymö
 < dcc->
dúe˘i⁄
[d].box.ymin)

1347 
dcc
->
dúe˘i⁄
[
d
].
box
.
ymö
 = dcc->
‰ame
[d][
f
].box.ymin;

1349 i‡(
dcc
->
‰ame
[
d
][
f
].
box
.
xmax
 > dcc->
dúe˘i⁄
[d].box.xmax)

1350 
dcc
->
dúe˘i⁄
[
d
].
box
.
xmax
 = dcc->
‰ame
[d][
f
].box.xmax;

1352 i‡(
dcc
->
‰ame
[
d
][
f
].
box
.
ymax
 > dcc->
dúe˘i⁄
[d].box.ymax)

1353 
dcc
->
dúe˘i⁄
[
d
].
box
.
ymax
 = dcc->
‰ame
[d][
f
].box.ymax;

1355 
dcc
->
dúe˘i⁄
[
d
].
box
.
width
 =

1356 
dcc
->
dúe˘i⁄
[
d
].
box
.
xmax
 - dcc->dúe˘i⁄[d].box.
xmö
 + 1;

1357 
dcc
->
dúe˘i⁄
[
d
].
box
.
height
 =

1358 
dcc
->
dúe˘i⁄
[
d
].
box
.
ymax
 - dcc->dúe˘i⁄[d].box.
ymö
 + 1;

1361 i‡(
	`dcc_›ti⁄Æ_d©as
(
dcc
, & 
bs
, 
d
))

1365 i‡(
	`dcc_Ÿhî_bô°ªam_size
(
dcc
, & 
bs
, 
d
))

1369 i‡(
	`dcc_pixñ_vÆues_key
(
dcc
, & 
bs
, 
d
))

1373 
	`dcc_öô_dú_bô°ªam
(
dcc
, & 
bs
, 
d
);

1376 i‡(
	`dcc_fûl_pixñ_buf„r
(
dcc
, 
d
))

1380 i‡(
	`dcc_make_‰ames
(
dcc
, 
d
))

1384 i‡(
dcc
->
dúe˘i⁄
[
d
].
pixñ_buf„r
)

1386 
	`‰ì
(
dcc
->
dúe˘i⁄
[
d
].
pixñ_buf„r
);

1387 
dcc
->
dúe˘i⁄
[
d
].
pixñ_buf„r
 = 
NULL
;

1391 i‡(
dcc
->
dúe˘i⁄
[
d
].
equÆ_˚Œ_bô°ªam_size
 !=

1392 
dcc
->
dúe˘i⁄
[
d
].
equÆ_˚Œ_bô°ªam
.
cur_bô_num
)

1394 
	`•rötf
(
dcc_îr‹
, "dúe˘i⁄ %i,ÉquÆ_˚Œ bô°ªamÇŸÑód com∂ëly whûêô should\n", 
d
);

1395 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

1398 i‡(
dcc
->
dúe˘i⁄
[
d
].
pixñ_mask_bô°ªam_size
 !=

1399 
dcc
->
dúe˘i⁄
[
d
].
pixñ_mask_bô°ªam
.
cur_bô_num
)

1401 
	`•rötf
(
dcc_îr‹
, "dúe˘i⁄ %i,Öixñ_mask bô°ªamÇŸÑód com∂ëly whûêô should\n", 
d
);

1402 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

1405 i‡(
dcc
->
dúe˘i⁄
[
d
].
ícodög_ty≥_bô°ªam_size
 !=

1406 
dcc
->
dúe˘i⁄
[
d
].
ícodög_ty≥_bô°ªam
.
cur_bô_num
)

1408 
	`•rötf
(
dcc_îr‹
, "dúe˘i⁄ %i,Éncodög_ty≥ bô°ªamÇŸÑód com∂ëly whûêô should\n", 
d
);

1409 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

1412 i‡(
dcc
->
dúe˘i⁄
[
d
].
pixñ_code_™d_di•œcmít_bô°ªam
.
cur_bô_num
 + 7

1413 < 
dcc
->
dúe˘i⁄
[
d
].
pixñ_code_™d_di•œcmít_bô°ªam
.
size
)

1415 
	`•rötf
(
dcc_îr‹
, "dúe˘i⁄ %i,Öixñ_code_™d_di•œcmíàbô°ªamÇŸÑód com∂ëly whûêô should\n", 
d
);

1416 
	`°rˇt
(
dcc_îr‹
, 
add_îr‹
);

1421 
	}
}

1426 
	$dcc_fûe_hódî
(
DCC_S
 * 
dcc
)

1428 
DCC_BITSTREAM_S
 
bs
;

1429 
i
;

1431 i‡(
dcc
->
hódî
.
Æªady_decoded
 =
TRUE
)

1434 
bs
.
cur_bô
 = 0;

1435 
bs
.
cur_bô_num
 = 0;

1436 
bs
.
cur_byã
 = 0;

1437 
bs
.
d©a
 = 
dcc
->
±r
;

1438 
bs
.
size
 = 8 * 
dcc
->size;

1440 i‡(
	`dcc_ªad_byãs
–& 
bs
, 1, & 
dcc
->
hódî
.
fûe_sig«tuª
))

1443 i‡(
	`dcc_ªad_byãs
–& 
bs
, 1, & 
dcc
->
hódî
.
vîsi⁄
))

1446 i‡(
	`dcc_ªad_byãs
–& 
bs
, 1, & 
dcc
->
hódî
.
dúe˘i⁄s
))

1449 i‡(
	`dcc_ªad_byãs
–& 
bs
, 4, & 
dcc
->
hódî
.
‰ames_≥r_dú
))

1452 i‡(
	`dcc_ªad_byãs
–& 
bs
, 4, & 
dcc
->
hódî
.
èg
))

1455 i‡(
	`dcc_ªad_byãs
–& 
bs
, 4, & 
dcc
->
hódî
.
föÆ_dc6_size
))

1458 
i
=0; i < 
dcc
->
hódî
.
dúe˘i⁄s
; i++)

1459 i‡(
	`dcc_ªad_byãs
–& 
bs
, 4, & 
dcc
->
hódî
.
dú_off£t
[
i
]))

1463 
dcc
->
hódî
.
Æªady_decoded
 = 
TRUE
;

1465 
	}
}

1472 
	$dcc_decode
(
DCC_S
 * 
dcc
, 
dú_bôfõld
)

1474 
d
;

1477 
	`dcc_öô
();

1480 
dcc
->
box
.
xmö
 = dcc->box.
ymö
 = 0x7FFFFFFFL;

1481 
dcc
->
box
.
xmax
 = dcc->box.
ymax
 = 0x80000000L;

1484 i‡(
	`dcc_fûe_hódî
(
dcc
))

1488 
d
=0; d<
dcc
->
hódî
.
dúe˘i⁄s
; d++)

1490 i‡(
dú_bôfõld
 & (1 << 
d
))

1492 i‡(
	`dcc_dú_bô°ªam
(
dcc
, 
d
))

1496 i‡(
dcc
->
dúe˘i⁄
[
d
].
box
.
xmö
 < dcc->box.xmin)

1497 
dcc
->
box
.
xmö
 = dcc->
dúe˘i⁄
[
d
].box.xmin;

1499 i‡(
dcc
->
dúe˘i⁄
[
d
].
box
.
ymö
 < dcc->box.ymin)

1500 
dcc
->
box
.
ymö
 = dcc->
dúe˘i⁄
[
d
].box.ymin;

1502 i‡(
dcc
->
dúe˘i⁄
[
d
].
box
.
xmax
 > dcc->box.xmax)

1503 
dcc
->
box
.
xmax
 = dcc->
dúe˘i⁄
[
d
].box.xmax;

1505 i‡(
dcc
->
dúe˘i⁄
[
d
].
box
.
ymax
 > dcc->box.ymax)

1506 
dcc
->
box
.
ymax
 = dcc->
dúe˘i⁄
[
d
].box.ymax;

1509 
dcc
->
box
.
width
 = dcc->box.
xmax
 - dcc->box.
xmö
 + 1;

1510 
dcc
->
box
.
height
 = dcc->box.
ymax
 - dcc->box.
ymö
 + 1;

1514 
	}
}

1519 
	$dcc_debug
(
DCC_S
 * 
dcc
)

1521 
d
, 
f
, 
i
;

1523 
	`¥ötf
("fûe_sig«tuª = %i\n", 
dcc
->
hódî
.
fûe_sig«tuª
);

1524 
	`¥ötf
("vîsi⁄ = %i\n", 
dcc
->
hódî
.
vîsi⁄
);

1525 
	`¥ötf
("dúe˘i⁄† = %i\n", 
dcc
->
hódî
.
dúe˘i⁄s
);

1526 
	`¥ötf
("‰ames_≥r_dú = %li\n", 
dcc
->
hódî
.
‰ames_≥r_dú
);

1527 
	`¥ötf
("èg = %li\n", 
dcc
->
hódî
.
èg
);

1528 
	`¥ötf
("föÆ_dc6_sizê%lòbyãs\n", 
dcc
->
hódî
.
föÆ_dc6_size
);

1530 
	`¥ötf
("\nbox = (%li, %li) ---> (%li, %li) = %li * %li\n",

1531 
dcc
->
box
.
xmö
, dcc->box.
ymö
,

1532 
dcc
->
box
.
xmax
, dcc->box.
ymax
,

1533 
dcc
->
box
.
width
, dcc->box.
height


1536 
d
=0; d<
dcc
->
hódî
.
dúe˘i⁄s
; d++)

1538 
	`¥ötf
("\ndúe˘i⁄ %2i\n", 
d
);

1539 
	`¥ötf
(" outsize_coded = %lòbyãs\n", 
dcc
->
dúe˘i⁄
[
d
].
outsize_coded
);

1540 
	`¥ötf
(" com¥essi⁄_Êag = %li\n", 
dcc
->
dúe˘i⁄
[
d
].
com¥essi⁄_Êag
);

1541 
	`¥ötf
(" v¨übÀ0_bô† = %2lu (%2òbôs)\n", 
dcc
->
dúe˘i⁄
[
d
].
v¨übÀ0_bôs
, 
dcc_bôs_width_èbÀ
[dcc->direction[d].variable0_bits]);

1542 
	`¥ötf
(" width_bô† = %2lu (%2òbôs)\n", 
dcc
->
dúe˘i⁄
[
d
].
width_bôs
, 
dcc_bôs_width_èbÀ
[dcc->direction[d].width_bits]);

1543 
	`¥ötf
(" height_bô† = %2lu (%2òbôs)\n", 
dcc
->
dúe˘i⁄
[
d
].
height_bôs
, 
dcc_bôs_width_èbÀ
[dcc->direction[d].height_bits]);

1544 
	`¥ötf
(" xoff£t_bô† = %2lu (%2òbôs)\n", 
dcc
->
dúe˘i⁄
[
d
].
xoff£t_bôs
, 
dcc_bôs_width_èbÀ
[dcc->direction[d].xoffset_bits]);

1545 
	`¥ötf
(" yoff£t_bô† = %2lu (%2òbôs)\n", 
dcc
->
dúe˘i⁄
[
d
].
yoff£t_bôs
, 
dcc_bôs_width_èbÀ
[dcc->direction[d].yoffset_bits]);

1546 
	`¥ötf
(" o±i⁄Æ_byãs_bô†%2lu (%2òbôs)\n", 
dcc
->
dúe˘i⁄
[
d
].
›ti⁄Æ_byãs_bôs
, 
dcc_bôs_width_èbÀ
[dcc->direction[d].optional_bytes_bits]);

1547 
	`¥ötf
(" coded_byãs_bô† = %2lu (%2òbôs)\n", 
dcc
->
dúe˘i⁄
[
d
].
coded_byãs_bôs
, 
dcc_bôs_width_èbÀ
[dcc->direction[d].coded_bytes_bits]);

1548 
	`¥ötf
(" box = (%li, %li) ---> (%li, %li) = %li * %li\n",

1549 
dcc
->
dúe˘i⁄
[
d
].
box
.
xmö
,

1550 
dcc
->
dúe˘i⁄
[
d
].
box
.
ymö
,

1551 
dcc
->
dúe˘i⁄
[
d
].
box
.
xmax
,

1552 
dcc
->
dúe˘i⁄
[
d
].
box
.
ymax
,

1553 
dcc
->
dúe˘i⁄
[
d
].
box
.
width
,

1554 
dcc
->
dúe˘i⁄
[
d
].
box
.
height


1556 
	`¥ötf
(" cells = %i * %i = %i\n",

1557 
dcc
->
dúe˘i⁄
[
d
].
nb_˚Œs_w
,

1558 
dcc
->
dúe˘i⁄
[
d
].
nb_˚Œs_h
,

1559 
dcc
->
dúe˘i⁄
[
d
].
nb_˚Œs_w
 * dcc->dúe˘i⁄[d].
nb_˚Œs_h


1561 
	`¥ötf
(" CVDCC.DLL offsets = %li, %li (in version < 3.0)\n\n",

1562 
dcc
->
dúe˘i⁄
[
d
].
box
.
xmö
,

1563 
dcc
->
dúe˘i⁄
[
d
].
box
.
ymax


1565 
	`¥ötf
("ÉquÆ_˚Œ_bô°ªam_sizê = %8lòbô†‘ód %8li)\n", 
dcc
->
dúe˘i⁄
[
d
].
equÆ_˚Œ_bô°ªam_size
, dcc->dúe˘i⁄[d].
equÆ_˚Œ_bô°ªam
.
cur_bô_num
);

1566 
	`¥ötf
("Öixñ_mask_bô°ªam_sizê = %8lòbô†‘ód %8li)\n", 
dcc
->
dúe˘i⁄
[
d
].
pixñ_mask_bô°ªam_size
, dcc->dúe˘i⁄[d].
pixñ_mask_bô°ªam
.
cur_bô_num
);

1567 
	`¥ötf
("Éncodög_ty≥_bô°ªam_sizê = %8lòbô†‘ód %8li)\n", 
dcc
->
dúe˘i⁄
[
d
].
ícodög_ty≥_bô°ªam_size
, dcc->dúe˘i⁄[d].
ícodög_ty≥_bô°ªam
.
cur_bô_num
);

1568 
	`¥ötf
("Ñaw_pixñ_bô°ªam_sizê = %8lòbô†‘ód %8li)\n", 
dcc
->
dúe˘i⁄
[
d
].
øw_pixñ_bô°ªam_size
, dcc->dúe˘i⁄[d].
øw_pixñ_bô°ªam
.
cur_bô_num
);

1569 
	`¥ötf
("Öixñ_code_™d_di•œcmít.sizê%8lòbô†‘ód %8li)\n", 
dcc
->
dúe˘i⁄
[
d
].
pixñ_code_™d_di•œcmít_bô°ªam
.
size
, dcc->dúe˘i⁄[d].pixñ_code_™d_di•œcmít_bô°ªam.
cur_bô_num
);

1571 
	`¥ötf
("\nÖixel_values :\n");

1572 
i
=0; i < 256; i++)

1574 
	`¥ötf
(" %3i", 
dcc
->
dúe˘i⁄
[
d
].
pixñ_vÆues
[
i
]);

1575 i‡–! ((
i
+1) % 16))

1576 
	`¥ötf
("\n");

1579 
f
=0; f<
dcc
->
hódî
.
‰ames_≥r_dú
; f++)

1581 
	`¥ötf
("\¿ fømê%3i\n", 
f
);

1583 i‡(
dcc
->
dúe˘i⁄
[
d
].
v¨übÀ0_bôs
)

1584 
	`¥ötf
(" v¨übÀ0 = %lu\n", 
dcc
->
‰ame
[
d
][
f
].
v¨übÀ0
);

1586 i‡(
dcc
->
dúe˘i⁄
[
d
].
width_bôs
)

1587 
	`¥ötf
(" width = %lu\n", 
dcc
->
‰ame
[
d
][
f
].
width
);

1589 i‡(
dcc
->
dúe˘i⁄
[
d
].
height_bôs
)

1590 
	`¥ötf
(" heighà = %lu\n", 
dcc
->
‰ame
[
d
][
f
].
height
);

1592 i‡(
dcc
->
dúe˘i⁄
[
d
].
xoff£t_bôs
)

1593 
	`¥ötf
(" xoff£à = %li\n", 
dcc
->
‰ame
[
d
][
f
].
xoff£t
);

1595 i‡(
dcc
->
dúe˘i⁄
[
d
].
yoff£t_bôs
)

1596 
	`¥ötf
(" yoff£à = %li\n", 
dcc
->
‰ame
[
d
][
f
].
yoff£t
);

1598 i‡(
dcc
->
dúe˘i⁄
[
d
].
›ti⁄Æ_byãs_bôs
)

1599 
	`¥ötf
(" o±i⁄Æ_byã†%lu\n", 
dcc
->
‰ame
[
d
][
f
].
›ti⁄Æ_byãs
);

1601 i‡(
dcc
->
dúe˘i⁄
[
d
].
coded_byãs_bôs
)

1602 
	`¥ötf
(" coded_byã† = %lu\n", 
dcc
->
‰ame
[
d
][
f
].
coded_byãs
);

1604 
	`¥ötf
(" bŸtom_u∞ = %li\n", 
dcc
->
‰ame
[
d
][
f
].
bŸtom_up
);

1605 
	`¥ötf
(" box = (%li, %li) ---> (%li, %li) = %li * %li\n",

1606 
dcc
->
‰ame
[
d
][
f
].
box
.
xmö
,

1607 
dcc
->
‰ame
[
d
][
f
].
box
.
ymö
,

1608 
dcc
->
‰ame
[
d
][
f
].
box
.
xmax
,

1609 
dcc
->
‰ame
[
d
][
f
].
box
.
ymax
,

1610 
dcc
->
‰ame
[
d
][
f
].
box
.
width
,

1611 
dcc
->
‰ame
[
d
][
f
].
box
.
height


1614 
	`¥ötf
(" box2 = (%li, %li) ---> (%li, %li) = %li * %li\n",

1615 
dcc
->
‰ame
[
d
][
f
].
box
.
xmö
 - dcc->
dúe˘i⁄
[d].box.xmin,

1616 
dcc
->
‰ame
[
d
][
f
].
box
.
ymö
 - dcc->
dúe˘i⁄
[d].box.ymin,

1617 
dcc
->
‰ame
[
d
][
f
].
box
.
xmax
 - dcc->
dúe˘i⁄
[d].box.
xmö
,

1618 
dcc
->
‰ame
[
d
][
f
].
box
.
ymax
 - dcc->
dúe˘i⁄
[d].box.
ymö
,

1619 
dcc
->
‰ame
[
d
][
f
].
box
.
width
,

1620 
dcc
->
‰ame
[
d
][
f
].
box
.
height


1623 
	`¥ötf
(" cells = %i * %i = %i\n",

1624 
dcc
->
‰ame
[
d
][
f
].
nb_˚Œs_w
,

1625 
dcc
->
‰ame
[
d
][
f
].
nb_˚Œs_h
,

1626 
dcc
->
‰ame
[
d
][
f
].
nb_˚Œs_w
 * dcc->‰ame[d][f].
nb_˚Œs_h


1629 
	`¥ötf
(" 1st cell0_x, y = %li, %li\n",

1630 
dcc
->
‰ame
[
d
][
f
].
˚Œ
[0].
x0
,

1631 
dcc
->
‰ame
[
d
][
f
].
˚Œ
[0].
y0


1634 i‡(
dcc
->
‰ame
[
d
][
f
].
›ti⁄Æ_byãs
)

1636 
	`¥ötf
(" optional datas =");

1637 
i
=0; i < (Ë
dcc
->
‰ame
[
d
][
f
].
›ti⁄Æ_byãs
; i++)

1638 
	`¥ötf
(" %02X", 
dcc
->
‰ame
[
d
][
f
].
›ti⁄Æ_byãs_d©a
[
i
]);

1639 
	`¥ötf
("\n");

1643 
	`¥ötf
("\ndcc_îr‹[] :\n%s", 
dcc_îr‹
);

1644 
	}
}

1653 
DCC_S
 * 
	$dcc_disk_lﬂd
(* 
dcc_«me
)

1655 
DCC_S
 * 
dcc
;

1656 
FILE
 * 
ö
;

1657 
size
;

1660 
ö
 = 
	`f›í
(
dcc_«me
, "rb");

1661 i‡(
ö
 =
NULL
)

1663 
	`•rötf
(
dcc_îr‹
, "dcc_disk_lﬂd(Ë: c™'à›í %s\n", 
dcc_«me
);

1664  
NULL
;

1668 
size
 = (
DCC_S
);

1669 
dcc
 = (
DCC_S
 *Ë
	`mÆloc
(
size
);

1670 i‡(
dcc
 =
NULL
)

1672 
	`•rötf
(
dcc_îr‹
, "dcc_disk_load() : can'tállocate %i bytes (main struct) "

1673 "f‹ %s\n", 
size
, 
dcc_«me
);

1674 
	`f˛o£
(
ö
);

1675  
NULL
;

1677 
	`mem£t
(
dcc
, 0, 
size
);

1680 
	`f£ek
(
ö
, 0, 
SEEK_END
);

1681 
dcc
->
size
 = 
	`·ñl
(
ö
);

1682 i‡(
dcc
->
size
 < 0)

1684 
	`•rötf
(
dcc_îr‹
, "dcc_disk_load() : ftell() haveÑeturn %li "

1685 "f‹ %s\n", 
dcc
->
size
, 
dcc_«me
);

1686 
	`f˛o£
(
ö
);

1687 
	`‰ì
(
dcc
);

1688  
NULL
;

1690 
	`f£ek
(
ö
, 0, 
SEEK_SET
);

1693 
dcc
->
±r
 = (
UBYTE
 *Ë
	`mÆloc
(dcc->
size
);

1694 i‡(
dcc
->
±r
 =
NULL
)

1696 
	`•rötf
(
dcc_îr‹
, "dcc_disk_load() : can'tállocate %li bytes (buffer) "

1697 "f‹ %s\n", 
dcc
->
size
, 
dcc_«me
);

1698 
	`f˛o£
(
ö
);

1699 
	`‰ì
(
dcc
);

1700  
NULL
;

1704 
	`‰ód
(
dcc
->
±r
, dcc->
size
, 1, 
ö
);

1707 
	`f˛o£
(
ö
);

1708  
dcc
;

1709 
	}
}

1719 
DCC_S
 * 
	$dcc_mem_lﬂd
(* 
mem_±r
, 
mem_size
)

1721 
DCC_S
 * 
dcc
;

1722 
size
;

1725 
size
 = (
DCC_S
);

1726 
dcc
 = (
DCC_S
 *Ë
	`mÆloc
(
size
);

1727 i‡(
dcc
 =
NULL
)

1729 
	`•rötf
(
dcc_îr‹
, "dcc_mem_load() : can'tállocate %i bytes "

1730 "(maö såu˘)\n", 
size
);

1731  
NULL
;

1733 
	`mem£t
(
dcc
, 0, 
size
);

1736 
dcc
->
size
 = 
mem_size
;

1737 i‡(
dcc
->
size
 < 0)

1739 
	`•rötf
(
dcc_îr‹
, "dcc_mem_lﬂd(Ë: sizêi†%òbyãs\n", 
mem_size
);

1740 
	`‰ì
(
dcc
);

1741  
NULL
;

1745 
dcc
->
±r
 = (
UBYTE
 *Ë
	`mÆloc
(dcc->
size
);

1746 i‡(
dcc
->
±r
 =
NULL
)

1748 
	`•rötf
(
dcc_îr‹
, "dcc_mem_load() : can'tállocate %li bytes "

1749 "(buf„r)\n", 
dcc
->
size
);

1750 
	`‰ì
(
dcc
);

1751  
NULL
;

1755 
	`mem˝y
(
dcc
->
±r
, 
mem_±r
, 
mem_size
);

1758  
dcc
;

1759 
	}
}

1764 
	$dcc_de°roy
(
DCC_S
 * 
dcc
)

1766 
d
, 
f
, 
nb_˚Œ
, 
i
;

1769 i‡(
dcc
 =
NULL
)

1773 i‡(
dcc
->
±r
 !
NULL
)

1775 
	`‰ì
(
dcc
->
±r
);

1776 
dcc
->
±r
 = 
NULL
;

1780 
d
=0; d < 
dcc
->
hódî
.
dúe˘i⁄s
; d++)

1783 
f
=0; f < 
dcc
->
hódî
.
‰ames_≥r_dú
; f++)

1786 i‡(
dcc
->
‰ame
[
d
][
f
].
›ti⁄Æ_byãs_d©a
)

1788 
	`‰ì
(
dcc
->
‰ame
[
d
][
f
].
›ti⁄Æ_byãs_d©a
);

1789 
dcc
->
‰ame
[
d
][
f
].
›ti⁄Æ_byãs_d©a
 = 
NULL
;

1793 i‡(
dcc
->
‰ame
[
d
][
f
].
˚Œ
)

1795 
nb_˚Œ
 = 
dcc
->
‰ame
[
d
][
f
].
nb_˚Œs_w
 * dcc->‰ame[d][f].
nb_˚Œs_h
;

1796 
i
=0; i < 
nb_˚Œ
; i++)

1797 i‡(
dcc
->
‰ame
[
d
][
f
].
˚Œ
[
i
].
bmp
)

1798 
	`de°roy_bôm≠
(
dcc
->
‰ame
[
d
][
f
].
˚Œ
[
i
].
bmp
);

1800 
	`‰ì
(
dcc
->
‰ame
[
d
][
f
].
˚Œ
);

1801 
dcc
->
‰ame
[
d
][
f
].
˚Œ
 = 
NULL
;

1805 i‡(
dcc
->
‰ame
[
d
][
f
].
bmp
)

1806 
	`de°roy_bôm≠
(
dcc
->
‰ame
[
d
][
f
].
bmp
);

1810 i‡(
dcc
->
dúe˘i⁄
[
d
].
pixñ_buf„r
)

1812 
	`‰ì
(
dcc
->
dúe˘i⁄
[
d
].
pixñ_buf„r
);

1813 
dcc
->
dúe˘i⁄
[
d
].
pixñ_buf„r
 = 
NULL
;

1817 i‡(
dcc
->
dúe˘i⁄
[
d
].
buf„r_±r
)

1819 
nb_˚Œ
 = 
dcc
->
dúe˘i⁄
[
d
].
nb_˚Œs_w
 * dcc->dúe˘i⁄[d].
nb_˚Œs_h
;

1820 
i
=0; i < 
nb_˚Œ
; i++)

1821 i‡(
dcc
->
dúe˘i⁄
[
d
].
buf„r_±r
[
i
].
bmp
)

1822 
	`de°roy_bôm≠
(
dcc
->
dúe˘i⁄
[
d
].
buf„r_±r
[
i
].
bmp
);

1824 
	`‰ì
(
dcc
->
dúe˘i⁄
[
d
].
buf„r_±r
);

1825 
dcc
->
dúe˘i⁄
[
d
].
buf„r_±r
 = 
NULL
;

1829 i‡(
dcc
->
dúe˘i⁄
[
d
].
bmp
)

1830 
	`de°roy_bôm≠
(
dcc
->
dúe˘i⁄
[
d
].
bmp
);

1834 
	`‰ì
(
dcc
);

1835 
	}
}

	@dccinfo.h

1 #i‚de‡
_DCC_INFO_H_


3 
	#_DCC_INFO_H_


	)

6 
	#DCC_MAX_DIR
 32

	)

7 
	#DCC_MAX_FRAME
 256

	)

9 
	#DCC_MAX_PB_ENTRY
 85000

	)

12 
	gdcc_îr‹
[512];

17 
	gdcc_bôs_width_èbÀ
[16];

19 
	sDCC_BOX_S


21 
	mxmö
;

22 
	mymö
;

23 
	mxmax
;

24 
	mymax
;

25 
	mwidth
;

26 
	mheight
;

27 } 
	tDCC_BOX_S
;

29 
	sDCC_CELL_S


31 
	mx0
, 
	my0
;

32 
	mw
, 
	mh
;

34 
	mœ°_w
, 
	mœ°_h
;

36 
	mœ°_x0
, 
	mœ°_y0
;

38 
BITMAP
 * 
	mbmp
;

39 } 
	tDCC_CELL_S
;

42 
	sDCC_FRAME_S


44 
UDWORD
 
	mv¨übÀ0
;

45 
UDWORD
 
	mwidth
;

46 
UDWORD
 
	mheight
;

47 
	mxoff£t
;

48 
	myoff£t
;

49 
UDWORD
 
	m›ti⁄Æ_byãs
;

50 
UDWORD
 
	mcoded_byãs
;

52 
UBYTE
 * 
	m›ti⁄Æ_byãs_d©a
;

56 
UDWORD
 
	mbŸtom_up
;

59 
DCC_CELL_S
 * 
	m˚Œ
;

60 
	mnb_˚Œs_w
;

61 
	mnb_˚Œs_h
;

64 
DCC_BOX_S
 
	mbox
;

67 
BITMAP
 * 
	mbmp
;

69 } 
	tDCC_FRAME_S
;

71 
	sDCC_BITSTREAM_S


73 
UBYTE
 * 
	md©a
;

74 
UDWORD
 
	msize
;

75 
UDWORD
 
	mcur_byã
;

76 
UBYTE
 
	mcur_bô
;

78 
UDWORD
 
	mcur_bô_num
;

80 } 
	tDCC_BITSTREAM_S
;

83 
	sDCC_PB_ENTRY_S


85 
UBYTE
 
	mvÆ
[4];

86 
	m‰ame
;

87 
	m‰ame_˚Œ_ödex
;

88 } 
	tDCC_PB_ENTRY_S
;

90 
	sDCC_DIRECTION_S


92 
UDWORD
 
	moutsize_coded
;

93 
UDWORD
 
	mcom¥essi⁄_Êag
;

97 
UDWORD
 
	mv¨übÀ0_bôs
;

98 
UDWORD
 
	mwidth_bôs
;

99 
UDWORD
 
	mheight_bôs
;

100 
UDWORD
 
	mxoff£t_bôs
;

101 
UDWORD
 
	myoff£t_bôs
;

102 
UDWORD
 
	m›ti⁄Æ_byãs_bôs
;

103 
UDWORD
 
	mcoded_byãs_bôs
;

106 
UDWORD
 
	mequÆ_˚Œ_bô°ªam_size
;

107 
UDWORD
 
	mpixñ_mask_bô°ªam_size
;

108 
UDWORD
 
	mícodög_ty≥_bô°ªam_size
;

109 
UDWORD
 
	møw_pixñ_bô°ªam_size
;

110 
DCC_BITSTREAM_S
 
	mequÆ_˚Œ_bô°ªam
;

111 
DCC_BITSTREAM_S
 
	mpixñ_mask_bô°ªam
;

112 
DCC_BITSTREAM_S
 
	mícodög_ty≥_bô°ªam
;

113 
DCC_BITSTREAM_S
 
	møw_pixñ_bô°ªam
;

114 
DCC_BITSTREAM_S
 
	mpixñ_code_™d_di•œcmít_bô°ªam
;

117 
	mnb_˚Œs_w
;

118 
	mnb_˚Œs_h
;

119 
BITMAP
 * 
	mbmp
;

120 
DCC_CELL_S
 * 
	mbuf„r_±r
;

123 
DCC_PB_ENTRY_S
 * 
	mpixñ_buf„r
;

124 
	mpb_nb_íåy
;

127 
UBYTE
 
	mpixñ_vÆues
[256];

130 
DCC_BOX_S
 
	mbox
;

131 } 
	tDCC_DIRECTION_S
;

133 
	sDCC_HEADER_S


135 
UBYTE
 
	mfûe_sig«tuª
;

136 
UBYTE
 
	mvîsi⁄
;

137 
UBYTE
 
	mdúe˘i⁄s
;

138 
	m‰ames_≥r_dú
;

139 
	mèg
;

141 
	mföÆ_dc6_size
;

142 
	mdú_off£t
 [
DCC_MAX_DIR
];

144 
	mÆªady_decoded
;

145 } 
	tDCC_HEADER_S
;

147 
	sDCC_S


149 
UBYTE
 * 
	m±r
;

150 
	msize
;

151 
DCC_HEADER_S
 
	mhódî
;

152 
DCC_DIRECTION_S
 
	mdúe˘i⁄
 [
DCC_MAX_DIR
];

153 
DCC_FRAME_S
 
	m‰ame
 [
DCC_MAX_DIR
] [
DCC_MAX_FRAME
];

154 
DCC_BOX_S
 
	mbox
;

155 } 
	tDCC_S
;

157 
dcc_öô
 ();

158 
dcc_ªad_byãs
 (
DCC_BITSTREAM_S
 * 
bs
, 
byãs_numbî
, * 
de°
);

159 
dcc_ªad_bôs
 (
DCC_BITSTREAM_S
 * 
bs
, 
bôs_numbî
, 
is_sig√d
, 
UDWORD
 * 
de°
 );

160 
dcc_‰ame_hódî_bô°ªam
 (
DCC_S
 * 
dcc
, 
DCC_BITSTREAM_S
 * 
bs
, 
d
, 
f
);

161 
dcc_öô_dú_bô°ªam
 (
DCC_S
 * 
dcc
, 
DCC_BITSTREAM_S
 * 
bs
, 
d
);

162 
dcc_›ti⁄Æ_d©as
 (
DCC_S
 * 
dcc
, 
DCC_BITSTREAM_S
 * 
bs
, 
d
);

163 
dcc_Ÿhî_bô°ªam_size
 (
DCC_S
 * 
dcc
, 
DCC_BITSTREAM_S
 * 
bs
, 
d
);

164 
dcc_pixñ_vÆues_key
 (
DCC_S
 * 
dcc
, 
DCC_BITSTREAM_S
 * 
bs
, 
d
);

165 
dcc_¥ï¨e_buf„r_˚Œs
 (
DCC_S
 * 
dcc
, 
d
);

166 
dcc_¥ï¨e_‰ame_˚Œs
 (
DCC_S
 * 
dcc
, 
d
, 
f
);

167 
dcc_fûl_pixñ_buf„r
 (
DCC_S
 * 
dcc
, 
d
);

168 
dcc_ßve_‰ame
 (
DCC_S
 * 
dcc
, 
d
, 
f
, 
BITMAP
 * 
‰m_bmp
);

169 
dcc_make_‰ames
 (
DCC_S
 * 
dcc
, 
d
);

170 
dcc_dú_bô°ªam
 (
DCC_S
 * 
dcc
, 
d
);

171 
dcc_fûe_hódî
 (
DCC_S
 * 
dcc
);

172 
dcc_decode
 (
DCC_S
 * 
dcc
, 
dú_bôfõld
);

173 
dcc_debug
 (
DCC_S
 * 
dcc
);

174 
DCC_S
 * 
dcc_disk_lﬂd
 (* 
dcc_«me
);

175 
DCC_S
 * 
dcc_mem_lﬂd
 (* 
mem_±r
, 
mem_size
);

176 
dcc_de°roy
 (
DCC_S
 * 
dcc
);

	@ds1misc.c

1 
	~<°rög.h
>

2 
	~"°ru˘s.h
"

3 
	~"dt1misc.h
"

4 
	~"îr‹.h
"

5 
	~"edôobj.h
"

6 
	~"w¥evõw.h
"

7 
	~"ds1misc.h
"

8 
	~"misc.h
"

13 
	$ds1_‰ì
(
i
)

15 
d
, 
tŸÆ
 = 0;

17 i‡(
	`°æí
(
glb_ds1
[
i
].
«me
) == 0)

20 
	`Ârötf
(
°dîr
, " . %s\n", 
glb_ds1
[
i
].
«me
);

21 
	`fÊush
(
°dîr
);

24 
	`Ârötf
(
°dîr
, " _ dt1s");

25 
	`fÊush
(
°dîr
);

26 
d
=0; d<
DT1_IN_DS1_MAX
; d++)

27 
	`dt1_dñ
(
glb_ds1
[
i
].
dt1_idx
[
d
]);

30 
	`Ârötf
(
°dîr
, ", blockÅable");

31 
	`fÊush
(
°dîr
);

32 i‡(
glb_ds1
[
i
].
block_èbÀ
 !
NULL
)

34 
tŸÆ
 +
glb_ds1
[
i
].
bt_num
 * (
BLOCK_TABLE_S
);

35 
	`‰ì
(
glb_ds1
[
i
].
block_èbÀ
);

39 
	`Ârötf
(
°dîr
, ", file buffer");

40 
	`fÊush
(
°dîr
);

41 i‡(
glb_ds1
[
i
].
fûe_buff
 !
NULL
)

43 
tŸÆ
 +
glb_ds1
[
i
].
fûe_Àn
;

44 
	`‰ì
(
glb_ds1
[
i
].
fûe_buff
);

48 
	`Ârötf
(
°dîr
, ", floors");

49 
	`fÊush
(
°dîr
);

50 i‡(
glb_ds1
[
i
].
Êo‹_buff
 !
NULL
)

52 
tŸÆ
 +
glb_ds1
[
i
].
Êo‹_buff_Àn
;

53 
	`‰ì
(
glb_ds1
[
i
].
Êo‹_buff
);

55 i‡(
glb_ds1
[
i
].
Êo‹_buff2
 !
NULL
)

57 
tŸÆ
 +
glb_ds1
[
i
].
Êo‹_buff_Àn
;

58 
	`‰ì
(
glb_ds1
[
i
].
Êo‹_buff2
);

62 
	`Ârötf
(
°dîr
, ", shadows");

63 
	`fÊush
(
°dîr
);

64 i‡(
glb_ds1
[
i
].
shadow_buff
 !
NULL
)

66 
tŸÆ
 +
glb_ds1
[
i
].
shadow_buff_Àn
;

67 
	`‰ì
(
glb_ds1
[
i
].
shadow_buff
);

69 i‡(
glb_ds1
[
i
].
shadow_buff2
 !
NULL
)

71 
tŸÆ
 +
glb_ds1
[
i
].
shadow_buff_Àn
;

72 
	`‰ì
(
glb_ds1
[
i
].
shadow_buff2
);

76 
	`Ârötf
(
°dîr
, ", unknown");

77 
	`fÊush
(
°dîr
);

78 i‡(
glb_ds1
[
i
].
èg_buff
 !
NULL
)

80 
tŸÆ
 +
glb_ds1
[
i
].
èg_buff_Àn
;

81 
	`‰ì
(
glb_ds1
[
i
].
èg_buff
);

83 i‡(
glb_ds1
[
i
].
èg_buff2
 !
NULL
)

85 
tŸÆ
 +
glb_ds1
[
i
].
èg_buff_Àn
;

86 
	`‰ì
(
glb_ds1
[
i
].
èg_buff2
);

90 
	`Ârötf
(
°dîr
, ", walls\n");

91 
	`fÊush
(
°dîr
);

92 i‡(
glb_ds1
[
i
].
wÆl_buff
 !
NULL
)

94 
tŸÆ
 +
glb_ds1
[
i
].
wÆl_buff_Àn
;

95 
	`‰ì
(
glb_ds1
[
i
].
wÆl_buff
);

97 i‡(
glb_ds1
[
i
].
wÆl_buff2
 !
NULL
)

99 
tŸÆ
 +
glb_ds1
[
i
].
wÆl_buff_Àn
;

100 
	`‰ì
(
glb_ds1
[
i
].
wÆl_buff2
);

104 i‡(
glb_ds1
[
i
].
group
 !
NULL
)

105 
	`‰ì
(
glb_ds1
[
i
].
group
);

108 
	`mem£t
(& 
glb_ds1
[
i
], 0, (
DS1_S
));

109 
	`Ârötf
(
°dîr
, " byã†‰ì = %i\n", 
tŸÆ
);

110 
	`fÊush
(
°dîr
);

111  
tŸÆ
;

112 
	}
}

117 
	$w¥›_2_block
(
i
, 
CELL_W_S
 * 
w_±r
)

119 
BLOCK_TABLE_S
 * 
bt_±r
 = 
glb_ds1
[
i
].
block_èbÀ
;

120 
‹õ¡©i⁄
, 
maö_ödex
, 
sub_ödex
;

121 
b
;

123 
w_±r
->
bt_idx
 = -1;

124 i‡(
w_±r
->
¥›1
 == 0)

127 
w_±r
->
bt_idx
 = 0;

131 
‹õ¡©i⁄
 = 
w_±r
->orientation;

132 
maö_ödex
 = (
w_±r
->
¥›3
 >> 4Ë+ ((w_±r->
¥›4
 & 0x03) << 4);

133 
sub_ödex
 = 
w_±r
->
¥›2
;

134 
b
=0; b<
glb_ds1
[
i
].
bt_num
; b++)

136 i‡–(
bt_±r
->
‹õ¡©i⁄
 == orientation) &&

137 (
bt_±r
->
maö_ödex
 == main_index) &&

138 (
bt_±r
->
sub_ödex
 == sub_index) &&

139 (
bt_±r
->
u£d_by_edô‹
)

142 
w_±r
->
bt_idx
 = 
b
;

145 
bt_±r
++;

149 i‡((
‹õ¡©i⁄
 == 18) || (orientation == 19))

151 i‡(
‹õ¡©i⁄
 == 18)

152 
‹õ¡©i⁄
 = 19;

154 
‹õ¡©i⁄
 = 18;

157 
bt_±r
 = 
glb_ds1
[
i
].
block_èbÀ
;

158 
b
=0; b<
glb_ds1
[
i
].
bt_num
; b++)

160 i‡–(
bt_±r
->
‹õ¡©i⁄
 == orientation) &&

161 (
bt_±r
->
maö_ödex
 == main_index) &&

162 (
bt_±r
->
sub_ödex
 == sub_index) &&

163 (
bt_±r
->
u£d_by_edô‹
)

166 
w_±r
->
bt_idx
 = 
b
;

169 
bt_±r
++;

173 
sub_ödex
 = 0;

174 
bt_±r
 = 
glb_ds1
[
i
].
block_èbÀ
;

175 
b
=0; b<
glb_ds1
[
i
].
bt_num
; b++)

177 i‡–(
bt_±r
->
‹õ¡©i⁄
 == orientation) &&

178 (
bt_±r
->
maö_ödex
 == main_index) &&

179 (
bt_±r
->
sub_ödex
 == sub_index) &&

180 (
bt_±r
->
u£d_by_edô‹
)

183 
w_±r
->
bt_idx
 = 
b
;

186 
bt_±r
++;

189 
	}
}

194 
	$Âr›_2_block
(
i
, 
CELL_F_S
 * 
f_±r
)

196 
BLOCK_TABLE_S
 * 
bt_±r
 = 
glb_ds1
[
i
].
block_èbÀ
;

197 
maö_ödex
, 
sub_ödex
;

198 
b
;

200 
f_±r
->
bt_idx
 = -1;

201 i‡(
f_±r
->
¥›1
 == 0)

204 
f_±r
->
bt_idx
 = 0;

208 
maö_ödex
 = (
f_±r
->
¥›3
 >> 4Ë+ ((f_±r->
¥›4
 & 0x03) << 4);

209 
sub_ödex
 = 
f_±r
->
¥›2
;

210 
b
=0; b<
glb_ds1
[
i
].
bt_num
; b++)

212 i‡–(
bt_±r
->
‹õ¡©i⁄
 == 0) &&

213 (
bt_±r
->
maö_ödex
 == main_index) &&

214 (
bt_±r
->
sub_ödex
 == sub_index) &&

215 (
bt_±r
->
u£d_by_edô‹
)

218 
f_±r
->
bt_idx
 = 
b
;

221 
bt_±r
++;

223 
	}
}

228 
	$•r›_2_block
(
i
, 
CELL_S_S
 * 
s_±r
)

230 
BLOCK_TABLE_S
 * 
bt_±r
 = 
glb_ds1
[
i
].
block_èbÀ
;

231 
maö_ödex
, 
sub_ödex
;

232 
b
;

234 
s_±r
->
bt_idx
 = -1;

235 i‡(
s_±r
->
¥›1
 == 0)

238 
s_±r
->
bt_idx
 = 0;

242 
maö_ödex
 = (
s_±r
->
¥›3
 >> 4Ë+ ((s_±r->
¥›4
 & 0x03) << 4);

243 
sub_ödex
 = 
s_±r
->
¥›2
;

244 
b
=0; b<
glb_ds1
[
i
].
bt_num
; b++)

246 i‡–(
bt_±r
->
‹õ¡©i⁄
 == 13) &&

247 (
bt_±r
->
maö_ödex
 == main_index) &&

248 (
bt_±r
->
sub_ödex
 == sub_index) &&

249 (
bt_±r
->
u£d_by_edô‹
)

252 
s_±r
->
bt_idx
 = 
b
;

255 
bt_±r
++;

257 
	}
}

262 
	$ds1_make_¥›_2_block
(
i
)

264 
CELL_F_S
 * 
f_±r
;

265 
CELL_S_S
 * 
s_±r
;

266 
CELL_W_S
 * 
w_±r
;

267 
x
, 
y
, 
n
;

269 
w_±r
 = 
glb_ds1
[
i
].
wÆl_buff
;

270 
f_±r
 = 
glb_ds1
[
i
].
Êo‹_buff
;

271 
s_±r
 = 
glb_ds1
[
i
].
shadow_buff
;

273 
y
=0; y<
glb_ds1
[
i
].
height
; y++)

275 
x
=0; x<
glb_ds1
[
i
].
width
; x++)

277 
n
=0;Ç<
glb_ds1
[
i
].
wÆl_num
;Ç++)

279 
	`w¥›_2_block
(
i
, 
w_±r
);

280 
w_±r
++;

282 
n
=0;Ç<
glb_ds1
[
i
].
Êo‹_num
;Ç++)

284 
	`Âr›_2_block
(
i
, 
f_±r
);

285 
f_±r
++;

287 
n
=0;Ç<
glb_ds1
[
i
].
shadow_num
;Ç++)

289 
	`•r›_2_block
(
i
, 
s_±r
);

308 
s_±r
++;

312 
	}
}

321 
	$ds1_ªad
(c⁄° * 
ds1«me
, 
ds1_idx
, 
√w_width
, 
√w_height
)

323 
FILE
 * 
ö
;

324 
CELL_F_S
 * 
f_±r
[
FLOOR_MAX_LAYER
];

325 
CELL_S_S
 * 
s_±r
[
SHADOW_MAX_LAYER
];

326 
CELL_T_S
 * 
t_±r
[
TAG_MAX_LAYER
];

327 
CELL_W_S
 * 
w_±r
[
WALL_MAX_LAYER
];

328 
CELL_W_S
 * 
o_±r
[
WALL_MAX_LAYER
];

329 
OBJ_LABEL_S
 * 
œbñ
;

330 
o
, 
x
, 
y
, 
nb_œyî
, 
size
, 
n
, 
p
, 
ds1_Àn
, 
d⁄e
, 
cx
, 
cy
, 
dx
, 
dy
,

331 
cuºít_vÆid_obj_idx
=0, 
max_subtûe_width
, 
max_subtûe_height
;

332 
w_num
, 
f_num
, 
s_num
, 
t_num
, * 
±r
, 
≈c
, 
∑th
;

333 
œy_°ªam
[14],

334 
dú_lookup
[25] = {

339 
UBYTE
 * 
b±r
;

340 * 
ds1_buff
;

341 
obj_∑th_w¨n_wrŸe
 = 
FALSE
, 
œ°_o
, 
nb
;

342 
tmp
[150], * 
˝å
;

343 
tûe_x
, 
tûe_y
, 
zoom
;

344 
ö¸
;

347 i‡(
ds1_idx
 >
DS1_MAX
)

349 
	`•rötf
(
tmp
, "nŸÉnough fªêds1 slŸ f‹ %s, max i†%i", 
ds1«me
,

350 
DS1_MAX
);

351 
	`ds1edô_îr‹
(
tmp
);

354 i‡(
	`°æí
(
glb_ds1
[
ds1_idx
].
«me
))

356 
	`•rötf
(
tmp
, "ds1 slŸ %òi†Æªady u£d by %s", 
ds1_idx
, 
glb_ds1
[ds1_idx].
«me
);

357 
	`ds1edô_îr‹
(
tmp
);

359 i‡(
	`°ricmp
(
glb_ds1
[
ds1_idx
].
«me
, 
ds1«me
) == 0)

361 
	`•rötf
(
tmp
, "ds1 slŸ %òi†ÆªadyÜﬂded (%s)", 
ds1_idx
, 
glb_ds1
[ds1_idx].
«me
);

362 
	`ds1edô_îr‹
(
tmp
);

366 
x
 = 
	`°æí
(
ds1«me
) - 1;

367 (
x
 >0Ë&& (
ds1«me
[x] != '\\') && (ds1name[x] != '/') && (ds1name[x] != ':'))

368 
x
--;

369 i‡(
x
 == 0)

370 
	`°r˝y
(
glb_ds1
[
ds1_idx
].
fûíame
, 
ds1«me
);

372 
	`°r˝y
(
glb_ds1
[
ds1_idx
].
fûíame
, 
ds1«me
 + 
x
 + 1);

373 
	`°r˝y
(
glb_ds1
[
ds1_idx
].
«me
, 
ds1«me
);

376 
glb_ds1
[
ds1_idx
].
cuºít_obj_max
 = 
OBJ_MAX_START
;

379 
size
 = 
glb_ds1
[
ds1_idx
].
cuºít_obj_max
 * ();

380 
glb_ds1
[
ds1_idx
].
døwög_‹dî
 = (*Ë
	`ˇŒoc
(glb_ds1[ds1_idx].
cuºít_obj_max
, ());

381 i‡(
glb_ds1
[
ds1_idx
].
døwög_‹dî
 =
NULL
)

383 
	`•rötf
(
tmp
, "nŸÉnough mem (%òbyãsËf‹ glb_ds1[].døwög_‹dî o‡%s\n", 
size
, 
ds1«me
);

384 
	`ds1edô_îr‹
(
tmp
);

388 
size
 = 
glb_ds1
[
ds1_idx
].
cuºít_obj_max
 * (
OBJ_S
);

389 
glb_ds1
[
ds1_idx
].
obj
 = (
OBJ_S
 *Ë
	`ˇŒoc
(glb_ds1[ds1_idx].
cuºít_obj_max
, (OBJ_S));

390 i‡(
glb_ds1
[
ds1_idx
].
obj
 =
NULL
)

392 
	`•rötf
(
tmp
, "nŸÉnough mem (%òbyãsËf‹ glb_ds1[].obj o‡%s\n", 
size
, 
ds1«me
);

393 
	`ds1edô_îr‹
(
tmp
);

397 
glb_ds1
[
ds1_idx
].
obj_undo
 = (
OBJ_S
 *Ë
	`ˇŒoc
(glb_ds1[ds1_idx].
cuºít_obj_max
, (OBJ_S));

398 i‡(
glb_ds1
[
ds1_idx
].
obj_undo
 =
NULL
)

400 
	`•rötf
(
tmp
, "nŸÉnough mem (%òbyãsËf‹ glb_ds1[].obj_undÿo‡%s\n", 
size
, 
ds1«me
);

401 
	`ds1edô_îr‹
(
tmp
);

405 
x
=0; x < 
WALL_MAX_LAYER
; x++)

406 
glb_ds1
[
ds1_idx
].
wÆl_œyî_mask
[
x
] = 1;

408 
x
=0; x < 
FLOOR_MAX_LAYER
; x++)

409 
glb_ds1
[
ds1_idx
].
Êo‹_œyî_mask
[
x
] = 1;

411 
x
=0; x < 
SHADOW_MAX_LAYER
; x++)

412 
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[
x
] = 3;

414 
glb_ds1
[
ds1_idx
].
obje˘s_œyî_mask
 = 
OL_NONE
;

415 
glb_ds1
[
ds1_idx
].
∑ths_œyî_mask
 = 1;

416 
glb_ds1
[
ds1_idx
].
wÆkabÀ_œyî_mask
 = 0;

417 
glb_ds1
[
ds1_idx
].
subtûe_hñp_di•œy
 = 1;

418 
glb_ds1
[
ds1_idx
].
™im©i⁄s_œyî_mask
 = 1;

419 
glb_ds1
[
ds1_idx
].
•ecül_œyî_mask
 = 1;

422 
ö
 = 
	`f›í
(
ds1«me
, "rb");

423 i‡(
ö
 =
NULL
)

425 
	`•rötf
(
tmp
, "ˇn'à›í %s\n", 
ds1«me
);

426 
	`ds1edô_îr‹
(
tmp
);

428 
	`f£ek
(
ö
, 0, 
SEEK_END
);

429 
ds1_Àn
 = 
	`·ñl
(
ö
);

430 
	`f£ek
(
ö
, 0, 
SEEK_SET
);

431 
ds1_buff
 = (*Ë
	`mÆloc
(
ds1_Àn
);

432 i‡(
ds1_buff
 =
NULL
)

434 
	`f˛o£
(
ö
);

435 
	`•rötf
(
tmp
, "nŸÉnough mem (%òbyãsËf‹ %s\n", 
ds1_Àn
, 
ds1«me
);

436 
	`ds1edô_îr‹
(
tmp
);

438 
	`‰ód
(
ds1_buff
, 
ds1_Àn
, 1, 
ö
);

439 
	`f˛o£
(
ö
);

442 
w_num
 = 0;

443 
f_num
 = 0;

444 
s_num
 = 1;

445 
t_num
 = 0;

446 
±r
 = (*Ë
ds1_buff
;

452 
glb_ds1
[
ds1_idx
].
vîsi⁄
 = * 
±r
;

453 
±r
++;

456 
glb_ds1
[
ds1_idx
].
width
 = (* 
±r
) + 1;

457 
±r
++;

460 
glb_ds1
[
ds1_idx
].
height
 = (* 
±r
) + 1;

461 
±r
++;

464 i‡((
√w_width
 <0Ë|| (
√w_height
 <= 0))

466 
√w_width
 = 
glb_ds1
[
ds1_idx
].
width
;

467 
√w_height
 = 
glb_ds1
[
ds1_idx
].
height
;

471 
glb_ds1
[
ds1_idx
].
a˘
 = 1;

472 i‡(
glb_ds1
[
ds1_idx
].
vîsi⁄
 >= 8)

474 
glb_ds1
[
ds1_idx
].
a˘
 = (* 
±r
) + 1;

475 
±r
++;

476 i‡(
glb_ds1
[
ds1_idx
].
a˘
 > 5)

477 
glb_ds1
[
ds1_idx
].
a˘
 = 5;

481 
glb_ds1
[
ds1_idx
].
èg_ty≥
 = 0;

482 i‡(
glb_ds1
[
ds1_idx
].
vîsi⁄
 >= 10)

484 
glb_ds1
[
ds1_idx
].
èg_ty≥
 = * 
±r
;

485 
±r
++;

488 i‡((
glb_ds1
[
ds1_idx
].
èg_ty≥
 == 1) || (glb_ds1[ds1_idx].tag_type == 2))

489 
t_num
 = 1;

493 
	`¥ötf
("\nvîsi⁄ : %li\n", 
glb_ds1
[
ds1_idx
].
vîsi⁄
);

494 
	`¥ötf
("width : %li\n", 
glb_ds1
[
ds1_idx
].
width
);

495 
	`¥ötf
("heighà : %li\n", 
glb_ds1
[
ds1_idx
].
height
);

496 
	`¥ötf
("a˘ : %li\n", 
glb_ds1
[
ds1_idx
].
a˘
);

497 
	`¥ötf
("èg_ty≥ : %li\n", 
glb_ds1
[
ds1_idx
].
èg_ty≥
);

500 
glb_ds1
[
ds1_idx
].
fûe_num
 = 0;

501 i‡(
glb_ds1
[
ds1_idx
].
vîsi⁄
 >= 3)

503 
glb_ds1
[
ds1_idx
].
fûe_num
 = * 
±r
;

504 
±r
++;

505 
n
 = 0;

506 
	`¥ötf
("fûíame† : %li\n", 
glb_ds1
[
ds1_idx
].
fûe_num
);

508 
x
=0; x<
glb_ds1
[
ds1_idx
].
fûe_num
; x++)

510 
	`¥ötf
(" %2ò: %s\n", 
x
 + 1, ((*Ë
±r
Ë+ 
n
);

511 
n
 +(
	`°æí
–((*Ë
±r
) +Ç) + 1);

514 
glb_ds1
[
ds1_idx
].
fûe_buff
 = (*Ë
	`mÆloc
(
n
);

515 i‡(
glb_ds1
[
ds1_idx
].
fûe_buff
 =
NULL
)

517 
	`‰ì
(
ds1_buff
);

518 
	`•rötf
(
tmp
, "nŸÉnough mem (%òbyãsËf‹ fûe†öÅhêds1\n", 
n
);

519 
	`ds1edô_îr‹
(
tmp
);

521 
glb_ds1
[
ds1_idx
].
fûe_Àn
 = 
n
;

522 
	`mem˝y
(
glb_ds1
[
ds1_idx
].
fûe_buff
, 
±r
, 
n
);

523 
±r
 = (*Ë(((*Ë±rË+ 
n
);

526 
	`¥ötf
("no filenames\n");

529 i‡((
glb_ds1
[
ds1_idx
].
vîsi⁄
 >= 9) && (glb_ds1[ds1_idx].version <= 13))

530 
±r
 += 2;

533 i‡(
glb_ds1
[
ds1_idx
].
vîsi⁄
 >= 4)

536 
w_num
 = * 
±r
;

537 
±r
++;

540 i‡(
glb_ds1
[
ds1_idx
].
vîsi⁄
 >= 16)

542 
f_num
 = * 
±r
;

543 
±r
++;

546 
f_num
 = 1;

551 
w_num
 = 1;

552 
f_num
 = 1;

553 
t_num
 = 1;

557 i‡(
glb_ds1
[
ds1_idx
].
vîsi⁄
 < 4)

559 
œy_°ªam
[0] = 1;

560 
œy_°ªam
[1] = 9;

561 
œy_°ªam
[2] = 5;

562 
œy_°ªam
[3] = 12;

563 
œy_°ªam
[4] = 11;

564 
nb_œyî
 = 5;

568 
nb_œyî
 = 0;

569 
x
=0; x<
w_num
; x++)

571 
œy_°ªam
[
nb_œyî
++] = 1 + 
x
;

572 
œy_°ªam
[
nb_œyî
++] = 5 + 
x
;

574 
x
=0; x<
f_num
; x++)

575 
œy_°ªam
[
nb_œyî
++] = 9 + 
x
;

576 i‡(
s_num
)

577 
œy_°ªam
[
nb_œyî
++] = 11;

578 i‡(
t_num
)

579 
œy_°ªam
[
nb_œyî
++] = 12;

581 
	`¥ötf
("layers : (2 * %li walls) + %li floors + %li shadow"

582 " + %lòèg\n", 
w_num
, 
f_num
, 
s_num
, 
t_num
);

585 i‡(
glb_c⁄fig
.
Æways_max_œyîs
)

587 
f_num
 = 
FLOOR_MAX_LAYER
;

588 
w_num
 = 
WALL_MAX_LAYER
;

590 
glb_ds1
[
ds1_idx
].
Êo‹_num
 = 
f_num
;

591 
glb_ds1
[
ds1_idx
].
shadow_num
 = 
s_num
;

592 
glb_ds1
[
ds1_idx
].
èg_num
 = 
t_num
;

593 
glb_ds1
[
ds1_idx
].
wÆl_num
 = 
w_num
;

596 
glb_ds1
[
ds1_idx
].
Êo‹_löe
 = 
√w_width
 * glb_ds1[ds1_idx].
Êo‹_num
;

597 
glb_ds1
[
ds1_idx
].
Êo‹_Àn
 = glb_ds1[ds1_idx].
Êo‹_löe
 * 
√w_height
;

598 
glb_ds1
[
ds1_idx
].
Êo‹_buff_Àn
 = glb_ds1[ds1_idx].
Êo‹_Àn
 * (
CELL_F_S
);

599 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 = (
CELL_F_S
 *Ë
	`mÆloc
(glb_ds1[ds1_idx].
Êo‹_buff_Àn
);

600 i‡(
glb_ds1
[
ds1_idx
].
Êo‹_buff
 =
NULL
)

602 
	`‰ì
(
ds1_buff
);

603 
	`•rötf
(
tmp
, "notÉnough mem (%i bytes) for floor buffer\n",

604 
glb_ds1
[
ds1_idx
].
Êo‹_buff_Àn
);

605 
	`ds1edô_îr‹
(
tmp
);

607 
	`mem£t
(
glb_ds1
[
ds1_idx
].
Êo‹_buff
, 0, glb_ds1[ds1_idx].
Êo‹_buff_Àn
);

609 
glb_ds1
[
ds1_idx
].
Êo‹_buff2
 = (
CELL_F_S
 *Ë
	`mÆloc
(glb_ds1[ds1_idx].
Êo‹_buff_Àn
);

610 i‡(
glb_ds1
[
ds1_idx
].
Êo‹_buff2
 =
NULL
)

612 
	`‰ì
(
ds1_buff
);

613 
	`•rötf
(
tmp
, "notÉnough mem (%i bytes) for floor 2nd buffer\n",

614 
glb_ds1
[
ds1_idx
].
Êo‹_buff_Àn
);

615 
	`ds1edô_îr‹
(
tmp
);

617 
	`mem£t
(
glb_ds1
[
ds1_idx
].
Êo‹_buff2
, 0, glb_ds1[ds1_idx].
Êo‹_buff_Àn
);

620 
glb_ds1
[
ds1_idx
].
shadow_löe
 = 
√w_width
 * glb_ds1[ds1_idx].
shadow_num
;

621 
glb_ds1
[
ds1_idx
].
shadow_Àn
 = glb_ds1[ds1_idx].
shadow_löe
 * 
√w_height
;

622 
glb_ds1
[
ds1_idx
].
shadow_buff_Àn
 = glb_ds1[ds1_idx].
shadow_Àn
 * (
CELL_S_S
);

623 
glb_ds1
[
ds1_idx
].
shadow_buff
 = (
CELL_S_S
 *Ë
	`mÆloc
(glb_ds1[ds1_idx].
shadow_buff_Àn
);

624 i‡(
glb_ds1
[
ds1_idx
].
shadow_buff
 =
NULL
)

626 
	`‰ì
(
ds1_buff
);

627 
	`•rötf
(
tmp
, "notÉnough mem (%i bytes) for shadow buffer\n",

628 
glb_ds1
[
ds1_idx
].
shadow_buff_Àn
);

629 
	`ds1edô_îr‹
(
tmp
);

631 
	`mem£t
(
glb_ds1
[
ds1_idx
].
shadow_buff
, 0, glb_ds1[ds1_idx].
shadow_buff_Àn
);

633 
glb_ds1
[
ds1_idx
].
shadow_buff2
 = (
CELL_S_S
 *Ë
	`mÆloc
(glb_ds1[ds1_idx].
shadow_buff_Àn
);

634 i‡(
glb_ds1
[
ds1_idx
].
shadow_buff2
 =
NULL
)

636 
	`‰ì
(
ds1_buff
);

637 
	`•rötf
(
tmp
, "notÉnough mem (%i bytes) for shadow 2nd buffer\n",

638 
glb_ds1
[
ds1_idx
].
shadow_buff_Àn
);

639 
	`ds1edô_îr‹
(
tmp
);

641 
	`mem£t
(
glb_ds1
[
ds1_idx
].
shadow_buff2
, 0, glb_ds1[ds1_idx].
shadow_buff_Àn
);

644 
glb_ds1
[
ds1_idx
].
èg_löe
 = 
√w_width
 * glb_ds1[ds1_idx].
èg_num
;

645 
glb_ds1
[
ds1_idx
].
èg_Àn
 = glb_ds1[ds1_idx].
èg_löe
 * 
√w_height
;

646 
glb_ds1
[
ds1_idx
].
èg_buff_Àn
 = glb_ds1[ds1_idx].
èg_Àn
 * (
CELL_T_S
);

647 
glb_ds1
[
ds1_idx
].
èg_buff
 = (
CELL_T_S
 *Ë
	`mÆloc
(glb_ds1[ds1_idx].
èg_buff_Àn
);

648 i‡(
glb_ds1
[
ds1_idx
].
èg_buff
 =
NULL
)

650 
	`‰ì
(
ds1_buff
);

651 
	`•rötf
(
tmp
, "notÉnough mem (%i bytes) forÅag buffer\n",

652 
glb_ds1
[
ds1_idx
].
èg_buff_Àn
);

653 
	`ds1edô_îr‹
(
tmp
);

655 
	`mem£t
(
glb_ds1
[
ds1_idx
].
èg_buff
, 0, glb_ds1[ds1_idx].
èg_buff_Àn
);

657 
glb_ds1
[
ds1_idx
].
èg_buff2
 = (
CELL_T_S
 *Ë
	`mÆloc
(glb_ds1[ds1_idx].
èg_buff_Àn
);

658 i‡(
glb_ds1
[
ds1_idx
].
èg_buff2
 =
NULL
)

660 
	`‰ì
(
ds1_buff
);

661 
	`•rötf
(
tmp
, "notÉnough mem (%i bytes) forÅag 2nd buffer\n",

662 
glb_ds1
[
ds1_idx
].
èg_buff_Àn
);

663 
	`ds1edô_îr‹
(
tmp
);

665 
	`mem£t
(
glb_ds1
[
ds1_idx
].
èg_buff2
, 0, glb_ds1[ds1_idx].
èg_buff_Àn
);

668 
glb_ds1
[
ds1_idx
].
wÆl_löe
 = 
√w_width
 * glb_ds1[ds1_idx].
wÆl_num
;

669 
glb_ds1
[
ds1_idx
].
wÆl_Àn
 = glb_ds1[ds1_idx].
wÆl_löe
 * 
√w_height
;

670 
glb_ds1
[
ds1_idx
].
wÆl_buff_Àn
 = glb_ds1[ds1_idx].
wÆl_Àn
 * (
CELL_W_S
);

671 
glb_ds1
[
ds1_idx
].
wÆl_buff
 = (
CELL_W_S
 *Ë
	`mÆloc
(glb_ds1[ds1_idx].
wÆl_buff_Àn
);

672 i‡(
glb_ds1
[
ds1_idx
].
wÆl_buff
 =
NULL
)

674 
	`‰ì
(
ds1_buff
);

675 
	`•rötf
(
tmp
, "notÉnough mem (%i bytes) for wall buffer\n",

676 
glb_ds1
[
ds1_idx
].
wÆl_buff_Àn
);

677 
	`ds1edô_îr‹
(
tmp
);

679 
	`mem£t
(
glb_ds1
[
ds1_idx
].
wÆl_buff
, 0, glb_ds1[ds1_idx].
wÆl_buff_Àn
);

681 
glb_ds1
[
ds1_idx
].
wÆl_buff2
 = (
CELL_W_S
 *Ë
	`mÆloc
(glb_ds1[ds1_idx].
wÆl_buff_Àn
);

682 i‡(
glb_ds1
[
ds1_idx
].
wÆl_buff2
 =
NULL
)

684 
	`‰ì
(
ds1_buff
);

685 
	`•rötf
(
tmp
, "notÉnough mem (%i bytes) for wall 2nd buffer\n",

686 
glb_ds1
[
ds1_idx
].
wÆl_buff_Àn
);

687 
	`ds1edô_îr‹
(
tmp
);

689 
	`mem£t
(
glb_ds1
[
ds1_idx
].
wÆl_buff2
, 0, glb_ds1[ds1_idx].
wÆl_buff_Àn
);

694 
x
=0; x<
FLOOR_MAX_LAYER
; x++)

695 
f_±r
[
x
] = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + x;

697 
x
=0; x<
SHADOW_MAX_LAYER
; x++)

698 
s_±r
[
x
] = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + x;

700 
x
=0; x<
TAG_MAX_LAYER
; x++)

701 
t_±r
[
x
] = 
glb_ds1
[
ds1_idx
].
èg_buff
 + x;

703 
x
=0; x<
WALL_MAX_LAYER
; x++)

704 
o_±r
[
x
] = 
w_±r
[x] = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + x;

706 
b±r
 = (
UBYTE
 *Ë
±r
;

708 
n
=0;Ç < 
nb_œyî
;Ç++)

710 
y
=0; y < 
glb_ds1
[
ds1_idx
].
height
; y++)

712 
x
=0; x < 
glb_ds1
[
ds1_idx
].
width
; x++)

714 
œy_°ªam
[
n
])

721 i‡((
x
 < 
√w_width
Ë&& (
y
 < 
√w_height
))

723 
p
 = 
œy_°ªam
[
n
] - 1;

724 
w_±r
[
p
]->
¥›1
 = * 
b±r
;

725 
b±r
++;

726 
w_±r
[
p
]->
¥›2
 = * 
b±r
;

727 
b±r
++;

728 
w_±r
[
p
]->
¥›3
 = * 
b±r
;

729 
b±r
++;

730 
w_±r
[
p
]->
¥›4
 = * 
b±r
;

731 
b±r
++;

732 
w_±r
[
p
] +
w_num
;

735 
b±r
 += 4;

743 i‡((
x
 < 
√w_width
Ë&& (
y
 < 
√w_height
))

745 
p
 = 
œy_°ªam
[
n
] - 5;

746 i‡(
glb_ds1
[
ds1_idx
].
vîsi⁄
 < 7)

747 
o_±r
[
p
]->
‹õ¡©i⁄
 = 
dú_lookup
[* 
b±r
];

749 
o_±r
[
p
]->
‹õ¡©i⁄
 = * 
b±r
;

750 
o_±r
[
p
] +
w_num
;

752 
b±r
 += 4;

758 i‡((
x
 < 
√w_width
Ë&& (
y
 < 
√w_height
))

760 
p
 = 
œy_°ªam
[
n
] - 9;

761 
f_±r
[
p
]->
¥›1
 = * 
b±r
;

762 
b±r
++;

763 
f_±r
[
p
]->
¥›2
 = * 
b±r
;

764 
b±r
++;

765 
f_±r
[
p
]->
¥›3
 = * 
b±r
;

766 
b±r
++;

767 
f_±r
[
p
]->
¥›4
 = * 
b±r
;

768 
b±r
++;

769 
f_±r
[
p
] +
f_num
;

772 
b±r
 += 4;

777 i‡((
x
 < 
√w_width
Ë&& (
y
 < 
√w_height
))

779 
p
 = 
œy_°ªam
[
n
] - 11;

780 
s_±r
[
p
]->
¥›1
 = * 
b±r
;

781 
b±r
++;

782 
s_±r
[
p
]->
¥›2
 = * 
b±r
;

783 
b±r
++;

784 
s_±r
[
p
]->
¥›3
 = * 
b±r
;

785 
b±r
++;

786 
s_±r
[
p
]->
¥›4
 = * 
b±r
;

787 
b±r
++;

788 
s_±r
[
p
] +
s_num
;

791 
b±r
 += 4;

796 i‡((
x
 < 
√w_width
Ë&& (
y
 < 
√w_height
))

798 
p
 = 
œy_°ªam
[
n
] - 12;

799 
t_±r
[
p
]->
num
 = (
UDWORD
Ë* ((UDWORD *Ë
b±r
);

800 
t_±r
[
p
] +
t_num
;

802 
b±r
 += 4;

808 
p
 = 
√w_width
 - 
glb_ds1
[
ds1_idx
].
width
;

809 i‡(
p
 > 0)

811 
œy_°ªam
[
n
])

818 
w_±r
[
œy_°ªam
[
n
] - 1] +
p
 * 
w_num
;

826 
o_±r
[
œy_°ªam
[
n
] - 5] +
p
 * 
w_num
;

832 
f_±r
[
œy_°ªam
[
n
] - 9] +
p
 * 
f_num
;

837 
s_±r
[
œy_°ªam
[
n
] - 11] +
p
 * 
s_num
;

842 
t_±r
[
œy_°ªam
[
n
] - 12] +
p
 * 
t_num
;

850 
glb_ds1
[
ds1_idx
].
width
 = 
√w_width
;

851 
glb_ds1
[
ds1_idx
].
height
 = 
√w_height
;

854 
±r
 = (*Ë
b±r
;

856 
glb_ds1
[
ds1_idx
].
obj_num
 = 0;

857 i‡(
glb_ds1
[
ds1_idx
].
vîsi⁄
 >= 2)

859 
glb_ds1
[
ds1_idx
].
obj_num
 = * 
±r
;

860 
±r
++;

862 
	`¥ötf
("obje˘† : %li\n", 
glb_ds1
[
ds1_idx
].
obj_num
);

864 i‡(
glb_ds1
[
ds1_idx
].
obj_num
 > glb_ds1[ds1_idx].
cuºít_obj_max
)

866 
ö¸
 = 1 + 
glb_ds1
[
ds1_idx
].
obj_num
 - glb_ds1[ds1_idx].
cuºít_obj_max
;

867 i‡(
	`misc_ö¸ó£_ds1_obje˘s_max
(
ds1_idx
, 
ö¸
) != 0)

869 
	`‰ì
(
ds1_buff
);

870 
	`•rötf
(
tmp
, "too many objects (%i),Éditor max is <%i>\n",

871 
glb_ds1
[
ds1_idx
].
obj_num
, glb_ds1[ds1_idx].
cuºít_obj_max
);

872 
	`ds1edô_îr‹
(
tmp
);

875 
cuºít_vÆid_obj_idx
 = 0;

876 
max_subtûe_width
 = 
√w_width
 * 5;

877 
max_subtûe_height
 = 
√w_height
 * 5;

878 
n
=0;Ç < 
glb_ds1
[
ds1_idx
].
obj_num
;Ç++)

880 
glb_ds1
[
ds1_idx
].
obj
[
cuºít_vÆid_obj_idx
].
ty≥
 = * 
±r
;

881 
±r
++;

882 
glb_ds1
[
ds1_idx
].
obj
[
cuºít_vÆid_obj_idx
].
id
 = * 
±r
;

883 
±r
++;

884 
x
 = 
glb_ds1
[
ds1_idx
].
obj
[
cuºít_vÆid_obj_idx
].x = * 
±r
;

885 
±r
++;

886 
y
 = 
glb_ds1
[
ds1_idx
].
obj
[
cuºít_vÆid_obj_idx
].y = * 
±r
;

887 
±r
++;

889 i‡(
glb_ds1
[
ds1_idx
].
vîsi⁄
 > 5)

892 
glb_ds1
[
ds1_idx
].
obj
[
cuºít_vÆid_obj_idx
].
ds1_Êags
 = * 
±r
;

893 
±r
++;

897 i‡((
x
 >0Ë&& (x < 
max_subtûe_width
Ë&& (
y
 >0Ë&& (y < 
max_subtûe_height
))

900 
glb_ds1
[
ds1_idx
].
obj
[
cuºít_vÆid_obj_idx
].
∑th_num
 = 0;

901 
glb_ds1
[
ds1_idx
].
obj
[
cuºít_vÆid_obj_idx
].
desc_idx
 = -1;

902 
glb_ds1
[
ds1_idx
].
obj
[
cuºít_vÆid_obj_idx
].
Êags
 = 0;

904 
glb_ds1
[
ds1_idx
].
obj
[
cuºít_vÆid_obj_idx
].
‰ame_dñè
 = 
	`ønd
()%256;

906 
œbñ
 = & 
glb_ds1
[
ds1_idx
].
obj
[
cuºít_vÆid_obj_idx
].label;

907 
œbñ
->
rx
 =Üabñ->
ry
 =Üabñ->
w
 =Üabñ->
h
 =Üabñ->
Êags
 = 0;

909 
	`edôobj_make_obj_desc
(
ds1_idx
, 
cuºít_vÆid_obj_idx
);

910 
cuºít_vÆid_obj_idx
++;

915 
	`mem£t
(

916 & 
glb_ds1
[
ds1_idx
].
obj
[
cuºít_vÆid_obj_idx
],

918 (
glb_ds1
[
ds1_idx
].
obj
[
cuºít_vÆid_obj_idx
])

924 
	`¥ötf
("no objects\n");

927 
glb_ds1
[
ds1_idx
].
obj_num
 = 
cuºít_vÆid_obj_idx
;

936 i‡–(
glb_ds1
[
ds1_idx
].
vîsi⁄
 >= 12) &&

937 ((
glb_ds1
[
ds1_idx
].
èg_ty≥
 == 1) || (glb_ds1[ds1_idx].tag_type == 2))

941 i‡(
glb_ds1
[
ds1_idx
].
vîsi⁄
 >= 18)

942 
±r
++;

944 
glb_ds1
[
ds1_idx
].
group_num
 = 
n
 = * 
±r
;

945 
±r
++;

947 
	`¥ötf
("group† : %li\n", 
n
);

950 
glb_ds1
[
ds1_idx
].
group_size
 = 
size
 = 
n
 * (
GROUP_S
);

951 
glb_ds1
[
ds1_idx
].
group
 = (
GROUP_S
 *Ë
	`mÆloc
(
size
);

952 i‡(
glb_ds1
[
ds1_idx
].
group
 =
NULL
)

954 
	`‰ì
(
ds1_buff
);

955 
	`•rötf
(
tmp
, "nŸÉnough mem (%òbyãsËf‹ groups\n", 
size
);

956 
	`ds1edô_îr‹
(
tmp
);

958 
	`mem£t
(
glb_ds1
[
ds1_idx
].
group
, 0, 
size
);

961 
x
=0; x<
n
; x++)

963 i‡((
UDWORD
Ë
±r
 < (((UDWORDË
ds1_buff
Ë+ 
ds1_Àn
))

964 
glb_ds1
[
ds1_idx
].
group
[
x
].
tûe_x
 = * 
±r
;

965 
±r
++;

966 i‡((
UDWORD
Ë
±r
 < (((UDWORDË
ds1_buff
Ë+ 
ds1_Àn
))

967 
glb_ds1
[
ds1_idx
].
group
[
x
].
tûe_y
 = * 
±r
;

968 
±r
++;

969 i‡((
UDWORD
Ë
±r
 < (((UDWORDË
ds1_buff
Ë+ 
ds1_Àn
))

970 
glb_ds1
[
ds1_idx
].
group
[
x
].
width
 = * 
±r
;

971 
±r
++;

972 i‡((
UDWORD
Ë
±r
 < (((UDWORDË
ds1_buff
Ë+ 
ds1_Àn
))

973 
glb_ds1
[
ds1_idx
].
group
[
x
].
height
 = * 
±r
;

974 
±r
++;

975 i‡(
glb_ds1
[
ds1_idx
].
vîsi⁄
 >= 13)

977 i‡((
UDWORD
Ë
±r
 < (((UDWORDË
ds1_buff
Ë+ 
ds1_Àn
))

978 
glb_ds1
[
ds1_idx
].
group
[
x
].
unk
 = * 
±r
;

979 
±r
++;

984 
	`¥ötf
("no groups\n");

987 i‡(
glb_ds1
[
ds1_idx
].
vîsi⁄
 >= 14)

989 i‡((
UDWORD
Ë
±r
 < (((UDWORDË
ds1_buff
Ë+ 
ds1_Àn
))

990 
≈c
 = * 
±r
;

992 
≈c
 = 0;

993 
±r
++;

994 
	`¥ötf
("≈¯∑th† : %li\n", 
≈c
);

995 
n
=0;Ç<
≈c
;Ç++)

997 
∑th
 = * 
±r
;

998 
±r
++;

999 
x
 = * 
±r
;

1000 
±r
++;

1001 
y
 = * 
±r
;

1002 
±r
++;

1005 
o
 = 
œ°_o
 = 
nb
 = 0;

1006 
d⁄e
 = 
FALSE
;

1007 ! 
d⁄e
)

1009 i‡(
o
 < 
glb_ds1
[
ds1_idx
].
obj_num
)

1011 i‡((
glb_ds1
[
ds1_idx
].
obj
[
o
].
x
 =xË&& (glb_ds1[ds1_idx].obj[o].
y
 == y))

1013 
œ°_o
 = 
o
;

1014 
nb
++;

1015 i‡(
nb
 >= 2)

1016 
d⁄e
 = 
TRUE
;

1018 
o
++;

1021 
d⁄e
 = 
TRUE
;

1024 i‡(
nb
 >= 2)

1029 i‡(
obj_∑th_w¨n_wrŸe
 !
TRUE
)

1031 
obj_∑th_w¨n_wrŸe
 = 
TRUE
;

1032 
	`¥ötf
("\n"

1036 
	`¥ötf
(" * Removing %iÖathsÖoints of 1 objectát coordinates (%i, %i)\n",

1037 
∑th
, 
x
, 
y
);

1038 
	`fÊush
(
°dout
);

1041 
o
=0; o < 
glb_ds1
[
ds1_idx
].
obj_num
; o++)

1043 i‡((
glb_ds1
[
ds1_idx
].
obj
[
o
].
x
 =xË&& (glb_ds1[ds1_idx].obj[o].
y
 == y) &&

1044 (
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th_num
 != 0))

1046 
p
=0;Ö < 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th_num
;Ö++)

1048 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[
p
].
x
 = 0;

1049 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[
p
].
y
 = 0;

1050 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[
p
].
a˘i⁄
 = 0;

1051 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[
p
].
Êags
 = 0;

1053 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th_num
 = 0;

1058 i‡(
glb_ds1
[
ds1_idx
].
vîsi⁄
 >= 15)

1060 
p
=0;Ö < 
∑th
;Ö++)

1061 
±r
 += 3;

1065 
p
=0;Ö < 
∑th
;Ö++)

1066 
±r
 += 2;

1072 
o
 = 
œ°_o
;

1075 i‡(
o
 >
glb_ds1
[
ds1_idx
].
obj_num
)

1080 i‡(
glb_ds1
[
ds1_idx
].
vîsi⁄
 >= 15)

1082 
p
=0;Ö < 
∑th
;Ö++)

1083 
±r
 += 3;

1087 
p
=0;Ö < 
∑th
;Ö++)

1088 
±r
 += 2;

1095 i‡(
∑th
 > 
WINDS1EDIT_PATH_MAX
)

1097 
	`‰ì
(
ds1_buff
);

1098 
	`•rötf
(
tmp
, "object %li haveÅoo muchÖaths (%i),Éditor max is %i\n",

1099 
o
, 
∑th
, 
WINDS1EDIT_PATH_MAX
);

1100 
	`ds1edô_îr‹
(
tmp
);

1104 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th_num
 = 
∑th
;

1105 
p
=0;Ö < 
∑th
;Ö++)

1107 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[
p
].
x
 = * 
±r
;

1108 
±r
++;

1109 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[
p
].
y
 = * 
±r
;

1110 
±r
++;

1111 i‡(
glb_ds1
[
ds1_idx
].
vîsi⁄
 >= 15)

1113 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[
p
].
a˘i⁄
 = * 
±r
;

1114 
±r
++;

1117 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[
p
].
a˘i⁄
 = 1;

1122 
	`edôobj_make_obj_œbñ
(
ds1_idx
);

1125 
	`¥ötf
("noÇpcÖaths\n");

1128 
	`edôobj_£t_døwög_‹dî
(
ds1_idx
);

1131 
glb_ds1
[
ds1_idx
].
cur_zoom
 = 
ZM_11
;

1132 
glb_ds1
[
ds1_idx
].
tûe_w
 = 160;

1133 
glb_ds1
[
ds1_idx
].
tûe_h
 = 80;

1134 
glb_ds1
[
ds1_idx
].
height_mul
 = 1;

1135 
glb_ds1
[
ds1_idx
].
height_div
 = 1;

1136 
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
keyb
.
x
 = 
glb_c⁄fig
.
s¸ﬁl
.keyb.x;

1137 
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
keyb
.
y
 = 
glb_c⁄fig
.
s¸ﬁl
.keyb.y;

1138 
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
mou£
.
x
 = 
glb_c⁄fig
.
s¸ﬁl
.mouse.x;

1139 
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
mou£
.
y
 = 
glb_c⁄fig
.
s¸ﬁl
.mouse.y;

1142 
cx
 = 
glb_ds1
[
ds1_idx
].
width
/2 + 1;

1143 
cy
 = 
glb_ds1
[
ds1_idx
].
height
/2;

1144 
dx
 = (
cy
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2Ë+ (
cx
 * glb_ds1[ds1_idx].tile_w / 2);

1145 
dy
 = (
cy
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2Ë+ (
cx
 * glb_ds1[ds1_idx].tile_h / 2);

1147 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
x0
 = 
dx
 - 
glb_c⁄fig
.
s¸ìn
.
width
 / 2;

1148 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
y0
 = 
dy
 - 
glb_c⁄fig
.
s¸ìn
.
height
 / 2;

1149 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
w
 = 
glb_c⁄fig
.
s¸ìn
.
width
;

1150 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
h
 = 
glb_c⁄fig
.
s¸ìn
.
height
;

1152 
	`ch™ge_zoom
(
ds1_idx
, 
ZM_14
);

1155 
˝å
 = 
glb_ds1
[
ds1_idx
].
fûe_buff
;

1156 
tûe_x
 = 
tûe_y
 = 
zoom
 = -1;

1159 i‡(
glb_c⁄fig
.
w‹k•a˚_íabÀ
)

1163 
x
=0; x<
glb_ds1
[
ds1_idx
].
fûe_num
; x++)

1166 
y
=0; y < 
WRKSPC_MAX
; y++)

1171 
o
 = 0;

1172  (
˝å
[
o
] != 0x00) &&

1173 (
glb_wrk•c_d©as
[
y
].
id
[
o
] != 0x00) &&

1174 (
˝å
[
o
] =
glb_wrk•c_d©as
[
y
].
id
[o])

1178 
o
++;

1180 i‡((
glb_wrk•c_d©as
[
y
].
id
[
o
] =0x00Ë&& (
˝å
[o]== '='))

1183 
o
++;

1184 i‡(
˝å
[
o
] != 0x00)

1186 
y
)

1188 
WRKSPC_TILE_X
:

1189 
	`ssˇnf
(
˝å
 + 
o
, "%li", & 
tûe_x
);

1192 
WRKSPC_TILE_Y
:

1193 
	`ssˇnf
(
˝å
 + 
o
, "%li", & 
tûe_y
);

1196 
WRKSPC_ZOOM
:

1197 
	`ssˇnf
(
˝å
 + 
o
, "%li", & 
zoom
);

1200 
WRKSPC_VERSION
:

1204 
WRKSPC_SAVE_COUNT
:

1205 
	`ssˇnf
(
˝å
 + 
o
, "%lu", & 
glb_ds1
[
ds1_idx
].
ßve_cou¡
);

1213 
˝å
 +(
	`°æí
(cptr) + 1);

1217 i‡(
zoom
 != -1)

1219 
	`ch™ge_zoom
(
ds1_idx
, 
zoom
);

1221 i‡((
tûe_x
 !-1Ë&& (
tûe_y
 != -1))

1223 i‡(
tûe_x
 < 0)

1224 
tûe_x
 = 0;

1225 i‡(
tûe_x
 >
glb_ds1
[
ds1_idx
].
width
)

1226 
tûe_x
 = 
glb_ds1
[
ds1_idx
].
width
 - 1;

1227 i‡(
tûe_y
 < 0)

1228 
tûe_y
 = 0;

1229 i‡(
tûe_y
 >
glb_ds1
[
ds1_idx
].
height
)

1230 
tûe_y
 = 
glb_ds1
[
ds1_idx
].
height
 - 1;

1232 
tûe_x
++;

1233 
dx
 = (
tûe_y
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2Ë+ (
tûe_x
 * glb_ds1[ds1_idx].tile_w / 2);

1234 
dy
 = (
tûe_y
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2Ë+ (
tûe_x
 * glb_ds1[ds1_idx].tile_h / 2);

1235 
tûe_x
--;

1237 i‡(
ds1_idx
 == 0)

1239 
glb_ds1edô
.
wö_¥evõw
.
x0
 = 
dx
 - glb_ds1edô.wö_¥evõw.
w
 / 2;

1240 
glb_ds1edô
.
wö_¥evõw
.
y0
 = 
dy
 - glb_ds1edô.wö_¥evõw.
h
 / 2;

1242 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
x0
 = 
dx
 - 
glb_ds1edô
.
wö_¥evõw
.
w
 / 2;

1243 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
y0
 = 
dy
 - 
glb_ds1edô
.
wö_¥evõw
.
h
 / 2;

1244 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
w
 = 
glb_ds1edô
.
wö_¥evõw
.w;

1245 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
h
 = 
glb_ds1edô
.
wö_¥evõw
.h;

1250 
	`‰ì
(
ds1_buff
);

1251 
	`°∫˝y
(
glb_ds1
[
ds1_idx
].
undo
.
èg
, "UNDO", (glb_ds1[ds1_idx].undo.tag));

1252 
glb_ds1
[
ds1_idx
].
undo
.
cur_buf_num
 = -1;

1253 
glb_ds1
[
ds1_idx
].
∑th_edô_wö
.
obj_idx
 = -1;

1256 
	}
}

	@ds1misc.h

1 #i‚de‡
_DS1MISC_H_


3 
	#_DS1MISC_H_


	)

5 
ds1_‰ì
 (
i
);

6 
w¥›_2_block
 (
i
, 
CELL_W_S
 * 
w_±r
);

7 
Âr›_2_block
 (
i
, 
CELL_F_S
 * 
f_±r
);

8 
•r›_2_block
 (
i
, 
CELL_S_S
 * 
s_±r
);

9 
ds1_make_¥›_2_block
 (
i
);

10 
ds1_ªad
 (c⁄° * 
ds1«me
, 
ds1_idx
, 
√w_width
, 
√w_height
);

	@ds1save.c

1 
	~"°ru˘s.h
"

2 
	~"îr‹.h
"

3 
	~"ds1ßve.h
"

4 
	~"wPªvõw.h
"

10 
	$ds1_ßve
(
ds1_idx
, 
is_tmp_fûe
)

12 
CELL_W_S
 * 
w_±r
;

13 
CELL_S_S
 * 
s_±r
;

14 
CELL_F_S
 * 
f_±r
;

15 
CELL_T_S
 * 
t_±r
;

16 
i
=0, 
x
, 
y
, 
t
, 
cur_o
=0, 
p
, 
u£d
, 
Êí
;

17 
FILE
 * 
out
;

18 
n
, 
≈c
 = 0, 
fûe_cou¡
,

19 
ßve_wÆl_num
, 
ßve_Êo‹_num
;

20 
tmp
[512], 
tmp_«me
[256], * 
˝å
;

21 
ax
, 
ay
, 
cx
, 
cy
, 
is_d©a
;

25 i‡(
	`°æí
(
glb_ds1
[
ds1_idx
].
«me
) == 0)

29 
	`°r˝y
(
tmp
, 
glb_ds1
[
ds1_idx
].
«me
);

30 i‡(
	`°æí
(
tmp
) < 4)

32 
	`•rötf
(
tmp
, "ds1save(), glb_ds1[%i].ds1_name < 4 chars : \"%s\" (is_tmp_file = %i)",

33 
ds1_idx
, 
glb_ds1
[ds1_idx].
«me
, 
is_tmp_fûe
);

34 
	`ds1edô_îr‹
(
tmp
);

38 
tmp
[
	`°æí
(tmp)-4] = 0;

39 i‡(
is_tmp_fûe
)

42 
	`•rötf
(
tmp_«me
, "%s.tmp", 
tmp
);

43 i‡(
	`fûe_exi°s
(
tmp_«me
, -1, 
NULL
))

44 
	`ªmove
(
tmp_«me
);

52 
	`•rötf
(
tmp_«me
, "%s-%03i.ds1", 
tmp
, 
i
);

53 
	`fûe_exi°s
(
tmp_«me
, -1, 
NULL
))

55 
i
++;

56 
	`•rötf
(
tmp_«me
, "%s-%03i.ds1", 
tmp
, 
i
);

60 i‡(
	`ª«me
(
glb_ds1
[
ds1_idx
].
«me
, 
tmp_«me
))

62 
	`•rötf
(
tmp
, "ds1save(), couldn'tÑename %sÅo %s",

63 
glb_ds1
[
ds1_idx
].
«me
, 
tmp_«me
);

64 
	`ds1edô_îr‹
(
tmp
);

68 
	`°r˝y
(
tmp_«me
, 
glb_ds1
[
ds1_idx
].
«me
);

72 
out
 = 
	`f›í
(
tmp_«me
, "wb");

73 i‡(
out
 =
NULL
)

75 
	`•rötf
(
tmp
, "ds1ßve(), c™'àwrôê%s", 
tmp_«me
);

76 
	`ds1edô_îr‹
(
tmp
);

80 
n
 = 18;

81 
	`fwrôe
(& 
n
, 4, 1, 
out
);

84 
n
 = 
glb_ds1
[
ds1_idx
].
width
 - 1;

85 
	`fwrôe
(& 
n
, 4, 1, 
out
);

88 
n
 = 
glb_ds1
[
ds1_idx
].
height
 - 1;

89 
	`fwrôe
(& 
n
, 4, 1, 
out
);

92 
n
 = 
glb_ds1
[
ds1_idx
].
a˘
 - 1;

93 
	`fwrôe
(& 
n
, 4, 1, 
out
);

96 
	`fwrôe
(& 
glb_ds1
[
ds1_idx
].
èg_ty≥
, 4, 1, 
out
);

101 
fûe_cou¡
 = 0;

102 
˝å
 = 
glb_ds1
[
ds1_idx
].
fûe_buff
;

103 
i
=0; i < 
glb_ds1
[
ds1_idx
].
fûe_num
; i++)

105 
Êí
 = 
	`°æí
(
˝å
) + 1;

106 
is_d©a
 = 
FALSE
;

108 
y
=0; y < 
WRKSPC_MAX
; y++)

113 
x
 = 0;

114  (
˝å
[
x
] != 0x00) &&

115 (
glb_wrk•c_d©as
[
y
].
id
[
x
] != 0x00) &&

116 (
˝å
[
x
] =
glb_wrk•c_d©as
[
y
].
id
[x])

120 
x
++;

122 i‡((
glb_wrk•c_d©as
[
y
].
id
[
x
] =0x00Ë&& (
˝å
[x]== '='))

125 
is_d©a
 = 
TRUE
;

129 i‡(
is_d©a
 =
FALSE
)

130 
fûe_cou¡
++;

132 
˝å
 +
Êí
;

134 i‡(
glb_c⁄fig
.
w‹k•a˚_íabÀ
)

135 
fûe_cou¡
 +
WRKSPC_MAX
;

136 
	`fwrôe
(& 
fûe_cou¡
, 4, 1, 
out
);

139 
˝å
 = 
glb_ds1
[
ds1_idx
].
fûe_buff
;

140 
i
=0; i < 
glb_ds1
[
ds1_idx
].
fûe_num
; i++)

142 
Êí
 = 
	`°æí
(
˝å
) + 1;

143 
is_d©a
 = 
FALSE
;

145 
y
=0; y < 
WRKSPC_MAX
; y++)

150 
x
 = 0;

151  (
˝å
[
x
] != 0x00) &&

152 (
glb_wrk•c_d©as
[
y
].
id
[
x
] != 0x00) &&

153 (
˝å
[
x
] =
glb_wrk•c_d©as
[
y
].
id
[x])

157 
x
++;

159 i‡((
glb_wrk•c_d©as
[
y
].
id
[
x
] =0x00Ë&& (
˝å
[x]== '='))

162 
is_d©a
 = 
TRUE
;

166 i‡(
is_d©a
 =
FALSE
)

167 
	`fwrôe
(
˝å
, 
Êí
, 1, 
out
);

170 
˝å
 +
Êí
;

173 i‡(
glb_c⁄fig
.
w‹k•a˚_íabÀ
)

176 
ax
 = 
glb_ds1edô
.
wö_¥evõw
.
x0
 + glb_ds1edô.wö_¥evõw.
w
 / 2;

177 
ay
 = 
glb_ds1edô
.
wö_¥evõw
.
y0
 + glb_ds1edô.wö_¥evõw.
h
 / 2;

178 
	`co‹d_to_tûe
(
ds1_idx
, 
ax
, 
ay
, & 
cx
, & 
cy
);

179 i‡–(
glb_ds1edô
.
mode
 =
MOD_O
) ||

180 (
glb_ds1edô
.
mode
 =
MOD_P
) ||

181 (
glb_ds1edô
.
mode
 =
MOD_L
) )

183 
cx
 /= 5;

184 
cy
 /= 5;

186 
i
=0; i < 
WRKSPC_MAX
; i++)

188 
i
)

190 
WRKSPC_TILE_X
 :

191 
	`•rötf
(
tmp
, "%s=%i", 
glb_wrk•c_d©as
[
i
].
id
, 
cx
);

192 
	`fwrôe
(
tmp
, 
	`°æí
—mpË+ 1, 1, 
out
);

195 
WRKSPC_TILE_Y
 :

196 
	`•rötf
(
tmp
, "%s=%i", 
glb_wrk•c_d©as
[
i
].
id
, 
cy
);

197 
	`fwrôe
(
tmp
, 
	`°æí
—mpË+ 1, 1, 
out
);

200 
WRKSPC_ZOOM
 :

201 
	`•rötf
(
tmp
, "%s=%i", 
glb_wrk•c_d©as
[
i
].
id
, 
glb_ds1
[
ds1_idx
].
cur_zoom
);

202 
	`fwrôe
(
tmp
, 
	`°æí
—mpË+ 1, 1, 
out
);

205 
WRKSPC_VERSION
 :

206 
	`•rötf
(
tmp
, "%s=Build YYYY/MM/DD %s, %s",

207 
glb_wrk•c_d©as
[
i
].
id
,

208 
glb_ds1edô
.
vîsi⁄_buûd
,

209 
glb_ds1edô
.
vîsi⁄_dŒ


211 
	`fwrôe
(
tmp
, 
	`°æí
—mpË+ 1, 1, 
out
);

214 
WRKSPC_SAVE_COUNT
 :

215 
glb_ds1
[
ds1_idx
].
ßve_cou¡
++;

216 
	`•rötf
(
tmp
, "%s=%lu", 
glb_wrk•c_d©as
[
i
].
id
, 
glb_ds1
[
ds1_idx
].
ßve_cou¡
);

217 
	`fwrôe
(
tmp
, 
	`°æí
—mpË+ 1, 1, 
out
);

224 
ßve_wÆl_num
 = 
glb_ds1
[
ds1_idx
].
wÆl_num
;

225 
ßve_Êo‹_num
 = 
glb_ds1
[
ds1_idx
].
Êo‹_num
;

226 i‡(
glb_c⁄fig
.
möimize_ds1
 =
TRUE
)

230 
i
 = 
ßve_wÆl_num
 - 1; i >= 1; i--)

232 
u£d
 = 
FALSE
;

234 
y
=0; y < 
glb_ds1
[
ds1_idx
].
height
; y++)

236 
x
=0; x < 
glb_ds1
[
ds1_idx
].
width
; x++)

238 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

239 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
t
 + 
i
;

240 i‡((
w_±r
->
¥›1
 | w_±r->
¥›2
 | w_±r->
¥›3
 | w_±r->
¥›4
 |

241 
w_±r
->
‹õ¡©i⁄
) != 0)

243 
u£d
 = 
TRUE
;

247 i‡(
u£d
)

250 i‡(
u£d
)

253 
ßve_wÆl_num
--;

258 
i
 = 
ßve_Êo‹_num
 - 1; i >= 1; i--)

260 
u£d
 = 
FALSE
;

262 
y
=0; y < 
glb_ds1
[
ds1_idx
].
height
; y++)

264 
x
=0; x < 
glb_ds1
[
ds1_idx
].
width
; x++)

266 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

267 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
t
 + 
i
;

268 i‡((
f_±r
->
¥›1
 | f_±r->
¥›2
 | f_±r->
¥›3
 | f_±r->
¥›4
) != 0)

270 
u£d
 = 
TRUE
;

274 i‡(
u£d
)

277 i‡(
u£d
)

280 
ßve_Êo‹_num
--;

286 
	`fwrôe
(& 
ßve_wÆl_num
, 4, 1, 
out
);

289 
	`fwrôe
(& 
ßve_Êo‹_num
, 4, 1, 
out
);

292 
i
=0; i < 
ßve_wÆl_num
; i++)

295 
y
=0; y < 
glb_ds1
[
ds1_idx
].
height
; y++)

297 
x
=0; x < 
glb_ds1
[
ds1_idx
].
width
; x++)

299 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

300 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
t
 + 
i
;

301 
	`Âutc
(
w_±r
->
¥›1
, 
out
);

302 
	`Âutc
(
w_±r
->
¥›2
, 
out
);

303 
	`Âutc
(
w_±r
->
¥›3
, 
out
);

304 
	`Âutc
(
w_±r
->
¥›4
, 
out
);

309 
y
=0; y < 
glb_ds1
[
ds1_idx
].
height
; y++)

311 
x
=0; x < 
glb_ds1
[
ds1_idx
].
width
; x++)

313 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

314 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
t
 + 
i
;

315 
	`Âutc
(
w_±r
->
‹õ¡©i⁄
, 
out
);

316 
	`Âutc
(0, 
out
);

317 
	`Âutc
(0, 
out
);

318 
	`Âutc
(0, 
out
);

324 
i
=0; i < 
ßve_Êo‹_num
; i++)

327 
y
=0; y < 
glb_ds1
[
ds1_idx
].
height
; y++)

329 
x
=0; x < 
glb_ds1
[
ds1_idx
].
width
; x++)

331 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

332 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
t
 + 
i
;

333 
	`Âutc
(
f_±r
->
¥›1
, 
out
);

334 
	`Âutc
(
f_±r
->
¥›2
, 
out
);

335 
	`Âutc
(
f_±r
->
¥›3
, 
out
);

336 
	`Âutc
(
f_±r
->
¥›4
, 
out
);

342 
i
=0; i < 
glb_ds1
[
ds1_idx
].
shadow_num
; i++)

345 
y
=0; y < 
glb_ds1
[
ds1_idx
].
height
; y++)

347 
x
=0; x < 
glb_ds1
[
ds1_idx
].
width
; x++)

349 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

350 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
t
 + 
i
;

351 
	`Âutc
(
s_±r
->
¥›1
, 
out
);

352 
	`Âutc
(
s_±r
->
¥›2
, 
out
);

353 
	`Âutc
(
s_±r
->
¥›3
, 
out
);

354 
	`Âutc
(
s_±r
->
¥›4
, 
out
);

360 i‡(
glb_ds1
[
ds1_idx
].
èg_ty≥
)

362 
i
=0; i<
glb_ds1
[
ds1_idx
].
èg_num
; i++)

365 
y
=0; y < 
glb_ds1
[
ds1_idx
].
height
; y++)

367 
x
=0; x < 
glb_ds1
[
ds1_idx
].
width
; x++)

369 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
èg_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
èg_num
);

370 
t_±r
 = 
glb_ds1
[
ds1_idx
].
èg_buff
 + 
t
 + 
i
;

371 
	`fwrôe
–& 
t_±r
->
num
, 4, 1, 
out
);

378 
	`fwrôe
(&
glb_ds1
[
ds1_idx
].
obj_num
, 4, 1, 
out
);

379 
i
=0; i < 
glb_ds1
[
ds1_idx
].
obj_num
; i++)

381 
	`fwrôe
(&
glb_ds1
[
ds1_idx
].
obj
[
i
].
ty≥
, 4, 1, 
out
);

382 
	`fwrôe
(&
glb_ds1
[
ds1_idx
].
obj
[
i
].
id
, 4, 1, 
out
);

383 
	`fwrôe
(&
glb_ds1
[
ds1_idx
].
obj
[
i
].
x
, 4, 1, 
out
);

384 
	`fwrôe
(&
glb_ds1
[
ds1_idx
].
obj
[
i
].
y
, 4, 1, 
out
);

385 
	`fwrôe
(&
glb_ds1
[
ds1_idx
].
obj
[
i
].
ds1_Êags
, 4, 1, 
out
);

386 i‡(
glb_ds1
[
ds1_idx
].
obj
[
i
].
∑th_num
)

387 
≈c
++;

391 i‡(
glb_ds1
[
ds1_idx
].
èg_ty≥
)

394 
n
 = 0;

395 
	`fwrôe
(&
n
, 4, 1, 
out
);

398 
	`fwrôe
(&
glb_ds1
[
ds1_idx
].
group_num
, 4, 1, 
out
);

401 
i
=0; i < 
glb_ds1
[
ds1_idx
].
group_num
; i++)

403 
	`fwrôe
(&
glb_ds1
[
ds1_idx
].
group
[
i
].
tûe_x
, 4, 1, 
out
);

404 
	`fwrôe
(&
glb_ds1
[
ds1_idx
].
group
[
i
].
tûe_y
, 4, 1, 
out
);

405 
	`fwrôe
(&
glb_ds1
[
ds1_idx
].
group
[
i
].
width
, 4, 1, 
out
);

406 
	`fwrôe
(&
glb_ds1
[
ds1_idx
].
group
[
i
].
height
, 4, 1, 
out
);

407 
	`fwrôe
(&
glb_ds1
[
ds1_idx
].
group
[
i
].
unk
, 4, 1, 
out
);

412 
	`fwrôe
(&
≈c
, 4, 1, 
out
);

413 
i
=0; i < 
≈c
; i++)

415  ! 
glb_ds1
[
ds1_idx
].
obj
[
cur_o
].
∑th_num
)

416 
cur_o
++;

417 
	`fwrôe
(&
glb_ds1
[
ds1_idx
].
obj
[
cur_o
].
∑th_num
, 4, 1, 
out
);

418 
	`fwrôe
(&
glb_ds1
[
ds1_idx
].
obj
[
cur_o
].
x
, 4, 1, 
out
);

419 
	`fwrôe
(&
glb_ds1
[
ds1_idx
].
obj
[
cur_o
].
y
, 4, 1, 
out
);

420 
p
=0;Ö < 
glb_ds1
[
ds1_idx
].
obj
[
cur_o
].
∑th_num
;Ö++)

422 
	`fwrôe
(&
glb_ds1
[
ds1_idx
].
obj
[
cur_o
].
∑th
[
p
].
x
, 4, 1, 
out
);

423 
	`fwrôe
(&
glb_ds1
[
ds1_idx
].
obj
[
cur_o
].
∑th
[
p
].
y
, 4, 1, 
out
);

424 
	`fwrôe
(&
glb_ds1
[
ds1_idx
].
obj
[
cur_o
].
∑th
[
p
].
a˘i⁄
, 4, 1, 
out
);

426 
cur_o
++;

430 
	`f˛o£
(
out
);

431 
	}
}

	@ds1save.h

1 #i‚de‡
_DS1SAVE_H_


3 
	#_DS1SAVE_H_


	)

5 
ds1_ßve
(
ds1_idx
, 
is_tmp_fûe
);

	@dt1_draw.c

1 
	~"°ru˘s.h
"

2 
	~"dt1_døw.h
"

7 
	$døw_sub_tûe_isomëric
 (
BITMAP
 * 
d°
, 
x0
, 
y0
, 
UBYTE
 * 
d©a
, 
Àngth
)

9 
UBYTE
 * 
±r
 = 
d©a
;

10 
x
, 
y
=0, 
n
,

11 
xjump
[15] = {14, 12, 10, 8, 6, 4, 2, 0, 2, 4, 6, 8, 10, 12, 14},

12 
nbpix
[15] = {4, 8, 12, 16, 20, 24, 28, 32, 28, 24, 20, 16, 12, 8, 4};

15 i‡(
Àngth
 != 256)

19 
Àngth
 > 0)

21 
x
 = 
xjump
[
y
];

22 
n
 = 
nbpix
[
y
];

23 
Àngth
 -
n
;

24 
n
)

26 
	`puçixñ
(
d°
, 
x0
+
x
, 
y0
+
y
, * 
±r
);

27 
±r
++;

28 
x
++;

29 
n
--;

31 
y
++;

33 
	}
}

38 
	$døw_sub_tûe_n‹mÆ
 (
BITMAP
 * 
d°
, 
x0
, 
y0
, 
UBYTE
 * 
d©a
,

39 
Àngth
)

41 
UBYTE
 * 
±r
 = 
d©a
, 
b1
, 
b2
;

42 
x
=0, 
y
=0;

45 
Àngth
 > 0)

47 
b1
 = * 
±r
;

48 
b2
 = * (
±r
 + 1);

49 
±r
 += 2;

50 
Àngth
 -= 2;

51 i‡(
b1
 || 
b2
)

53 
x
 +
b1
;

54 
Àngth
 -
b2
;

55 
b2
)

57 
	`puçixñ
(
d°
, 
x0
+
x
, 
y0
+
y
, * 
±r
);

58 
±r
++;

59 
x
++;

60 
b2
--;

65 
x
 = 0;

66 
y
++;

69 
	}
}

	@dt1_draw.h

1 #i‚de‡
_DT1_DRAW_H_


3 
	#_DT1_DRAW_H_


	)

5 
døw_sub_tûe_isomëric
 (
BITMAP
 * 
d°
, 
x0
, 
y0
, 
UBYTE
 * 
d©a
, 
Àngth
);

6 
døw_sub_tûe_n‹mÆ
 (
BITMAP
 * 
d°
, 
x0
, 
y0
, 
UBYTE
 * 
d©a
, 
Àngth
);

	@dt1misc.c

1 
	~<°rög.h
>

2 
	~"°ru˘s.h
"

3 
	~"îr‹.h
"

4 
	~"dt1_døw.h
"

5 
	~"misc.h
"

6 
	~"mpq/MpqVõw.h
"

7 
	~"dt1misc.h
"

12 
	$dt1_Æªady_lﬂded
(* 
dt1«me
, * 
idx
)

14 
i
;

16 
i
=0; i<
DT1_MAX
; i++)

18 i‡(
	`°ricmp
(
glb_dt1
[
i
].
«me
, 
dt1«me
) == 0)

20 * 
idx
 = 
i
;

21  
TRUE
;

24 * 
idx
 = -1;

25  
FALSE
;

26 
	}
}

31 
	$dt1_‰ì
(
i
)

33 
BITMAP
 * 
bmp_±r
;

34 
size
 = 
glb_dt1
[
i
].
buff_Àn
 + glb_dt1[i].
bh_buff_Àn
;

35 
z
, 
b
;

38 i‡(
	`°æí
(
glb_dt1
[
i
].
«me
) == 0)

41 
	`Ârötf
(
°dîr
, " . %s\n", 
glb_dt1
[
i
].
«me
);

42 
	`fÊush
(
°dîr
);

45 
z
=0; z<
ZM_MAX
; z++)

47 i‡(
glb_dt1
[
i
].
block_zoom
[
z
] !
NULL
)

49 
b
=0; b < 
glb_dt1
[
i
].
block_num
; b++)

51 
bmp_±r
 = * (
glb_dt1
[
i
].
block_zoom
[
z
] + 
b
);

52 i‡(
bmp_±r
 !
NULL
)

54 
size
 +
bmp_±r
->
w
 * bmp_±r->
h
 + (
BITMAP
);

55 
	`de°roy_bôm≠
(
bmp_±r
);

58 
size
 +
glb_dt1
[
i
].
bz_size
[
z
];

59 
	`‰ì
(
glb_dt1
[
i
].
block_zoom
[
z
]);

64 i‡(
glb_dt1
[
i
].
bh_buf„r
 !
NULL
)

66 
	`‰ì
(
glb_dt1
[
i
].
bh_buf„r
);

70 i‡(
glb_dt1
[
i
].
buf„r
 !
NULL
)

72 
	`‰ì
(
glb_dt1
[
i
].
buf„r
);

76 
	`mem£t
(& 
glb_dt1
[
i
], 0, (
DT1_S
));

77  
size
;

78 
	}
}

85 
	$dt1_dñ
(
i
)

87 i‡–(
i
 < 0Ë|| (ò>
DT1_MAX
))

90 i‡(
glb_dt1
[
i
].
ds1_ußge
 <= 0)

93 
glb_dt1
[
i
].
ds1_ußge
--;

94 i‡(
glb_dt1
[
i
].
ds1_ußge
 == 0)

95 
	`dt1_‰ì
(
i
);

97 
	}
}

102 
	$dt1_bh_upd©e
(
i
)

104 
BLOCK_S
 * 
bh_±r
 = 
glb_dt1
[
i
].
bh_buf„r
;

105 
UBYTE
 * 
±r
;

106 
b
, 
t
, 
idxèbÀ
[25] = {20, 21, 22, 23, 24,

112 
±r
 = (
UBYTE
 *Ë
glb_dt1
[
i
].
buf„r
 + glb_dt1[i].
bh_°¨t
;

113 
b
=0; b < 
glb_dt1
[
i
].
block_num
; b++)

115 
bh_±r
->
dúe˘i⁄
 = * (*Ë
±r
;

116 
bh_±r
->
roof_y
 = * (
WORD
 *Ë(
±r
 + 4);

117 
bh_±r
->
sound
 = * (
UBYTE
 *Ë(
±r
 + 6);

118 
bh_±r
->
™im©ed
 = * (
UBYTE
 *Ë(
±r
 + 7);

119 
bh_±r
->
size_y
 = * (*Ë(
±r
 + 8);

120 
bh_±r
->
size_x
 = * (*Ë(
±r
 + 12);

122 
bh_±r
->
‹õ¡©i⁄
 = * (*Ë(
±r
 + 20);

123 
bh_±r
->
maö_ödex
 = * (*Ë(
±r
 + 24);

124 
bh_±r
->
sub_ödex
 = * (*Ë(
±r
 + 28);

125 
bh_±r
->
ørôy
 = * (*Ë(
±r
 + 32);

127 
t
=0;Å<25;Å++)

128 
bh_±r
->
sub_tûes_Êags
[
idxèbÀ
[
t
]] = * (
UBYTE
 *Ë(
±r
 + 40 +Å);

130 
bh_±r
->
tûes_±r
 = * (*Ë(
±r
 + 72);

131 
bh_±r
->
tûes_Àngth
 = * (*Ë(
±r
 + 76);

132 
bh_±r
->
tûes_numbî
 = * (*Ë(
±r
 + 80);

136 
bh_±r
++;

137 
±r
 += 96;

139 
	}
}

144 
	$dt1_fûl_subt
(
SUB_TILE_S
 * 
±r
, 
i
, 
tûes_±r
, 
s
)

146 
UBYTE
 * 
°_±r
;

148 
°_±r
 = (
UBYTE
 *Ë
glb_dt1
[
i
].
buf„r
 + 
tûes_±r
 + (20 * 
s
);

149 
±r
->
x_pos
 = * (
WORD
 *Ë
°_±r
;

150 
±r
->
y_pos
 = * (
WORD
 *Ë(
°_±r
 + 2);

152 
±r
->
x_grid
 = * (
UBYTE
 *Ë(
°_±r
 + 6);

153 
±r
->
y_grid
 = * (
UBYTE
 *Ë(
°_±r
 + 7);

154 
±r
->
f‹m©
 = * (
WORD
 *Ë(
°_±r
 + 8);

155 
±r
->
Àngth
 = * (*Ë(
°_±r
 + 10);

157 
±r
->
d©a_off£t
 = * (*Ë((
UBYTE
 *)
°_±r
 + 16);

158 
	}
}

163 
	$dt1_zoom
(
BITMAP
 * 
§c
, 
i
, 
b
, 
z
)

165 
BITMAP
 * 
d°
;

166 
w
 = 
§c
->w, 
h
 = src->h, 
d
=1;

167 
tmp_°r
[100];

169 
z
)

171 
ZM_11
 : ;

172 
ZM_12
 : 
d
 = 2; ;

173 
ZM_14
 : 
d
 = 4; ;

174 
ZM_18
 : 
d
 = 8; ;

175 
ZM_116
 : 
d
 = 16; ;

177 
w
 /
d
;

178 
h
 /
d
;

179 
d°
 = 
	`¸óã_bôm≠
(
w
, 
h
);

180 i‡(
d°
 =
NULL
)

182 
	`•rötf
(
tmp_°r
, "dt1_zoom(%i, %i, %i), can't makeá bitmap "

183 "o‡%ò* %òpixñs\n", 
i
, 
b
, 
z
, 
w
, 
h
);

184 
	`ds1edô_îr‹
(
tmp_°r
);

186 
	`°ªtch_blô
(
§c
, 
d°
, 0, 0, src->
w
, src->
h
, 0, 0, w, h);

188 * (
glb_dt1
[
i
].
block_zoom
[
z
] + 
b
Ë
d°
;

189 
	}
}

194 
	$dt1_Æl_zoom_make
(
i
)

196 
BLOCK_S
 * 
b_±r
, * 
my_b_±r
;

197 
SUB_TILE_S
 
°_±r
;

198 
BITMAP
 * 
tmp_bmp
, * 
•rôe
;

199 
b
, 
w
, 
h
, 
s
, 
x0
, 
y0
, 
Àngth
, 
y_add
, 
z
, 
mem_size
;

200 
UBYTE
 * 
d©a
;

201 
WORD
 
f‹m©
;

202 
‹õ¡©i⁄
;

203 
tmp_°r
[100];

204 
t_mi
, 
t_si
, 
my_idx
;

206 
b_±r
 = (
BLOCK_S
 *Ë
glb_dt1
[
i
].
bh_buf„r
;

208 
	`Ârötf
(
°dîr
, "makög zoom f‹ glb_dt1[%i] (%sË", 
i
, 
glb_dt1
[i].
«me
);

209 
	`fÊush
(
°dîr
);

211 
z
=0; z<
ZM_MAX
; z++)

213 
mem_size
 = (
BITMAP
 *Ë* 
glb_dt1
[
i
].
block_num
;

214 
glb_dt1
[
i
].
block_zoom
[
z
] = (
BITMAP
 **Ë
	`mÆloc
(
mem_size
);

215 i‡(
glb_dt1
[
i
].
block_zoom
[
z
] =
NULL
)

217 
	`•rötf
(
tmp_°r
, "dt1_all_zoom_make(%i), zoom %i,ÇotÉnough mem "

218 "f‹ %òbyãs\n", 
i
, 
z
, 
mem_size
);

219 
	`ds1edô_îr‹
(
tmp_°r
);

221 
	`mem£t
(
glb_dt1
[
i
].
block_zoom
[
z
], 0, 
mem_size
);

222 
glb_dt1
[
i
].
bz_size
[
z
] = 
mem_size
;

226 
b
=0; b < 
glb_dt1
[
i
].
block_num
; b++)

229 
‹õ¡©i⁄
 = 
b_±r
->orientation;

232 
w
 = 
b_±r
->
size_x
;

233 i‡((
‹õ¡©i⁄
 == 10) || (orientation == 11))

234 
w
 = 160;

235 
h
 = - 
b_±r
->
size_y
;

240 
y_add
 = 96;

241 i‡((
‹õ¡©i⁄
 == 0) || (orientation == 15))

243 i‡(
b_±r
->
size_y
)

245 
b_±r
->
size_y
 = - 80;

246 
h
 = 80;

247 
y_add
 = 0;

250 i‡(
‹õ¡©i⁄
 < 15)

252 i‡(
b_±r
->
size_y
)

254 
b_±r
->
size_y
 += 32;

255 
h
 -= 32;

256 
y_add
 = 
h
;

261 i‡((
w
 =0Ë|| (
h
 == 0))

263 
	`Ârötf
(
°dîr
, "0");

264 
	`fÊush
(
°dîr
);

265 
b_±r
 ++;

270 
tmp_bmp
 = 
	`¸óã_bôm≠
(
w
, 
h
);

271 i‡(
tmp_bmp
 =
NULL
)

273 
	`•rötf
(
tmp_°r
, "dt1_all_zoom_make(%i), can't makeá bitmap "

274 "o‡%ò* %òpixñs\n", 
i
, 
w
, 
h
);

275 
	`ds1edô_îr‹
(
tmp_°r
);

277 
	`˛ór
(
tmp_bmp
);

280 
s
=0; s < 
b_±r
->
tûes_numbî
; s++)

283 
	`dt1_fûl_subt
(& 
°_±r
, 
i
, 
b_±r
->
tûes_±r
, 
s
);

286 
x0
 = 
°_±r
.
x_pos
;

287 
y0
 = 
y_add
 + 
°_±r
.
y_pos
;

288 
d©a
 = (
UBYTE
 *Ë((UBYTE *)
glb_dt1
[
i
].
buf„r
 + 
b_±r
->
tûes_±r
 + 
°_±r
.
d©a_off£t
);

289 
Àngth
 = 
°_±r
.length;

290 
f‹m©
 = 
°_±r
.format;

293 i‡(
f‹m©
 == 0x0001)

294 
	`døw_sub_tûe_isomëric
(
tmp_bmp
, 
x0
, 
y0
, 
d©a
, 
Àngth
);

296 
	`døw_sub_tûe_n‹mÆ
(
tmp_bmp
, 
x0
, 
y0
, 
d©a
, 
Àngth
);

300 i‡–(
glb_ds1edô
.
cmd_löe
.
no_vis_debug
 =
FALSE
) &&

301 (
i
 !0Ë&& ((
‹õ¡©i⁄
 == 10) || (orientation == 11))

305 
t_mi
 = 
b_±r
->
maö_ödex
;

306 
t_si
 = 
b_±r
->
sub_ödex
;

307 
my_b_±r
 = (
BLOCK_S
 *Ë
glb_dt1
[0].
bh_buf„r
;

310 
my_idx
=0; my_idx < 
glb_dt1
[0].
block_num
; my_idx++)

312 i‡–(
my_b_±r
[
my_idx
].
‹õ¡©i⁄
 == orientation) &&

313 (
my_b_±r
[
my_idx
].
maö_ödex
 =
t_mi
) &&

314 (
my_b_±r
[
my_idx
].
sub_ödex
 =
t_si
)

318 
•rôe
 = * (
glb_dt1
[0].
block_zoom
[
ZM_11
] + 
my_idx
);

319 i‡(
•rôe
 !
NULL
)

320 
	`døw_•rôe
(
tmp_bmp
, 
•rôe
, 0,Åmp_bmp->
h
 - sprite->h);

323 
my_idx
 = 
glb_dt1
[0].
block_num
;

329 
z
=0; z<
ZM_MAX
; z++)

330 
	`dt1_zoom
(
tmp_bmp
, 
i
, 
b
, 
z
);

333 
	`de°roy_bôm≠
(
tmp_bmp
);

336 
b_±r
 ++;

337 
	`Ârötf
(
°dîr
, ".");

338 
	`fÊush
(
°dîr
);

340 
	`Ârötf
(
°dîr
, "\n");

341 
	`fÊush
(
°dîr
);

342 
	}
}

347 
	$dt1_°ru˘_upd©e
(
i
)

349 * 
±r
 = 
glb_dt1
[
i
].
buf„r
;

350 
size
;

351 
tmp
[100];

353 i‡(
±r
 =
NULL
)

355 
glb_dt1
[
i
].
x1
 = * (*Ë
±r
;

356 
glb_dt1
[
i
].
x2
 = * (*Ë((
UBYTE
 *)
±r
 + 4);

357 
glb_dt1
[
i
].
block_num
 = * (*Ë((
UBYTE
 *)
±r
 + 268);

358 
glb_dt1
[
i
].
bh_°¨t
 = * (*Ë((
UBYTE
 *)
±r
 + 272);

361 
	`¥ötf
("°ru˘ d©®o‡glb_dt1[%i] :\n", 
i
);

362 
	`¥ötf
(" x1 = %li\n", 
glb_dt1
[
i
].
x1
);

363 
	`¥ötf
(" x2 = %li\n", 
glb_dt1
[
i
].
x2
);

364 
	`¥ötf
(" block_num = %li\n", 
glb_dt1
[
i
].
block_num
);

365 
	`¥ötf
(" bh_°¨à = 0x%0lX\n", 
glb_dt1
[
i
].
bh_°¨t
);

368 
size
 = (
BLOCK_S
Ë* 
glb_dt1
[
i
].
block_num
;

369 
glb_dt1
[
i
].
bh_buf„r
 = (*Ë
	`mÆloc
(
size
);

370 i‡(
glb_dt1
[
i
].
bh_buf„r
 =
NULL
)

372 
	`•rötf
(
tmp
, "dt1_struct_update(%i),ÇotÉnough memory for %i bytes\n",

373 
i
, 
size
);

374 
	`ds1edô_îr‹
(
tmp
);

376 
glb_dt1
[
i
].
bh_buff_Àn
 = 
size
;

377 
	`dt1_bh_upd©e
(
i
);

378 
	`dt1_Æl_zoom_make
(
i
);

379 
	}
}

387 
	$dt1_add
(* 
dt1«me
)

389 
i
, 
idx
, 
íåy
;

390 
tmp
[256];

392 i‡(
	`dt1_Æªady_lﬂded
(
dt1«me
, & 
idx
Ë=
TRUE
)

394 
glb_dt1
[
idx
].
ds1_ußge
++;

395  
idx
;

400 
i
=0; i<
DT1_MAX
; i++)

402 i‡(
glb_dt1
[
i
].
ds1_ußge
 == 0)

405 
íåy
 = 
	`misc_lﬂd_mpq_fûe
(

406 
dt1«me
,

407 (**Ë& 
glb_dt1
[
i
].
buf„r
,

408 & 
glb_dt1
[
i
].
buff_Àn
,

409 
TRUE


411 i‡(
íåy
 == -1)

413 
	`•rötf
(
tmp
, "dt1_add(Ë: fûê%†nŸ found", 
dt1«me
);

414 
	`ds1edô_îr‹
(
tmp
);

418 
	`°r˝y
(
glb_dt1
[
i
].
«me
, 
dt1«me
);

419 
glb_dt1
[
i
].
ds1_ußge
 = 1;

420 
	`dt1_°ru˘_upd©e
(
i
);

423 
	`‰ì
(
glb_dt1
[
i
].
buf„r
);

424 
glb_dt1
[
i
].
buf„r
 = 
NULL
;

425 
glb_dt1
[
i
].
buff_Àn
 = 0;

428  
i
;

431 
	`•rötf
(
tmp
, "can'tÜoad %s from mpq,\ntoo much dt1álreadyÜoaded (%i)",

432 
dt1«me
, 
DT1_MAX
);

433 
	`ds1edô_îr‹
(
tmp
);

436 
	}
}

441 
	$dt1_add_•ecül
(* 
dt1«me
)

443 
i
, 
idx
, 
íåy
;

444 
tmp
[256];

446 i‡(
	`dt1_Æªady_lﬂded
(
dt1«me
, & 
idx
Ë=
TRUE
)

448 
glb_dt1
[
idx
].
ds1_ußge
++;

449  
idx
;

454 
i
=0; i<
DT1_MAX
; i++)

456 i‡(
glb_dt1
[
i
].
ds1_ußge
 == 0)

459 
íåy
 = 
	`mod_lﬂd_ö_mem
(".", 
dt1«me
,

460 & 
glb_dt1
[
i
].
buf„r
, & glb_dt1[i].
buff_Àn
);

461 i‡(
íåy
 == -1)

463 
	`•rötf
(
tmp
, "(dt1_add_•ecülËfûê%†nŸ found", 
dt1«me
);

464 
	`ds1edô_îr‹
(
tmp
);

467 
	`¥ötf
(", found\n");

470 
	`°r˝y
(
glb_dt1
[
i
].
«me
, 
dt1«me
);

471 
glb_dt1
[
i
].
ds1_ußge
 = 1;

472 
	`dt1_°ru˘_upd©e
(
i
);

475 
	`‰ì
(
glb_dt1
[
i
].
buf„r
);

476 
glb_dt1
[
i
].
buf„r
 = 
NULL
;

477 
glb_dt1
[
i
].
buff_Àn
 = 0;

480  
i
;

483 
	`•rötf
(
tmp
, "can'tÜoad %s from mpq,\ntoo much dt1álreadyÜoaded (%i)",

484 
dt1«me
, 
DT1_MAX
);

485 
	`ds1edô_îr‹
(
tmp
);

488 
	}
}

	@dt1misc.h

1 #i‚de‡
_DT1MISC_H_


3 
	#_DT1MISC_H_


	)

5 
dt1_Æªady_lﬂded
 (* 
dt1«me
, * 
idx
);

6 
dt1_‰ì
 (
i
);

7 
dt1_dñ
 (
i
);

8 
dt1_bh_upd©e
 (
i
);

9 
dt1_fûl_subt
 (
SUB_TILE_S
 * 
±r
, 
i
, 
tûes_±r
, 
s
);

10 
dt1_zoom
 (
BITMAP
 * 
§c
, 
i
, 
b
, 
z
);

11 
dt1_Æl_zoom_make
 (
i
);

12 
dt1_°ru˘_upd©e
 (
i
);

13 
dt1_add
 (* 
dt1«me
);

14 
dt1_add_•ecül
 (* 
dt1«me
);

	@editobj.c

1 
	~"°ru˘s.h
"

2 
	~"misc.h
"

3 
	~"îr‹.h
"

4 
	~"™im.h
"

5 
	~"edô∑th.h
"

6 
	~"edôobj.h
"

11 
	$edôobj_qs‹t_hñ≥r_døwög_‹dî
(c⁄° * 
e1
, c⁄° * 
e2
)

13 
ds1_idx
 = 
glb_ds1edô
.
obj_‹dî_ds1_idx
;

14 
i1
 = * ((*Ë
e1
),

15 
i2
 = * ((*Ë
e2
);

16 
OBJ_S
 * 
o1
, * 
o2
;

21 
o1
 = & 
glb_ds1
[
ds1_idx
].
obj
[
i1
];

22 
o2
 = & 
glb_ds1
[
ds1_idx
].
obj
[
i2
];

23 i‡(
o1
->
ty
 =
o2
->ty)

25 i‡(
o1
->
tx
 =
o2
->tx)

27 i‡(
glb_ds1edô
.
obj_sub_tûe_‹dî
[
o1
->
sx
][o1->
sy
] ==

28 
glb_ds1edô
.
obj_sub_tûe_‹dî
[
o2
->
sx
][o2->
sy
]

30  
i1
 - 
i2
;

32  
glb_ds1edô
.
obj_sub_tûe_‹dî
[
o1
->
sy
][o1->
sx
] -

33 
glb_ds1edô
.
obj_sub_tûe_‹dî
[
o2
->
sy
][o2->
sx
];

36  
o1
->
tx
 - 
o2
->tx;

38  
o1
->
ty
 - 
o2
->ty;

39 
	}
}

44 
	$edôobj_£t_døwög_‹dî
(
ds1_idx
)

46 
OBJ_S
 * 
obj
;

47 
i
;

51 
i
=0; i < 
glb_ds1
[
ds1_idx
].
obj_num
; i++)

53 
obj
 = & 
glb_ds1
[
ds1_idx
].obj[
i
];

54 
obj
->
tx
 = obj->
x
 / 5L;

55 
obj
->
sx
 = obj->
x
 % 5L;

56 
obj
->
ty
 = obj->
y
 / 5L;

57 
obj
->
sy
 = obj->
y
 % 5L;

61 
i
 = 
glb_ds1
[
ds1_idx
].
obj_num
; i < glb_ds1[ds1_idx].
cuºít_obj_max
; i++)

62 
glb_ds1
[
ds1_idx
].
obj
[
i
].
ty
 = 32000L;

65 
i
=0; i < 
glb_ds1
[
ds1_idx
].
cuºít_obj_max
; i++)

66 
glb_ds1
[
ds1_idx
].
døwög_‹dî
[
i
] = i;

69 
glb_ds1edô
.
obj_‹dî_ds1_idx
 = 
ds1_idx
;

70 
	`qs‹t
(

71 
glb_ds1
[
ds1_idx
].
døwög_‹dî
,

72 
glb_ds1
[
ds1_idx
].
obj_num
,

74 
edôobj_qs‹t_hñ≥r_døwög_‹dî


76 
	}
}

81 
	$edôobj_make_obj_œbñ
(
ds1_idx
)

83 
OBJ_LABEL_S
 * 
œbñ
;

84 
d
, 
o
, 
w
, 
wtmp
, 
h
;

85 
ty≥
, 
id
;

88 
o
=0; o < 
glb_ds1
[
ds1_idx
].
obj_num
; o++)

90 
ty≥
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].type;

91 
id
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].id;

92 
d
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
desc_idx
;

93 
œbñ
 = & 
glb_ds1
[
ds1_idx
].
obj
[
o
].label;

95 
w
 = 16 * 8;

96 
h
 = 2 * 8 + 2;

98 i‡(
d
 != -1)

100 
wtmp
 = 8 * 
	`°æí
(
glb_ds1edô
.
obj_desc
[
d
].
desc
);

101 i‡(
wtmp
 > 
w
)

102 
w
 = 
wtmp
;

104 
œbñ
->
rx
 = 0;

105 
œbñ
->
ry
 = 0;

106 
œbñ
->
w
 = w;

107 
œbñ
->
h
 = h;

108 
œbñ
->
Êags
 = 0;

110 
	}
}

116 
	$edôobj_døw_obj_œb
(
ds1_idx
, 
is_shadow
)

118 
OBJ_LABEL_S
 * 
œbñ
;

119 
d
, 
dx
, 
dy
, 
o
, 
cx
, 
cy
, 
w
, 
h
, 
p
, 
lo›
, 
f1
, 
f2
;

120 
ty≥
, 
id
, 
x
, 
y
;

121 
ox0
, 
oy0
, 
lx0
, 
ly0
;

122 
hm
 = 
glb_ds1
[
ds1_idx
].
height_mul
;

123 
hd
 = 
glb_ds1
[
ds1_idx
].
height_div
;

124 
x1
, 
x2
, 
x3
, 
x4
, 
y1
, 
y2
, 
y3
;

125 
cﬁ‹1
=0, 
cﬁ‹2
=0, 
cﬁ‹3
=0;

126 
o_idx
;

129 
lo›
=0;Üoop<3;Üoop++)

134 
o_idx
=0; o_idx < 
glb_ds1
[
ds1_idx
].
obj_num
; o_idx++)

136 
o
 = 
glb_ds1
[
ds1_idx
].
døwög_‹dî
[
o_idx
];

138 
ty≥
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].type;

139 
id
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].id;

140 
x
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].x;

141 
y
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].y;

143 
d
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
desc_idx
;

144 
p
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th_num
;

145 
f1
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
Êags
;

146 
œbñ
 = & 
glb_ds1
[
ds1_idx
].
obj
[
o
].label;

147 
w
 = 
œbñ
->w;

148 
h
 = 
œbñ
->h;

149 
f2
 = 
œbñ
->
Êags
;

151 i‡(
is_shadow
)

153 i‡–! 
	`IS_MOVING
(
f1
 | 
f2
))

156 
cﬁ‹1
 = 186;

157 
cﬁ‹2
 = 209;

158 
cﬁ‹3
 = 214;

160 
x
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
ﬁd_x
;

161 
y
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
ﬁd_y
;

165 
x
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].x;

166 
y
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].y;

170 
dx
 = ((
y
-2Ë* -
glb_ds1
[
ds1_idx
].
tûe_w
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_w / 10);

171 
dy
 = ((
y
-2Ë* 
glb_ds1
[
ds1_idx
].
tûe_h
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_h / 10);

172 
ox0
 = 
dx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
;

173 
oy0
 = 
dy
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 - 16;

176 i‡(
is_shadow
)

178 
lx0
 = 
ox0
 + (
œbñ
->
ﬁd_rx
 * 
hm
 / 
hd
);

179 
ly0
 = 
oy0
 + (
œbñ
->
ﬁd_ry
 * 
hm
 / 
hd
);

183 
lx0
 = 
ox0
 + (
œbñ
->
rx
 * 
hm
 / 
hd
);

184 
ly0
 = 
oy0
 + (
œbñ
->
ry
 * 
hm
 / 
hd
);

188 i‡(
is_shadow
 =
FALSE
)

190 
cﬁ‹1
 = 0;

191 
cﬁ‹2
 = 255;

192 
cﬁ‹3
 = 255;

193 i‡(
	`IS_SELECTED
(
f1
))

195 
cﬁ‹1
 = 118;

196 
cﬁ‹2
 = 132;

197 
cﬁ‹3
 = 132;

199 i‡(
	`IS_MOUSE_OVER
(
f1
))

201 
cﬁ‹2
 = 129;

202 i‡(
	`IS_SELECTED
(
f2
))

204 
cﬁ‹1
 = 118;

205 
cﬁ‹3
 = 132;

208 
cﬁ‹3
 = 129;

210 i‡(
	`IS_SELECTED
(
f2
))

212 
cﬁ‹1
 = 118;

213 
cﬁ‹3
 = 132;

215 i‡(
	`IS_MOUSE_OVER
(
f2
))

216 
cﬁ‹3
 = 129;

219 
lo›
)

223 
cx
 = 
x
 + 2;

224 
cy
 = 
y
 - 2;

226 
dx
 = (
cy
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 10Ë+ (
cx
 * glb_ds1[ds1_idx].tile_w / 10);

227 
dy
 = (
cy
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 10Ë+ (
cx
 * glb_ds1[ds1_idx].tile_h / 10);

229 
x1
 = 
dx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
;

230 
x2
 = 
x1
 + 
glb_ds1
[
ds1_idx
].
tûe_w
 / 10 - 1;

231 
x3
 = 
x1
 + 
glb_ds1
[
ds1_idx
].
tûe_w
 / 10;

232 
x4
 = 
x1
 + 
glb_ds1
[
ds1_idx
].
tûe_w
 / 5 - 1;

234 
y1
 = 
dy
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
;

235 
y2
 = 
y1
 + 
glb_ds1
[
ds1_idx
].
tûe_h
 / 10 - 1;

236 
y3
 = 
y1
 + 
glb_ds1
[
ds1_idx
].
tûe_h
 / 5 - 2;

238 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y2
, 
x2
, 
y1
, 
cﬁ‹2
);

239 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x3
, 
y1
, 
x4
, 
y2
, 
cﬁ‹2
);

240 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x3
, 
y3
, 
x4
, 
y2
, 
cﬁ‹2
);

241 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y2
, 
x2
, 
y3
, 
cﬁ‹2
);

247 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ox0
+1, 
oy0
+17, ox0+1, oy0+1, 0);

248 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ox0
+1, 
oy0
+1, 
lx0
+1, 
ly0
+1, 0);

249 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
lx0
+1, 
ly0
+1,Üx0+1,Üy0-8, 0);

252 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ox0
, 
oy0
+16, ox0, oy0, 
cﬁ‹2
);

253 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ox0
, 
oy0
, 
lx0
, 
ly0
, 
cﬁ‹2
);

254 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
lx0
, 
ly0
,Üx0,Üy0-9, 
cﬁ‹2
);

256 i‡(
	`IS_SELECTED
(
f1
))

258 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ox0
-1, 
oy0
+16, ox0-1, oy0, 
cﬁ‹2
);

259 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ox0
-1, 
oy0
, 
lx0
-1, 
ly0
, 
cﬁ‹2
);

260 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
lx0
-1, 
ly0
,Üx0-1,Üy0-9, 
cﬁ‹2
);

261 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
ox0
-2, 
oy0
+14, ox0+1, oy0+16, 
cﬁ‹2
);

264 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
ox0
-1, 
oy0
+14, ox0+1, oy0+16, 
cﬁ‹2
);

271 
x1
 = 
lx0
 - (
w
/2) - 2;

272 
x2
 = 
x1
 + 
w
 + 4;

273 
y1
 = 
ly0
 - 8 - 
h
 - 4;

274 
y2
 = 
y1
 + 
h
 + 2;

276 i‡(
is_shadow
 =
FALSE
)

278 
œbñ
->
x0
 = 
x1
;

279 
œbñ
->
y0
 = 
y1
;

283 i‡((
x1
 >
glb_c⁄fig
.
s¸ìn
.
width
) ||

284 (
y1
 >
glb_c⁄fig
.
s¸ìn
.
height
) ||

285 (
x2
 < 0Ë|| (
y2
 < 0))

288 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 
cﬁ‹1
);

289 
	`ª˘
 (
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 
cﬁ‹3
);

292 
x2
 = 
x1
 + 2 + (
w
/2);

293 
y2
 = 
y1
 + 2;

294 i‡(
d
 == -1)

295 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x2
 - 8, 
y2
, 255, "??");

298 
x2
 -(8 * 
	`°æí
(
glb_ds1edô
.
obj_desc
[
d
].
desc
) / 2);

299 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x2
, 
y2
, 255, "%s",

300 
glb_ds1edô
.
obj_desc
[
d
].
desc
);

304 
x2
 = 
x1
 + 2;

305 
y2
 += 8 + 2;

306 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x2
, 
y2
, 
is_shadow
 ? 255 : 111, "#%i", 
o
);

309 i‡(
id
 <-100Ë
x2
 = 
lx0
 - 3 * 8;

310 i‡(
id
 <-10Ë
x2
 = 
lx0
 - 2 * 8 - 4;

311 i‡(
id
 < 0Ë
x2
 = 
lx0
 - 8 - 4;

312 i‡(
id
 < 10Ë
x2
 = 
lx0
 - 8 - 4;

313 i‡(
id
 < 100Ë
x2
 = 
lx0
 - 2 * 8;

314 
x2
 = 
lx0
 - 2 * 8 - 4;

315 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x2
, 
y2
, 
is_shadow
 ? 255 : 11, "%i", 
ty≥
);

319 
x2
 += 1*8;

320 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x2
, 
y2
, 
is_shadow
 ? 255 : 255, " %i", 
id
);

323 i‡(
p
 < 10)

324 
x2
 = 
x1
 + 
w
 + 4 - 2 * 8;

326 
x2
 = 
x1
 + 
w
 + 4 - 3 * 8;

327 i‡(
p
 == 0)

328 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x2
, 
y2
, 
is_shadow
 ? 255 : 208, "P-");

330 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x2
, 
y2
, 
is_shadow
 ? 255 : 133, "P%i", 
p
);

335 
	}
}

340 
	$edôobj_make_obj_desc
(
ds1_idx
, 
obj_idx
)

342 
a˘
, 
ty≥
, 
id
, 
i
, * 
nb_ty≥_≥r_a˘_±r
;

345 
a˘
 = 
glb_ds1
[
ds1_idx
].act;

346 
ty≥
 = 
glb_ds1
[
ds1_idx
].
obj
[
obj_idx
].type;

347 
id
 = 
glb_ds1
[
ds1_idx
].
obj
[
obj_idx
].id;

350 
i
=0; i < 
glb_ds1edô
.
obj_desc_num
; i++)

352 i‡–(
glb_ds1edô
.
obj_desc
[
i
].
a˘
 ==áct) &&

353 (
glb_ds1edô
.
obj_desc
[
i
].
ty≥
 ==Åype) &&

354 (
glb_ds1edô
.
obj_desc
[
i
].
id
 == id)

358 
glb_ds1
[
ds1_idx
].
obj
[
obj_idx
].
desc_idx
 = 
i
;

366 i‡(
ty≥
 == 1)

367 
nb_ty≥_≥r_a˘_±r
 = & 
glb_c⁄fig
.
nb_ty≥1_≥r_a˘
;

368 i‡(
ty≥
 == 2)

369 
nb_ty≥_≥r_a˘_±r
 = & 
glb_c⁄fig
.
nb_ty≥2_≥r_a˘
;

372 
glb_ds1
[
ds1_idx
].
obj
[
obj_idx
].
desc_idx
 = -1;

376 
id
 < 0)

379 
a˘
--;

380 
id
 +(* 
nb_ty≥_≥r_a˘_±r
);

382 
id
 >(* 
nb_ty≥_≥r_a˘_±r
))

385 
a˘
++;

386 
id
 -(* 
nb_ty≥_≥r_a˘_±r
);

390 
i
=0; i < 
glb_ds1edô
.
obj_desc_num
; i++)

392 i‡–(
glb_ds1edô
.
obj_desc
[
i
].
a˘
 ==áct) &&

393 (
glb_ds1edô
.
obj_desc
[
i
].
ty≥
 ==Åype) &&

394 (
glb_ds1edô
.
obj_desc
[
i
].
id
 == id)

398 
glb_ds1
[
ds1_idx
].
obj
[
obj_idx
].
desc_idx
 = 
i
;

404 
glb_ds1
[
ds1_idx
].
obj
[
obj_idx
].
desc_idx
 = -1;

405 
	}
}

410 
	$edôobj_make_obj_√w_id
(
ds1_idx
, 
obj_idx
)

412 
a˘
, 
ty≥
, 
id
, 
d
, * 
nb_ty≥_≥r_a˘_±r
;

415 
d
 = 
glb_ds1
[
ds1_idx
].
obj
[
obj_idx
].
desc_idx
;

416 
a˘
 = 
glb_ds1edô
.
obj_desc
[
d
].act;

417 
ty≥
 = 
glb_ds1edô
.
obj_desc
[
d
].type;

418 
id
 = 
glb_ds1edô
.
obj_desc
[
d
].id;

420 i‡(
ty≥
 == 1)

421 
nb_ty≥_≥r_a˘_±r
 = & 
glb_c⁄fig
.
nb_ty≥1_≥r_a˘
;

422 i‡(
ty≥
 == 2)

423 
nb_ty≥_≥r_a˘_±r
 = & 
glb_c⁄fig
.
nb_ty≥2_≥r_a˘
;

427 
glb_ds1
[
ds1_idx
].
obj
[
obj_idx
].
ty≥
 =Åype;

428 
glb_ds1
[
ds1_idx
].
obj
[
obj_idx
].
id
 = id;

432 
a˘
 < 
glb_ds1
[
ds1_idx
].act)

435 
a˘
++;

436 
id
 -(* 
nb_ty≥_≥r_a˘_±r
);

438 
a˘
 > 
glb_ds1
[
ds1_idx
].act)

441 
a˘
--;

442 
id
 +(* 
nb_ty≥_≥r_a˘_±r
);

446 
glb_ds1
[
ds1_idx
].
obj
[
obj_idx
].
ty≥
 =Åype;

447 
glb_ds1
[
ds1_idx
].
obj
[
obj_idx
].
id
 = id;

448 
	}
}

453 
	$edôobj_˛ór_obj_œb_£l
(
ds1_idx
)

455 
i
;

458 
i
=0; i < 
glb_ds1
[
ds1_idx
].
obj_num
; i++)

460 
	`DEL_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
i
].
œbñ
.
Êags
);

461 
	`DEL_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
i
].
Êags
);

463 
	}
}

468 
	$edôobj_˛ór_obj_œb_ovî
(
ds1_idx
)

470 
i
;

473 
i
=0; i < 
glb_ds1
[
ds1_idx
].
obj_num
; i++)

475 
	`DEL_MOUSE_OVER
(
glb_ds1
[
ds1_idx
].
obj
[
i
].
œbñ
.
Êags
);

476 
	`DEL_MOUSE_OVER
(
glb_ds1
[
ds1_idx
].
obj
[
i
].
Êags
);

478 
	}
}

483 
	$edôobj_˛ór_obj_œb_Êags
(
ds1_idx
)

485 
i
;

488 
i
=0; i < 
glb_ds1
[
ds1_idx
].
obj_num
; i++)

489 
glb_ds1
[
ds1_idx
].
obj
[
i
].
Êags
 = glb_ds1[ds1_idx].obj[i].
œbñ
.flags = 0;

490 
	}
}

499 
	$edôobj_ovî_obj_œb
(
ds1_idx
, * 
±r_t
, * 
±r_o
,

500 
cx
, 
cy
, 
mx
, 
my
)

502 
OBJ_LABEL_S
 * 
œbñ
;

503 
lo›
, 
o
, 
w
, 
h
, 
x
, 
y
, 
x0
, 
y0
, 
œ°_t
=0, 
œ°_o
 = -1;

504 
ªdøw
 = 
FALSE
, 
o_idx
;

507 
lo›
=0;Üoop<2;Üoop++)

509 
o_idx
=0; o_idx < 
glb_ds1
[
ds1_idx
].
obj_num
; o_idx++)

511 
o
 = 
glb_ds1
[
ds1_idx
].
døwög_‹dî
[
o_idx
];

512 
lo›
)

516 
x
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].x;

517 
y
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].y;

518 i‡((
cx
 =
x
Ë&& (
cy
 =
y
))

521 
œ°_t
 = 2;

522 
œ°_o
 = 
o
;

527 i‡(
	`IS_MOUSE_OVER
(
glb_ds1
[
ds1_idx
].
obj
[
o
].
Êags
))

530 
ªdøw
 = 
TRUE
;

537 
œbñ
 = & 
glb_ds1
[
ds1_idx
].
obj
[
o
].label;

538 
w
 = 
œbñ
->w;

539 
h
 = 
œbñ
->h;

540 
x0
 = 
œbñ
->x0;

541 
y0
 = 
œbñ
->y0;;

542 i‡((
mx
 >
x0
Ë&& (
my
 >
y0
Ë&& (mx < x0+
w
+4) &&

543 (
my
 < 
y0
+
h
+4))

546 
œ°_t
 = 1;

547 
œ°_o
 = 
o
;

552 i‡(
	`IS_MOUSE_OVER
(
glb_ds1
[
ds1_idx
].
obj
[
o
].
œbñ
.
Êags
))

555 
ªdøw
 = 
TRUE
;

563 i‡(
ªdøw
 =
TRUE
)

566 
	`edôobj_˛ór_obj_œb_ovî
(
ds1_idx
);

567 i‡(
œ°_o
 != -1)

569 i‡(
œ°_t
 == 1)

570 
	`SET_MOUSE_OVER
(
glb_ds1
[
ds1_idx
].
obj
[
œ°_o
].
œbñ
.
Êags
);

572 
	`SET_MOUSE_OVER
(
glb_ds1
[
ds1_idx
].
obj
[
œ°_o
].
Êags
);

576 i‡(
œ°_o
 != -1)

579 i‡(
œ°_t
 == 1)

582 i‡–! 
	`IS_MOUSE_OVER
(
glb_ds1
[
ds1_idx
].
obj
[
œ°_o
].
œbñ
.
Êags
))

585 
	`edôobj_˛ór_obj_œb_ovî
(
ds1_idx
);

586 
	`SET_MOUSE_OVER
(
glb_ds1
[
ds1_idx
].
obj
[
œ°_o
].
œbñ
.
Êags
);

587 
ªdøw
 = 
TRUE
;

593 i‡–! 
	`IS_MOUSE_OVER
(
glb_ds1
[
ds1_idx
].
obj
[
œ°_o
].
Êags
))

596 
	`edôobj_˛ór_obj_œb_ovî
(
ds1_idx
);

597 
	`SET_MOUSE_OVER
(
glb_ds1
[
ds1_idx
].
obj
[
œ°_o
].
Êags
);

598 
ªdøw
 = 
TRUE
;

604 * 
±r_t
 = 
œ°_t
;

605 * 
±r_o
 = 
œ°_o
;

606  
ªdøw
;

607 
	}
}

613 
	$edôobj_¥ï¨e_movög
(
ds1_idx
)

615 
OBJ_LABEL_S
 * 
œbñ
;

616 
OBJ_S
 * 
±r_obj
;

617 
o
;

620 
o
=0; o < 
glb_ds1
[
ds1_idx
].
obj_num
; o++)

622 
±r_obj
 = & 
glb_ds1
[
ds1_idx
].
obj
[
o
];

623 
œbñ
 = & 
glb_ds1
[
ds1_idx
].
obj
[
o
].label;

624 i‡(
	`IS_SELECTED
(
±r_obj
->
Êags
 | 
œbñ
->flags))

626 i‡(
	`IS_SELECTED
(
±r_obj
->
Êags
))

627 
	`SET_MOVING
(
±r_obj
->
Êags
);

629 i‡(
	`IS_SELECTED
(
œbñ
->
Êags
))

630 
	`SET_MOVING
(
œbñ
->
Êags
);

632 
±r_obj
->
ﬁd_x
 =Öå_obj->
x
;

633 
±r_obj
->
ﬁd_y
 =Öå_obj->
y
;

634 
œbñ
->
ﬁd_rx
 =Üabñ->
rx
;

635 
œbñ
->
ﬁd_ry
 =Üabñ->
ry
;

638 
	}
}

643 
	$edôobj_movög_obj_œb
(
ds1_idx
, 
dcx
, 
dcy
, 
dmx
, 
dmy
)

645 
OBJ_LABEL_S
 * 
œbñ
;

646 
OBJ_S
 * 
±r_obj
;

647 
ﬁd_dcx
, 
ﬁd_dcy
, 
ﬁd_dmx
, 
ﬁd_dmy
, 
ﬁd_ds1_idx
 = -1;

648 
o
, 
ªdøw
 = 
FALSE
, 
ßve_ﬁd
 = FALSE;

651 
o
=0; o < 
glb_ds1
[
ds1_idx
].
obj_num
; o++)

653 
±r_obj
 = & 
glb_ds1
[
ds1_idx
].
obj
[
o
];

654 i‡(
	`IS_MOVING
(
±r_obj
->
Êags
))

656 i‡((
ﬁd_dcx
 !
dcx
Ë|| (
ﬁd_dcy
 !
dcy
Ë|| (
ds1_idx
 !
ﬁd_ds1_idx
))

658 
±r_obj
->
x
 =Öå_obj->
ﬁd_x
 + 
dcx
;

659 
±r_obj
->
y
 =Öå_obj->
ﬁd_y
 + 
dcy
;

661 i‡(
±r_obj
->
x
 < 0)

662 
±r_obj
->
x
 = 0;

663 i‡(
±r_obj
->
x
 >
glb_ds1
[
ds1_idx
].
width
 * 5)

664 
±r_obj
->
x
 = 
glb_ds1
[
ds1_idx
].
width
 * 5 - 1;

666 i‡(
±r_obj
->
y
 < 0)

667 
±r_obj
->
y
 = 0;

668 i‡(
±r_obj
->
y
 >
glb_ds1
[
ds1_idx
].
height
 * 5)

669 
±r_obj
->
y
 = 
glb_ds1
[
ds1_idx
].
height
 * 5 - 1;

671 
ßve_ﬁd
 = 
TRUE
;

675 
œbñ
 = & 
glb_ds1
[
ds1_idx
].
obj
[
o
].label;

676 i‡(
	`IS_MOVING
(
œbñ
->
Êags
))

678 i‡((
ﬁd_dmx
 !
dmx
Ë|| (
ﬁd_dmy
 !
dmy
Ë|| (
ds1_idx
 !
ﬁd_ds1_idx
))

680 
œbñ
->
rx
 =Üabñ->
ﬁd_rx
 + 
dmx
;

681 
œbñ
->
ry
 =Üabñ->
ﬁd_ry
 + 
dmy
;

683 
ßve_ﬁd
 = 
TRUE
;

687 i‡((
ßve_ﬁd
Ë|| (
ds1_idx
 !
ﬁd_ds1_idx
))

689 
ﬁd_ds1_idx
 = 
ds1_idx
;

690 
ﬁd_dcx
 = 
dcx
;

691 
ﬁd_dcy
 = 
dcy
;

692 
ﬁd_dmx
 = 
dmx
;

693 
ﬁd_dmy
 = 
dmy
;

694 
ªdøw
 = 
TRUE
;

696  
ªdøw
;

697 
	}
}

702 
	$edôobj_íd_move_obj_œb
(
ds1_idx
)

704 
OBJ_LABEL_S
 * 
œbñ
;

705 
OBJ_S
 * 
±r_obj
;

706 
o
;

709 
o
=0; o < 
glb_ds1
[
ds1_idx
].
obj_num
; o++)

711 
±r_obj
 = & 
glb_ds1
[
ds1_idx
].
obj
[
o
];

712 
	`DEL_MOVING
(
±r_obj
->
Êags
);

714 
œbñ
 = & 
±r_obj
->label;

715 
	`DEL_MOVING
(
œbñ
->
Êags
);

717 
	}
}

722 
	$edôobj_¥ï¨e_undo
(
ds1_idx
)

724 
OBJ_S
 * 
±r_s
, * 
±r_d
;

725 
o
;

728 
o
=0; o < 
glb_ds1
[
ds1_idx
].
obj_num
; o++)

730 
±r_s
 = & 
glb_ds1
[
ds1_idx
].
obj
[
o
];

731 
±r_d
 = & 
glb_ds1
[
ds1_idx
].
obj_undo
[
o
];

732 
	`mem˝y
(
±r_d
, 
±r_s
,  (
OBJ_S
));

734 
glb_ds1
[
ds1_idx
].
obj_num_undo
 = glb_ds1[ds1_idx].
obj_num
;

735 
glb_ds1
[
ds1_idx
].
ˇn_undo_obj
 = 
TRUE
;

736 
	}
}

741 
	$edôobj_undo
(
ds1_idx
)

743 
OBJ_S
 * 
±r_s
, * 
±r_d
;

744 
o
;

748 i‡(
glb_ds1
[
ds1_idx
].
ˇn_undo_obj
 =
FALSE
)

751 
o
=0; o < 
glb_ds1
[
ds1_idx
].
obj_num_undo
; o++)

753 
±r_s
 = & 
glb_ds1
[
ds1_idx
].
obj_undo
[
o
];

754 
±r_d
 = & 
glb_ds1
[
ds1_idx
].
obj
[
o
];

755 
	`mem˝y
(
±r_d
, 
±r_s
,  (
OBJ_S
));

757 
glb_ds1
[
ds1_idx
].
obj_num
 = glb_ds1[ds1_idx].
obj_num_undo
;

758 
	}
}

764 
	$edôobj_dñ_obj
(
ds1_idx
)

766 
OBJ_S
 * 
±r_s
, * 
±r_d
;

767 
s
=0, 
d
=0, 
n
=0, 
max
 = 
glb_ds1
[
ds1_idx
].
obj_num
, 
d⁄e
 = 
FALSE
;

770  ! 
d⁄e
)

772 
±r_d
 = & 
glb_ds1
[
ds1_idx
].
obj
[
d
];

773 i‡(
	`IS_SELECTED
(
±r_d
->
Êags
))

776 (
s
 < 
max
Ë&& 
	`IS_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[s].
Êags
))

777 
s
++;

779 i‡(
s
 < 
max
)

782 
±r_s
 = & 
glb_ds1
[
ds1_idx
].
obj
[
s
];

783 
	`mem˝y
(
±r_d
, 
±r_s
,  (
OBJ_S
));

784 
	`SET_SELECTED
(
±r_s
->
Êags
);

787 
d⁄e
 = 
TRUE
;

789 i‡(
d⁄e
 =
FALSE
)

791 
n
++;

792 
d
++;

793 
s
++;

794 i‡(
d
 >
max
)

795 
d⁄e
 = 
TRUE
;

800 
s
=
n
; s < 
max
; s++)

801 
	`mem£t
–& 
glb_ds1
[
ds1_idx
].
obj
[
s
], 0, (
OBJ_S
));

804 
glb_ds1
[
ds1_idx
].
obj_num
 = 
n
;

805 
	}
}

811 
	$edôobj_c›y_obj
(
ds1_idx
)

813 
OBJ_S
 * 
±r_s
, * 
±r_d
;

814 
o
, 
d
, 
nb
=0, 
max
 = 
glb_ds1
[
ds1_idx
].
obj_num
;

815 
ö¸
;

819 
o
=0; o < 
max
; o++)

820 i‡(
	`IS_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
o
].
Êags
))

821 
nb
++;

824 i‡(
nb
 <= 0)

828 i‡((
max
 + 
nb
Ë>
glb_ds1
[
ds1_idx
].
cuºít_obj_max
)

830 
ö¸
 = 1 + (
max
 + 
nb
Ë- 
glb_ds1
[
ds1_idx
].
cuºít_obj_max
;

831 i‡(
	`misc_ö¸ó£_ds1_obje˘s_max
(
ds1_idx
, 
ö¸
) != 0)

836 
d
 = 
max
;

837 
o
=0; o < 
max
; o++)

839 i‡(
	`IS_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
o
].
Êags
))

841 
±r_s
 = & 
glb_ds1
[
ds1_idx
].
obj
[
o
];

842 
±r_d
 = & 
glb_ds1
[
ds1_idx
].
obj
[
d
];

843 
	`mem˝y
(
±r_d
, 
±r_s
,  (
OBJ_S
));

844 
	`DEL_SELECTED
(
±r_s
->
Êags
);

845 
	`SET_MOUSE_OVER
(
±r_s
->
Êags
);

846 
±r_d
->
‰ame_dñè
 = 
	`ønd
()%256;;

847 
d
++;

850 
glb_ds1
[
ds1_idx
].
obj_num
 = 
max
 + 
nb
;

851 
	}
}

918 
	$edôobj_cou¡_£l_obj
(
ds1_idx
)

920 
o
, 
nb
=0;

923 
o
=0; o < 
glb_ds1
[
ds1_idx
].
obj_num
; o++)

924 i‡(
	`IS_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
o
].
Êags
))

925 
nb
++;

927  
nb
;

928 
	}
}

934 
	$edôobj_ö£π_obj
(
ds1_idx
, 
cx
, 
cy
)

936 
OBJ_LABEL_S
 * 
œbñ
;

937 
OBJ_S
 * 
±r_o
;

938 
d
, 
id
, 
ty≥
, 
obj
, 
w
, 
wtmp
, 
h
;

939 
ö¸
;

942 
obj
 = 
glb_ds1
[
ds1_idx
].
obj_num
;

943 i‡(
obj
 >
glb_ds1
[
ds1_idx
].
cuºít_obj_max
)

945 
ö¸
 = 1 + 
obj
 - 
glb_ds1
[
ds1_idx
].
cuºít_obj_max
;

946 i‡(
	`misc_ö¸ó£_ds1_obje˘s_max
(
ds1_idx
, 
ö¸
) != 0)

950 
glb_ds1
[
ds1_idx
].
obj_num
++;

951 
±r_o
 = & 
glb_ds1
[
ds1_idx
].
obj
[obj];

953 
±r_o
->
ty≥
 = 1;

954 
±r_o
->
id
 = 0;

955 
±r_o
->
x
 = 
cx
;

956 
±r_o
->
y
 = 
cy
;

957 
±r_o
->
∑th_num
 = 0;

958 
±r_o
->
Êags
 = 0;

959 
	`SET_SELECTED
(
±r_o
->
Êags
);

960 
±r_o
->
‰ame_dñè
 = 
	`ønd
()%256;

961 
	`edôobj_make_obj_desc
(
ds1_idx
, 
obj
);

963 
ty≥
 = 
±r_o
->type;

964 
id
 = 
±r_o
->id;

965 
d
 = 
±r_o
->
desc_idx
;

966 
œbñ
 = & 
±r_o
->label;

968 
w
 = 16 * 8;

969 
h
 = 2 * 8 + 2;

971 i‡(
d
 != -1)

973 
wtmp
 = 8 * 
	`°æí
(
glb_ds1edô
.
obj_desc
[
d
].
desc
);

974 i‡(
wtmp
 > 
w
)

975 
w
 = 
wtmp
;

977 
œbñ
->
rx
 = 0;

978 
œbñ
->
ry
 = 0;

979 
œbñ
->
w
 = w;

980 
œbñ
->
h
 = h;

981 
œbñ
->
Êags
 = 0;

984 
	}
}

989 
	$edôobj_¥ï¨e_edô_obj_wö
(
ds1_idx
, 
obj_idx
)

991 
WIN_EDT_OBJ_S
 * 
±r_w
 = & 
glb_ds1
[
ds1_idx
].
wö_edt_obj
;

992 
OBJ_DESC_S
 * 
±r_d
;

993 
EDT_BUT_S
 * 
b
;

994 
a˘
, 
w
, 
h
, 
desc_Àn
 = 0, 
Àn
, 
n
, 
d
, 
i
, 
x0
, 
y0
, 
typ
;

995 
myb‹dî
 = 2;

997 
x1
, 
y1
, 
x2
, 
y2
, 
x
, 
y
;

999 
«me
[10];

1000 } 
but_öô
[
EB_MAX
] = {

1014 
w
 = 
glb_c⁄fig
.
s¸ìn
.
width
;

1015 
h
 = 
glb_c⁄fig
.
s¸ìn
.
height
;

1016 
a˘
 = 
±r_w
->
cur_a˘
;

1017 
typ
 = 
±r_w
->
cur_ty≥
;

1020 
±r_w
->
desc_íd
 =Öå_w->
desc_°¨t
 = -1;

1021 
d
=0; d < 
glb_ds1edô
.
obj_desc_num
; d++)

1023 
±r_d
 = & 
glb_ds1edô
.
obj_desc
[
d
];

1024 i‡((
±r_d
->
a˘
 =a˘Ë&& (±r_d->
ty≥
 =
typ
))

1026 
Àn
 = 1 + 
	`°æí
(
±r_d
->
desc
);

1027 i‡(
Àn
 > 
desc_Àn
)

1028 
desc_Àn
 = 
Àn
;

1029 i‡(
±r_w
->
desc_°¨t
 == -1)

1030 
±r_w
->
desc_°¨t
 = 
d
;

1031 
±r_w
->
desc_íd
 = 
d
;

1034 
n
 = 
	`°æí
(" Description");

1035 i‡(
n
 > 
desc_Àn
)

1036 
desc_Àn
 = 
n
;

1037 
±r_w
->
desc_ch¨
 = 
desc_Àn
;

1038 
±r_w
->
desc_num
 =Öå_w->
desc_íd
 -Öå_w->
desc_°¨t
 + 1;

1039 
±r_w
->
obj_idx
 = obj_idx;

1042 
±r_w
->
x0
 = 5;

1043 
±r_w
->
y0
 = 15;

1044 
±r_w
->
h
 = 
glb_c⁄fig
.
s¸ìn
.
height
 -Öå_w->
y0
 - 20;

1045 
±r_w
->
num
 = (’å_w->
h
 - 69 - (3 * 10)Ë/ 10Ë- 
myb‹dî
;

1046 i‡(
±r_w
->
num
 < 1)

1047 
±r_w
->
num
 = 1;

1048 
±r_w
->
h
 = 69 + 10 * (3 +Öå_w->
num
 + 
myb‹dî
) + 5;

1050 i‡(
glb_ds1edô
.
obj_desc
[
±r_w
->
desc_cur
].
a˘
 !±r_w->
cur_a˘
)

1051 
±r_w
->
°¨t
 =Öå_w->
desc_°¨t
;

1052 i‡(
glb_ds1
[
ds1_idx
].
obj
[
obj_idx
].
desc_idx
 == -1)

1054 
±r_w
->
°¨t
 =Öå_w->
desc_°¨t
;

1058 
±r_w
->
°¨t
 =Öå_w->
desc_cur
 - (±r_w->
num
 / 2);

1059 i‡(
±r_w
->
°¨t
 +Öå_w->
num
 >Öå_w->
desc_íd
)

1060 
±r_w
->
°¨t
 =Öå_w->
desc_íd
 -Öå_w->
num
 + 1;

1061 i‡(
±r_w
->
°¨t
 <Öå_w->
desc_°¨t
)

1062 
±r_w
->
°¨t
 =Öå_w->
desc_°¨t
;

1065 
±r_w
->
w
 = 8 * (4 + 3 + 
desc_Àn
 + 5);

1066 i‡(
±r_w
->
w
 < 358)

1067 
±r_w
->
w
 = 358;

1070 
x0
 = 
±r_w
->x0 + 8;

1071 
y0
 = 
±r_w
->y0 + 8;

1072 
i
=0; i<
EB_MAX
; i++)

1074 
b
 = & 
±r_w
->
buâ⁄
[
i
];

1075 
b
->
box
.
x1
 = 
x0
 + 
but_öô
[
i
].x1;

1076 
b
->
box
.
y1
 = 
y0
 + 
but_öô
[
i
].y1;

1077 
b
->
box
.
x2
 = 
x0
 + 
but_öô
[
i
].x2;

1078 
b
->
box
.
y2
 = 
y0
 + 
but_öô
[
i
].y2;

1079 
b
->
txt
.
x
 = 
x0
 + 
but_öô
[
i
].x;

1080 
b
->
txt
.
y
 = 
y0
 + 
but_öô
[
i
].y;

1081 
	`°r˝y
(
b
->
«me
, 
but_öô
[
i
].name);

1082 
b
->
Êags
 = 0;

1086 
	`SET_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_OK
].
Êags
);

1087 
	`SET_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_CANCEL
].
Êags
);

1088 
	`SET_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_TYPE1
].
Êags
);

1089 
	`SET_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_TYPE2
].
Êags
);

1091 i‡(
typ
 == 1)

1093 
	`SET_SELECTED
(
±r_w
->
buâ⁄
[
EB_TYPE1
].
Êags
);

1095 
	`SET_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_ACT1
].
Êags
);

1096 
	`SET_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_ACT2
].
Êags
);

1097 
	`SET_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_ACT3
].
Êags
);

1098 
	`SET_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_ACT4
].
Êags
);

1099 
	`SET_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_ACT5
].
Êags
);

1103 
	`SET_SELECTED
(
±r_w
->
buâ⁄
[
EB_TYPE2
].
Êags
);

1104 i‡(
glb_c⁄fig
.
n‹mÆ_ty≥2
 =
TRUE
)

1107 
	`SET_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_ACT1
].
Êags
);

1110 i‡(
glb_ds1
[
ds1_idx
].
a˘
 >= 2)

1111 
	`SET_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_ACT2
].
Êags
);

1113 i‡(
glb_ds1
[
ds1_idx
].
a˘
 >= 3)

1114 
	`SET_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_ACT3
].
Êags
);

1116 i‡(
glb_ds1
[
ds1_idx
].
a˘
 >= 4)

1117 
	`SET_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_ACT4
].
Êags
);

1119 i‡(
glb_ds1
[
ds1_idx
].
a˘
 >= 5)

1120 
	`SET_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_ACT5
].
Êags
);

1124 
	`SET_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_ACT1
].
Êags
);

1125 
	`SET_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_ACT2
].
Êags
);

1126 
	`SET_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_ACT3
].
Êags
);

1127 
	`SET_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_ACT4
].
Êags
);

1128 
	`SET_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_ACT5
].
Êags
);

1132 
a˘
)

1134 1 : 
	`SET_SELECTED
(
±r_w
->
buâ⁄
[
EB_ACT1
].
Êags
); ;

1135 2 : 
	`SET_SELECTED
(
±r_w
->
buâ⁄
[
EB_ACT2
].
Êags
); ;

1136 3 : 
	`SET_SELECTED
(
±r_w
->
buâ⁄
[
EB_ACT3
].
Êags
); ;

1137 4 : 
	`SET_SELECTED
(
±r_w
->
buâ⁄
[
EB_ACT4
].
Êags
); ;

1138 5 : 
	`SET_SELECTED
(
±r_w
->
buâ⁄
[
EB_ACT5
].
Êags
); ;

1142 
glb_ds1
[
ds1_idx
].
døw_edô_obj
 = 
TRUE
;

1143 
	}
}

1148 
	$edôobj_døw_edô_obj
(
ds1_idx
)

1150 
WIN_EDT_OBJ_S
 * 
±r_w
 = & 
glb_ds1
[
ds1_idx
].
wö_edt_obj
;

1151 
OBJ_DESC_S
 * 
±r_d
=
NULL
;

1152 
EDT_BUT_S
 * 
b
;

1153 
x1
, 
x2
, 
y1
, 
y2
, 
x
, 
y
, 
d
, 
löe
, 
bg_cﬁ‹
, 
c
, 
i
, 
size
;

1154 * 
möus_tmp
, 
tmp
[150];

1157 
size
 = 
glb_ds1edô
.
obj_buff
->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJ
, "Description")].size + 1;

1158 
möus_tmp
 = (*Ë
	`mÆloc
(
size
);

1159 i‡(
möus_tmp
 =
NULL
)

1161 
	`•rötf
(
tmp
, "edôobj_døw_edô_obj(Ë: c™'àÆloˇã %òbyãs", 
size
);

1162 
	`ds1edô_îr‹
(
tmp
);

1165 
x1
 = 
±r_w
->
x0
;

1166 
y1
 = 
±r_w
->
y0
;

1167 
x2
 = 
x1
 + 
±r_w
->
w
;

1168 
y2
 = 
y1
 + 
±r_w
->
h
;

1169 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 0);

1170 
	`ª˘
 (
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 255);

1172 
i
=0; i < 
EB_MAX
; i++)

1174 
b
 = & 
±r_w
->
buâ⁄
[
i
];

1175 
x1
 = 
b
->
box
.x1;

1176 
y1
 = 
b
->
box
.y1;

1177 
x2
 = 
b
->
box
.x2;

1178 
y2
 = 
b
->
box
.y2;

1179 
x
 = 
b
->
txt
.x;

1180 
y
 = 
b
->
txt
.y;

1181 i‡(
	`IS_ACTIVATED
(
b
->
Êags
))

1183 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 129);

1184 i‡(
	`IS_SELECTED
(
b
->
Êags
))

1186 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
+2, 
y1
+2, 
x2
-2, 
y2
-2, 116);

1187 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x
+1, 
y
 + 1, 0, 
b
->
«me
);

1189 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x
, 
y
, 132, 
b
->
«me
);

1193 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 186);

1194 i‡(
	`IS_SELECTED
(
b
->
Êags
))

1196 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
+2, 
y1
+2, 
x2
-2, 
y2
-2, 209);

1197 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x
+1, 
y
 + 1, 0, 
b
->
«me
);

1199 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x
, 
y
, 214, 
b
->
«me
);

1203 
x1
 = 
±r_w
->
x0
 + (8 * 2);

1204 
y1
 = 
±r_w
->
y0
 + 69;

1205 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x1
, 
y1
, 11, "Type");

1207 
x1
 += 8 * 5;

1208 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x1
, 
y1
, 255, " Id");

1209 
x1
 += 8 * 4;

1210 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x1
, 
y1
, 255, " Description");

1212 
x1
 = 
±r_w
->
x0
 + (8 * 2);

1213 
y1
 += 10;

1214 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x1
, 
y1
, 210, "---- --- -----------");

1216 
	`°r˝y
(
möus_tmp
, "");

1217 
c
=0; c < 
±r_w
->
desc_ch¨
 - 11; c++)

1218 
	`°rˇt
(
möus_tmp
, "-");

1219 
x1
 += 20 * 8;

1220 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x1
, 
y1
, 210, "%s", 
möus_tmp
);

1223 
löe
=0;Üöê< 
±r_w
->
num
;Üine++)

1225 
x1
 = 
±r_w
->
x0
 + (8 * 2);

1226 
y1
 += 10;

1227 
d
 = 
±r_w
->
°¨t
 + 
löe
;

1228 i‡–(
d
 >0Ë&& (d < 
glb_ds1edô
.
obj_desc_num
) &&

1229 (
d
 >
±r_w
->
desc_°¨t
Ë&& (d <±r_w->
desc_íd
)

1232 i‡(
d
 =
±r_w
->
desc_cur
)

1233 
bg_cﬁ‹
 = 121;

1234 i‡(
d
 =
±r_w
->
cur
)

1235 
bg_cﬁ‹
 = 71;

1236 i‡(
löe
 % 2)

1237 
bg_cﬁ‹
 = 1;

1239 
bg_cﬁ‹
 = 0;

1240 i‡(
bg_cﬁ‹
)

1241 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
±r_w
->
x0
+8, 
y1
-1,Öå_w->x0 +Öå_w->
w
 - 8, y1+8, 
bg_cﬁ‹
);

1243 
±r_d
 = & 
glb_ds1edô
.
obj_desc
[
d
];

1245 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x1
, 
y1
, 11, "%3i", 
±r_d
->
ty≥
);

1246 
x1
 += 8 * 5;

1247 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x1
, 
y1
, 255, "%3i", 
±r_d
->
id
);

1248 
x1
 += 8 * 4;

1249 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x1
, 
y1
, 255, " %s", 
±r_d
->
desc
);

1252 
x1
 = 
±r_w
->
x0
 + (8 * 2);

1253 
y1
 += 25;

1254 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x1
, 
y1
, 214, "(scroll down here)");

1256 
	`‰ì
(
möus_tmp
);

1257 
	}
}

1262 
	$edôobj_edô_obj
(
ds1_idx
, * 
edô_íd
, 
mx
, 
my
, 
mb
)

1264 
WIN_EDT_OBJ_S
 * 
±r_w
 = & 
glb_ds1
[
ds1_idx
].
wö_edt_obj
;

1265 
ªdøw
 = 
FALSE
, 
√w_cur
, 
íd
, 
w
, 
wtmp
;

1268 * 
edô_íd
 = 
FALSE
;

1271 i‡((
mx
 >
±r_w
->
buâ⁄
[
EB_OK
].
box
.
x1
) &&

1272 (
mx
 <
±r_w
->
buâ⁄
[
EB_OK
].
box
.
x2
) &&

1273 (
my
 >
±r_w
->
buâ⁄
[
EB_OK
].
box
.
y1
) &&

1274 (
my
 <
±r_w
->
buâ⁄
[
EB_OK
].
box
.
y2
)

1278 i‡(
mb
 & 1)

1280 
glb_ds1
[
ds1_idx
].
døw_edô_obj
 = 
FALSE
;

1281 
ªdøw
 = 
TRUE
;

1282 * 
edô_íd
 = 
TRUE
;

1283 
glb_ds1
[
ds1_idx
].
obj
[
±r_w
->
obj_idx
].
ty≥
 = 
glb_ds1edô
.
obj_desc
[±r_w->
desc_cur
].type;

1284 
glb_ds1
[
ds1_idx
].
obj
[
±r_w
->
obj_idx
].
id
 = 
glb_ds1edô
.
obj_desc
[±r_w->
desc_cur
].id;

1285 
glb_ds1
[
ds1_idx
].
obj
[
±r_w
->
obj_idx
].
desc_idx
 =Öå_w->
desc_cur
;

1286 
	`edôobj_make_obj_√w_id
(
ds1_idx
, 
±r_w
->
obj_idx
);

1287 
w
 = 16 * 8;

1288 i‡(
±r_w
->
desc_cur
 != -1)

1290 
wtmp
 = 8 * 
	`°æí
(
glb_ds1edô
.
obj_desc
[
±r_w
->
desc_cur
].
desc
);

1291 i‡(
wtmp
 > 
w
)

1292 
w
 = 
wtmp
;

1294 
glb_ds1
[
ds1_idx
].
obj
[
±r_w
->
obj_idx
].
œbñ
.
w
 = w;

1297 i‡(
key
[
KEY_ENTER
] || key[
KEY_ENTER_PAD
])

1300 
key
[
KEY_ENTER
] || key[
KEY_ENTER_PAD
])

1302 
glb_ds1
[
ds1_idx
].
døw_edô_obj
 = 
FALSE
;

1303 
ªdøw
 = 
TRUE
;

1304 * 
edô_íd
 = 
TRUE
;

1305 
glb_ds1
[
ds1_idx
].
obj
[
±r_w
->
obj_idx
].
ty≥
 = 
glb_ds1edô
.
obj_desc
[±r_w->
desc_cur
].type;

1306 
glb_ds1
[
ds1_idx
].
obj
[
±r_w
->
obj_idx
].
id
 = 
glb_ds1edô
.
obj_desc
[±r_w->
desc_cur
].id;

1307 
glb_ds1
[
ds1_idx
].
obj
[
±r_w
->
obj_idx
].
desc_idx
 =Öå_w->
desc_cur
;

1308 
	`edôobj_make_obj_√w_id
(
ds1_idx
, 
±r_w
->
obj_idx
);

1309 
w
 = 16 * 8;

1310 i‡(
±r_w
->
desc_cur
 != -1)

1312 
wtmp
 = 8 * 
	`°æí
(
glb_ds1edô
.
obj_desc
[
±r_w
->
desc_cur
].
desc
);

1313 i‡(
wtmp
 > 
w
)

1314 
w
 = 
wtmp
;

1316 
glb_ds1
[
ds1_idx
].
obj
[
±r_w
->
obj_idx
].
œbñ
.
w
 = w;

1318 i‡((
glb_c⁄fig
.
wöobj_s¸ﬁl_keyb
 =
FALSE
Ë&& 
key
[
KEY_UP
])

1321 
±r_w
->
°¨t
 -
glb_c⁄fig
.
s¸ﬁl
.
obj_edô
;

1322 i‡(
±r_w
->
°¨t
 <Öå_w->
desc_°¨t
)

1323 
±r_w
->
°¨t
 =Öå_w->
desc_°¨t
;

1324 
±r_w
->
cur
 = -1;

1325 
ªdøw
 = 
TRUE
;

1327 i‡((
glb_c⁄fig
.
wöobj_s¸ﬁl_keyb
 =
FALSE
Ë&& 
key
[
KEY_DOWN
])

1330 
±r_w
->
°¨t
 +
glb_c⁄fig
.
s¸ﬁl
.
obj_edô
;

1331 i‡–(
±r_w
->
°¨t
 +Öå_w->
num
 - 1Ë>Öå_w->
desc_íd
)

1332 
±r_w
->
°¨t
 =Öå_w->
desc_íd
 -Öå_w->
num
 + 1;

1333 i‡(
±r_w
->
°¨t
 <Öå_w->
desc_°¨t
)

1334 
±r_w
->
°¨t
 =Öå_w->
desc_°¨t
;

1335 
±r_w
->
cur
 = -1;

1336 
ªdøw
 = 
TRUE
;

1338 i‡((
mx
 >
±r_w
->
buâ⁄
[
EB_CANCEL
].
box
.
x1
) &&

1339 (
mx
 <
±r_w
->
buâ⁄
[
EB_CANCEL
].
box
.
x2
) &&

1340 (
my
 >
±r_w
->
buâ⁄
[
EB_CANCEL
].
box
.
y1
) &&

1341 (
my
 <
±r_w
->
buâ⁄
[
EB_CANCEL
].
box
.
y2
)

1345 i‡(
mb
 & 1)

1347 
glb_ds1
[
ds1_idx
].
døw_edô_obj
 = 
FALSE
;

1348 
ªdøw
 = 
TRUE
;

1349 * 
edô_íd
 = 
TRUE
;

1352 i‡((
mx
 >
±r_w
->
buâ⁄
[
EB_TYPE1
].
box
.
x1
) &&

1353 (
mx
 <
±r_w
->
buâ⁄
[
EB_TYPE1
].
box
.
x2
) &&

1354 (
my
 >
±r_w
->
buâ⁄
[
EB_TYPE1
].
box
.
y1
) &&

1355 (
my
 <
±r_w
->
buâ⁄
[
EB_TYPE1
].
box
.
y2
)

1359 i‡(
mb
 & 1)

1361 
mou£_b
 & 1)

1365 i‡(
±r_w
->
cur_ty≥
 != 1)

1366 
±r_w
->
cur_a˘
 = 
glb_ds1
[
ds1_idx
].
a˘
;

1367 
±r_w
->
cur_ty≥
 = 1;

1368 
	`edôobj_¥ï¨e_edô_obj_wö
(
ds1_idx
, 
±r_w
->
obj_idx
);

1369 
ªdøw
 = 
TRUE
;

1372 i‡((
mx
 >
±r_w
->
buâ⁄
[
EB_TYPE2
].
box
.
x1
) &&

1373 (
mx
 <
±r_w
->
buâ⁄
[
EB_TYPE2
].
box
.
x2
) &&

1374 (
my
 >
±r_w
->
buâ⁄
[
EB_TYPE2
].
box
.
y1
) &&

1375 (
my
 <
±r_w
->
buâ⁄
[
EB_TYPE2
].
box
.
y2
)

1379 i‡(
mb
 & 1)

1381 
mou£_b
 & 1)

1385 
±r_w
->
cur_ty≥
 = 2;

1386 
±r_w
->
cur_a˘
 = 
glb_ds1
[
ds1_idx
].
a˘
;

1387 
	`edôobj_¥ï¨e_edô_obj_wö
(
ds1_idx
, 
±r_w
->
obj_idx
);

1388 
ªdøw
 = 
TRUE
;

1391 i‡((
mx
 >
±r_w
->
buâ⁄
[
EB_ACT1
].
box
.
x1
) &&

1392 (
mx
 <
±r_w
->
buâ⁄
[
EB_ACT1
].
box
.
x2
) &&

1393 (
my
 >
±r_w
->
buâ⁄
[
EB_ACT1
].
box
.
y1
) &&

1394 (
my
 <
±r_w
->
buâ⁄
[
EB_ACT1
].
box
.
y2
)

1398 i‡((
mb
 & 1Ë&& (
	`IS_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_ACT1
].
Êags
)))

1400 
mou£_b
 & 1)

1404 
±r_w
->
cur_a˘
 = 1;

1405 
	`edôobj_¥ï¨e_edô_obj_wö
(
ds1_idx
, 
±r_w
->
obj_idx
);

1406 
ªdøw
 = 
TRUE
;

1409 i‡((
mx
 >
±r_w
->
buâ⁄
[
EB_ACT2
].
box
.
x1
) &&

1410 (
mx
 <
±r_w
->
buâ⁄
[
EB_ACT2
].
box
.
x2
) &&

1411 (
my
 >
±r_w
->
buâ⁄
[
EB_ACT2
].
box
.
y1
) &&

1412 (
my
 <
±r_w
->
buâ⁄
[
EB_ACT2
].
box
.
y2
)

1416 i‡((
mb
 & 1Ë&& (
	`IS_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_ACT2
].
Êags
)))

1418 
mou£_b
 & 1)

1422 
±r_w
->
cur_a˘
 = 2;

1423 
	`edôobj_¥ï¨e_edô_obj_wö
(
ds1_idx
, 
±r_w
->
obj_idx
);

1424 
ªdøw
 = 
TRUE
;

1427 i‡((
mx
 >
±r_w
->
buâ⁄
[
EB_ACT3
].
box
.
x1
) &&

1428 (
mx
 <
±r_w
->
buâ⁄
[
EB_ACT3
].
box
.
x2
) &&

1429 (
my
 >
±r_w
->
buâ⁄
[
EB_ACT3
].
box
.
y1
) &&

1430 (
my
 <
±r_w
->
buâ⁄
[
EB_ACT3
].
box
.
y2
)

1434 i‡((
mb
 & 1Ë&& (
	`IS_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_ACT3
].
Êags
)))

1436 
mou£_b
 & 1)

1440 
±r_w
->
cur_a˘
 = 3;

1441 
	`edôobj_¥ï¨e_edô_obj_wö
(
ds1_idx
, 
±r_w
->
obj_idx
);

1442 
ªdøw
 = 
TRUE
;

1445 i‡((
mx
 >
±r_w
->
buâ⁄
[
EB_ACT4
].
box
.
x1
) &&

1446 (
mx
 <
±r_w
->
buâ⁄
[
EB_ACT4
].
box
.
x2
) &&

1447 (
my
 >
±r_w
->
buâ⁄
[
EB_ACT4
].
box
.
y1
) &&

1448 (
my
 <
±r_w
->
buâ⁄
[
EB_ACT4
].
box
.
y2
)

1452 i‡((
mb
 & 1Ë&& (
	`IS_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_ACT4
].
Êags
)))

1454 
mou£_b
 & 1)

1458 
±r_w
->
cur_a˘
 = 4;

1459 
	`edôobj_¥ï¨e_edô_obj_wö
(
ds1_idx
, 
±r_w
->
obj_idx
);

1460 
ªdøw
 = 
TRUE
;

1463 i‡((
mx
 >
±r_w
->
buâ⁄
[
EB_ACT5
].
box
.
x1
) &&

1464 (
mx
 <
±r_w
->
buâ⁄
[
EB_ACT5
].
box
.
x2
) &&

1465 (
my
 >
±r_w
->
buâ⁄
[
EB_ACT5
].
box
.
y1
) &&

1466 (
my
 <
±r_w
->
buâ⁄
[
EB_ACT5
].
box
.
y2
)

1470 i‡((
mb
 & 1Ë&& (
	`IS_ACTIVATED
(
±r_w
->
buâ⁄
[
EB_ACT5
].
Êags
)))

1472 
mou£_b
 & 1)

1476 
±r_w
->
cur_a˘
 = 5;

1477 
	`edôobj_¥ï¨e_edô_obj_wö
(
ds1_idx
, 
±r_w
->
obj_idx
);

1478 
ªdøw
 = 
TRUE
;

1483 
√w_cur
 = (
my
 - 
±r_w
->
y0
 - 69 - (2 * 10)) / 10;

1484 
√w_cur
 +
±r_w
->
°¨t
;

1485 i‡–(
mx
 >
±r_w
->
x0
Ë&& (mx < (±r_w->x0 +Öå_w->
w
)) &&

1486 (
my
 >
±r_w
->
x0
Ë&& (my < (±r_w->
y0
 +Öå_w->
h
))

1491 
íd
 = 
±r_w
->
°¨t
 +Öå_w->
num
 - 1;

1492 i‡((
√w_cur
 < 
±r_w
->
°¨t
Ë&& (±r_w->°¨à>Öå_w->
desc_°¨t
))

1495 
±r_w
->
°¨t
 -
glb_c⁄fig
.
s¸ﬁl
.
obj_edô
;

1496 i‡(
±r_w
->
°¨t
 <Öå_w->
desc_°¨t
)

1497 
±r_w
->
°¨t
 =Öå_w->
desc_°¨t
;

1498 
±r_w
->
cur
 = -1;

1499 
ªdøw
 = 
TRUE
;

1501 i‡((
√w_cur
 > 
íd
Ë&& (íd < 
±r_w
->
desc_íd
))

1504 
±r_w
->
°¨t
 +
glb_c⁄fig
.
s¸ﬁl
.
obj_edô
;

1505 i‡–(
±r_w
->
°¨t
 +Öå_w->
num
 - 1Ë>Öå_w->
desc_íd
)

1506 
±r_w
->
°¨t
 =Öå_w->
desc_íd
 -Öå_w->
num
 + 1;

1507 i‡(
±r_w
->
°¨t
 <Öå_w->
desc_°¨t
)

1508 
±r_w
->
°¨t
 =Öå_w->
desc_°¨t
;

1509 
±r_w
->
cur
 = -1;

1510 
ªdøw
 = 
TRUE
;

1516 i‡(
√w_cur
 !
±r_w
->
cur
)

1519 
±r_w
->
cur
 = 
√w_cur
;

1520 
ªdøw
 = 
TRUE
;

1523 i‡(
mb
 & 1)

1525 i‡–(
√w_cur
 !
±r_w
->
desc_cur
) &&

1526 (
√w_cur
 >
±r_w
->
desc_°¨t
) &&

1527 (
√w_cur
 <
±r_w
->
desc_íd
)

1531 
±r_w
->
desc_cur
 = 
√w_cur
;

1532 
ªdøw
 = 
TRUE
;

1540 i‡(
±r_w
->
cur
 != -1)

1542 
±r_w
->
cur
 = -1;

1543 
ªdøw
 = 
TRUE
;

1548  
ªdøw
;

1549 
	}
}

1556 
	$edôobj_idítiˇl_obj_√w
(
ds1_idx
, 
o
)

1558 
i
;

1562 
i
=0; i < 
glb_ds1
[
ds1_idx
].
obj_num
; i++)

1565 i‡(
glb_ds1
[
ds1_idx
].
obj
[
i
].
desc_idx
 =glb_ds1[ds1_idx].obj[
o
].desc_idx)

1568 
	`SET_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
i
].
Êags
);

1571 
	}
}

1577 
	$edôobj_idítiˇl_obj_add
(
ds1_idx
, 
o
)

1579 
√ed_ªdøw
 = 
FALSE
, 
i
;

1583 
i
=0; i < 
glb_ds1
[
ds1_idx
].
obj_num
; i++)

1586 i‡(
glb_ds1
[
ds1_idx
].
obj
[
i
].
desc_idx
 =glb_ds1[ds1_idx].obj[
o
].desc_idx)

1589 i‡–! 
	`IS_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
i
].
Êags
))

1592 
	`SET_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
i
].
Êags
);

1593 
√ed_ªdøw
 = 
TRUE
;

1597  
√ed_ªdøw
;

1598 
	}
}

1604 
	$edôobj_idítiˇl_obj_dñ
(
ds1_idx
, 
o
)

1606 
√ed_ªdøw
 = 
FALSE
, 
i
;

1610 
i
=0; i < 
glb_ds1
[
ds1_idx
].
obj_num
; i++)

1613 i‡(
glb_ds1
[
ds1_idx
].
obj
[
i
].
desc_idx
 =glb_ds1[ds1_idx].obj[
o
].desc_idx)

1616 i‡(
	`IS_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
i
].
Êags
))

1619 
	`DEL_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
i
].
Êags
);

1620 
√ed_ªdøw
 = 
TRUE
;

1624  
√ed_ªdøw
;

1625 
	}
}

1632 
	$edôobj_idítiˇl_œb_√w
(
ds1_idx
, 
o
)

1634 
i
;

1638 
i
=0; i < 
glb_ds1
[
ds1_idx
].
obj_num
; i++)

1641 i‡(
glb_ds1
[
ds1_idx
].
obj
[
i
].
desc_idx
 =glb_ds1[ds1_idx].obj[
o
].desc_idx)

1644 
	`SET_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
i
].
œbñ
.
Êags
);

1647 
	}
}

1653 
	$edôobj_idítiˇl_œb_add
(
ds1_idx
, 
o
)

1655 
√ed_ªdøw
 = 
FALSE
, 
i
;

1659 
i
=0; i < 
glb_ds1
[
ds1_idx
].
obj_num
; i++)

1662 i‡(
glb_ds1
[
ds1_idx
].
obj
[
i
].
desc_idx
 =glb_ds1[ds1_idx].obj[
o
].desc_idx)

1665 i‡–! 
	`IS_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
i
].
œbñ
.
Êags
))

1668 
	`SET_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
i
].
œbñ
.
Êags
);

1669 
√ed_ªdøw
 = 
TRUE
;

1673  
√ed_ªdøw
;

1674 
	}
}

1680 
	$edôobj_idítiˇl_œb_dñ
(
ds1_idx
, 
o
)

1682 
√ed_ªdøw
 = 
FALSE
, 
i
;

1686 
i
=0; i < 
glb_ds1
[
ds1_idx
].
obj_num
; i++)

1689 i‡(
glb_ds1
[
ds1_idx
].
obj
[
i
].
desc_idx
 =glb_ds1[ds1_idx].obj[
o
].desc_idx)

1692 i‡(
	`IS_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
i
].
œbñ
.
Êags
))

1695 
	`DEL_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
i
].
œbñ
.
Êags
);

1696 
√ed_ªdøw
 = 
TRUE
;

1700  
√ed_ªdøw
;

1701 
	}
}

1706 
	$edôobj_h™dÀr
(
ds1_idx
, 
cx
, 
cy
, 
mx
, 
my
, 
mb
)

1708 
ﬁd_ds1_idx
 = -1, 
ﬁd_t
, 
ﬁd_o
, 
cur_ty≥
;

1709 íum {
OM_NONE
, 
OM_NEW
, 
OM_ADD
, 
OM_DEL
, 
OM_MOV
, 
OM_EDT
, 
OM_INS
} 
ﬁd_mode
;

1710 
t
=0, 
o
=0, 
ªdøw
 = 
FALSE
;

1711 
°¨t_cx
, 
°¨t_cy
, 
°¨t_mx
, 
°¨t_my
;

1712 
dif_cx
=0, 
dif_cy
=0, 
dif_mx
=0, 
dif_my
=0;

1713 
hm
 = 
glb_ds1
[
ds1_idx
].
height_mul
;

1714 
hd
 = 
glb_ds1
[
ds1_idx
].
height_div
;

1715 
edô_íd
=0;

1716 
i
;

1719 
ﬁd_t
, 
ﬁd_o
, 
cur_ty≥
;

1720 
ﬁd_mode
;

1721 
t
, 
o
;

1722 
°¨t_cx
, 
°¨t_cy
, 
°¨t_mx
, 
°¨t_my
;

1723 
dif_cx
, 
dif_cy
, 
dif_mx
, 
dif_my
;

1724 
edô_íd
;

1725 } 
backup
[
DS1_MAX
];

1729 i‡(
ds1_idx
 !
ﬁd_ds1_idx
)

1732 i‡(
ﬁd_ds1_idx
 == -1)

1734 
i
=0; i<
DS1_MAX
; i++)

1736 
backup
[
i
].
ﬁd_t
 = -1;

1737 
backup
[
i
].
ﬁd_o
 = -1;

1738 
backup
[
i
].
cur_ty≥
 = 0;

1739 
backup
[
i
].
ﬁd_mode
 = 
OM_NONE
;

1741 
t
 = 
o
 = 
dif_cx
 = 
dif_cy
 = 
dif_mx
 = 
dif_my
 = 
edô_íd
 = -1;

1745 i‡(
ﬁd_ds1_idx
 != -1)

1747 
backup
[
ﬁd_ds1_idx
].
ﬁd_t
 = old_t;

1748 
backup
[
ﬁd_ds1_idx
].
ﬁd_o
 = old_o;

1749 
backup
[
ﬁd_ds1_idx
].
cur_ty≥
 = cur_type;

1750 
backup
[
ﬁd_ds1_idx
].
ﬁd_mode
 = old_mode;

1751 
backup
[
ﬁd_ds1_idx
].
t
 =Å;

1752 
backup
[
ﬁd_ds1_idx
].
o
 = o;

1753 
backup
[
ﬁd_ds1_idx
].
°¨t_cx
 = start_cx;

1754 
backup
[
ﬁd_ds1_idx
].
°¨t_cy
 = start_cy;

1755 
backup
[
ﬁd_ds1_idx
].
°¨t_mx
 = start_mx;

1756 
backup
[
ﬁd_ds1_idx
].
°¨t_my
 = start_my;

1757 
backup
[
ﬁd_ds1_idx
].
dif_cx
 = dif_cx;

1758 
backup
[
ﬁd_ds1_idx
].
dif_cy
 = dif_cy;

1759 
backup
[
ﬁd_ds1_idx
].
dif_mx
 = dif_mx;

1760 
backup
[
ﬁd_ds1_idx
].
dif_my
 = dif_my;

1761 
backup
[
ﬁd_ds1_idx
].
edô_íd
 =Édit_end;

1765 
ﬁd_t
 = 
backup
[
ds1_idx
].old_t;

1766 
ﬁd_o
 = 
backup
[
ds1_idx
].old_o;

1767 
cur_ty≥
 = 
backup
[
ds1_idx
].cur_type;

1768 
ﬁd_mode
 = 
backup
[
ds1_idx
].old_mode;

1769 
t
 = 
backup
[
ds1_idx
].t;

1770 
o
 = 
backup
[
ds1_idx
].o;

1771 
°¨t_cx
 = 
backup
[
ds1_idx
].start_cx;

1772 
°¨t_cy
 = 
backup
[
ds1_idx
].start_cy;

1773 
°¨t_mx
 = 
backup
[
ds1_idx
].start_mx;

1774 
°¨t_my
 = 
backup
[
ds1_idx
].start_my;

1775 
dif_cx
 = 
backup
[
ds1_idx
].dif_cx;

1776 
dif_cy
 = 
backup
[
ds1_idx
].dif_cy;

1777 
dif_mx
 = 
backup
[
ds1_idx
].dif_mx;

1778 
dif_my
 = 
backup
[
ds1_idx
].dif_my;

1779 
edô_íd
 = 
backup
[
ds1_idx
].edit_end;

1782 
ﬁd_ds1_idx
 = 
ds1_idx
;

1785 i‡(
ﬁd_mode
 =
OM_EDT
)

1788 i‡(
	`edôobj_edô_obj
(
ds1_idx
, & 
edô_íd
, 
mx
, 
my
, 
mb
))

1789 
ªdøw
 = 
TRUE
;

1791 i‡(
edô_íd
)

1793 
ﬁd_mode
 = 
OM_NONE
;

1794 
mou£_b
 & 1)

1798 
	`™im_upd©e_gfx
(
FALSE
);

1801 i‡(
ﬁd_mode
 !
OM_MOV
)

1805 i‡(
	`edôobj_ovî_obj_œb
(
ds1_idx
, & 
t
, & 
o
, 
cx
, 
cy
, 
mx
, 
my
))

1806 
ªdøw
 = 
TRUE
;

1808 i‡(
mb
 & 1)

1812 i‡(
key
[
KEY_ALT
] || key[
KEY_ALTGR
])

1814 i‡(
o
 != -1)

1817 
°¨t_cx
 = 
cx
;

1818 
°¨t_cy
 = 
cy
;

1819 
°¨t_mx
 = (
mx
 + 
glb_ds1edô
.
wö_¥evõw
.
x0
Ë* 
hd
 / 
hm
;

1820 
°¨t_my
 = (
my
 + 
glb_ds1edô
.
wö_¥evõw
.
y0
Ë* 
hd
 / 
hm
;

1822 i‡((
cur_ty≥
 =1Ë&& (
t
 == 1))

1824 i‡(
	`IS_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
o
].
œbñ
.
Êags
))

1826 
	`edôobj_¥ï¨e_undo
(
ds1_idx
);

1827 
	`edôobj_¥ï¨e_movög
(
ds1_idx
);

1828 
ﬁd_mode
 = 
OM_MOV
;

1829 
mou£_b
 & 1)

1835 i‡((
cur_ty≥
 =2Ë&& (
t
 == 2))

1837 i‡(
	`IS_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
o
].
Êags
))

1839 
	`edôobj_¥ï¨e_undo
(
ds1_idx
);

1840 
	`edôobj_¥ï¨e_movög
(
ds1_idx
);

1841 
ﬁd_mode
 = 
OM_MOV
;

1842 
mou£_b
 & 1)

1850 i‡(
key
[
KEY_LSHIFT
] || key[
KEY_RSHIFT
])

1853 i‡((
cur_ty≥
 =0Ë|| (
t
 == cur_type))

1855 
cur_ty≥
 = 
t
;

1856 i‡(
o
 != -1)

1858 i‡(
t
 == 1)

1861 i‡(
key
[
KEY_I
])

1864 i‡(
	`edôobj_idítiˇl_œb_add
(
ds1_idx
, 
o
))

1867 
ªdøw
 = 
TRUE
;

1868 
ﬁd_mode
 = 
OM_ADD
;

1869 
ﬁd_o
 = 
o
;

1870 
ﬁd_t
 = 
t
;

1873 i‡–! 
	`IS_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
o
].
œbñ
.
Êags
))

1875 
	`SET_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
o
].
œbñ
.
Êags
);

1876 
ªdøw
 = 
TRUE
;

1877 
ﬁd_mode
 = 
OM_ADD
;

1878 
ﬁd_o
 = 
o
;

1879 
ﬁd_t
 = 
t
;

1885 i‡(
key
[
KEY_I
])

1888 i‡(
	`edôobj_idítiˇl_obj_add
(
ds1_idx
, 
o
))

1891 
ªdøw
 = 
TRUE
;

1892 
ﬁd_mode
 = 
OM_ADD
;

1893 
ﬁd_o
 = 
o
;

1894 
ﬁd_t
 = 
t
;

1897 i‡–! 
	`IS_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
o
].
Êags
))

1899 
	`SET_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
o
].
Êags
);

1900 
ªdøw
 = 
TRUE
;

1901 
ﬁd_mode
 = 
OM_ADD
;

1902 
ﬁd_o
 = 
o
;

1903 
ﬁd_t
 = 
t
;

1909 i‡(
key
[
KEY_LCONTROL
] || key[
KEY_RCONTROL
])

1912 i‡(
o
 != -1)

1914 i‡((
ﬁd_t
 =1Ë&& (
t
 == 1))

1917 i‡(
key
[
KEY_I
])

1920 i‡(
	`edôobj_idítiˇl_œb_dñ
(
ds1_idx
, 
o
))

1923 
ªdøw
 = 
TRUE
;

1924 
ﬁd_o
 = 
o
;

1925 
ﬁd_mode
 = 
OM_DEL
;

1928 i‡(
	`IS_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
o
].
œbñ
.
Êags
))

1930 
	`DEL_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
o
].
œbñ
.
Êags
);

1931 
ªdøw
 = 
TRUE
;

1932 
ﬁd_o
 = 
o
;

1933 
ﬁd_mode
 = 
OM_DEL
;

1936 i‡((
ﬁd_t
 =2Ë&& (
t
 == 2))

1939 i‡(
key
[
KEY_I
])

1942 i‡(
	`edôobj_idítiˇl_obj_dñ
(
ds1_idx
, 
o
))

1945 
ªdøw
 = 
TRUE
;

1946 
ﬁd_o
 = 
o
;

1947 
ﬁd_mode
 = 
OM_DEL
;

1950 i‡(
	`IS_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
o
].
Êags
))

1952 
	`DEL_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
o
].
Êags
);

1953 
ªdøw
 = 
TRUE
;

1954 
ﬁd_o
 = 
o
;

1955 
ﬁd_mode
 = 
OM_DEL
;

1964 i‡((
ﬁd_o
 !
o
Ë|| (
ﬁd_t
 !
t
Ë|| (
ﬁd_mode
 !
OM_NEW
))

1966 
ﬁd_t
 = 
t
;

1967 
cur_ty≥
 = 
t
;

1968 
ﬁd_o
 = 
o
;

1969 
ﬁd_mode
 = 
OM_NEW
;

1970 
ªdøw
 = 
TRUE
;

1971 
	`edôobj_˛ór_obj_œb_£l
(
ds1_idx
);

1972 i‡(
o
 != -1)

1974 i‡(
t
 == 1)

1977 i‡(
key
[
KEY_I
])

1978 
	`edôobj_idítiˇl_œb_√w
(
ds1_idx
, 
o
);

1982 
	`SET_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
o
].
œbñ
.
Êags
);

1988 i‡(
key
[
KEY_I
])

1991 
	`edôobj_idítiˇl_obj_√w
(
ds1_idx
, 
o
);

1996 
	`SET_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
o
].
Êags
);

2001 
cur_ty≥
 = 0;

2006 
	`edô∑th_£¨ch_£À˘ed_obj
(
ds1_idx
);

2008 i‡(
mb
 & 2)

2010 i‡(
o
 != -1)

2014 
	`edôobj_¥ï¨e_undo
(
ds1_idx
);

2016 i‡(
glb_ds1
[
ds1_idx
].
obj
[
o
].
desc_idx
 == -1)

2018 
glb_ds1
[
ds1_idx
].
wö_edt_obj
.
°¨t_a˘
 =

2019 
glb_ds1
[
ds1_idx
].
wö_edt_obj
.
cur_a˘
 =

2020 
glb_ds1
[
ds1_idx
].
a˘
;

2022 
glb_ds1
[
ds1_idx
].
wö_edt_obj
.
cur_ty≥
 = glb_ds1[ds1_idx].
obj
[
o
].
ty≥
;

2026 
glb_ds1
[
ds1_idx
].
wö_edt_obj
.
°¨t_a˘
 =

2027 
glb_ds1
[
ds1_idx
].
wö_edt_obj
.
cur_a˘
 =

2028 
glb_ds1edô
.
obj_desc
[
glb_ds1
[
ds1_idx
].
obj
[
o
].
desc_idx
].
a˘
;

2030 
glb_ds1
[
ds1_idx
].
wö_edt_obj
.
cur_ty≥
 =

2031 
glb_ds1edô
.
obj_desc
[
glb_ds1
[
ds1_idx
].
obj
[
o
].
desc_idx
].
ty≥
;

2035 
glb_ds1
[
ds1_idx
].
wö_edt_obj
.
desc_cur
 = glb_ds1[ds1_idx].
obj
[
o
].
desc_idx
;

2037 
	`edôobj_¥ï¨e_edô_obj_wö
(
ds1_idx
, 
o
);

2038 
ﬁd_mode
 = 
OM_EDT
;

2040 
ªdøw
 = 
TRUE
;

2047 i‡(
key
[
KEY_DEL
] || key[
KEY_DEL_PAD
])

2050 
key
[
KEY_DEL
] || key[
KEY_DEL_PAD
])

2054 
	`edôobj_¥ï¨e_undo
(
ds1_idx
);

2055 
	`edôobj_dñ_obj
(
ds1_idx
);

2056 
ªdøw
 = 
TRUE
;

2057 
	`™im_upd©e_gfx
(
FALSE
);

2059 i‡(
key
[
KEY_U
] && (key[
KEY_LCONTROL
] || key[
KEY_RCONTROL
]))

2062 i‡(
glb_ds1
[
ds1_idx
].
ˇn_undo_obj
)

2064 
key
[
KEY_U
])

2068 
	`edôobj_undo
(
ds1_idx
);

2069 
ªdøw
 = 
TRUE
;

2071 
	`™im_upd©e_gfx
(
FALSE
);

2073 i‡(
key
[
KEY_C
] && (key[
KEY_LCONTROL
] || key[
KEY_RCONTROL
]))

2079 i‡(
	`edôobj_cou¡_£l_obj
(
ds1_idx
))

2081 
key
[
KEY_C
])

2085 
	`edôobj_¥ï¨e_undo
(
ds1_idx
);

2086 
	`edôobj_c›y_obj
(
ds1_idx
);

2087 
ﬁd_mode
 = 
OM_MOV
;

2088 
ªdøw
 = 
TRUE
;

2089 
°¨t_cx
 = 
cx
;

2090 
°¨t_cy
 = 
cy
;

2091 
°¨t_mx
 = (
mx
 + 
glb_ds1edô
.
wö_¥evõw
.
x0
Ë* 
hd
 / 
hm
;

2092 
°¨t_my
 = (
my
 + 
glb_ds1edô
.
wö_¥evõw
.
y0
Ë* 
hd
 / 
hm
;

2093 
	`edôobj_¥ï¨e_movög
(
ds1_idx
);

2096 i‡(
key
[
KEY_INSERT
])

2099 
key
[
KEY_INSERT
])

2101 
	`edôobj_¥ï¨e_undo
(
ds1_idx
);

2102 
	`edôobj_˛ór_obj_œb_£l
(
ds1_idx
);

2103 i‡(
	`edôobj_ö£π_obj
(
ds1_idx
, 
cx
, 
cy
) == 0)

2105 
ﬁd_mode
 = 
OM_INS
;

2106 
ªdøw
 = 
TRUE
;

2107 
	`™im_upd©e_gfx
(
FALSE
);

2116 i‡–! 
mb
 & 1)

2119 
dif_cx
 = 
cx
 - 
°¨t_cx
;

2120 
dif_cy
 = 
cy
 - 
°¨t_cy
;

2122 
dif_mx
 = ((
mx
 + 
glb_ds1edô
.
wö_¥evõw
.
x0
Ë* 
hd
 / 
hm
Ë- 
°¨t_mx
;

2123 
dif_my
 = ((
my
 + 
glb_ds1edô
.
wö_¥evõw
.
y0
Ë* 
hd
 / 
hm
Ë- 
°¨t_my
;

2125 i‡(
	`edôobj_movög_obj_œb
(
ds1_idx
, 
dif_cx
, 
dif_cy
, 
dif_mx
, 
dif_my
))

2126 
ªdøw
 = 
TRUE
;

2131 
	`edôobj_íd_move_obj_œb
(
ds1_idx
);

2132 
ﬁd_mode
 = 
OM_NONE
;

2133 
ªdøw
 = 
TRUE
;

2134 
mou£_b
 & 1)

2141 i‡(
ªdøw
)

2142 
	`edôobj_£t_døwög_‹dî
(
ds1_idx
);

2144  
ªdøw
;

2145 
	}
}

	@editobj.h

1 #i‚de‡
_EDITOBJ_H_


3 
	#_EDITOBJ_H_


	)

5 
edôobj_qs‹t_hñ≥r_døwög_‹dî
 (c⁄° * 
e1
, c⁄° * 
e2
);

6 
edôobj_£t_døwög_‹dî
 (
ds1_idx
);

7 
edôobj_make_obj_œbñ
 (
ds1_idx
);

8 
edôobj_døw_obj_œb
 (
ds1_idx
, 
is_shadow
);

9 
edôobj_make_obj_desc
 (
ds1_idx
, 
obj_idx
);

10 
edôobj_make_obj_√w_id
 (
ds1_idx
, 
obj_idx
);

11 
edôobj_˛ór_obj_œb_£l
 (
ds1_idx
);

12 
edôobj_˛ór_obj_œb_ovî
 (
ds1_idx
);

13 
edôobj_˛ór_obj_œb_Êags
 (
ds1_idx
);

14 
edôobj_ovî_obj_œb
 (
ds1_idx
, * 
±r_t
, * 
±r_o
, 
cx
, 
cy
, 
mx
, 
my
);

15 
edôobj_¥ï¨e_movög
 (
ds1_idx
);

16 
edôobj_movög_obj_œb
 (
ds1_idx
, 
dcx
, 
dcy
, 
dmx
, 
dmy
);

17 
edôobj_íd_move_obj_œb
 (
ds1_idx
);

18 
edôobj_¥ï¨e_undo
 (
ds1_idx
);

19 
edôobj_undo
 (
ds1_idx
);

20 
edôobj_dñ_obj
 (
ds1_idx
);

21 
edôobj_c›y_obj
 (
ds1_idx
);

24 
edôobj_cou¡_£l_obj
 (
ds1_idx
);

25 
edôobj_ö£π_obj
 (
ds1_idx
, 
cx
, 
cy
);

26 
edôobj_¥ï¨e_edô_obj_wö
 (
ds1_idx
, 
obj_idx
);

27 
edôobj_døw_edô_obj
 (
ds1_idx
);

28 
edôobj_edô_obj
 (
ds1_idx
, * 
edô_íd
, 
mx
, 
my
, 
mb
);

29 
edôobj_h™dÀr
 (
ds1_idx
, 
cx
, 
cy
, 
mx
, 
my
, 
mb
);

	@editpath.c

1 
	~"°ru˘s.h
"

2 
	~"edô∑th.h
"

3 
	~"misc.h
"

7 
	$edô∑th_mou£_ö
(
ds1_idx
, 
mx
, 
my
)

9 
PATH_EDIT_WIN_S
 * 
pwö
 = & 
glb_ds1
[
ds1_idx
].
∑th_edô_wö
;

12 i‡–(
mx
 >
pwö
->
x0
Ë&& (mx <pwö->x0 +Öwö->
w
 - 1) &&

13 (
my
 >
pwö
->
y0
Ë&& (my <pwö->y0 +Öwö->
h
 - 1))

14  
TRUE
;

16  
FALSE
;

17 
	}
}

21 
	$edô∑th_mou£_cmdbut_ö
(
ds1_idx
, 
mx
, 
my
)

23 
PATH_EDIT_WIN_S
 * 
pwö
 = & 
glb_ds1
[
ds1_idx
].
∑th_edô_wö
;

26 i‡–(
mx
 >
pwö
->
but_x0
Ë&& (mx <pwö->but_x0 +Öwö->
but_w
 - 1) &&

27 (
my
 >
pwö
->
but_y0
Ë&& (my <pwö->but_y0 +Öwö->
but_h
 - 1))

28  
TRUE
;

30  
FALSE
;

31 
	}
}

35 
	$edô∑th_öô
(
ds1_idx
)

37 
PATH_EDIT_WIN_S
 * 
pwö
 = & 
glb_ds1
[
ds1_idx
].
∑th_edô_wö
;

38 
i
;

41 
pwö
->
but_x0
 = 10;

42 
pwö
->
but_y0
 = 2 * 10;

43 
pwö
->
but_w
 = 49 * 8;

44 
pwö
->
but_h
 = 80;

46 
pwö
->
x0
 = 10;

47 
pwö
->
y0
 =Öwö->
but_y0
 +Öwö->
but_h
 + 10;

48 
pwö
->
w
 = 23 * 8;

49 
pwö
->
h
 = 
glb_c⁄fig
.
s¸ìn
.
height
 -Öwö->
y0
 - 20;

51 
pwö
->
c_bœck
 = 
	`makecﬁ
( 0, 0, 0);

52 
pwö
->
c_whôe
 = 
	`makecﬁ
(255, 255, 255);

53 
pwö
->
c_gªí
 = 
	`makecﬁ
( 0, 255, 0);

54 
pwö
->
c_d¨kgªí
 = 
	`makecﬁ
( 0, 128, 0);

55 
pwö
->
c_yñlow
 = 
	`makecﬁ
(255, 255, 0);

56 
pwö
->
c_gøy
 = 
	`makecﬁ
(128, 128, 128);

57 
pwö
->
c_d¨kgøy
 = 
	`makecﬁ
( 64, 64, 64);

60 
pwö
->
buâ⁄
[
PEB_OK
].
show
 = 
FALSE
;

61 
pwö
->
buâ⁄
[
PEB_OK
].
ãxt
 = "OK";

62 
pwö
->
buâ⁄
[
PEB_OK
].
ãxt_x0
 = 3 * 8 + 1;

63 
pwö
->
buâ⁄
[
PEB_OK
].
x0
 = 10;

64 
pwö
->
buâ⁄
[
PEB_OK
].
y0
 = 10;

65 
pwö
->
buâ⁄
[
PEB_OK
].
w
 = 8 * 8;

66 
pwö
->
buâ⁄
[
PEB_OK
].
h
 = 20;

67 
pwö
->
buâ⁄
[
PEB_OK
].
cﬁ_⁄
.
fg
 =Öwö->
c_bœck
;

68 
pwö
->
buâ⁄
[
PEB_OK
].
cﬁ_⁄
.
bg
 =Öwö->
c_d¨kgªí
;

69 
pwö
->
buâ⁄
[
PEB_OK
].
cﬁ_⁄
.
b‹dî
 =Öwö->
c_whôe
;

70 
pwö
->
buâ⁄
[
PEB_OK
].
cﬁ_off
.
fg
 =Öwö->
c_gªí
;

71 
pwö
->
buâ⁄
[
PEB_OK
].
cﬁ_off
.
bg
 =Öwö->
c_bœck
;

72 
pwö
->
buâ⁄
[
PEB_OK
].
cﬁ_off
.
b‹dî
 =Öwö->
c_gªí
;

75 
pwö
->
buâ⁄
[
PEB_CANCEL
].
show
 = 
FALSE
;

76 
pwö
->
buâ⁄
[
PEB_CANCEL
].
ãxt
 = "CANCEL";

77 
pwö
->
buâ⁄
[
PEB_CANCEL
].
ãxt_x0
 = 1 * 8 + 1;

78 
pwö
->
buâ⁄
[
PEB_CANCEL
].
x0
 = 80;

79 
pwö
->
buâ⁄
[
PEB_CANCEL
].
y0
 = 10;

80 
pwö
->
buâ⁄
[
PEB_CANCEL
].
w
 = 8 * 8;

81 
pwö
->
buâ⁄
[
PEB_CANCEL
].
h
 = 20;

82 
pwö
->
buâ⁄
[
PEB_CANCEL
].
cﬁ_⁄
.
fg
 =Öwö->
c_bœck
;

83 
pwö
->
buâ⁄
[
PEB_CANCEL
].
cﬁ_⁄
.
bg
 =Öwö->
c_d¨kgªí
;

84 
pwö
->
buâ⁄
[
PEB_CANCEL
].
cﬁ_⁄
.
b‹dî
 =Öwö->
c_whôe
;

85 
pwö
->
buâ⁄
[
PEB_CANCEL
].
cﬁ_off
.
fg
 =Öwö->
c_gªí
;

86 
pwö
->
buâ⁄
[
PEB_CANCEL
].
cﬁ_off
.
bg
 =Öwö->
c_bœck
;

87 
pwö
->
buâ⁄
[
PEB_CANCEL
].
cﬁ_off
.
b‹dî
 =Öwö->
c_gªí
;

90 
pwö
->
buâ⁄
[
PEB_ALLNEW
].
show
 = 
TRUE
;

91 
pwö
->
buâ⁄
[
PEB_ALLNEW
].
ãxt
 = "ALL NEW";

92 
pwö
->
buâ⁄
[
PEB_ALLNEW
].
ãxt_x0
 = 1 * 8 + 1;

93 
pwö
->
buâ⁄
[
PEB_ALLNEW
].
x0
 = 10;

94 
pwö
->
buâ⁄
[
PEB_ALLNEW
].
y0
 = 50;

95 
pwö
->
buâ⁄
[
PEB_ALLNEW
].
w
 = 9 * 8;

96 
pwö
->
buâ⁄
[
PEB_ALLNEW
].
h
 = 20;

97 
pwö
->
buâ⁄
[
PEB_ALLNEW
].
cﬁ_⁄
.
fg
 =Öwö->
c_bœck
;

98 
pwö
->
buâ⁄
[
PEB_ALLNEW
].
cﬁ_⁄
.
bg
 =Öwö->
c_d¨kgªí
;

99 
pwö
->
buâ⁄
[
PEB_ALLNEW
].
cﬁ_⁄
.
b‹dî
 =Öwö->
c_whôe
;

100 
pwö
->
buâ⁄
[
PEB_ALLNEW
].
cﬁ_off
.
fg
 =Öwö->
c_gªí
;

101 
pwö
->
buâ⁄
[
PEB_ALLNEW
].
cﬁ_off
.
bg
 =Öwö->
c_bœck
;

102 
pwö
->
buâ⁄
[
PEB_ALLNEW
].
cﬁ_off
.
b‹dî
 =Öwö->
c_gªí
;

105 
pwö
->
buâ⁄
[
PEB_STOP
].
show
 = 
FALSE
;

106 
pwö
->
buâ⁄
[
PEB_STOP
].
ãxt
 = "STOP";

107 
pwö
->
buâ⁄
[
PEB_STOP
].
ãxt_x0
 = 2 * 8 + 5;

108 
pwö
->
buâ⁄
[
PEB_STOP
].
x0
 = 10;

109 
pwö
->
buâ⁄
[
PEB_STOP
].
y0
 = 50;

110 
pwö
->
buâ⁄
[
PEB_STOP
].
w
 = 9 * 8;

111 
pwö
->
buâ⁄
[
PEB_STOP
].
h
 = 20;

112 
pwö
->
buâ⁄
[
PEB_STOP
].
cﬁ_⁄
.
fg
 =Öwö->
c_bœck
;

113 
pwö
->
buâ⁄
[
PEB_STOP
].
cﬁ_⁄
.
bg
 =Öwö->
c_d¨kgªí
;

114 
pwö
->
buâ⁄
[
PEB_STOP
].
cﬁ_⁄
.
b‹dî
 =Öwö->
c_whôe
;

115 
pwö
->
buâ⁄
[
PEB_STOP
].
cﬁ_off
.
fg
 =Öwö->
c_gªí
;

116 
pwö
->
buâ⁄
[
PEB_STOP
].
cﬁ_off
.
bg
 =Öwö->
c_bœck
;

117 
pwö
->
buâ⁄
[
PEB_STOP
].
cﬁ_off
.
b‹dî
 =Öwö->
c_gªí
;

120 
pwö
->
buâ⁄
[
PEB_SETACTION
].
show
 = 
TRUE
;

121 
pwö
->
buâ⁄
[
PEB_SETACTION
].
ãxt
 = "(Enter) SET ACTION";

122 
pwö
->
buâ⁄
[
PEB_SETACTION
].
ãxt_x0
 = 1 * 8 + 1;

123 
pwö
->
buâ⁄
[
PEB_SETACTION
].
x0
 = 160;

124 
pwö
->
buâ⁄
[
PEB_SETACTION
].
y0
 = 50;

125 
pwö
->
buâ⁄
[
PEB_SETACTION
].
w
 = 20 * 8 + 1;

126 
pwö
->
buâ⁄
[
PEB_SETACTION
].
h
 = 20;

127 
pwö
->
buâ⁄
[
PEB_SETACTION
].
cﬁ_⁄
.
fg
 =Öwö->
c_bœck
;

128 
pwö
->
buâ⁄
[
PEB_SETACTION
].
cﬁ_⁄
.
bg
 =Öwö->
c_d¨kgªí
;

129 
pwö
->
buâ⁄
[
PEB_SETACTION
].
cﬁ_⁄
.
b‹dî
 =Öwö->
c_whôe
;

130 
pwö
->
buâ⁄
[
PEB_SETACTION
].
cﬁ_off
.
fg
 =Öwö->
c_gªí
;

131 
pwö
->
buâ⁄
[
PEB_SETACTION
].
cﬁ_off
.
bg
 =Öwö->
c_bœck
;

132 
pwö
->
buâ⁄
[
PEB_SETACTION
].
cﬁ_off
.
b‹dî
 =Öwö->
c_gªí
;

134 i‡(
pwö
->
obj_idx
 == -1)

136 
i
=0; i < 
PEB_MAX
; i++)

138 i‡(
i
 !
PEB_SETACTION
)

139 
pwö
->
buâ⁄
[
i
].
show
 = 
FALSE
;

143 
pwö
->
cuº_a˘i⁄
 = 1;

144 
	}
}

148 
	$edô∑th_£¨ch_£À˘ed_obj
(
ds1_idx
)

150 
PATH_EDIT_WIN_S
 * 
pwö
 = & 
glb_ds1
[
ds1_idx
].
∑th_edô_wö
;

151 
OBJ_S
 * 
pobj
 = 
NULL
;

152 
o
, 
nb
=0, 
√w_obj_idx
=0, 
i
;

155 i‡(
glb_ds1
[
ds1_idx
].
∑th_edô_wö
.
obj_dúty
 !
FALSE
)

158 
o
=0; o < 
glb_ds1
[
ds1_idx
].
obj_num
; o++)

160 
pobj
 = & 
glb_ds1
[
ds1_idx
].
obj
[
o
];

161 i‡(
	`IS_SELECTED
(
pobj
->
Êags
Ë|| IS_SELECTED’obj->
œbñ
.flags))

163 
nb
++;

164 
√w_obj_idx
 = 
o
;

167 i‡(
nb
 == 1)

169 i‡(
pwö
->
obj_idx
 !
√w_obj_idx
)

171 
pwö
->
obj_idx
 = 
√w_obj_idx
;

172 
pobj
 = & 
glb_ds1
[
ds1_idx
].
obj
[
√w_obj_idx
];

173 
i
=0; i < 
WINDS1EDIT_PATH_MAX
; i++)

175 
pwö
->
∑th_c›y
[
i
].
x
 = 
pobj
->
∑th
[i].x;

176 
pwö
->
∑th_c›y
[
i
].
y
 = 
pobj
->
∑th
[i].y;

177 
pwö
->
∑th_c›y
[
i
].
a˘i⁄
 = 
pobj
->
∑th
[i].action;

179 
pwö
->
∑th_c›y_num
 = 
pobj
->
∑th_num
;

183 
pwö
->
buâ⁄
[
PEB_ALLNEW
].
show
 = 
TRUE
;

187 
pwö
->
obj_idx
 = -1;

188 
i
=0; i < 
PEB_MAX
; i++)

190 i‡(
i
 !
PEB_SETACTION
)

191 
pwö
->
buâ⁄
[
i
].
show
 = 
FALSE
;

194 
	}
}

198 
	$edô∑th_íãr_a˘i⁄
(
ds1_idx
, * 
∑˘i⁄
)

200 
PATH_EDIT_WIN_S
 * 
pwö
 = & 
glb_ds1
[
ds1_idx
].
∑th_edô_wö
;

201 
x1
, 
y1
, 
w
, 
h
, 
x2
, 
y2
,

202 
tx1
, 
ty1
, 
tx2
, 
ty2
, 
tw
, 
th
,

203 
d⁄e
, 
add_x
, 
nb_ch¨
;

204 
BITMAP
 * 
bmp
;

205 
lvÆue
 = 0;

206 
svÆue
[30];

211 
w
 = 200;

212 
h
 = 80;

213 
x1
 = (
glb_c⁄fig
.
s¸ìn
.
width
 - 
w
) / 2;

214 
y1
 = (
glb_c⁄fig
.
s¸ìn
.
height
 - 
h
) / 2;

215 
x2
 = 
x1
 + 
w
 - 1;

216 
y2
 = 
y1
 + 
h
 - 1;

218 
tw
 = 11 * 8 + 4;

219 
th
 = 16;

220 
tx1
 = 
x1
 + (
w
 - 
tw
) / 2;

221 
ty1
 = 
y1
 + 40;

222 
tx2
 = 
tx1
 + 
tw
 - 1;

223 
ty2
 = 
ty1
 + 
th
 - 1;

225 
nb_ch¨
 = 
	`°æí
(
	`…ﬂ
(
lvÆue
, 
svÆue
, 10));

228 
bmp
 = 
	`¸óã_bôm≠
(
w
, 
h
);

229 
	`blô
(
glb_ds1edô
.
s¸ìn_buff
, 
bmp
, 
x1
, 
y1
, 0, 0, 
w
, 
h
);

232 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 
pwö
->
c_bœck
);

233 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 
pwö
->
c_whôe
);

236 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, y1 + 18, 
pwö
->
c_gªí
);

237 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "Ty≥Çew ACTION vÆue", 
x1
 + 8, 
y1
+6, 
pwö
->
c_bœck
);

238 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, y1 + 18, 
pwö
->
c_whôe
);

241 
d⁄e
 = 
FALSE
;

242  ! 
d⁄e
)

244 i‡(
key
[
KEY_ENTER
] || key[
KEY_ENTER_PAD
])

246 
key
[
KEY_ENTER
] || key[
KEY_ENTER_PAD
])

248 
d⁄e
 = 
TRUE
;

249 * 
∑˘i⁄
 = 
lvÆue
;

251 i‡(
key
[
KEY_ESC
])

253 
key
[
KEY_ESC
])

255 
d⁄e
 = 
TRUE
;

257 i‡(
key
[
KEY_MINUS
] || key[
KEY_MINUS_PAD
] || key[
KEY_EQUALS
])

259 
key
[
KEY_MINUS
] || key[
KEY_MINUS_PAD
] || key[
KEY_EQUALS
])

261 
lvÆue
 = -lvalue;

263 i‡((
lvÆue
 >= -99999999) && (lvalue <= 99999999))

265 i‡(
key
[
KEY_1
] || key[
KEY_1_PAD
])

267 
key
[
KEY_1
] || key[
KEY_1_PAD
])

269 
lvÆue
 *= 10;

270 i‡(
lvÆue
 < 0)

271 
lvÆue
 -= 1;

273 
lvÆue
 += 1;

275 i‡(
key
[
KEY_2
] || key[
KEY_2_PAD
])

277 
key
[
KEY_2
] || key[
KEY_2_PAD
])

279 
lvÆue
 *= 10;

280 i‡(
lvÆue
 < 0)

281 
lvÆue
 -= 2;

283 
lvÆue
 += 2;

285 i‡(
key
[
KEY_3
] || key[
KEY_3_PAD
])

287 
key
[
KEY_3
] || key[
KEY_3_PAD
])

289 
lvÆue
 *= 10;

290 i‡(
lvÆue
 < 0)

291 
lvÆue
 -= 3;

293 
lvÆue
 += 3;

295 i‡(
key
[
KEY_4
] || key[
KEY_4_PAD
])

297 
key
[
KEY_4
] || key[
KEY_4_PAD
])

299 
lvÆue
 *= 10;

300 i‡(
lvÆue
 < 0)

301 
lvÆue
 -= 4;

303 
lvÆue
 += 4;

305 i‡(
key
[
KEY_5
] || key[
KEY_5_PAD
])

307 
key
[
KEY_5
] || key[
KEY_5_PAD
])

309 
lvÆue
 *= 10;

310 i‡(
lvÆue
 < 0)

311 
lvÆue
 -= 5;

313 
lvÆue
 += 5;

315 i‡(
key
[
KEY_6
] || key[
KEY_6_PAD
])

317 
key
[
KEY_6
] || key[
KEY_6_PAD
])

319 
lvÆue
 *= 10;

320 i‡(
lvÆue
 < 0)

321 
lvÆue
 -= 6;

323 
lvÆue
 += 6;

325 i‡(
key
[
KEY_7
] || key[
KEY_7_PAD
])

327 
key
[
KEY_7
] || key[
KEY_7_PAD
])

329 
lvÆue
 *= 10;

330 i‡(
lvÆue
 < 0)

331 
lvÆue
 -= 7;

333 
lvÆue
 += 7;

335 i‡(
key
[
KEY_8
] || key[
KEY_8_PAD
])

337 
key
[
KEY_8
] || key[
KEY_8_PAD
])

339 
lvÆue
 *= 10;

340 i‡(
lvÆue
 < 0)

341 
lvÆue
 -= 8;

343 
lvÆue
 += 8;

345 i‡(
key
[
KEY_9
] || key[
KEY_9_PAD
])

347 
key
[
KEY_9
] || key[
KEY_9_PAD
])

349 
lvÆue
 *= 10;

350 i‡(
lvÆue
 < 0)

351 
lvÆue
 -= 9;

353 
lvÆue
 += 9;

355 i‡(
key
[
KEY_0
] || key[
KEY_0_PAD
])

357 
key
[
KEY_0
] || key[
KEY_0_PAD
])

359 
lvÆue
 *= 10;

360 i‡(
lvÆue
 < 0)

361 
lvÆue
 -= 0;

363 
lvÆue
 += 0;

368 
nb_ch¨
 = 
	`°æí
(
	`…ﬂ
(
lvÆue
, 
svÆue
, 10));

369 
add_x
 = 2 + (11 - 
nb_ch¨
) * 8;

370 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
tx1
, 
ty1
, 
tx2
, 
ty2
, 
pwö
->
c_d¨kgøy
);

371 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
,

372 
tx1
 + 
add_x
,

373 
ty1
 + 4,

374 
pwö
->
c_whôe
,

376 
lvÆue


380 i‡–! 
d⁄e
)

382 
	`vsync
();

383 
	`blô
(
glb_ds1edô
.
s¸ìn_buff
, 
s¸ìn
, 
x1
, 
y1
, x1, y1, 
w
, 
h
);

388 
	`vsync
();

389 
	`blô
(
bmp
, 
s¸ìn
, 0, 0, 
x1
, 
y1
, 
w
, 
h
);

392 
	`de°roy_bôm≠
(
bmp
);

393 
	}
}

398 
	$edô∑th_døw
(
ds1_idx
, 
mx
, 
my
, 
mb
, 
tx
, 
ty
)

400 
PATH_EDIT_WIN_S
 * 
pwö
 = & 
glb_ds1
[
ds1_idx
].
∑th_edô_wö
;

401 
PATH_EDIT_BUT_S
 * 
pbut
 = 
NULL
;

402 
OBJ_S
 * 
pobj
 = 
NULL
;

403 
PATH_S
 * 
µ©h
 = 
NULL
;

404 
x1
, 
y1
, 
x2
, 
y2
, 
i
, 
d⁄e
, 
y
, 
xt
;

408 i‡(
pwö
->
w
 == 0)

409 
	`edô∑th_öô
(
ds1_idx
);

412 i‡(
pwö
->
obj_idx
 != -1)

413 
pobj
 = & 
glb_ds1
[
ds1_idx
].
obj
[
pwö
->
obj_idx
];

416 i‡(
pwö
->
mode
)

418 
pwö
->
mode
)

420 
PEM_NONE
 :

423 
PEM_ALLNEW
 :

424 i‡(
mb
 & 1)

426 i‡(
	`edô∑th_mou£_cmdbut_ö
(
ds1_idx
, 
mx
, 
my
Ë=
FALSE
)

428 i‡(
	`edô∑th_mou£_ö
(
ds1_idx
, 
mx
, 
my
Ë=
FALSE
)

431 
mou£_b
 & 1)

433 
mb
 = 0;

436 i‡(
pobj
->
∑th_num
 < 
WINDS1EDIT_PATH_MAX
)

438 
i
 = 
pobj
->
∑th_num
;

439 
pobj
->
∑th
[
i
].
x
 = 
tx
;

440 
pobj
->
∑th
[
i
].
y
 = 
ty
;

441 
pobj
->
∑th
[
i
].
a˘i⁄
 = 
pwö
->
cuº_a˘i⁄
;

442 
pobj
->
∑th
[
i
].
Êags
 = 0;

443 
pobj
->
∑th_num
++;

455 
x1
 = 
pwö
->
but_x0
;

456 
y1
 = 
pwö
->
but_y0
;

457 
x2
 = 
x1
 + 
pwö
->
but_w
;

458 
y2
 = 
y1
 + 
pwö
->
but_h
;

459 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 
pwö
->
c_bœck
);

460 i‡(
	`edô∑th_mou£_cmdbut_ö
(
ds1_idx
, 
mx
, 
my
))

461 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 
pwö
->
c_yñlow
);

463 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 
pwö
->
c_whôe
);

466 i‡(
mb
 & 1)

469 
mou£_b
 & 1)

471 
mb
 = 0;

474 
d⁄e
 = 
FALSE
;

475 
i
=0; (ò< 
PEB_MAX
Ë&& ! 
d⁄e
; i++)

477 
pbut
 = & 
pwö
->
buâ⁄
[
i
];

479 i‡(
pbut
->
show
 !
TRUE
)

482 
x1
 = 
pwö
->
but_x0
 + 
pbut
->
x0
;

483 
y1
 = 
pwö
->
but_y0
 + 
pbut
->
y0
;

484 
x2
 = 
x1
 + 
pbut
->
w
;

485 
y2
 = 
y1
 + 
pbut
->
h
;

487 i‡((
mx
 >
x1
Ë&& (mx <
x2
Ë&& (
my
 >
y1
Ë&& (my <
y2
))

489 
i
)

491 
PEB_OK
 :

494 
i
=0; i < 
WINDS1EDIT_PATH_MAX
; i++)

496 
pwö
->
∑th_c›y
[
i
].
x
 = 
pobj
->
∑th
[i].x;

497 
pwö
->
∑th_c›y
[
i
].
y
 = 
pobj
->
∑th
[i].y;

498 
pwö
->
∑th_c›y
[
i
].
a˘i⁄
 = 
pobj
->
∑th
[i].action;

500 
pwö
->
∑th_c›y_num
 = 
pobj
->
∑th_num
;

503 
pwö
->
buâ⁄
[
PEB_OK
].
show
 = 
FALSE
;

504 
pwö
->
buâ⁄
[
PEB_CANCEL
].
show
 = 
FALSE
;

505 
pwö
->
buâ⁄
[
PEB_ALLNEW
].
show
 = 
TRUE
;

506 
pwö
->
buâ⁄
[
PEB_STOP
].
show
 = 
FALSE
;

508 
d⁄e
 = 
TRUE
;

509 
pwö
->
mode
 = 
PEM_NONE
;

510 
pwö
->
obj_dúty
 = 
FALSE
;

513 
PEB_CANCEL
 :

515 
i
=0; i < 
WINDS1EDIT_PATH_MAX
; i++)

517 
pobj
->
∑th
[
i
].
x
 = 
pwö
->
∑th_c›y
[i].x;

518 
pobj
->
∑th
[
i
].
y
 = 
pwö
->
∑th_c›y
[i].y;

519 
pobj
->
∑th
[
i
].
a˘i⁄
 = 
pwö
->
∑th_c›y
[i].action;

520 
pobj
->
∑th
[
i
].
Êags
 = 0;

522 
pobj
->
∑th_num
 = 
pwö
->
∑th_c›y_num
;

525 
pwö
->
buâ⁄
[
PEB_OK
].
show
 = 
FALSE
;

526 
pwö
->
buâ⁄
[
PEB_CANCEL
].
show
 = 
FALSE
;

527 
pwö
->
buâ⁄
[
PEB_ALLNEW
].
show
 = 
TRUE
;

528 
pwö
->
buâ⁄
[
PEB_STOP
].
show
 = 
FALSE
;

530 
d⁄e
 = 
TRUE
;

531 
pwö
->
mode
 = 
PEM_NONE
;

532 
pwö
->
obj_dúty
 = 
FALSE
;

535 
PEB_ALLNEW
 :

537 
pwö
->
buâ⁄
[
PEB_OK
].
show
 = 
TRUE
;

538 
pwö
->
buâ⁄
[
PEB_CANCEL
].
show
 = 
TRUE
;

539 
pwö
->
buâ⁄
[
PEB_ALLNEW
].
show
 = 
FALSE
;

540 
pwö
->
buâ⁄
[
PEB_STOP
].
show
 = 
TRUE
;

542 
d⁄e
 = 
TRUE
;

543 
pwö
->
mode
 = 
PEM_ALLNEW
;

544 
pwö
->
obj_dúty
 = 
TRUE
;

545 
pobj
->
∑th_num
 = 0;

548 
PEB_STOP
 :

550 
pwö
->
buâ⁄
[
PEB_OK
].
show
 = 
TRUE
;

551 
pwö
->
buâ⁄
[
PEB_CANCEL
].
show
 = 
TRUE
;

552 
pwö
->
buâ⁄
[
PEB_ALLNEW
].
show
 = 
TRUE
;

553 
pwö
->
buâ⁄
[
PEB_STOP
].
show
 = 
FALSE
;

555 
d⁄e
 = 
TRUE
;

556 
pwö
->
mode
 = 
PEM_NONE
;

559 
PEB_SETACTION
 :

560 
	`edô∑th_íãr_a˘i⁄
(
ds1_idx
, & 
pwö
->
cuº_a˘i⁄
);

567 i‡(
key
[
KEY_ENTER
] || key[
KEY_ENTER_PAD
])

569 
key
[
KEY_ENTER
] || key[
KEY_ENTER_PAD
])

571 
	`edô∑th_íãr_a˘i⁄
(
ds1_idx
, & 
pwö
->
cuº_a˘i⁄
);

575 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
,

576 
pwö
->
x0
 + 160,

577 
pwö
->
x0
 + 27,

578 
pwö
->
c_gøy
,

580 
pwö
->
cuº_a˘i⁄


584 
i
=0; i < 
PEB_MAX
; i++)

586 
pbut
 = & 
pwö
->
buâ⁄
[
i
];

588 i‡(
pbut
->
show
 !
TRUE
)

591 
x1
 = 
pwö
->
but_x0
 + 
pbut
->
x0
;

592 
xt
 = 
x1
 + 
pbut
->
ãxt_x0
;

593 
y1
 = 
pwö
->
but_y0
 + 
pbut
->
y0
;

594 
x2
 = 
x1
 + 
pbut
->
w
;

595 
y2
 = 
y1
 + 
pbut
->
h
;

597 i‡((
mx
 >
x1
Ë&& (mx <
x2
Ë&& (
my
 >
y1
Ë&& (my <
y2
))

599 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 
pbut
->
cﬁ_⁄
.
bg
);

600 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
pbut
->
ãxt
, 
xt
, 
y1
+7,Öbut->
cﬁ_⁄
.
fg
);

601 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 
pbut
->
cﬁ_⁄
.
b‹dî
);

605 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 
pbut
->
cﬁ_off
.
bg
);

606 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
pbut
->
ãxt
, 
xt
, 
y1
+7,Öbut->
cﬁ_off
.
fg
);

607 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 
pbut
->
cﬁ_off
.
b‹dî
);

614 
x1
 = 
pwö
->
x0
;

615 
y1
 = 
pwö
->
y0
;

616 
x2
 = 
x1
 + 
pwö
->
w
;

617 
y2
 = 
y1
 + 
pwö
->
h
;

618 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 
pwö
->
c_bœck
);

619 i‡(
	`edô∑th_mou£_ö
(
ds1_idx
, 
mx
, 
my
))

620 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 
pwö
->
c_yñlow
);

622 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 
pwö
->
c_whôe
);

625 
pwö
->
c_gªí
 = 
	`makecﬁ
(0, 255, 0);

626 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
,

628 
x1
 + 8, 
y1
 + 10, 
pwö
->
c_gªí


630 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
,

632 
x1
 + 8, 
y1
 + 20, 
pwö
->
c_gªí


675 i‡((
pwö
->
obj_idx
 < 0Ë|| (pwö->obj_idx >
glb_ds1
[
ds1_idx
].
cuºít_obj_max
))

679 
d⁄e
 = 
FALSE
;

680 
i
 = 
pwö
->
∑th_°¨t_idx
;

681 
y
 = 
y1
 + 35;

682 
µ©h
 = & 
pobj
->
∑th
[
i
];

684 i‡(
i
 >
pobj
->
∑th_num
)

685 
d⁄e
 = 
TRUE
;

687  ! 
d⁄e
)

689 i‡(
y
 + 10 < 
pwö
->
y0
 +Öwö->
h
)

692 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
,

693 
pwö
->
x0
 + 8, 
y
,

694 
pwö
->
c_whôe
,

696 
i
 + 1,

697 
µ©h
->
x
,

698 
µ©h
->
y
,

699 
µ©h
->
a˘i⁄


701 
i
++;

702 i‡(
i
 >
pobj
->
∑th_num
)

703 
d⁄e
 = 
TRUE
;

704 
y
 += 20;

705 
µ©h
++;

708 
d⁄e
 = 
TRUE
;

710 
	}
}

	@editpath.h

1 #i‚de‡
_EDITPATH_H_


3 
	#_EDITPATH_H_


	)

5 
edô∑th_mou£_ö
 (
ds1_idx
, 
mx
, 
my
);

6 
edô∑th_öô
 (
ds1_idx
);

7 
edô∑th_£¨ch_£À˘ed_obj
 (
ds1_idx
);

8 
edô∑th_døw
 (
ds1_idx
, 
mx
, 
my
, 
mb
, 
tx
, 
ty
);

	@edittile.c

1 
	~"°ru˘s.h
"

2 
	~"ds1misc.h
"

3 
	~"undo.h
"

4 
	~"edôtûe.h
"

16 
	$edôtûe_middÀ_£À˘
(
ds1_idx
, * 
°¨t_x
, * 
°¨t_y
)

18 
CELL_F_S
 * 
f_±r
;

19 
CELL_S_S
 * 
s_±r
;

20 
CELL_W_S
 * 
w_±r
;

21 
x
, 
y
, 
t
, 
i
;

22 
möx
, 
möy
, 
maxx
, 
maxy
;

25 
maxx
 = 0;

26 
maxy
 = 0;

27 
möx
 = 
glb_ds1
[
ds1_idx
].
width
 - 1;

28 
möy
 = 
glb_ds1
[
ds1_idx
].
height
 - 1;

30 
y
=0; y < 
glb_ds1
[
ds1_idx
].
height
; y++)

32 
x
=0; x < 
glb_ds1
[
ds1_idx
].
width
; x++)

35 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

36 
i
=0; i<
glb_ds1
[
ds1_idx
].
Êo‹_num
; i++)

38 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
t
 + 
i
;

39 i‡(
	`IS_SELECTED
(
f_±r
->
Êags
))

41 i‡(
x
 < 
möx
) minx = x;

42 i‡(
x
 > 
maxx
) maxx = x;

43 i‡(
y
 < 
möy
) miny = y;

44 i‡(
y
 > 
maxy
) maxy = y;

49 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

50 
i
=0; i<
glb_ds1
[
ds1_idx
].
shadow_num
; i++)

52 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
t
 + 
i
;

53 i‡(
	`IS_SELECTED
(
s_±r
->
Êags
))

55 i‡(
x
 < 
möx
) minx = x;

56 i‡(
x
 > 
maxx
) maxx = x;

57 i‡(
y
 < 
möy
) miny = y;

58 i‡(
y
 > 
maxy
) maxy = y;

63 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

64 
i
=0; i<
glb_ds1
[
ds1_idx
].
wÆl_num
; i++)

66 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
t
 + 
i
;

67 i‡(
	`IS_SELECTED
(
w_±r
->
Êags
))

69 i‡(
x
 < 
möx
) minx = x;

70 i‡(
x
 > 
maxx
) maxx = x;

71 i‡(
y
 < 
möy
) miny = y;

72 i‡(
y
 > 
maxy
) maxy = y;

78 i‡(
möx
 < 
maxx
)

79 * 
°¨t_x
 = 
möx
 + ((
maxx
 - minx) / 2);

81 * 
°¨t_x
 = 
maxx
 + ((
möx
 - maxx) / 2);

83 i‡(
möy
 < 
maxy
)

84 * 
°¨t_y
 = 
möy
 + ((
maxy
 - miny) / 2);

86 * 
°¨t_y
 = 
maxy
 + ((
möy
 - maxy) / 2);

87 
	}
}

93 
	$edôtûe_∑°e_¥ï¨e
(
ds1_idx
)

95 
CELL_F_S
 * 
§c_f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
,

96 * 
d°_f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff2
;

97 
CELL_S_S
 * 
§c_s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
,

98 * 
d°_s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff2
;

99 
CELL_W_S
 * 
§c_w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
,

100 * 
d°_w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff2
;

101 
i
;

105 
i
=0; i < 
glb_ds1
[
ds1_idx
].
Êo‹_Àn
; i++)

107 
d°_f_±r
->
¥›1
 = 
§c_f_±r
->prop1;

108 
d°_f_±r
->
¥›2
 = 
§c_f_±r
->prop2;

109 
d°_f_±r
->
¥›3
 = 
§c_f_±r
->prop3;

110 
d°_f_±r
->
¥›4
 = 
§c_f_±r
->prop4;

111 
d°_f_±r
->
bt_idx
 = 
§c_f_±r
->bt_idx;

112 
d°_f_±r
->
Êags
 = 
§c_f_±r
->flags;

113 
d°_f_±r
++;

114 
§c_f_±r
++;

118 
i
=0; i < 
glb_ds1
[
ds1_idx
].
shadow_Àn
; i++)

120 
d°_s_±r
->
¥›1
 = 
§c_s_±r
->prop1;

121 
d°_s_±r
->
¥›2
 = 
§c_s_±r
->prop2;

122 
d°_s_±r
->
¥›3
 = 
§c_s_±r
->prop3;

123 
d°_s_±r
->
¥›4
 = 
§c_s_±r
->prop4;

124 
d°_s_±r
->
bt_idx
 = 
§c_s_±r
->bt_idx;

125 
d°_s_±r
->
Êags
 = 
§c_s_±r
->flags;

126 
d°_s_±r
++;

127 
§c_s_±r
++;

131 
i
=0; i < 
glb_ds1
[
ds1_idx
].
wÆl_Àn
; i++)

133 
d°_w_±r
->
¥›1
 = 
§c_w_±r
->prop1;

134 
d°_w_±r
->
¥›2
 = 
§c_w_±r
->prop2;

135 
d°_w_±r
->
¥›3
 = 
§c_w_±r
->prop3;

136 
d°_w_±r
->
¥›4
 = 
§c_w_±r
->prop4;

137 
d°_w_±r
->
‹õ¡©i⁄
 = 
§c_w_±r
->orientation;

138 
d°_w_±r
->
bt_idx
 = 
§c_w_±r
->bt_idx;

139 
d°_w_±r
->
Êags
 = 
§c_w_±r
->flags;

140 
d°_w_±r
++;

141 
§c_w_±r
++;

143 
	}
}

148 
	$edôtûe_∑°e_undo
(
ds1_idx
)

150 
CELL_F_S
 * 
§c_f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff2
,

151 * 
d°_f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
;

152 
CELL_S_S
 * 
§c_s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff2
,

153 * 
d°_s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
;

154 
CELL_W_S
 * 
§c_w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff2
,

155 * 
d°_w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
;

156 
i
;

160 
i
=0; i < 
glb_ds1
[
ds1_idx
].
Êo‹_Àn
; i++)

162 
d°_f_±r
->
¥›1
 = 
§c_f_±r
->prop1;

163 
d°_f_±r
->
¥›2
 = 
§c_f_±r
->prop2;

164 
d°_f_±r
->
¥›3
 = 
§c_f_±r
->prop3;

165 
d°_f_±r
->
¥›4
 = 
§c_f_±r
->prop4;

166 
d°_f_±r
->
bt_idx
 = 
§c_f_±r
->bt_idx;

167 
d°_f_±r
->
Êags
 = 
§c_f_±r
->flags;

168 
d°_f_±r
++;

169 
§c_f_±r
++;

173 
i
=0; i < 
glb_ds1
[
ds1_idx
].
shadow_Àn
; i++)

175 
d°_s_±r
->
¥›1
 = 
§c_s_±r
->prop1;

176 
d°_s_±r
->
¥›2
 = 
§c_s_±r
->prop2;

177 
d°_s_±r
->
¥›3
 = 
§c_s_±r
->prop3;

178 
d°_s_±r
->
¥›4
 = 
§c_s_±r
->prop4;

179 
d°_s_±r
->
bt_idx
 = 
§c_s_±r
->bt_idx;

180 
d°_s_±r
->
Êags
 = 
§c_s_±r
->flags;

181 
d°_s_±r
++;

182 
§c_s_±r
++;

186 
i
=0; i < 
glb_ds1
[
ds1_idx
].
wÆl_Àn
; i++)

188 
d°_w_±r
->
¥›1
 = 
§c_w_±r
->prop1;

189 
d°_w_±r
->
¥›2
 = 
§c_w_±r
->prop2;

190 
d°_w_±r
->
¥›3
 = 
§c_w_±r
->prop3;

191 
d°_w_±r
->
¥›4
 = 
§c_w_±r
->prop4;

192 
d°_w_±r
->
‹õ¡©i⁄
 = 
§c_w_±r
->orientation;

193 
d°_w_±r
->
bt_idx
 = 
§c_w_±r
->bt_idx;

194 
d°_w_±r
->
Êags
 = 
§c_w_±r
->flags;

195 
d°_w_±r
++;

196 
§c_w_±r
++;

198 
	}
}

203 
	$edôtûe_∑°e_¥evõw
(
ds1_idx
, 
dx
, 
dy
, 
PASTE_POS_S
 * 
p
)

205 
CELL_F_S
 * 
§c_f_±r
, * 
d°_f_±r
;

206 
CELL_S_S
 * 
§c_s_±r
, * 
d°_s_±r
;

207 
CELL_W_S
 * 
§c_w_±r
, * 
d°_w_±r
;

208 
x
, 
y
, 
ts
, 
td
, 
i
, 
f
;

212 i‡(
p
->
is_cut
 =
TRUE
)

214 i‡(
p
->
cut_ßved
 =
FALSE
)

217 
	`edôtûe_dñëe_£À˘ed_tûes
(
p
->
§c_ds1_idx
);

218 
p
->
cut_ßved
 = 
TRUE
;

223 
	`edôtûe_dñëe_£À˘ed_tûes2
(
p
->
§c_ds1_idx
);

228 
y
=0; y < 
glb_ds1
[
p
->
§c_ds1_idx
].
height
; y++)

230 i‡–((
y
+
dy
Ë< 0Ë|| ((y+dyË>
glb_ds1
[
ds1_idx
].
height
) )

233 
x
=0; x < 
glb_ds1
[
p
->
§c_ds1_idx
].
width
; x++)

235 i‡–((
x
+
dx
Ë< 0Ë|| ((x+dxË>
glb_ds1
[
ds1_idx
].
width
) )

239 
ts
 = (
y
 * 
glb_ds1
[
p
->
§c_ds1_idx
].
Êo‹_löe
) +

240 (
x
 * 
glb_ds1
[
p
->
§c_ds1_idx
].
Êo‹_num
);

241 
td
 = ((
y
+
dy
Ë* 
glb_ds1
[
ds1_idx
].
Êo‹_löe
) +

242 ((
x
+
dx
Ë* 
glb_ds1
[
ds1_idx
].
Êo‹_num
);

243 
i
=0; (i<
glb_ds1
[
ds1_idx
].
Êo‹_num
) &&

244 (
i
<
glb_ds1
[
p
->
§c_ds1_idx
].
Êo‹_num
); i++)

246 
§c_f_±r
 = 
glb_ds1
[
p
->
§c_ds1_idx
].
Êo‹_buff2
 + 
ts
 + 
i
;

247 
d°_f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
td
 + 
i
;

249 
f
 = 
§c_f_±r
->
Êags
;

250 i‡(
	`IS_SELECTED
(
f
Ë&& (
§c_f_±r
->
bt_idx
 != 0))

252 
	`SET_COPY_INFO
(
f
);

253 i‡(
d°_f_±r
->
bt_idx
 != 0)

255 i‡–(
d°_f_±r
->
¥›1
 !
§c_f_±r
->prop1) ||

256 (
d°_f_±r
->
¥›2
 !
§c_f_±r
->prop2) ||

257 (
d°_f_±r
->
¥›3
 !
§c_f_±r
->prop3) ||

258 (
d°_f_±r
->
¥›4
 !
§c_f_±r
->prop4)

261 
	`SET_COPY_STATE
(
f
);

264 
d°_f_±r
->
¥›1
 = 
§c_f_±r
->prop1;

265 
d°_f_±r
->
¥›2
 = 
§c_f_±r
->prop2;

266 
d°_f_±r
->
¥›3
 = 
§c_f_±r
->prop3;

267 
d°_f_±r
->
¥›4
 = 
§c_f_±r
->prop4;

268 
d°_f_±r
->
Êags
 = 
f
;

269 
	`Âr›_2_block
(
ds1_idx
, 
d°_f_±r
);

274 
ts
 = (
y
 * 
glb_ds1
[
p
->
§c_ds1_idx
].
shadow_löe
) +

275 (
x
 * 
glb_ds1
[
p
->
§c_ds1_idx
].
shadow_num
);

276 
td
 = ((
y
+
dy
Ë* 
glb_ds1
[
ds1_idx
].
shadow_löe
) +

277 ((
x
+
dx
Ë* 
glb_ds1
[
ds1_idx
].
shadow_num
);

278 
i
=0; (i<
glb_ds1
[
ds1_idx
].
shadow_num
) &&

279 (
i
<
glb_ds1
[
p
->
§c_ds1_idx
].
shadow_num
); i++)

281 
§c_s_±r
 = 
glb_ds1
[
p
->
§c_ds1_idx
].
shadow_buff2
 + 
ts
 + 
i
;

282 
d°_s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
td
 + 
i
;

284 
f
 = 
§c_s_±r
->
Êags
;

285 i‡(
	`IS_SELECTED
(
f
Ë&& (
§c_s_±r
->
bt_idx
 != 0))

287 
	`SET_COPY_INFO
(
f
);

288 i‡(
d°_s_±r
->
bt_idx
 != 0)

290 i‡–(
d°_s_±r
->
¥›1
 !
§c_s_±r
->prop1) ||

291 (
d°_s_±r
->
¥›2
 !
§c_s_±r
->prop2) ||

292 (
d°_s_±r
->
¥›3
 !
§c_s_±r
->prop3) ||

293 (
d°_s_±r
->
¥›4
 !
§c_s_±r
->prop4)

296 
	`SET_COPY_STATE
(
f
);

299 
d°_s_±r
->
¥›1
 = 
§c_s_±r
->prop1;

300 
d°_s_±r
->
¥›2
 = 
§c_s_±r
->prop2;

301 
d°_s_±r
->
¥›3
 = 
§c_s_±r
->prop3;

302 
d°_s_±r
->
¥›4
 = 
§c_s_±r
->prop4;

303 
d°_s_±r
->
Êags
 = 
f
;

304 
	`•r›_2_block
(
ds1_idx
, 
d°_s_±r
);

309 
ts
 = (
y
 * 
glb_ds1
[
p
->
§c_ds1_idx
].
wÆl_löe
) +

310 (
x
 * 
glb_ds1
[
p
->
§c_ds1_idx
].
wÆl_num
);

311 
td
 = ((
y
+
dy
Ë* 
glb_ds1
[
ds1_idx
].
wÆl_löe
) +

312 ((
x
+
dx
Ë* 
glb_ds1
[
ds1_idx
].
wÆl_num
);

313 
i
=0; (i<
glb_ds1
[
ds1_idx
].
wÆl_num
) &&

314 (
i
<
glb_ds1
[
p
->
§c_ds1_idx
].
wÆl_num
); i++)

316 
§c_w_±r
 = 
glb_ds1
[
p
->
§c_ds1_idx
].
wÆl_buff2
 + 
ts
 + 
i
;

317 
d°_w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
td
 + 
i
;

319 
f
 = 
§c_w_±r
->
Êags
;

320 i‡(
	`IS_SELECTED
(
f
Ë&& (
§c_w_±r
->
bt_idx
 != 0) )

322 
	`SET_COPY_INFO
(
f
);

323 i‡(
d°_w_±r
->
bt_idx
 != 0)

325 i‡–(
d°_w_±r
->
¥›1
 !
§c_w_±r
->prop1) ||

326 (
d°_w_±r
->
¥›2
 !
§c_w_±r
->prop2) ||

327 (
d°_w_±r
->
¥›3
 !
§c_w_±r
->prop3) ||

328 (
d°_w_±r
->
¥›4
 !
§c_w_±r
->prop4) ||

329 (
d°_w_±r
->
‹õ¡©i⁄
 !
§c_w_±r
->orientation)

332 
	`SET_COPY_STATE
(
f
);

335 
d°_w_±r
->
¥›1
 = 
§c_w_±r
->prop1;

336 
d°_w_±r
->
¥›2
 = 
§c_w_±r
->prop2;

337 
d°_w_±r
->
¥›3
 = 
§c_w_±r
->prop3;

338 
d°_w_±r
->
¥›4
 = 
§c_w_±r
->prop4;

339 
d°_w_±r
->
‹õ¡©i⁄
 = 
§c_w_±r
->orientation;

340 
d°_w_±r
->
Êags
 = 
f
;

341 
	`w¥›_2_block
(
ds1_idx
, 
d°_w_±r
);

346 
	}
}

351 
	$edôtûe_∑°e_föÆ
(
ds1_idx
)

353 
CELL_F_S
 * 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
, * 
f2
;

354 
CELL_S_S
 * 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
, * 
s2
;

355 
CELL_W_S
 * 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
, * 
w2
;

356 
i
, 
f
, 
tf
, 
ts
, 
tw
, 
x
, 
y
, 
make_undo
;

357 
UNDO_S
 * 
u
 = & 
glb_ds1
[
ds1_idx
].
undo
;

360 
	`undo_√w_tûe_buf„r
(
ds1_idx
);

361 
y
=0; y<
glb_ds1
[
ds1_idx
].
height
; y++)

363 
x
=0; x<
glb_ds1
[
ds1_idx
].
width
; x++)

365 
tf
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

366 
ts
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

367 
tw
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

368 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
tf
;

369 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
ts
;

370 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
tw
;

371 
f2
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff2
 + 
tf
;

372 
s2
 = 
glb_ds1
[
ds1_idx
].
shadow_buff2
 + 
ts
;

373 
w2
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff2
 + 
tw
;

376 
make_undo
 = 
FALSE
;

377 
i
=0; i<
glb_ds1
[
ds1_idx
].
Êo‹_num
; i++)

379 i‡(
f_±r
[
i
].
¥›1
 !
f2
[i].prop1)

380 
u
->
d©_Êg
.
f
[
i
] |
DF_P1
;

382 i‡(
f_±r
[
i
].
¥›2
 !
f2
[i].prop2)

383 
u
->
d©_Êg
.
f
[
i
] |
DF_P2
;

385 i‡(
f_±r
[
i
].
¥›3
 !
f2
[i].prop3)

386 
u
->
d©_Êg
.
f
[
i
] |
DF_P3
;

388 i‡(
f_±r
[
i
].
¥›4
 !
f2
[i].prop4)

389 
u
->
d©_Êg
.
f
[
i
] |
DF_P4
;

391 i‡(
f_±r
[
i
].
bt_idx
 !
f2
[i].bt_idx)

392 
u
->
d©_Êg
.
f
[
i
] |
DF_BT
;

394 
f
 = 
f_±r
[
i
].
Êags
;

395 i‡(
	`IS_COPY_INFO
(
f
))

396 
	`SET_SELECTED
(
f
);

398 
	`DEL_SELECTED
(
f
);

399 
f_±r
[
i
].
Êags
 = 
	`IS_SELECTED
(
f
Ë| 
	`IS_HIDE
(f);

401 i‡(
f_±r
[
i
].
Êags
 !
f2
[i].flags)

402 
u
->
d©_Êg
.
f
[
i
] |
DF_FL
;

404 i‡(
u
->
d©_Êg
.
f
[
i
])

405 
make_undo
 = 
TRUE
;

407 
i
=0; i<
glb_ds1
[
ds1_idx
].
shadow_num
; i++)

409 i‡(
s_±r
[
i
].
¥›1
 !
s2
[i].prop1)

410 
u
->
d©_Êg
.
s
[
i
] |
DF_P1
;

412 i‡(
s_±r
[
i
].
¥›2
 !
s2
[i].prop2)

413 
u
->
d©_Êg
.
s
[
i
] |
DF_P2
;

415 i‡(
s_±r
[
i
].
¥›3
 !
s2
[i].prop3)

416 
u
->
d©_Êg
.
s
[
i
] |
DF_P3
;

418 i‡(
s_±r
[
i
].
¥›4
 !
s2
[i].prop4)

419 
u
->
d©_Êg
.
s
[
i
] |
DF_P4
;

421 i‡(
s_±r
[
i
].
bt_idx
 !
s2
[i].bt_idx)

422 
u
->
d©_Êg
.
s
[
i
] |
DF_BT
;

424 
f
 = 
s_±r
[
i
].
Êags
;

425 i‡(
	`IS_COPY_INFO
(
f
))

426 
	`SET_SELECTED
(
f
);

428 
	`DEL_SELECTED
(
f
);

429 
s_±r
[
i
].
Êags
 = 
	`IS_SELECTED
(
f
Ë| 
	`IS_HIDE
(f);

431 i‡(
s_±r
[
i
].
Êags
 !
s2
[i].flags)

432 
u
->
d©_Êg
.
s
[
i
] |
DF_FL
;

434 i‡(
u
->
d©_Êg
.
s
[
i
])

435 
make_undo
 = 
TRUE
;

437 
i
=0; i<
glb_ds1
[
ds1_idx
].
wÆl_num
; i++)

439 i‡(
w_±r
[
i
].
¥›1
 !
w2
[i].prop1)

440 
u
->
d©_Êg
.
w
[
i
] |
DF_P1
;

442 i‡(
w_±r
[
i
].
¥›2
 !
w2
[i].prop2)

443 
u
->
d©_Êg
.
w
[
i
] |
DF_P2
;

445 i‡(
w_±r
[
i
].
¥›3
 !
w2
[i].prop3)

446 
u
->
d©_Êg
.
w
[
i
] |
DF_P3
;

448 i‡(
w_±r
[
i
].
¥›4
 !
w2
[i].prop4)

449 
u
->
d©_Êg
.
w
[
i
] |
DF_P4
;

451 i‡(
w_±r
[
i
].
‹õ¡©i⁄
 !
w2
[i].orientation)

452 
u
->
d©_Êg
.
w
[
i
] |
DF_OR
;

454 i‡(
w_±r
[
i
].
bt_idx
 !
w2
[i].bt_idx)

455 
u
->
d©_Êg
.
w
[
i
] |
DF_BT
;

457 
f
 = 
w_±r
[
i
].
Êags
;

458 i‡(
	`IS_COPY_INFO
(
f
))

459 
	`SET_SELECTED
(
f
);

461 
	`DEL_SELECTED
(
f
);

462 
w_±r
[
i
].
Êags
 = 
	`IS_SELECTED
(
f
Ë| 
	`IS_HIDE
(f);

464 i‡(
w_±r
[
i
].
Êags
 !
w2
[i].flags)

465 
u
->
d©_Êg
.
w
[
i
] |
DF_FL
;

467 i‡(
u
->
d©_Êg
.
w
[
i
])

468 
make_undo
 = 
TRUE
;

470 i‡(
make_undo
)

471 
	`undo_add_this_tûe_to_buf„r
(
ds1_idx
, 
x
, 
y
, 
f2
, 
w2
, 
s2
);

475 
	`undo_˛o£_tûe_buf„r
(
ds1_idx
);

476 
	}
}

490 
	$edôtûe_dñëe_£À˘ed_tûes
(
ds1_idx
)

492 
CELL_W_S
 * 
w_±r
;

493 
CELL_F_S
 * 
f_±r
;

494 
CELL_S_S
 * 
s_±r
;

495 
i
, 
tf
, 
ts
, 
tw
, 
x
, 
y
, 
make_undo
;

496 
UNDO_S
 * 
u
 = & 
glb_ds1
[
ds1_idx
].
undo
;

499 
	`undo_√w_tûe_buf„r
(
ds1_idx
);

500 
y
=0; y<
glb_ds1
[
ds1_idx
].
height
; y++)

502 
x
=0; x<
glb_ds1
[
ds1_idx
].
width
; x++)

504 
tf
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

505 
ts
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

506 
tw
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

507 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
tf
;

508 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
ts
;

509 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
tw
;

512 
make_undo
 = 
FALSE
;

513 
i
=0; i<
glb_ds1
[
ds1_idx
].
Êo‹_num
; i++)

515 i‡(
	`IS_SELECTED
(
f_±r
[
i
].
Êags
))

517 i‡(
f_±r
[
i
].
¥›1
)

518 
u
->
d©_Êg
.
f
[
i
] |
DF_P1
;

520 i‡(
f_±r
[
i
].
¥›2
)

521 
u
->
d©_Êg
.
f
[
i
] |
DF_P2
;

523 i‡(
f_±r
[
i
].
¥›3
)

524 
u
->
d©_Êg
.
f
[
i
] |
DF_P3
;

526 i‡(
f_±r
[
i
].
¥›4
)

527 
u
->
d©_Êg
.
f
[
i
] |
DF_P4
;

529 i‡(
f_±r
[
i
].
bt_idx
 != 0)

530 
u
->
d©_Êg
.
f
[
i
] |
DF_BT
;

532 i‡(
f_±r
[
i
].
Êags
)

533 
u
->
d©_Êg
.
f
[
i
] |
DF_FL
;

535 i‡(
u
->
d©_Êg
.
f
[
i
])

536 
make_undo
 = 
TRUE
;

539 
i
=0; i<
glb_ds1
[
ds1_idx
].
shadow_num
; i++)

541 i‡(
	`IS_SELECTED
(
s_±r
[
i
].
Êags
))

543 i‡(
s_±r
[
i
].
¥›1
)

544 
u
->
d©_Êg
.
s
[
i
] |
DF_P1
;

546 i‡(
s_±r
[
i
].
¥›2
)

547 
u
->
d©_Êg
.
s
[
i
] |
DF_P2
;

549 i‡(
s_±r
[
i
].
¥›3
)

550 
u
->
d©_Êg
.
s
[
i
] |
DF_P3
;

552 i‡(
s_±r
[
i
].
¥›4
)

553 
u
->
d©_Êg
.
s
[
i
] |
DF_P4
;

555 i‡(
s_±r
[
i
].
bt_idx
 != 0)

556 
u
->
d©_Êg
.
s
[
i
] |
DF_BT
;

558 i‡(
s_±r
[
i
].
Êags
)

559 
u
->
d©_Êg
.
s
[
i
] |
DF_FL
;

561 i‡(
u
->
d©_Êg
.
s
[
i
])

562 
make_undo
 = 
TRUE
;

565 
i
=0; i<
glb_ds1
[
ds1_idx
].
wÆl_num
; i++)

567 i‡(
	`IS_SELECTED
(
w_±r
[
i
].
Êags
))

569 i‡(
w_±r
[
i
].
¥›1
)

570 
u
->
d©_Êg
.
w
[
i
] |
DF_P1
;

572 i‡(
w_±r
[
i
].
¥›2
)

573 
u
->
d©_Êg
.
w
[
i
] |
DF_P2
;

575 i‡(
w_±r
[
i
].
¥›3
)

576 
u
->
d©_Êg
.
w
[
i
] |
DF_P3
;

578 i‡(
w_±r
[
i
].
¥›4
)

579 
u
->
d©_Êg
.
w
[
i
] |
DF_P4
;

581 i‡(
w_±r
[
i
].
‹õ¡©i⁄
)

582 
u
->
d©_Êg
.
w
[
i
] |
DF_OR
;

584 i‡(
w_±r
[
i
].
bt_idx
 != 0)

585 
u
->
d©_Êg
.
w
[
i
] |
DF_BT
;

587 i‡(
w_±r
[
i
].
Êags
)

588 
u
->
d©_Êg
.
w
[
i
] |
DF_FL
;

590 i‡(
u
->
d©_Êg
.
w
[
i
])

591 
make_undo
 = 
TRUE
;

594 i‡(
make_undo
)

595 
	`undo_add_to_tûe_buf„r
(
ds1_idx
, 
x
, 
y
);

598 
i
=0; i<
glb_ds1
[
ds1_idx
].
Êo‹_num
; i++)

600 i‡(
	`IS_SELECTED
(
f_±r
[
i
].
Êags
))

602 
f_±r
[
i
].
¥›1
 = 0;

603 
f_±r
[
i
].
¥›2
 = 0;

604 
f_±r
[
i
].
¥›3
 = 0;

605 
f_±r
[
i
].
¥›4
 = 0;

606 
f_±r
[
i
].
bt_idx
 = 0;

607 
f_±r
[
i
].
Êags
 = 0;

612 
i
=0; i<
glb_ds1
[
ds1_idx
].
shadow_num
; i++)

614 i‡(
	`IS_SELECTED
(
s_±r
[
i
].
Êags
))

616 
s_±r
[
i
].
¥›1
 = 0;

617 
s_±r
[
i
].
¥›2
 = 0;

618 
s_±r
[
i
].
¥›3
 = 0;

619 
s_±r
[
i
].
¥›4
 = 0;

620 
s_±r
[
i
].
bt_idx
 = 0;

621 
s_±r
[
i
].
Êags
 = 0;

626 
i
=0; i<
glb_ds1
[
ds1_idx
].
wÆl_num
; i++)

628 i‡(
	`IS_SELECTED
(
w_±r
[
i
].
Êags
))

630 
w_±r
[
i
].
¥›1
 = 0;

631 
w_±r
[
i
].
¥›2
 = 0;

632 
w_±r
[
i
].
¥›3
 = 0;

633 
w_±r
[
i
].
¥›4
 = 0;

634 
w_±r
[
i
].
‹õ¡©i⁄
 = 0;

635 
w_±r
[
i
].
bt_idx
 = 0;

636 
w_±r
[
i
].
Êags
 = 0;

641 
	`undo_˛o£_tûe_buf„r
(
ds1_idx
);

642 
	}
}

648 
	$edôtûe_dñëe_£À˘ed_tûes2
(
ds1_idx
)

650 
CELL_W_S
 * 
w_±r
;

651 
CELL_F_S
 * 
f_±r
;

652 
CELL_S_S
 * 
s_±r
;

653 
i
, 
tf
, 
ts
, 
tw
, 
x
, 
y
;

656 
y
=0; y<
glb_ds1
[
ds1_idx
].
height
; y++)

658 
x
=0; x<
glb_ds1
[
ds1_idx
].
width
; x++)

660 
tf
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

661 
ts
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

662 
tw
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

663 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
tf
;

664 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
ts
;

665 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
tw
;

668 
i
=0; i<
glb_ds1
[
ds1_idx
].
Êo‹_num
; i++)

670 i‡(
	`IS_SELECTED
(
f_±r
[
i
].
Êags
))

672 
f_±r
[
i
].
¥›1
 = 0;

673 
f_±r
[
i
].
¥›2
 = 0;

674 
f_±r
[
i
].
¥›3
 = 0;

675 
f_±r
[
i
].
¥›4
 = 0;

676 
f_±r
[
i
].
bt_idx
 = 0;

677 
f_±r
[
i
].
Êags
 = 0;

682 
i
=0; i<
glb_ds1
[
ds1_idx
].
shadow_num
; i++)

684 i‡(
	`IS_SELECTED
(
s_±r
[
i
].
Êags
))

686 
s_±r
[
i
].
¥›1
 = 0;

687 
s_±r
[
i
].
¥›2
 = 0;

688 
s_±r
[
i
].
¥›3
 = 0;

689 
s_±r
[
i
].
¥›4
 = 0;

690 
s_±r
[
i
].
bt_idx
 = 0;

691 
s_±r
[
i
].
Êags
 = 0;

696 
i
=0; i<
glb_ds1
[
ds1_idx
].
wÆl_num
; i++)

698 i‡(
	`IS_SELECTED
(
w_±r
[
i
].
Êags
))

700 
w_±r
[
i
].
¥›1
 = 0;

701 
w_±r
[
i
].
¥›2
 = 0;

702 
w_±r
[
i
].
¥›3
 = 0;

703 
w_±r
[
i
].
¥›4
 = 0;

704 
w_±r
[
i
].
‹õ¡©i⁄
 = 0;

705 
w_±r
[
i
].
bt_idx
 = 0;

706 
w_±r
[
i
].
Êags
 = 0;

711 
	}
}

725 
	$edôtûe_de£À˘_⁄e
(
ds1_idx
, 
x
, 
y
)

727 
CELL_F_S
 * 
f_±r
;

728 
CELL_S_S
 * 
s_±r
;

729 
CELL_W_S
 * 
w_±r
;

730 
UNDO_S
 * 
u
 = & 
glb_ds1
[
ds1_idx
].
undo
;

731 
n
, 
tf
, 
ts
, 
tw
, 
make_undo
 = 
FALSE
;

734 
tf
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

735 
ts
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

736 
tw
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

737 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
tf
;

738 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
ts
;

739 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
tw
;

742 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
Êo‹_num
;Ç++)

744 i‡(
glb_ds1
[
ds1_idx
].
Êo‹_œyî_mask
[
n
] != 0)

746 i‡(
	`IS_SELECTED
(
f_±r
[
n
].
Êags
))

748 
u
->
d©_Êg
.
f
[
n
] |
DF_FL
;

749 
make_undo
 = 
TRUE
;

753 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
shadow_num
;Ç++)

755 i‡(
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[
n
] != 0)

757 i‡(
	`IS_SELECTED
(
s_±r
[
n
].
Êags
))

759 
u
->
d©_Êg
.
s
[
n
] |
DF_FL
;

760 
make_undo
 = 
TRUE
;

764 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

766 i‡(
glb_ds1
[
ds1_idx
].
wÆl_œyî_mask
[
n
] != 0)

768 i‡(
	`IS_SELECTED
(
w_±r
[
n
].
Êags
))

770 
u
->
d©_Êg
.
w
[
n
] |
DF_FL
;

771 
make_undo
 = 
TRUE
;

775 i‡(
make_undo
)

776 
	`undo_add_to_tûe_buf„r
(
ds1_idx
, 
x
, 
y
);

779 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
Êo‹_num
;Ç++)

780 i‡(
glb_ds1
[
ds1_idx
].
Êo‹_œyî_mask
[
n
] != 0)

781 
	`DEL_SELECTED
(
f_±r
[
n
].
Êags
);

784 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
shadow_num
;Ç++)

785 i‡(
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[
n
] != 0)

786 
	`DEL_SELECTED
(
s_±r
[
n
].
Êags
);

789 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

790 i‡(
glb_ds1
[
ds1_idx
].
wÆl_œyî_mask
[
n
] != 0)

791 
	`DEL_SELECTED
(
w_±r
[
n
].
Êags
);

792 
	}
}

797 
	$edôtûe_de£À˘_⁄e_com∂ëly
(
ds1_idx
, 
x
, 
y
)

799 
CELL_F_S
 * 
f_±r
;

800 
CELL_S_S
 * 
s_±r
;

801 
CELL_W_S
 * 
w_±r
;

802 
UNDO_S
 * 
u
 = & 
glb_ds1
[
ds1_idx
].
undo
;

803 
n
, 
tf
, 
ts
, 
tw
, 
make_undo
 = 
FALSE
;

806 
tf
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

807 
ts
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

808 
tw
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

809 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
tf
;

810 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
ts
;

811 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
tw
;

814 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
Êo‹_num
;Ç++)

816 i‡(
	`IS_SELECTED
(
f_±r
[
n
].
Êags
))

818 
u
->
d©_Êg
.
f
[
n
] |
DF_FL
;

819 
make_undo
 = 
TRUE
;

822 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
shadow_num
;Ç++)

824 i‡(
	`IS_SELECTED
(
s_±r
[
n
].
Êags
))

826 
u
->
d©_Êg
.
s
[
n
] |
DF_FL
;

827 
make_undo
 = 
TRUE
;

830 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

832 i‡(
	`IS_SELECTED
(
w_±r
[
n
].
Êags
))

834 
u
->
d©_Êg
.
w
[
n
] |
DF_FL
;

835 
make_undo
 = 
TRUE
;

838 i‡(
make_undo
)

839 
	`undo_add_to_tûe_buf„r
(
ds1_idx
, 
x
, 
y
);

842 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
Êo‹_num
;Ç++)

843 
	`DEL_SELECTED
(
f_±r
[
n
].
Êags
);

846 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
shadow_num
;Ç++)

847 
	`DEL_SELECTED
(
s_±r
[
n
].
Êags
);

850 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

851 
	`DEL_SELECTED
(
w_±r
[
n
].
Êags
);

852 
	}
}

857 
	$edôtûe_£À˘_⁄e
(
ds1_idx
, 
x
, 
y
)

859 
CELL_F_S
 * 
f_±r
;

860 
CELL_S_S
 * 
s_±r
;

861 
CELL_W_S
 * 
w_±r
;

862 
UNDO_S
 * 
u
 = & 
glb_ds1
[
ds1_idx
].
undo
;

863 
n
, 
tf
, 
ts
, 
tw
, 
make_undo
 = 
FALSE
;

866 
tf
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

867 
ts
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

868 
tw
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

869 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
tf
;

870 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
ts
;

871 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
tw
;

874 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
Êo‹_num
;Ç++)

876 i‡((
glb_ds1
[
ds1_idx
].
Êo‹_œyî_mask
[
n
] !0Ë&& (
f_±r
[n].
¥›1
 != 0))

878 i‡–! 
	`IS_SELECTED
(
f_±r
[
n
].
Êags
))

880 
u
->
d©_Êg
.
f
[
n
] |
DF_FL
;

881 
make_undo
 = 
TRUE
;

885 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
shadow_num
;Ç++)

887 i‡((
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[
n
] !0Ë&& (
s_±r
[n].
¥›1
 != 0))

889 i‡–! 
	`IS_SELECTED
(
s_±r
[
n
].
Êags
))

891 
u
->
d©_Êg
.
s
[
n
] |
DF_FL
;

892 
make_undo
 = 
TRUE
;

896 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

898 i‡((
glb_ds1
[
ds1_idx
].
wÆl_œyî_mask
[
n
] !0Ë&& (
w_±r
[n].
¥›1
 != 0))

900 i‡–! 
	`IS_SELECTED
(
w_±r
[
n
].
Êags
))

902 
u
->
d©_Êg
.
w
[
n
] |
DF_FL
;

903 
make_undo
 = 
TRUE
;

907 i‡(
make_undo
)

908 
	`undo_add_to_tûe_buf„r
(
ds1_idx
, 
x
, 
y
);

911 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
Êo‹_num
;Ç++)

912 i‡((
glb_ds1
[
ds1_idx
].
Êo‹_œyî_mask
[
n
] !0Ë&& (
f_±r
[n].
¥›1
 != 0))

913 
	`SET_SELECTED
(
f_±r
[
n
].
Êags
);

916 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
shadow_num
;Ç++)

917 i‡((
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[
n
] !0Ë&& (
s_±r
[n].
¥›1
 != 0))

918 
	`SET_SELECTED
(
s_±r
[
n
].
Êags
);

921 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

922 i‡((
glb_ds1
[
ds1_idx
].
wÆl_œyî_mask
[
n
] !0Ë&& (
w_±r
[n].
¥›1
 != 0))

923 
	`SET_SELECTED
(
w_±r
[
n
].
Êags
);

924 
	}
}

929 
	$edôtûe_£À˘_√w_⁄e
(
ds1_idx
, 
x
, 
y
)

931 
CELL_F_S
 * 
f_±r
;

932 
CELL_S_S
 * 
s_±r
;

933 
CELL_W_S
 * 
w_±r
;

934 
UNDO_S
 * 
u
 = & 
glb_ds1
[
ds1_idx
].
undo
;

935 
n
, 
tf
, 
ts
, 
tw
, 
make_undo
 = 
FALSE
;

938 
tf
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

939 
ts
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

940 
tw
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

941 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
tf
;

942 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
ts
;

943 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
tw
;

946 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
Êo‹_num
;Ç++)

948 i‡((
glb_ds1
[
ds1_idx
].
Êo‹_œyî_mask
[
n
] !0Ë&& (
f_±r
[n].
¥›1
 != 0))

951 i‡–! 
	`IS_SELECTED
(
f_±r
[
n
].
Êags
))

954 
u
->
d©_Êg
.
f
[
n
] |
DF_FL
;

955 
make_undo
 = 
TRUE
;

961 i‡–
	`IS_SELECTED
(
f_±r
[
n
].
Êags
))

964 
u
->
d©_Êg
.
f
[
n
] |
DF_FL
;

965 
make_undo
 = 
TRUE
;

969 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
shadow_num
;Ç++)

971 i‡((
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[
n
] !0Ë&& (
s_±r
[n].
¥›1
 != 0))

973 i‡–! 
	`IS_SELECTED
(
s_±r
[
n
].
Êags
))

975 
u
->
d©_Êg
.
s
[
n
] |
DF_FL
;

976 
make_undo
 = 
TRUE
;

981 i‡–
	`IS_SELECTED
(
s_±r
[
n
].
Êags
))

983 
u
->
d©_Êg
.
s
[
n
] |
DF_FL
;

984 
make_undo
 = 
TRUE
;

988 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

990 i‡((
glb_ds1
[
ds1_idx
].
wÆl_œyî_mask
[
n
] !0Ë&& (
w_±r
[n].
¥›1
 != 0))

992 i‡–! 
	`IS_SELECTED
(
w_±r
[
n
].
Êags
))

994 
u
->
d©_Êg
.
w
[
n
] |
DF_FL
;

995 
make_undo
 = 
TRUE
;

1000 i‡–
	`IS_SELECTED
(
w_±r
[
n
].
Êags
))

1002 
u
->
d©_Êg
.
w
[
n
] |
DF_FL
;

1003 
make_undo
 = 
TRUE
;

1007 i‡(
make_undo
)

1008 
	`undo_add_to_tûe_buf„r
(
ds1_idx
, 
x
, 
y
);

1011 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
Êo‹_num
;Ç++)

1012 i‡((
glb_ds1
[
ds1_idx
].
Êo‹_œyî_mask
[
n
] !0Ë&& (
f_±r
[n].
¥›1
 != 0))

1013 
	`SET_SELECTED
(
f_±r
[
n
].
Êags
);

1015 
	`DEL_SELECTED
(
f_±r
[
n
].
Êags
);

1018 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
shadow_num
;Ç++)

1019 i‡((
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[
n
] !0Ë&& (
s_±r
[n].
¥›1
 != 0))

1020 
	`SET_SELECTED
(
s_±r
[
n
].
Êags
);

1022 
	`DEL_SELECTED
(
s_±r
[
n
].
Êags
);

1025 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

1026 i‡((
glb_ds1
[
ds1_idx
].
wÆl_œyî_mask
[
n
] !0Ë&& (
w_±r
[n].
¥›1
 != 0))

1027 
	`SET_SELECTED
(
w_±r
[
n
].
Êags
);

1029 
	`DEL_SELECTED
(
w_±r
[
n
].
Êags
);

1030 
	}
}

1035 
	$edôtûe_idítiˇl
(
ds1_idx
, 
IT_ENUM
 
ôy≥
, 
tx
, 
ty
)

1037 
CELL_F_S
 * 
f_±r
;

1038 
CELL_S_S
 * 
s_±r
;

1039 
CELL_W_S
 * 
w_±r
;

1040 
UNDO_S
 * 
u
 = & 
glb_ds1
[
ds1_idx
].
undo
;

1041 
x
, 
y
, 
n
, 
t
, 
i
, 
make_undo
, 
is_ßme
;

1042 
Ê_ªf
[
FLOOR_MAX_LAYER
],

1043 
sh_ªf
[
SHADOW_MAX_LAYER
],

1044 
wa_ªf
[
WALL_MAX_LAYER
];

1048 
	`undo_√w_tûe_buf„r
(
ds1_idx
);

1051 
n
=0;Ç < 
FLOOR_MAX_LAYER
;Ç++Ë
Ê_ªf
[n] = 0;

1052 
n
=0;Ç < 
SHADOW_MAX_LAYER
;Ç++Ë
sh_ªf
[n] = 0;

1053 
n
=0;Ç < 
WALL_MAX_LAYER
;Ç++Ë
wa_ªf
[n] = 0;

1058 
y
 = 0;

1059 
t
 = (
ty
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
tx
 * glb_ds1[ds1_idx].
Êo‹_num
);

1060 
i
=0; i < 
glb_ds1
[
ds1_idx
].
Êo‹_num
; i++)

1062 i‡(
glb_ds1
[
ds1_idx
].
Êo‹_œyî_mask
[
i
] != 0)

1064 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
t
 + 
i
;

1065 i‡(
f_±r
->
bt_idx
 >= 1)

1067 
Ê_ªf
[
y
] = 
f_±r
->
bt_idx
;

1068 
y
++;

1074 
y
 = 0;

1075 
t
 = (
ty
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
tx
 * glb_ds1[ds1_idx].
shadow_num
);

1076 
i
=0; i < 
glb_ds1
[
ds1_idx
].
shadow_num
; i++)

1078 i‡(
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[
i
] != 0)

1080 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
t
 + 
i
;

1081 i‡(
s_±r
->
bt_idx
 >= 1)

1083 
sh_ªf
[
y
] = 
s_±r
->
bt_idx
;

1084 
y
++;

1090 
y
 = 0;

1091 
t
 = (
ty
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
tx
 * glb_ds1[ds1_idx].
wÆl_num
);

1092 
i
=0; i < 
glb_ds1
[
ds1_idx
].
wÆl_num
; i++)

1094 i‡(
glb_ds1
[
ds1_idx
].
wÆl_œyî_mask
[
i
] != 0)

1096 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
t
 + 
i
;

1097 i‡(
w_±r
->
bt_idx
 >= 1)

1099 
wa_ªf
[
y
] = 
w_±r
->
bt_idx
;

1100 
y
++;

1106 
y
=0; y < 
glb_ds1
[
ds1_idx
].
height
; y++)

1108 
x
=0; x < 
glb_ds1
[
ds1_idx
].
width
; x++)

1111 
make_undo
 = 
FALSE
;

1116 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

1117 
i
=0; i < 
glb_ds1
[
ds1_idx
].
Êo‹_num
; i++)

1119 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
t
 + 
i
;

1120 
u
->
d©_Êg
.
f
[
i
] = 0;

1123 
is_ßme
 = 
FALSE
;

1124 
n
=0;Ç < 
glb_ds1
[
ds1_idx
].
Êo‹_num
;Ç++)

1126 i‡(
Ê_ªf
[
n
])

1128 i‡(
Ê_ªf
[
n
] =
f_±r
->
bt_idx
)

1131 
is_ßme
 = 
TRUE
;

1133 i‡((
ôy≥
 =
IT_NEW
Ë|| (ôy≥ =
IT_ADD
))

1138 i‡(
	`IS_SELECTED
(
f_±r
->
Êags
))

1145 
u
->
d©_Êg
.
f
[
i
] |
DF_FL
;

1146 
make_undo
 = 
TRUE
;

1149 
	`SET_SELECTED
(
f_±r
->
Êags
);

1152 i‡(
ôy≥
 =
IT_DEL
)

1157 i‡–! 
	`IS_SELECTED
(
f_±r
->
Êags
))

1164 
u
->
d©_Êg
.
f
[
i
] |
DF_FL
;

1165 
make_undo
 = 
TRUE
;

1168 
	`DEL_SELECTED
(
f_±r
->
Êags
);

1174 i‡(
is_ßme
 =
FALSE
)

1178 i‡(
ôy≥
 =
IT_NEW
)

1183 i‡–! 
	`IS_SELECTED
(
f_±r
->
Êags
))

1190 
u
->
d©_Êg
.
f
[
i
] |
DF_FL
;

1191 
make_undo
 = 
TRUE
;

1194 
	`DEL_SELECTED
(
f_±r
->
Êags
);

1201 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

1202 
i
=0; i < 
glb_ds1
[
ds1_idx
].
shadow_num
; i++)

1204 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
t
 + 
i
;

1205 
u
->
d©_Êg
.
s
[
i
] = 0;

1208 
is_ßme
 = 
FALSE
;

1209 
n
=0;Ç < 
glb_ds1
[
ds1_idx
].
shadow_num
;Ç++)

1211 i‡(
sh_ªf
[
n
])

1213 i‡(
sh_ªf
[
n
] =
s_±r
->
bt_idx
)

1216 
is_ßme
 = 
TRUE
;

1218 i‡((
ôy≥
 =
IT_NEW
Ë|| (ôy≥ =
IT_ADD
))

1223 i‡(
	`IS_SELECTED
(
s_±r
->
Êags
))

1230 
u
->
d©_Êg
.
s
[
i
] |
DF_FL
;

1231 
make_undo
 = 
TRUE
;

1234 
	`SET_SELECTED
(
s_±r
->
Êags
);

1237 i‡(
ôy≥
 =
IT_DEL
)

1242 i‡–! 
	`IS_SELECTED
(
s_±r
->
Êags
))

1249 
u
->
d©_Êg
.
s
[
i
] |
DF_FL
;

1250 
make_undo
 = 
TRUE
;

1253 
	`DEL_SELECTED
(
s_±r
->
Êags
);

1259 i‡(
is_ßme
 =
FALSE
)

1263 i‡(
ôy≥
 =
IT_NEW
)

1268 i‡–! 
	`IS_SELECTED
(
s_±r
->
Êags
))

1275 
u
->
d©_Êg
.
s
[
i
] |
DF_FL
;

1276 
make_undo
 = 
TRUE
;

1279 
	`DEL_SELECTED
(
s_±r
->
Êags
);

1286 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

1287 
i
=0; i < 
glb_ds1
[
ds1_idx
].
wÆl_num
; i++)

1289 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
t
 + 
i
;

1290 
u
->
d©_Êg
.
w
[
i
] = 0;

1293 
is_ßme
 = 
FALSE
;

1294 
n
=0;Ç < 
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

1296 i‡(
wa_ªf
[
n
])

1298 i‡(
wa_ªf
[
n
] =
w_±r
->
bt_idx
)

1301 
is_ßme
 = 
TRUE
;

1303 i‡((
ôy≥
 =
IT_NEW
Ë|| (ôy≥ =
IT_ADD
))

1308 i‡(
	`IS_SELECTED
(
w_±r
->
Êags
))

1315 
u
->
d©_Êg
.
w
[
i
] |
DF_FL
;

1316 
make_undo
 = 
TRUE
;

1319 
	`SET_SELECTED
(
w_±r
->
Êags
);

1322 i‡(
ôy≥
 =
IT_DEL
)

1327 i‡–! 
	`IS_SELECTED
(
w_±r
->
Êags
))

1334 
u
->
d©_Êg
.
w
[
i
] |
DF_FL
;

1335 
make_undo
 = 
TRUE
;

1338 
	`DEL_SELECTED
(
w_±r
->
Êags
);

1344 i‡(
is_ßme
 =
FALSE
)

1348 i‡(
ôy≥
 =
IT_NEW
)

1353 i‡–! 
	`IS_SELECTED
(
w_±r
->
Êags
))

1360 
u
->
d©_Êg
.
w
[
i
] |
DF_FL
;

1361 
make_undo
 = 
TRUE
;

1364 
	`DEL_SELECTED
(
w_±r
->
Êags
);

1371 i‡(
make_undo
)

1372 
	`undo_add_to_tûe_buf„r
(
ds1_idx
, 
x
, 
y
);

1377 
	`undo_˛o£_tûe_buf„r
(
ds1_idx
);

1378 
	}
}

1392 
	$edôtûe_unhide_Æl
(
ds1_idx
)

1394 
CELL_F_S
 * 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
;

1395 
CELL_S_S
 * 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
;

1396 
CELL_W_S
 * 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
;

1397 
i
;

1401 
i
=0; i<
glb_ds1
[
ds1_idx
].
Êo‹_Àn
; i++)

1403 
	`DEL_HIDE
(
f_±r
->
Êags
);

1404 
f_±r
++;

1408 
i
=0; i<
glb_ds1
[
ds1_idx
].
shadow_Àn
; i++)

1410 
	`DEL_HIDE
(
s_±r
->
Êags
);

1411 
s_±r
++;

1415 
i
=0; i<
glb_ds1
[
ds1_idx
].
wÆl_Àn
; i++)

1417 
	`DEL_HIDE
(
w_±r
->
Êags
);

1418 
w_±r
++;

1420 
	}
}

1425 
	$edôtûe_hide_add_⁄e
(
ds1_idx
, 
x
, 
y
)

1427 
CELL_F_S
 * 
f_±r
;

1428 
CELL_S_S
 * 
s_±r
;

1429 
CELL_W_S
 * 
w_±r
;

1430 
n
, 
tf
, 
ts
, 
tw
;

1433 
tf
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

1434 
ts
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

1435 
tw
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

1436 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
tf
;

1437 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
ts
;

1438 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
tw
;

1441 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
Êo‹_num
;Ç++)

1443 i‡(
glb_ds1
[
ds1_idx
].
Êo‹_œyî_mask
[
n
] != 0)

1444 
	`SET_HIDE
(
f_±r
->
Êags
);

1445 
f_±r
++;

1449 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
shadow_num
;Ç++)

1451 i‡(
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[
n
] != 0)

1452 
	`SET_HIDE
(
s_±r
->
Êags
);

1453 
s_±r
++;

1457 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

1459 i‡(
glb_ds1
[
ds1_idx
].
wÆl_œyî_mask
[
n
] != 0)

1460 
	`SET_HIDE
(
w_±r
->
Êags
);

1461 
w_±r
++;

1463 
	}
}

1484 
	$edôtûe_dñëe_Æl_tmp£l
(
ds1_idx
)

1486 
CELL_F_S
 * 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
;

1487 
CELL_S_S
 * 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
;

1488 
CELL_W_S
 * 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
;

1489 
i
;

1493 
i
=0; i<
glb_ds1
[
ds1_idx
].
Êo‹_Àn
; i++)

1495 
	`DEL_TMP_SELECT
(
f_±r
->
Êags
);

1496 
f_±r
++;

1500 
i
=0; i<
glb_ds1
[
ds1_idx
].
shadow_Àn
; i++)

1502 
	`DEL_TMP_SELECT
(
s_±r
->
Êags
);

1503 
s_±r
++;

1507 
i
=0; i<
glb_ds1
[
ds1_idx
].
wÆl_Àn
; i++)

1509 
	`DEL_TMP_SELECT
(
w_±r
->
Êags
);

1510 
w_±r
++;

1512 
	}
}

1517 
	$edôtûe_add_tmp£l_⁄e
(
ds1_idx
, 
x
, 
y
)

1519 
CELL_F_S
 * 
f_±r
;

1520 
CELL_S_S
 * 
s_±r
;

1521 
CELL_W_S
 * 
w_±r
;

1522 
n
, 
tf
, 
ts
, 
tw
;

1525 
tf
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

1526 
ts
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

1527 
tw
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

1528 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
tf
;

1529 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
ts
;

1530 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
tw
;

1533 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
Êo‹_num
;Ç++)

1535 i‡(
glb_ds1
[
ds1_idx
].
Êo‹_œyî_mask
[
n
] != 0)

1536 
	`SET_TMP_SELECT
(
f_±r
->
Êags
);

1537 
f_±r
++;

1541 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
shadow_num
;Ç++)

1543 i‡(
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[
n
] != 0)

1544 
	`SET_TMP_SELECT
(
s_±r
->
Êags
);

1545 
s_±r
++;

1549 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

1551 i‡(
glb_ds1
[
ds1_idx
].
wÆl_œyî_mask
[
n
] != 0)

1552 
	`SET_TMP_SELECT
(
w_±r
->
Êags
);

1553 
w_±r
++;

1555 
	}
}

1560 
	$edôtûe_£t_tmp£l
(
ds1_idx
, 
TMP_SEL_S
 * 
s
)

1562 
x
, 
y
, 
x1
, 
y1
, 
x2
, 
y2
;

1565 
x1
 = 
s
->x1;

1566 
x2
 = 
s
->x2;

1567 i‡(
s
->
x2
 < s->
x1
)

1569 
x1
 = 
s
->
x2
;

1570 
x2
 = 
s
->
x1
;

1572 
y1
 = 
s
->y1;

1573 
y2
 = 
s
->y2;

1574 i‡(
s
->
y2
 < s->
y1
)

1576 
y1
 = 
s
->
y2
;

1577 
y2
 = 
s
->
y1
;

1580 
y
 = 
y1
; y <
y2
; y++)

1581 
x
 = 
x1
; x <
x2
; x++)

1582 
	`edôtûe_add_tmp£l_⁄e
(
ds1_idx
, 
x
, 
y
);

1583 
	}
}

1588 
	$edôtûe_ch™ge_to_√w_≥rm™ít_£l
(
ds1_idx
, 
TMP_SEL_S
 * 
s
)

1590 
x
, 
y
, 
x1
, 
y1
, 
x2
, 
y2
;

1593 
x1
 = 
s
->x1;

1594 
x2
 = 
s
->x2;

1595 i‡(
s
->
x2
 < s->
x1
)

1597 
x1
 = 
s
->
x2
;

1598 
x2
 = 
s
->
x1
;

1600 
y1
 = 
s
->y1;

1601 
y2
 = 
s
->y2;

1602 i‡(
s
->
y2
 < s->
y1
)

1604 
y1
 = 
s
->
y2
;

1605 
y2
 = 
s
->
y1
;

1608 
	`undo_√w_tûe_buf„r
(
ds1_idx
);

1609 
y
=0; y < 
glb_ds1
[
ds1_idx
].
height
; y++)

1611 
x
=0; x < 
glb_ds1
[
ds1_idx
].
width
; x++)

1613 i‡((
x
 >
x1
Ë&& (x <
x2
Ë&& (
y
 >
y1
Ë&& (y <
y2
))

1614 
	`edôtûe_£À˘_√w_⁄e
(
ds1_idx
, 
x
, 
y
);

1616 
	`edôtûe_de£À˘_⁄e_com∂ëly
(
ds1_idx
, 
x
, 
y
);

1619 
	`undo_˛o£_tûe_buf„r
(
ds1_idx
);

1620 
	}
}

1625 
	$edôtûe_ch™ge_to_add_≥rm™ít_£l
(
ds1_idx
, 
TMP_SEL_S
 * 
s
)

1627 
x
, 
y
, 
x1
, 
y1
, 
x2
, 
y2
;

1630 
x1
 = 
s
->x1;

1631 
x2
 = 
s
->x2;

1632 i‡(
s
->
x2
 < s->
x1
)

1634 
x1
 = 
s
->
x2
;

1635 
x2
 = 
s
->
x1
;

1637 
y1
 = 
s
->y1;

1638 
y2
 = 
s
->y2;

1639 i‡(
s
->
y2
 < s->
y1
)

1641 
y1
 = 
s
->
y2
;

1642 
y2
 = 
s
->
y1
;

1645 
	`undo_√w_tûe_buf„r
(
ds1_idx
);

1646 
y
=0; y < 
glb_ds1
[
ds1_idx
].
height
; y++)

1647 
x
=0; x < 
glb_ds1
[
ds1_idx
].
width
; x++)

1648 i‡((
x
 >
x1
Ë&& (x <
x2
Ë&& (
y
 >
y1
Ë&& (y <
y2
))

1649 
	`edôtûe_£À˘_⁄e
(
ds1_idx
, 
x
, 
y
);

1650 
	`undo_˛o£_tûe_buf„r
(
ds1_idx
);

1651 
	}
}

1656 
	$edôtûe_ch™ge_to_hide_£l
(
ds1_idx
, 
TMP_SEL_S
 * 
s
)

1658 
x
, 
y
, 
x1
, 
y1
, 
x2
, 
y2
;

1661 
x1
 = 
s
->x1;

1662 
x2
 = 
s
->x2;

1663 i‡(
s
->
x2
 < s->
x1
)

1665 
x1
 = 
s
->
x2
;

1666 
x2
 = 
s
->
x1
;

1668 
y1
 = 
s
->y1;

1669 
y2
 = 
s
->y2;

1670 i‡(
s
->
y2
 < s->
y1
)

1672 
y1
 = 
s
->
y2
;

1673 
y2
 = 
s
->
y1
;

1676 
y
 = 
y1
; y <
y2
; y++)

1677 
x
 = 
x1
; x <
x2
; x++)

1678 
	`edôtûe_hide_add_⁄e
(
ds1_idx
, 
x
, 
y
);

1679 
	}
}

1684 
	$edôtûe_ch™ge_to_dñ_£l
(
ds1_idx
, 
TMP_SEL_S
 * 
s
)

1686 
x
, 
y
, 
x1
, 
y1
, 
x2
, 
y2
;

1689 
x1
 = 
s
->x1;

1690 
x2
 = 
s
->x2;

1691 i‡(
s
->
x2
 < s->
x1
)

1693 
x1
 = 
s
->
x2
;

1694 
x2
 = 
s
->
x1
;

1696 
y1
 = 
s
->y1;

1697 
y2
 = 
s
->y2;

1698 i‡(
s
->
y2
 < s->
y1
)

1700 
y1
 = 
s
->
y2
;

1701 
y2
 = 
s
->
y1
;

1704 
	`undo_√w_tûe_buf„r
(
ds1_idx
);

1705 
y
 = 
y1
; y <
y2
; y++)

1706 
x
 = 
x1
; x <
x2
; x++)

1707 
	`edôtûe_de£À˘_⁄e
(
ds1_idx
, 
x
, 
y
);

1708 
	`undo_˛o£_tûe_buf„r
(
ds1_idx
);

1709 
	}
}

	@edittile.h

1 #i‚de‡
_EDITTILE_H_


3 
	#_EDITTILE_H_


	)

6 
edôtûe_middÀ_£À˘
 (
ds1_idx
, * 
°¨t_x
, * 
°¨t_y
);

7 
edôtûe_∑°e_¥ï¨e
 (
ds1_idx
);

8 
edôtûe_∑°e_undo
 (
ds1_idx
);

9 
edôtûe_∑°e_¥evõw
 (
ds1_idx
, 
dx
, 
dy
, 
PASTE_POS_S
 * 
p
);

10 
edôtûe_∑°e_föÆ
 (
ds1_idx
);

13 
edôtûe_dñëe_£À˘ed_tûes
 (
ds1_idx
);

14 
edôtûe_dñëe_£À˘ed_tûes2
 (
ds1_idx
);

17 
edôtûe_de£À˘_⁄e
 (
ds1_idx
, 
x
, 
y
);

18 
edôtûe_de£À˘_⁄e_com∂ëly
 (
ds1_idx
, 
x
, 
y
);

19 
edôtûe_£À˘_⁄e
 (
ds1_idx
, 
x
, 
y
);

20 
edôtûe_£À˘_√w_⁄e
 (
ds1_idx
, 
x
, 
y
);

21 
edôtûe_idítiˇl
 (
ds1_idx
, 
IT_ENUM
 
ôy≥
, 
tx
, 
ty
);

24 
edôtûe_unhide_Æl
 (
ds1_idx
);

25 
edôtûe_hide_add_⁄e
 (
ds1_idx
, 
x
, 
y
);

28 
edôtûe_dñëe_Æl_tmp£l
 (
ds1_idx
);

29 
edôtûe_add_tmp£l_⁄e
 (
ds1_idx
, 
x
, 
y
);

30 
edôtûe_£t_tmp£l
 (
ds1_idx
, 
TMP_SEL_S
 * 
s
);

31 
edôtûe_ch™ge_to_√w_≥rm™ít_£l
 (
ds1_idx
, 
TMP_SEL_S
 * 
s
);

32 
edôtûe_ch™ge_to_add_≥rm™ít_£l
 (
ds1_idx
, 
TMP_SEL_S
 * 
s
);

33 
edôtûe_ch™ge_to_hide_£l
 (
ds1_idx
, 
TMP_SEL_S
 * 
s
);

34 
edôtûe_ch™ge_to_dñ_£l
 (
ds1_idx
, 
TMP_SEL_S
 * 
s
);

	@error.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~"°ru˘s.h
"

4 
	~"îr‹.h
"

9 
	$ds1edô_îr‹
(c⁄° * 
ãxt
)

12 
	`¥ötf
("\nds1edô_îr‹(Ë:\n%s\n\n", 
ãxt
);

13 
	`fÊush
(
°dout
);

14 
	`f˛o£
(
°dout
);

17 
	`Ârötf
(

18 
°dîr
,

20 
ãxt


22 
	`fÊush
(
°dîr
);

25 
	`ÆÀgro_mesßge
(
ãxt
);

28 
	`exô
(
DS1ERR_OTHER
);

29 
	}
}

	@error.h

1 #i‚de‡
_ERROR_H_


3 
	#_ERROR_H_


	)

5 
ds1edô_îr‹
 (c⁄° * 
ãxt
);

	@gfx_custom.c

1 
	~"°ru˘s.h
"

2 
	~"gfx_cu°om.h
"

10 
	$°ªtch_å™s_•rôe_8bµ
(
BITMAP
 * 
d°
, BITMAP * 
•rôe
, 
x0
, 
y0
, 
div
)

12 
dx1
, 
dy1
, 
dx2
, 
dy2
, 
sx1
, 
sy1
, 
dw
, 
dh
, 
sw
, 
sh
;

16 i‡((
	`bôm≠_cﬁ‹_dïth
(
d°
Ë!8Ë|| (bôm≠_cﬁ‹_dïth(
•rôe
) != 8))

18 i‡(–! 
	`is_löór_bôm≠
(
d°
)Ë|| ( ! is_löór_bôm≠(
•rôe
)))

23 
dw
 = 
d°
->
w
;

24 
dh
 = 
d°
->
h
;

25 i‡((
x0
 >
dw
Ë|| (
y0
 >
dh
))

28 
sw
 = 
•rôe
->
w
;

29 
sh
 = 
•rôe
->
h
;

32 i‡(
x0
 < 0)

34 
dx1
 = 0;

35 
sx1
 = (-
x0
Ë* 
div
;

36 i‡(
sx1
 >
sw
)

41 
dx1
 = 
x0
;

42 
sx1
 = 0;

45 i‡(
y0
 < 0)

47 
dy1
 = 0;

48 
sy1
 = (-
y0
Ë* 
div
;

49 i‡(
sy1
 >
sh
)

54 
dy1
 = 
y0
;

55 
sy1
 = 0;

59 
sw
 /
div
;

60 
sh
 /
div
;

62 
dx2
 = 
dx1
 + 
sw
 - 1 - (
sx1
 / 
div
);

63 i‡(
dx2
 >
dw
)

64 
dx2
 = 
dw
 - 1;

66 
dy2
 = 
dy1
 + 
sh
 - 1 - (
sy1
 / 
div
);

67 i‡(
dy2
 >
dh
)

68 
dy2
 = 
dh
 - 1;

70 i‡((
dx2
 < 0Ë|| (
dy2
 < 0))

75 
dx
, 
dy
, 
sx
, 
sy
;

77 
dx
 = 
dx1
;

78 
dy
 = 
dy1
;

79 
sx
 = 
sx1
;

80 
sy
 = 
sy1
;

81 i‡(
cﬁ‹_m≠
 =
NULL
)

86 i‡(
•rôe
->
löe
[
sy
][
sx
])

87 
d°
->
löe
[
dy
][
dx
] = 
•rôe
->löe[
sy
][
sx
];

88 
dx
++;

89 i‡(
dx
 > 
dx2
)

91 
dx
 = 
dx1
;

92 
sx
 = 
sx1
;

93 
dy
++;

94 i‡(
dy
 > 
dy2
)

97 
sy
 +
div
;

100 
sx
 +
div
;

108 i‡(
•rôe
->
löe
[
sy
][
sx
])

110 
d°
->
löe
[
dy
][
dx
] = 
cﬁ‹_m≠
->
d©a


111 [ 
d°
->
löe
[
dy
][
dx
] ]

112 [ 
•rôe
->
löe
[
sy
][
sx
] ];

114 
dx
++;

115 i‡(
dx
 > 
dx2
)

117 
dx
 = 
dx1
;

118 
sx
 = 
sx1
;

119 
dy
++;

120 i‡(
dy
 > 
dy2
)

123 
sy
 +
div
;

126 
sx
 +
div
;

130 
	}
}

139 
	$°ªtch_å™s_shadow_8bµ
(
BITMAP
 * 
d°
, BITMAP * 
•rôe
, 
x0
, 
y0
, 
div
,

140 
UBYTE
 * 
cm≠
, 
offy
)

142 
dx1
, 
dy1
, 
dx2
, 
dy2
, 
sx1
, 
sy1
, 
sw
, 
sh
;

146 i‡((
	`bôm≠_cﬁ‹_dïth
(
d°
Ë!8Ë|| (bôm≠_cﬁ‹_dïth(
•rôe
) != 8))

148 i‡(–! 
	`is_löór_bôm≠
(
d°
)Ë|| ( ! is_löór_bôm≠(
•rôe
)))

151 
sx1
 = 0;

152 
sy1
 = 0;

153 
sw
 = 
•rôe
->
w
 / 
div
;

154 
sh
 = 
•rôe
->
h
 / (
div
 * 2);

156 
dy1
 = 
y0
 + ((
offy
 - y0) / 2);

157 
dx1
 = 
x0
 - ((
offy
 - 
y0
) / 2);

159 
dx2
 = 
dx1
 + 
sw
 - 1;

160 
dy2
 = 
dy1
 + 
sh
 - 1;

164 
dx
, 
dy
, 
sx
, 
sy
;

166 
dx
 = 
dx1
;

167 
dy
 = 
dy1
;

168 
sx
 = 
sx1
;

169 
sy
 = 
sy1
;

172 i‡((
dx
 >0Ë&& (
dy
 >0Ë&& (dx < 
d°
->
w
Ë&& (dy < d°->
h
))

174 i‡(
•rôe
->
löe
[
sy
][
sx
])

175 
d°
->
löe
[
dy
][
dx
] = 
cm≠
[ dst->line[dy][dx] ];

177 
dx
++;

178 i‡(
dx
 > 
dx2
)

180 
dx1
++;

181 
dx2
++;

182 
dx
 = 
dx1
;

183 
sx
 = 
sx1
;

184 
dy
++;

185 i‡(
dy
 > 
dy2
)

188 
sy
 +
div
 * 2;

191 
sx
 +
div
;

194 
	}
}

	@gfx_custom.h

1 #i‚de‡
_GFX_CUSTOM_H_


3 
	#_GFX_CUSTOM_H_


	)

5 
°ªtch_å™s_•rôe_8bµ
(
BITMAP
 * 
d°
, BITMAP * 
•rôe
, 
x0
, 
y0
, 
div
);

6 
°ªtch_å™s_shadow_8bµ
(
BITMAP
 * 
d°
, BITMAP * 
•rôe
, 
x0
, 
y0
, 
div
, 
UBYTE
 * 
cm≠_±r
, 
offy
);

	@inicreat.c

1 
	~<°dio.h
>

2 
	~"ty≥s.h
"

3 
	~"îr‹.h
"

4 
	~"öi¸ót.h
"

9 
	$öi_¸óã
(* 
ööame
)

11 
FILE
 * 
out
;

12 
tmp
[80];

14 
	`¥ötf
("ˇn'à›í %s, cª©ög it\n", 
ööame
);

15 
out
 = 
	`f›í
(
ööame
, "wt");

16 i‡(
out
 =
NULL
)

18 
	`•rötf
(
tmp
, "ˇn'à¸óã %s", 
ööame
);

19 
	`ds1edô_îr‹
(
tmp
);

21 
	`Âuts
(

151 , 
out


154 
	`f˛o£
(
out
);

155 
	`¥ötf
("new ds1edit.ini was created\n");

156 
	`Ârötf
(
°dîr
, "new ds1edit.ini was created\n");

157 
	}
}

	@inicreat.h

1 #i‚de‡
_INICREAT_H_


3 
	#_INICREAT_H_


	)

5 
öi_¸óã
 (* 
ööame
);

	@iniread.c

1 
	~"°ru˘s.h
"

2 
	~"îr‹.h
"

3 
	~<°rög.h
>

4 
	~"öúód.h
"

8 
	$öi_ªad
(* 
ööame
)

10 íum {
T_NULL
, 
T_MPQ
, 
T_MOD
, 
T_STR
, 
T_INT
, 
T_GAM
, 
T_YES
, 
T_ZOOM
} 
	tTYPE_E
;

13 
«me
[30];

14 
TYPE_E
 
ty≥
;

15 * 
d©a_±r
;

16 * 
def
;

17 } 
d©as
[] =

19 {"d2ch¨", 
T_MPQ
, & 
glb_c⁄fig
.
mpq_fûe
[3], ""},

20 {"d2d©a", 
T_MPQ
, & 
glb_c⁄fig
.
mpq_fûe
[2], ""},

21 {"d2exp", 
T_MPQ
, & 
glb_c⁄fig
.
mpq_fûe
[1], ""},

22 {"∑tch_d2", 
T_MPQ
, & 
glb_c⁄fig
.
mpq_fûe
[0], ""},

23 {"mod_dú", 
T_MOD
, & 
glb_c⁄fig
.
mod_dú
[0], ""},

24 {"fuŒ_s¸ìn", 
T_YES
, & 
glb_c⁄fig
.
fuŒs¸ìn
, "YES"},

25 {"s¸ìn_width", 
T_INT
, & 
glb_c⁄fig
.
s¸ìn
.
width
, (*) 800},

26 {"s¸ìn_height", 
T_INT
, & 
glb_c⁄fig
.
s¸ìn
.
height
, (*) 600},

27 {"s¸ìn_dïth", 
T_INT
, & 
glb_c⁄fig
.
s¸ìn
.
dïth
, (*) 8},

28 {"ª‰esh_øã", 
T_INT
, & 
glb_c⁄fig
.
s¸ìn
.
ª‰esh
, (*) 60},

29 {"keyb_s¸ﬁl_x", 
T_INT
, & 
glb_c⁄fig
.
s¸ﬁl
.
keyb
.
x
, (*) 40},

30 {"keyb_s¸ﬁl_y", 
T_INT
, & 
glb_c⁄fig
.
s¸ﬁl
.
keyb
.
y
, (*) 20},

31 {"mou£_s¸ﬁl_x", 
T_INT
, & 
glb_c⁄fig
.
s¸ﬁl
.
mou£
.
x
, (*) 20},

32 {"mou£_s¸ﬁl_y", 
T_INT
, & 
glb_c⁄fig
.
s¸ﬁl
.
mou£
.
y
, (*) 10},

33 {"edô_s¸ﬁl_x", 
T_INT
, & 
glb_c⁄fig
.
s¸ﬁl
.
edô
.
x
, (*) 20},

34 {"edô_s¸ﬁl_y", 
T_INT
, & 
glb_c⁄fig
.
s¸ﬁl
.
edô
.
y
, (*) 20},

35 {"obj_edô_s¸ﬁl", 
T_INT
, & 
glb_c⁄fig
.
s¸ﬁl
.
obj_edô
, (*) 2},

36 {"mou£_•ìd_x", 
T_INT
, & 
glb_c⁄fig
.
mou£_•ìd
.
x
, (*) 2},

37 {"mou£_•ìd_y", 
T_INT
, & 
glb_c⁄fig
.
mou£_•ìd
.
y
, (*) 2},

38 {"gamma_c‹ª˘i⁄", 
T_GAM
, & 
glb_c⁄fig
.
gamma
, "1.30"},

39 {"⁄ly_n‹mÆ_ty≥2", 
T_YES
, & 
glb_c⁄fig
.
n‹mÆ_ty≥2
, "YES"},

40 {"Æways_max_œyîs", 
T_YES
, & 
glb_c⁄fig
.
Æways_max_œyîs
, "YES"},

41 {"°ªtch_•rôe", 
T_YES
, & 
glb_c⁄fig
.
°ªtch_•rôes
, "YES"},

42 {"wöobj_ˇn_s¸ﬁl_keyb", 
T_YES
, & 
glb_c⁄fig
.
wöobj_s¸ﬁl_keyb
, "YES"},

43 {"wöobj_ˇn_s¸ﬁl_mou£", 
T_YES
, & 
glb_c⁄fig
.
wöobj_s¸ﬁl_mou£
, "NO"},

44 {"˚¡î_zoom", 
T_ZOOM
, & 
glb_c⁄fig
.
˚¡î_zoom
, "1:1"},

45 {"nb_ty≥1_≥r_a˘", 
T_INT
, & 
glb_c⁄fig
.
nb_ty≥1_≥r_a˘
, (*) 60},

46 {"nb_ty≥2_≥r_a˘", 
T_INT
, & 
glb_c⁄fig
.
nb_ty≥2_≥r_a˘
, (*) 150},

47 {"ds1_ßved_möimize", 
T_YES
, & 
glb_c⁄fig
.
möimize_ds1
, "YES"},

48 {"lowî_•ìd_zoom_out", 
T_YES
, & 
glb_c⁄fig
.
lowî_•ìd_zoom_out
, "NO"},

49 {"w‹k•a˚_íabÀ", 
T_YES
, & 
glb_c⁄fig
.
w‹k•a˚_íabÀ
, "YES"},

50 {"", 
T_NULL
, 
NULL
, NULL}

52 
i
, 
vÆ
, 
is_ok
 = 
TRUE
, 
n
, 
Àn
;

53 c⁄° * 
°r
;

54 
tmp
[256], * 
buf
, ** 
tmµå
;

57 
	`¥ötf
("ini_read()\n");

58 
	`Ârötf
(
°dîr
, "ini_read(),Üoad ds1edit.ini\n");

59 
	`fÊush
(
°dout
);

60 
	`fÊush
(
°dîr
);

62 
	`£t_c⁄fig_fûe
(
ööame
);

63 
i
 = 0;

64 
d©as
[
i
].
ty≥
 !
T_NULL
)

66 
°r
 = 
	`gë_c⁄fig_°rög
(
NULL
, 
d©as
[
i
].
«me
, (c⁄° *Ëd©as[i].
def
);

67 i‡(
°r
 =
NULL
)

69 
	`Ârötf
(

70 
°dîr
,

72 
d©as
[
i
].
«me


74 
	`Ârötf
(

75 
°dout
,

77 
d©as
[
i
].
«me


79 
is_ok
 = 
FALSE
;

81 
d©as
[
i
].
ty≥
)

84 
T_STR
 :

85 i‡(
	`°æí
(
°r
))

86 
d©as
[
i
].
d©a_±r
 = (*Ë
°r
;

90 
T_INT
 :

91 
vÆ
 = 
	`gë_c⁄fig_öt
(
NULL
, 
d©as
[
i
].
«me
, (Ëd©as[i].
def
);

92 * ((*Ë
d©as
[
i
].
d©a_±r
Ë
vÆ
;

96 
T_GAM
 :

97 
n
=0;

98  (
n
 < 
GC_MAX
) &&

99 (
	`°rcmp
(
°r
, 
glb_gamma_°r
[
n
].str) != 0) )

100 
n
++;

101 i‡(
n
 < 
GC_MAX
)

102 
glb_c⁄fig
.
gamma
 = 
glb_gamma_°r
[
n
].
vÆ
;

106 
T_MPQ
 :

107 
Àn
 = 
	`°æí
(
°r
);

108 i‡(
Àn
)

110 
buf
 = (*Ë
	`mÆloc
((Ë* (
Àn
+1));

111 i‡(
buf
 =
NULL
)

112 
	`ds1edô_îr‹
("read_ini(), malloc()Érror on MpqÇame");

115 
	`°r˝y
(
buf
, 
°r
);

116 
tmµå
 = 
d©as
[
i
].
d©a_±r
;

117 * 
tmµå
 = 
buf
;

123 
T_MOD
 :

124 
Àn
 = 
	`°æí
(
°r
);

125 i‡(
Àn
)

127 
buf
 = (*Ë
	`mÆloc
((Ë* (
Àn
+1));

128 i‡(
buf
 =
NULL
)

129 
	`ds1edô_îr‹
("read_ini(), malloc()Érror on ModÇame");

132 
	`°r˝y
(
buf
, 
°r
);

133 i‡((
buf
[
	`°æí
(buf)-1] == '\\') || (buf[strlen(buf)-1] == '/'))

134 
buf
[
	`°æí
(buf)-1] = 0;

135 
tmµå
 = 
d©as
[
i
].
d©a_±r
;

136 * 
tmµå
 = 
buf
;

142 
T_YES
 :

143 i‡(
	`°æí
(
°r
))

145 i‡(
	`°ricmp
(
°r
, "YES") == 0)

146 * ((*Ë
d©as
[
i
].
d©a_±r
Ë
TRUE
;

148 * ((*Ë
d©as
[
i
].
d©a_±r
Ë
FALSE
;

153 
T_ZOOM
 :

154 i‡(
	`°æí
(
°r
))

157 * ((*Ë
d©as
[
i
].
d©a_±r
) = -1;

160 i‡(
	`°ricmp
(
°r
, "1:1") == 0)

161 * ((*Ë
d©as
[
i
].
d©a_±r
Ë
ZM_11
;

162 i‡(
	`°ricmp
(
°r
, "1:2") == 0)

163 * ((*Ë
d©as
[
i
].
d©a_±r
Ë
ZM_12
;

164 i‡(
	`°ricmp
(
°r
, "1:4") == 0)

165 * ((*Ë
d©as
[
i
].
d©a_±r
Ë
ZM_14
;

166 i‡(
	`°ricmp
(
°r
, "1:8") == 0)

167 * ((*Ë
d©as
[
i
].
d©a_±r
Ë
ZM_18
;

168 i‡(
	`°ricmp
(
°r
, "1:16") == 0)

169 * ((*Ë
d©as
[
i
].
d©a_±r
Ë
ZM_116
;

172 
d©as
[
i
].
d©a_±r
 = (*Ë
°r
;

176 
i
++;

178 i‡(
is_ok
 !
TRUE
)

180 
	`•rötf
(

181 
tmp
,

185 
ööame


187 
	`ds1edô_îr‹
(
tmp
);

189 
	}
}

	@iniread.h

1 #i‚de‡
_INIREAD_H_


3 
	#_INIREAD_H_


	)

5 
öi_ªad
 (* 
ööame
);

	@interfac.c

1 
	~"°ru˘s.h
"

2 
	~"wPªvõw.h
"

3 
	~"edôobj.h
"

4 
	~"misc.h
"

5 
	~"ds1ßve.h
"

6 
	~"msg_ßve.h
"

7 
	~"edôtûe.h
"

8 
	~"undo.h
"

9 
	~"™imd©a.h
"

10 
	~"™im.h
"

11 
	~"txåód.h
"

12 
	~"wBôs.h
"

13 
	~"wEdô.h
"

14 
	~"msg_quô.h
"

15 
	~"öãrÁc.h
"

20 
	$öãrÁc_u£r_h™dÀr
(
°¨t_ds1_idx
)

22 
ds1_idx
, 
d⁄e
, 
cx
, 
cy
, 
n
, 
i
, 
dx
, 
dy
, 
ﬁd_ds1_idx
=0;

23 
ﬁd_mou£_x
 = 
mou£_x
, 
ﬁd_mou£_y
=
mou£_y
, 
ﬁd_mou£_b
=0;

24 
cur_mou£_z
 = 0, 
ﬁd_mou£_z
 = 0;

25 
ﬁd_˚Œ_x
 = -1, 
ﬁd_˚Œ_y
 = -1;

26 
ﬁd_idítiˇl_x
 = -1, 
ﬁd_idítiˇl_y
 = -1;

27 
ticks_ñ≠£d
, 
ªt
;

28 
ˇn_swich_mode
, 
key_func_code
[7] = {
KEY_F1
, 
KEY_F2
,

29 
KEY_F5
, 
KEY_F6
, 
KEY_F7
, 
KEY_F8
, 
KEY_F11
};

30 
TMP_SEL_S
 
tmp_£l
;

31 
PASTE_POS_S
 
∑°e_pos
;

32 
tmp
[150];

33 
MODE_E
 
ﬁd_mode
 = 0;

34 
IT_ENUM
 
ôy≥
 = 
IT_NULL
;

35 
group_ch™ged
, 
ﬁd_group
, 
found
;

36 
BITMAP
 * 
ﬁd_s¸ìn_buff
 = 
NULL
;

40 
tmp_£l
.
x1
 =Åmp_£l.
x2
 =Åmp_£l.
y1
 =Åmp_£l.
y2
 = 0;

41 
tmp_£l
.
ﬁd_x2
 =Åmp_£l.
ﬁd_y2
 = 0;

42 
tmp_£l
.
ty≥
 = 
TMP_NULL
;

43 
tmp_£l
.
°¨t
 = 
FALSE
;

44 
∑°e_pos
.
ﬁd_ds1_idx
 = 0;

45 
∑°e_pos
.
ﬁd_x
 = 0;

46 
∑°e_pos
.
ﬁd_y
 = 0;

47 
∑°e_pos
.
§c_ds1_idx
 = 0;

48 
∑°e_pos
.
°¨t_x
 = 0;

49 
∑°e_pos
.
°¨t_y
 = 0;

50 
∑°e_pos
.
°¨t
 = 
FALSE
;

51 
∑°e_pos
.
is_cut
 = 
FALSE
;

52 
∑°e_pos
.
cut_ßved
 = 
FALSE
;

53 
ds1_idx
 = 
°¨t_ds1_idx
;

54 
d⁄e
 = 
FALSE
;

58 ! 
d⁄e
)

60 
ˇn_swich_mode
 = 
TRUE
;

61 i‡(
glb_ds1edô
.
mode
 =
MOD_P
)

63 i‡(
glb_ds1
[
ds1_idx
].
∑th_edô_wö
.
mode
 !
PEM_NONE
)

64 
ˇn_swich_mode
 = 
FALSE
;

65 i‡(
glb_ds1
[
ds1_idx
].
∑th_edô_wö
.
obj_dúty
 =
TRUE
)

66 
ˇn_swich_mode
 = 
FALSE
;

69 
ﬁd_mou£_x
 = 
mou£_x
;

70 
ﬁd_mou£_y
 = 
mou£_y
;

71 
ﬁd_mou£_b
 = 
mou£_b
;

73 
cur_mou£_z
 = 
mou£_z
;

78 
	`mou£_to_tûe
(
ds1_idx
, &
cx
, &
cy
);

79 i‡(
glb_ds1edô
.
mode
 =
MOD_T
)

81 i‡(
cx
 < 0)

82 
cx
 = 0;

83 i‡(
cx
 >
glb_ds1
[
ds1_idx
].
width
)

84 
cx
 = 
glb_ds1
[
ds1_idx
].
width
 - 1;

85 i‡(
cy
 < 0)

86 
cy
 = 0;

87 i‡(
cy
 >
glb_ds1
[
ds1_idx
].
height
)

88 
cy
 = 
glb_ds1
[
ds1_idx
].
height
 - 1;

92 
cx
 -= 2;

93 
cy
 += 2;

94 i‡(
cx
 < 0)

95 
cx
 = 0;

96 i‡(
cx
 >
glb_ds1
[
ds1_idx
].
width
 * 5 - 1)

97 
cx
 = 
glb_ds1
[
ds1_idx
].
width
 * 5 - 1;

98 i‡(
cy
 < 0)

99 
cy
 = 0;

100 i‡(
cy
 >
glb_ds1
[
ds1_idx
].
height
 * 5 - 1)

101 
cy
 = 
glb_ds1
[
ds1_idx
].
height
 * 5 - 1;

104 i‡(
glb_ds1edô
.
mode
 =
MOD_O
)

106 
	`edôobj_h™dÀr
(

107 
ds1_idx
, 
cx
,

108 
cy
,

109 
ﬁd_mou£_x
,

110 
ﬁd_mou£_y
,

111 
ﬁd_mou£_b


115 i‡((
cx
 !
ﬁd_˚Œ_x
Ë|| (
cy
 !
ﬁd_˚Œ_y
))

117 
ﬁd_˚Œ_x
 = 
cx
;

118 
ﬁd_˚Œ_y
 = 
cy
;

119 
ﬁd_idítiˇl_x
 = -1;

120 
ﬁd_idítiˇl_y
 = -1;

124 
ticks_ñ≠£d
 = 
glb_ds1edô
.ticks_elapsed;

125 i‡–
ticks_ñ≠£d
 && (
glb_ds1
[
ds1_idx
].
™im©i⁄s_œyî_mask
 == 1))

130 
glb_ds1
[
ds1_idx
].
cur_™im_Êo‹_‰ame
 +
ticks_ñ≠£d
 * 2;

133 
glb_ds1edô
.
ticks_ñ≠£d
 = 0;

136 
	`w¥evõw_døw_tûes
(
ds1_idx
);

137 
glb_ds1edô
.
Âs
++;

142 i‡(
glb_ds1
[
ds1_idx
].
døw_edô_obj
 =
TRUE
)

144 i‡(
glb_c⁄fig
.
wöobj_s¸ﬁl_keyb
 =
TRUE
)

147 i‡(
key
[
KEY_UP
])

149 
glb_ds1edô
.
wö_¥evõw
.
y0
 -
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
keyb
.
y
;

151 i‡(
key
[
KEY_DOWN
])

153 
glb_ds1edô
.
wö_¥evõw
.
y0
 +
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
keyb
.
y
;

155 i‡(
key
[
KEY_LEFT
])

157 
glb_ds1edô
.
wö_¥evõw
.
x0
 -
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
keyb
.
x
;

159 i‡(
key
[
KEY_RIGHT
])

161 
glb_ds1edô
.
wö_¥evõw
.
x0
 +
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
keyb
.
x
;

165 i‡(
glb_c⁄fig
.
wöobj_s¸ﬁl_mou£
 =
TRUE
)

168 i‡(
ﬁd_mou£_y
 == 0)

170 
glb_ds1edô
.
wö_¥evõw
.
y0
 -
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
mou£
.
y
;

172 i‡(
ﬁd_mou£_y
 =
glb_c⁄fig
.
s¸ìn
.
height
 - 1)

174 
glb_ds1edô
.
wö_¥evõw
.
y0
 +
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
mou£
.
y
;

176 i‡(
ﬁd_mou£_x
 == 0)

178 
glb_ds1edô
.
wö_¥evõw
.
x0
 -
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
mou£
.
x
;

180 i‡(
ﬁd_mou£_x
 =
glb_c⁄fig
.
s¸ìn
.
width
 - 1)

182 
glb_ds1edô
.
wö_¥evõw
.
x0
 +
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
mou£
.
x
;

188 i‡(
key
[
KEY_UP
])

190 
glb_ds1edô
.
wö_¥evõw
.
y0
 -
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
keyb
.
y
;

192 i‡(
ﬁd_mou£_y
 == 0)

194 
glb_ds1edô
.
wö_¥evõw
.
y0
 -
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
mou£
.
y
;

197 i‡(
key
[
KEY_DOWN
])

199 
glb_ds1edô
.
wö_¥evõw
.
y0
 +
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
keyb
.
y
;

201 i‡(
ﬁd_mou£_y
 =
glb_c⁄fig
.
s¸ìn
.
height
 - 1)

203 
glb_ds1edô
.
wö_¥evõw
.
y0
 +
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
mou£
.
y
;

206 i‡(
key
[
KEY_LEFT
])

208 
glb_ds1edô
.
wö_¥evõw
.
x0
 -
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
keyb
.
x
;

210 i‡(
ﬁd_mou£_x
 == 0)

212 
glb_ds1edô
.
wö_¥evõw
.
x0
 -
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
mou£
.
x
;

215 i‡(
key
[
KEY_RIGHT
])

217 
glb_ds1edô
.
wö_¥evõw
.
x0
 +
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
keyb
.
x
;

219 i‡(
ﬁd_mou£_x
 =
glb_c⁄fig
.
s¸ìn
.
width
 - 1)

221 
glb_ds1edô
.
wö_¥evõw
.
x0
 +
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
mou£
.
x
;

226 i‡–(
key
[
KEY_MINUS_PAD
] || key[
KEY_MINUS
] || (
cur_mou£_z
 < 
ﬁd_mou£_z
) ) &&

227 
glb_ds1
[
ds1_idx
].
cur_zoom
 < 
ZM_116
)

229 i‡(
key
[
KEY_MINUS_PAD
] || key[
KEY_MINUS
])

231 
key
[
KEY_MINUS_PAD
] || key[
KEY_MINUS
])

236 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
x0
 = 
glb_ds1edô
.
wö_¥evõw
.x0;

237 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
y0
 = 
glb_ds1edô
.
wö_¥evõw
.y0;

238 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
w
 = 
glb_ds1edô
.
wö_¥evõw
.w;

239 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
h
 = 
glb_ds1edô
.
wö_¥evõw
.h;

240 
	`ch™ge_zoom
(
ds1_idx
, 
glb_ds1
[ds1_idx].
cur_zoom
 + 1);

241 
glb_ds1edô
.
wö_¥evõw
.
x0
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.x0;

242 
glb_ds1edô
.
wö_¥evõw
.
y0
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.y0;

245 i‡–(
key
[
KEY_PLUS_PAD
] || key[
KEY_EQUALS
] || (
cur_mou£_z
 > 
ﬁd_mou£_z
) ) &&

246 
glb_ds1
[
ds1_idx
].
cur_zoom
 > 
ZM_11
)

248 i‡(
key
[
KEY_PLUS_PAD
] || key[
KEY_EQUALS
])

250 
key
[
KEY_PLUS_PAD
] || key[
KEY_EQUALS
])

255 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
x0
 = 
glb_ds1edô
.
wö_¥evõw
.x0;

256 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
y0
 = 
glb_ds1edô
.
wö_¥evõw
.y0;

257 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
w
 = 
glb_ds1edô
.
wö_¥evõw
.w;

258 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
h
 = 
glb_ds1edô
.
wö_¥evõw
.h;

259 
	`ch™ge_zoom
(
ds1_idx
, 
glb_ds1
[ds1_idx].
cur_zoom
 - 1);

260 
glb_ds1edô
.
wö_¥evõw
.
x0
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.x0;

261 
glb_ds1edô
.
wö_¥evõw
.
y0
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.y0;

264 i‡(
ﬁd_mou£_z
 !
cur_mou£_z
)

266 
ﬁd_mou£_z
 = 
cur_mou£_z
;

267 i‡(
mou£_b
 & 4)

269 i‡(
glb_ds1edô
.
mode
 =
MOD_T
)

272 
cx
++;

273 
dx
 = (
cy
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2Ë+ (
cx
 * glb_ds1[ds1_idx].tile_w / 2);

274 
dy
 = (
cy
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2Ë+ (
cx
 * glb_ds1[ds1_idx].tile_h / 2);

275 
cx
--;

276 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
x0
 = 
glb_ds1edô
.
wö_¥evõw
.x0 =

277 
dx
 - 
glb_ds1edô
.
wö_¥evõw
.
w
 / 2;

278 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
y0
 = 
glb_ds1edô
.
wö_¥evõw
.y0 =

279 
dy
 - 
glb_ds1edô
.
wö_¥evõw
.
h
 / 2;

280 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
w
 = 
glb_ds1edô
.
wö_¥evõw
.w;

281 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
h
 = 
glb_ds1edô
.
wö_¥evõw
.h;

282 
glb_ds1edô
.
wö_¥evõw
.
x0
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.x0;

283 
glb_ds1edô
.
wö_¥evõw
.
y0
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.y0;

284 
	`posôi⁄_mou£
(
glb_ds1edô
.
wö_¥evõw
.
w
 / 2, glb_ds1edô.wö_¥evõw.
h
 / 2);

289 
cx
 /= 5;

290 
cy
 /= 5;

291 
cx
++;

292 
dx
 = (
cy
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2Ë+ (
cx
 * glb_ds1[ds1_idx].tile_w / 2);

293 
dy
 = (
cy
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2Ë+ (
cx
 * glb_ds1[ds1_idx].tile_h / 2);

294 
cx
--;

295 
cx
 *= 5;

296 
cy
 *= 5;

297 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
x0
 = 
glb_ds1edô
.
wö_¥evõw
.x0 =

298 
dx
 - 
glb_ds1edô
.
wö_¥evõw
.
w
 / 2;

299 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
y0
 = 
glb_ds1edô
.
wö_¥evõw
.y0 =

300 
dy
 - 
glb_ds1edô
.
wö_¥evõw
.
h
 / 2;

301 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
w
 = 
glb_ds1edô
.
wö_¥evõw
.w;

302 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
h
 = 
glb_ds1edô
.
wö_¥evõw
.h;

303 
glb_ds1edô
.
wö_¥evõw
.
x0
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.x0;

304 
glb_ds1edô
.
wö_¥evõw
.
y0
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.y0;

305 
	`posôi⁄_mou£
(
glb_ds1edô
.
wö_¥evõw
.
w
 / 2, glb_ds1edô.wö_¥evõw.
h
 / 2);

311 i‡(
key
[
KEY_LSHIFT
] || key[
KEY_RSHIFT
])

314 
n
=0;Ç<7;Ç++)

316 i‡(
key
[
key_func_code
[
n
]])

318 
i
=0; i<
FLOOR_MAX_LAYER
; i++)

319 
glb_ds1
[
ds1_idx
].
Êo‹_œyî_mask
[
i
] = 0;

321 i‡(
key
[
KEY_F11
])

323 
i
=0; i<
SHADOW_MAX_LAYER
; i++)

324 
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[
i
] = 3;

328 
i
=0; i<
SHADOW_MAX_LAYER
; i++)

329 
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[
i
] = 0;

332 
i
=0; i<
WALL_MAX_LAYER
; i++)

333 
glb_ds1
[
ds1_idx
].
wÆl_œyî_mask
[
i
] = 0;

339 i‡(
key
[
KEY_LCONTROL
] || key[
KEY_RCONTROL
])

342 
n
=0;Ç<7;Ç++)

344 i‡(
key
[
key_func_code
[
n
]])

346 
i
=0; i<
FLOOR_MAX_LAYER
; i++)

347 
glb_ds1
[
ds1_idx
].
Êo‹_œyî_mask
[
i
] = 1;

349 
i
=0; i<
SHADOW_MAX_LAYER
; i++)

350 
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[
i
] = 3;

352 
i
=0; i<
WALL_MAX_LAYER
; i++)

353 
glb_ds1
[
ds1_idx
].
wÆl_œyî_mask
[
i
] = 1;

359 i‡(
key
[
KEY_F1
])

361 
key
[
KEY_F1
])

365 
glb_ds1
[
ds1_idx
].
Êo‹_œyî_mask
[0] = 1 - glb_ds1[ds1_idx].floor_layer_mask[0];

367 i‡(
key
[
KEY_F2
])

369 
key
[
KEY_F2
])

373 
glb_ds1
[
ds1_idx
].
Êo‹_œyî_mask
[1] = 1 - glb_ds1[ds1_idx].floor_layer_mask[1];

375 i‡(
key
[
KEY_F5
])

377 
key
[
KEY_F5
])

381 
glb_ds1
[
ds1_idx
].
wÆl_œyî_mask
[0] = 1 - glb_ds1[ds1_idx].wall_layer_mask[0];

383 i‡(
key
[
KEY_F6
])

385 
key
[
KEY_F6
])

389 
glb_ds1
[
ds1_idx
].
wÆl_œyî_mask
[1] = 1 - glb_ds1[ds1_idx].wall_layer_mask[1];

391 i‡(
key
[
KEY_F7
])

393 
key
[
KEY_F7
])

397 
glb_ds1
[
ds1_idx
].
wÆl_œyî_mask
[2] = 1 - glb_ds1[ds1_idx].wall_layer_mask[2];

399 i‡(
key
[
KEY_F8
])

401 
key
[
KEY_F8
])

405 
glb_ds1
[
ds1_idx
].
wÆl_œyî_mask
[3] = 1 - glb_ds1[ds1_idx].wall_layer_mask[3];

409 i‡(
key
[
KEY_F9
])

411 
key
[
KEY_F9
])

415 
glb_ds1
[
ds1_idx
].
•ecül_œyî_mask
 = 1 - glb_ds1[ds1_idx].special_layer_mask;

419 i‡(
key
[
KEY_F3
])

421 
key
[
KEY_F3
])

425 
glb_ds1
[
ds1_idx
].
™im©i⁄s_œyî_mask
++;

426 i‡(
glb_ds1
[
ds1_idx
].
™im©i⁄s_œyî_mask
 == 3)

427 
glb_ds1
[
ds1_idx
].
™im©i⁄s_œyî_mask
 = 0;

431 i‡(
key
[
KEY_F4
] && (
glb_ds1edô
.
mode
 !
MOD_O
))

433 
key
[
KEY_F4
])

437 
glb_ds1
[
ds1_idx
].
obje˘s_œyî_mask
++;

438 i‡(
glb_ds1
[
ds1_idx
].
obje˘s_œyî_mask
 >
OL_MAX
)

439 
glb_ds1
[
ds1_idx
].
obje˘s_œyî_mask
 = 
OL_NONE
;

443 i‡(
key
[
KEY_F10
] && (
glb_ds1edô
.
mode
 !
MOD_P
))

445 
key
[
KEY_F10
])

449 
glb_ds1
[
ds1_idx
].
∑ths_œyî_mask
 = 1 - glb_ds1[ds1_idx].paths_layer_mask;

453 i‡(
key
[
KEY_F11
])

455 
key
[
KEY_F11
])

459 i‡(
key
[
KEY_LSHIFT
] || key[
KEY_RSHIFT
])

461 
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[0]--;

462 i‡(
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[0] < 0)

463 
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[0] = 3;

467 
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[0]++;

468 i‡(
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[0] >= 4)

469 
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[0] = 0;

474 i‡(
key
[
KEY_SPACE
])

476 
key
[
KEY_SPACE
])

480 
glb_ds1
[
ds1_idx
].
wÆkabÀ_œyî_mask
++;

481 i‡(
glb_ds1
[
ds1_idx
].
wÆkabÀ_œyî_mask
 >= 3)

482 
glb_ds1
[
ds1_idx
].
wÆkabÀ_œyî_mask
 = 0;

484 i‡(
key
[
KEY_T
])

486 
key
[
KEY_T
])

490 
glb_ds1
[
ds1_idx
].
subtûe_hñp_di•œy
 =

491 1 - 
glb_ds1
[
ds1_idx
].
subtûe_hñp_di•œy
;

495 i‡(
key
[
KEY_F12
])

497 i‡(
key
[
KEY_LSHIFT
] || key[
KEY_RSHIFT
])

499 i‡(
glb_ds1edô
.
cur_gamma
 > 
GC_060
)

501 
	`ª°
(80);

502 
glb_ds1edô
.
cur_gamma
--;

503 
	`misc_upd©e_∑l_wôh_gamma
();

504 
	`£t_∑Àâe
(
glb_ds1edô
.
vga_∑l
[
glb_ds1
[
ds1_idx
].
a˘
 - 1]);

509 i‡(
glb_ds1edô
.
cur_gamma
 < 
GC_300
)

511 
	`ª°
(80);

512 
glb_ds1edô
.
cur_gamma
++;

513 
	`misc_upd©e_∑l_wôh_gamma
();

514 
	`£t_∑Àâe
(
glb_ds1edô
.
vga_∑l
[
glb_ds1
[
ds1_idx
].
a˘
 - 1]);

520 i‡(
key
[
KEY_HOME
])

522 
key
[
KEY_HOME
])

526 
cx
 = 
glb_ds1
[
ds1_idx
].
width
/2 + 1;

527 
cy
 = 
glb_ds1
[
ds1_idx
].
height
/2;

528 
dx
 = (
cy
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2Ë+ (
cx
 * glb_ds1[ds1_idx].tile_w / 2);

529 
dy
 = (
cy
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2Ë+ (
cx
 * glb_ds1[ds1_idx].tile_h / 2);

530 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
x0
 = 
glb_ds1edô
.
wö_¥evõw
.x0 = 
dx
 - glb_ds1edô.wö_¥evõw.
w
 / 2;

531 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
y0
 = 
glb_ds1edô
.
wö_¥evõw
.y0 = 
dy
 - glb_ds1edô.wö_¥evõw.
h
 / 2;

535 i‡(
key
[
KEY_BACKSPACE
])

537 
key
[
KEY_BACKSPACE
])

541 
i
=0; i<
FLOOR_MAX_LAYER
; i++)

542 
glb_ds1
[
ds1_idx
].
Êo‹_œyî_mask
[
i
] = 1;

543 
i
=0; i<
WALL_MAX_LAYER
; i++)

544 
glb_ds1
[
ds1_idx
].
wÆl_œyî_mask
[
i
] = 1;

545 
i
=0; i<
SHADOW_MAX_LAYER
; i++)

546 
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[
i
] = 3;

550 i‡(
key
[
KEY_P
])

552 i‡((
key
[
KEY_LSHIFT
] || key[
KEY_RSHIFT
]))

555 
ﬁd_s¸ìn_buff
 = 
glb_ds1edô
.
s¸ìn_buff
;

556 i‡(
	`w¥evõw_døw_tûes_big_s¸ìnshŸ
(
ds1_idx
) == 0)

559 
	`•rötf
(
tmp
, "s¸ìnshŸ-%05i.bmp", 
glb_ds1edô
.
s¸ìnshŸ_num
);

560 
	`fûe_exi°s
(
tmp
, -1, 
NULL
))

562 
glb_ds1edô
.
s¸ìnshŸ_num
++;

563 
	`•rötf
(
tmp
, "s¸ìnshŸ-%05i.bmp", 
glb_ds1edô
.
s¸ìnshŸ_num
);

567 i‡(
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 == -1)

570 
	`ßve_bmp
(
tmp
, 
glb_ds1edô
.
s¸ìn_buff
, glb_ds1edô.
vga_∑l
[
glb_ds1
[
ds1_idx
].
a˘
 - 1]);

575 
	`ßve_bmp
(
tmp
, 
glb_ds1edô
.
s¸ìn_buff
, glb_ds1edô.
vga_∑l
[glb_ds1edô.
cmd_löe
.
f‹˚_∑l_num
 - 1]);

579 
	`de°roy_bôm≠
(
glb_ds1edô
.
s¸ìn_buff
);

581 (
key
[
KEY_LSHIFT
] || key[
KEY_RSHIFT
]))

585 
glb_ds1edô
.
s¸ìn_buff
 = 
ﬁd_s¸ìn_buff
;

590 
	`•rötf
(
tmp
, "s¸ìnshŸ-%05i.pcx", 
glb_ds1edô
.
s¸ìnshŸ_num
);

591 
	`fûe_exi°s
(
tmp
, -1, 
NULL
))

593 
glb_ds1edô
.
s¸ìnshŸ_num
++;

594 
	`•rötf
(
tmp
, "s¸ìnshŸ-%05i.pcx", 
glb_ds1edô
.
s¸ìnshŸ_num
);

598 
	`døw_•rôe
(

599 
glb_ds1edô
.
s¸ìn_buff
,

600 
glb_ds1edô
.
mou£_curs‹
[glb_ds1edô.
mode
],

601 
ﬁd_mou£_x
 - 1,

602 
ﬁd_mou£_y
 - 1

606 i‡(
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 == -1)

609 
	`ßve_pcx
(
tmp
, 
glb_ds1edô
.
s¸ìn_buff
, glb_ds1edô.
vga_∑l
[
glb_ds1
[
ds1_idx
].
a˘
 - 1]);

610 
	`misc_pcx_put_d2_∑Àâe
(
tmp
, 
glb_ds1
[
ds1_idx
].
a˘
 - 1);

615 
	`ßve_pcx
(
tmp
, 
glb_ds1edô
.
s¸ìn_buff
, glb_ds1edô.
vga_∑l
[glb_ds1edô.
cmd_löe
.
f‹˚_∑l_num
 - 1]);

616 
	`misc_pcx_put_d2_∑Àâe
(
tmp
, 
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 - 1);

619 
key
[
KEY_P
])

625 
glb_ds1edô
.
s¸ìnshŸ_num
++;

629 i‡(
key
[
KEY_S
])

631 i‡(
key
[
KEY_LCONTROL
] || key[
KEY_RCONTROL
])

634 
	`ds1_ßve
(
ds1_idx
, 
FALSE
);

635 
key
[
KEY_S
])

639 
ªt
 = 
	`msg_ßve_maö
();

640 
ªt
)

644 
d⁄e
 = 
TRUE
;

652 i‡(
glb_ds1edô
.
mode
 =
MOD_T
)

655 
key
[
KEY_S
])

659 
	`edôtûe_unhide_Æl
(
ds1_idx
);

664 i‡(
key
[
KEY_C
])

666 i‡(
glb_ds1edô
.
mode
 =
MOD_T
)

669 i‡(
key
[
KEY_LCONTROL
] || key[
KEY_RCONTROL
])

672 i‡(
∑°e_pos
.
°¨t
 =
FALSE
)

674 
i
=0; i<
DS1_MAX
; i++)

676 i‡(
	`°æí
(
glb_ds1
[
i
].
«me
))

677 
	`edôtûe_∑°e_¥ï¨e
(
i
);

679 
∑°e_pos
.
§c_ds1_idx
 = 
ds1_idx
;

680 
∑°e_pos
.
ﬁd_ds1_idx
 = 
ds1_idx
;

681 
∑°e_pos
.
°¨t
 = 
TRUE
;

682 
∑°e_pos
.
is_cut
 = 
FALSE
;

683 
∑°e_pos
.
cut_ßved
 = 
FALSE
;

684 
∑°e_pos
.
ﬁd_x
 = 
cx
;

685 
∑°e_pos
.
ﬁd_y
 = 
cy
;

686 
	`edôtûe_middÀ_£À˘
(

687 
ds1_idx
,

688 & 
∑°e_pos
.
°¨t_x
,

689 & 
∑°e_pos
.
°¨t_y


691 
	`edôtûe_∑°e_¥evõw
(
ds1_idx
,

692 
cx
 - 
∑°e_pos
.
°¨t_x
,

693 
cy
 - 
∑°e_pos
.
°¨t_y
,

694 & 
∑°e_pos


697 
key
[
KEY_C
])

706 
key
[
KEY_C
])

710 
cx
++;

711 
dx
 = (
cy
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2Ë+ (
cx
 * glb_ds1[ds1_idx].tile_w / 2);

712 
dy
 = (
cy
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2Ë+ (
cx
 * glb_ds1[ds1_idx].tile_h / 2);

713 
cx
--;

714 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
x0
 = 
glb_ds1edô
.
wö_¥evõw
.x0 =

715 
dx
 - 
glb_ds1edô
.
wö_¥evõw
.
w
 / 2;

716 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
y0
 = 
glb_ds1edô
.
wö_¥evõw
.y0 =

717 
dy
 - 
glb_ds1edô
.
wö_¥evõw
.
h
 / 2;

718 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
w
 = 
glb_ds1edô
.
wö_¥evõw
.w;

719 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
h
 = 
glb_ds1edô
.
wö_¥evõw
.h;

720 i‡(
glb_c⁄fig
.
˚¡î_zoom
 != -1)

721 
	`ch™ge_zoom
(
ds1_idx
, 
glb_c⁄fig
.
˚¡î_zoom
);

722 
glb_ds1edô
.
wö_¥evõw
.
x0
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.x0;

723 
glb_ds1edô
.
wö_¥evõw
.
y0
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.y0;

724 
	`posôi⁄_mou£
(
glb_ds1edô
.
wö_¥evõw
.
w
 / 2, glb_ds1edô.wö_¥evõw.
h
 / 2);

729 i‡–! 
key
[
KEY_LCONTROL
] && ! key[
KEY_RCONTROL
])

732 
key
[
KEY_C
])

736 
cx
 /= 5;

737 
cy
 /= 5;

738 
cx
++;

739 
dx
 = (
cy
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2Ë+ (
cx
 * glb_ds1[ds1_idx].tile_w / 2);

740 
dy
 = (
cy
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2Ë+ (
cx
 * glb_ds1[ds1_idx].tile_h / 2);

741 
cx
--;

742 
cx
 *= 5;

743 
cy
 *= 5;

744 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
x0
 = 
glb_ds1edô
.
wö_¥evõw
.x0 =

745 
dx
 - 
glb_ds1edô
.
wö_¥evõw
.
w
 / 2;

746 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
y0
 = 
glb_ds1edô
.
wö_¥evõw
.y0 =

747 
dy
 - 
glb_ds1edô
.
wö_¥evõw
.
h
 / 2;

748 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
w
 = 
glb_ds1edô
.
wö_¥evõw
.w;

749 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
h
 = 
glb_ds1edô
.
wö_¥evõw
.h;

750 i‡(
glb_c⁄fig
.
˚¡î_zoom
 != -1)

751 
	`ch™ge_zoom
(
ds1_idx
, 
glb_c⁄fig
.
˚¡î_zoom
);

752 
glb_ds1edô
.
wö_¥evõw
.
x0
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.x0;

753 
glb_ds1edô
.
wö_¥evõw
.
y0
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.y0;

754 
	`posôi⁄_mou£
(
glb_ds1edô
.
wö_¥evõw
.
w
 / 2, glb_ds1edô.wö_¥evõw.
h
 / 2);

760 i‡(
key
[
KEY_X
] && (key[
KEY_LCONTROL
] || key[
KEY_RCONTROL
]))

762 i‡(
glb_ds1edô
.
mode
 =
MOD_T
)

765 i‡(
∑°e_pos
.
°¨t
 =
FALSE
)

767 
i
=0; i<
DS1_MAX
; i++)

769 i‡(
	`°æí
(
glb_ds1
[
i
].
«me
))

770 
	`edôtûe_∑°e_¥ï¨e
(
i
);

772 
∑°e_pos
.
§c_ds1_idx
 = 
ds1_idx
;

773 
∑°e_pos
.
ﬁd_ds1_idx
 = 
ds1_idx
;

774 
∑°e_pos
.
°¨t
 = 
TRUE
;

775 
∑°e_pos
.
is_cut
 = 
TRUE
;

776 
∑°e_pos
.
cut_ßved
 = 
FALSE
;

777 
∑°e_pos
.
ﬁd_x
 = 
cx
;

778 
∑°e_pos
.
ﬁd_y
 = 
cy
;

779 
	`edôtûe_middÀ_£À˘
(

780 
ds1_idx
,

781 & 
∑°e_pos
.
°¨t_x
,

782 & 
∑°e_pos
.
°¨t_y


784 
	`edôtûe_∑°e_¥evõw
(
ds1_idx
,

785 
cx
 - 
∑°e_pos
.
°¨t_x
,

786 
cy
 - 
∑°e_pos
.
°¨t_y
,

787 & 
∑°e_pos


789 
key
[
KEY_X
])

798 i‡(
key
[
KEY_DEL
] || key[
KEY_DEL_PAD
])

800 i‡(
glb_ds1edô
.
mode
 =
MOD_T
)

802 i‡(
∑°e_pos
.
°¨t
 =
FALSE
)

804 
	`edôtûe_dñëe_£À˘ed_tûes
(
ds1_idx
);

805 
key
[
KEY_DEL
] || key[
KEY_DEL_PAD
])

814 i‡(
key
[
KEY_U
] && (key[
KEY_LCONTROL
] || key[
KEY_RCONTROL
]))

816 i‡(
glb_ds1edô
.
mode
 =
MOD_T
)

818 i‡(
∑°e_pos
.
°¨t
 =
FALSE
)

820 
	`undo_≠∂y_tûe_buf„r
(
ds1_idx
);

821 
key
[
KEY_U
])

830 i‡(
key
[
KEY_G
])

832 i‡(
key
[
KEY_LSHIFT
] || key[
KEY_RSHIFT
])

833 
glb_ds1edô
.
di•œy_tûe_grid
 --;

835 
glb_ds1edô
.
di•œy_tûe_grid
 ++;

836 i‡(
glb_ds1edô
.
di•œy_tûe_grid
 < 
TG_OFF
)

837 
glb_ds1edô
.
di•œy_tûe_grid
 = 
TG_MAX
 - 1;

838 i‡(
glb_ds1edô
.
di•œy_tûe_grid
 >
TG_MAX
)

839 
glb_ds1edô
.
di•œy_tûe_grid
 = 
TG_OFF
;

840 
key
[
KEY_G
])

847 
group_ch™ged
 = 
FALSE
;

848 
ﬁd_group
 = 
glb_ds1edô
.
ds1_group_idx
;

849 i‡(
ˇn_swich_mode
)

851 i‡(
key
[
KEY_LCONTROL
] || key[
KEY_RCONTROL
])

853 i‡(
key
[
KEY_1
])

855 
key
[
KEY_1
] || key[
KEY_LCONTROL
] || key[
KEY_RCONTROL
])

859 
glb_ds1edô
.
ds1_group_idx
 = 0;

860 
group_ch™ged
 = 
TRUE
;

862 i‡(
key
[
KEY_2
])

864 
key
[
KEY_2
] || key[
KEY_LCONTROL
] || key[
KEY_RCONTROL
])

868 
glb_ds1edô
.
ds1_group_idx
 = 1;

869 
group_ch™ged
 = 
TRUE
;

871 i‡(
key
[
KEY_3
])

873 
key
[
KEY_3
] || key[
KEY_LCONTROL
] || key[
KEY_RCONTROL
])

877 
glb_ds1edô
.
ds1_group_idx
 = 2;

878 
group_ch™ged
 = 
TRUE
;

880 i‡(
key
[
KEY_4
])

882 
key
[
KEY_4
] || key[
KEY_LCONTROL
] || key[
KEY_RCONTROL
])

886 
glb_ds1edô
.
ds1_group_idx
 = 3;

887 
group_ch™ged
 = 
TRUE
;

889 i‡(
key
[
KEY_5
])

891 
key
[
KEY_5
] || key[
KEY_LCONTROL
] || key[
KEY_RCONTROL
])

895 
glb_ds1edô
.
ds1_group_idx
 = 4;

896 
group_ch™ged
 = 
TRUE
;

898 i‡(
key
[
KEY_6
])

900 
key
[
KEY_6
] || key[
KEY_LCONTROL
] || key[
KEY_RCONTROL
])

904 
glb_ds1edô
.
ds1_group_idx
 = 5;

905 
group_ch™ged
 = 
TRUE
;

907 i‡(
key
[
KEY_7
])

909 
key
[
KEY_7
] || key[
KEY_LCONTROL
] || key[
KEY_RCONTROL
])

913 
glb_ds1edô
.
ds1_group_idx
 = 6;

914 
group_ch™ged
 = 
TRUE
;

916 i‡(
key
[
KEY_8
])

918 
key
[
KEY_8
] || key[
KEY_LCONTROL
] || key[
KEY_RCONTROL
])

922 
glb_ds1edô
.
ds1_group_idx
 = 7;

923 
group_ch™ged
 = 
TRUE
;

925 i‡(
key
[
KEY_9
])

927 
key
[
KEY_9
] || key[
KEY_LCONTROL
] || key[
KEY_RCONTROL
])

931 
glb_ds1edô
.
ds1_group_idx
 = 8;

932 
group_ch™ged
 = 
TRUE
;

934 i‡(
key
[
KEY_0
])

936 
key
[
KEY_0
] || key[
KEY_LCONTROL
] || key[
KEY_RCONTROL
])

940 
glb_ds1edô
.
ds1_group_idx
 = 9;

941 
group_ch™ged
 = 
TRUE
;

945 i‡(
group_ch™ged
 =
TRUE
)

948 
found
 = 
FALSE
;

949 
i
=0; i < 10; i++)

951 i‡(
	`°æí
(
glb_ds1
[
glb_ds1edô
.
ds1_group_idx
 * 10 + 
i
].
«me
))

954 
ﬁd_ds1_idx
 = 
ds1_idx
;

955 
ds1_idx
 = 
glb_ds1edô
.
ds1_group_idx
 * 10 + 
i
;

956 
found
 = 
TRUE
;

960 i‡(
found
 =
FALSE
)

963 
glb_ds1edô
.
ds1_group_idx
 = 
ﬁd_group
;

964 
group_ch™ged
 = 
FALSE
;

969 i‡(
key
[
KEY_1
] && 
	`°æí
(
glb_ds1
[
glb_ds1edô
.
ds1_group_idx
 * 10].
«me
))

971 
ﬁd_ds1_idx
 = 
ds1_idx
;

972 
ds1_idx
 = 
glb_ds1edô
.
ds1_group_idx
 * 10;

973 
key
[
KEY_1
])

978 i‡(
key
[
KEY_2
] && 
	`°æí
(
glb_ds1
[
glb_ds1edô
.
ds1_group_idx
 * 10 + 1].
«me
))

980 
ﬁd_ds1_idx
 = 
ds1_idx
;

981 
ds1_idx
 = 
glb_ds1edô
.
ds1_group_idx
 * 10 + 1;

982 
key
[
KEY_2
])

987 i‡(
key
[
KEY_3
] && 
	`°æí
(
glb_ds1
[
glb_ds1edô
.
ds1_group_idx
 * 10 + 2].
«me
))

989 
ﬁd_ds1_idx
 = 
ds1_idx
;

990 
ds1_idx
 = 
glb_ds1edô
.
ds1_group_idx
 * 10 + 2;

991 
key
[
KEY_3
])

996 i‡(
key
[
KEY_4
] && 
	`°æí
(
glb_ds1
[
glb_ds1edô
.
ds1_group_idx
 * 10 + 3].
«me
))

998 
ﬁd_ds1_idx
 = 
ds1_idx
;

999 
ds1_idx
 = 
glb_ds1edô
.
ds1_group_idx
 * 10 + 3;

1000 
key
[
KEY_4
])

1005 i‡(
key
[
KEY_5
] && 
	`°æí
(
glb_ds1
[
glb_ds1edô
.
ds1_group_idx
 * 10 + 4].
«me
))

1007 
ﬁd_ds1_idx
 = 
ds1_idx
;

1008 
ds1_idx
 = 
glb_ds1edô
.
ds1_group_idx
 * 10 + 4;

1009 
key
[
KEY_5
])

1014 i‡(
key
[
KEY_6
] && 
	`°æí
(
glb_ds1
[
glb_ds1edô
.
ds1_group_idx
 * 10 + 5].
«me
))

1016 
ﬁd_ds1_idx
 = 
ds1_idx
;

1017 
ds1_idx
 = 
glb_ds1edô
.
ds1_group_idx
 * 10 + 5;

1018 
key
[
KEY_6
])

1023 i‡(
key
[
KEY_7
] && 
	`°æí
(
glb_ds1
[
glb_ds1edô
.
ds1_group_idx
 * 10 + 6].
«me
))

1025 
ﬁd_ds1_idx
 = 
ds1_idx
;

1026 
ds1_idx
 = 
glb_ds1edô
.
ds1_group_idx
 * 10 + 6;

1027 
key
[
KEY_7
])

1032 i‡(
key
[
KEY_8
] && 
	`°æí
(
glb_ds1
[
glb_ds1edô
.
ds1_group_idx
 * 10 + 7].
«me
))

1034 
ﬁd_ds1_idx
 = 
ds1_idx
;

1035 
ds1_idx
 = 
glb_ds1edô
.
ds1_group_idx
 * 10 + 7;

1036 
key
[
KEY_8
])

1041 i‡(
key
[
KEY_9
] && 
	`°æí
(
glb_ds1
[
glb_ds1edô
.
ds1_group_idx
 * 10 + 8].
«me
))

1043 
ﬁd_ds1_idx
 = 
ds1_idx
;

1044 
ds1_idx
 = 
glb_ds1edô
.
ds1_group_idx
 * 10 + 8;

1045 
key
[
KEY_9
])

1050 i‡(
key
[
KEY_0
] && 
	`°æí
(
glb_ds1
[
glb_ds1edô
.
ds1_group_idx
 * 10 + 9].
«me
))

1052 
ﬁd_ds1_idx
 = 
ds1_idx
;

1053 
ds1_idx
 = 
glb_ds1edô
.
ds1_group_idx
 * 10 + 9;

1054 
key
[
KEY_0
])

1061 i‡(
ﬁd_ds1_idx
 !
ds1_idx
)

1064 
glb_ds1
[
ﬁd_ds1_idx
].
own_w¥evõw
.
x0
 = 
glb_ds1edô
.
wö_¥evõw
.x0;

1065 
glb_ds1
[
ﬁd_ds1_idx
].
own_w¥evõw
.
y0
 = 
glb_ds1edô
.
wö_¥evõw
.y0;

1066 
glb_ds1
[
ﬁd_ds1_idx
].
own_w¥evõw
.
w
 = 
glb_ds1edô
.
wö_¥evõw
.w;

1067 
glb_ds1
[
ﬁd_ds1_idx
].
own_w¥evõw
.
h
 = 
glb_ds1edô
.
wö_¥evõw
.h;

1070 
glb_ds1edô
.
wö_¥evõw
.
x0
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.x0;

1071 
glb_ds1edô
.
wö_¥evõw
.
y0
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.y0;

1072 
glb_ds1edô
.
wö_¥evõw
.
w
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.w;

1073 
glb_ds1edô
.
wö_¥evõw
.
h
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.h;

1076 
ﬁd_ds1_idx
 = 
ds1_idx
;

1080 i‡(
key
[
KEY_TILDE
])

1082 
key
[
KEY_TILDE
])

1086 i‡(
glb_ds1edô
.
show_2nd_row
 =
FALSE
)

1087 
glb_ds1edô
.
show_2nd_row
 = 
TRUE
;

1089 
glb_ds1edô
.
show_2nd_row
 = 
FALSE
;

1093 i‡(
key
[
KEY_TAB
])

1095 
key
[
KEY_TAB
])

1099 i‡(
glb_ds1edô
.
mode
 =
MOD_L
)

1100 
glb_ds1edô
.
mode
 = 
ﬁd_mode
;

1103 i‡(
ˇn_swich_mode
)

1105 i‡((
key
[
KEY_LSHIFT
]Ë|| (key[
KEY_RSHIFT
]))

1106 
glb_ds1edô
.
mode
--;

1108 
glb_ds1edô
.
mode
++;

1111 i‡(
glb_ds1edô
.
mode
 < 
MOD_T
)

1112 
glb_ds1edô
.
mode
 = 
MOD_P
;

1113 i‡((
glb_ds1edô
.
mode
 >
MOD_MAX
Ë|| (glb_ds1edô.modê=
MOD_L
))

1114 
glb_ds1edô
.
mode
 = 
MOD_T
;

1118 
ﬁd_˚Œ_x
 = -1;

1119 
ﬁd_˚Œ_y
 = -1;

1123 i‡(
key
[
KEY_N
])

1125 
key
[
KEY_N
])

1129 i‡(
glb_ds1edô
.
mode
 =
MOD_L
)

1131 
glb_ds1edô
.
night_mode
++;

1132 i‡(
glb_ds1edô
.
night_mode
 >= 2)

1134 
glb_ds1edô
.
night_mode
 = 0;

1135 
glb_ds1edô
.
mode
 = 
ﬁd_mode
;

1140 
ﬁd_mode
 = 
glb_ds1edô
.
mode
;

1141 
glb_ds1edô
.
mode
 = 
MOD_L
;

1144 
ﬁd_˚Œ_x
 = -1;

1145 
ﬁd_˚Œ_y
 = -1;

1149 i‡(
key
[
KEY_R
])

1151 
key
[
KEY_R
])

1157 
	`™imd©a_lﬂd
();

1160 
	`™im_exô
();

1163 
glb_ds1edô
.
obj_buff
 = 
	`txt_de°roy
(glb_ds1edit.obj_buff);

1164 
glb_ds1edô
.
obje˘s_buff
 = 
	`txt_de°roy
(glb_ds1edô.
obj_buff
);

1167 
	`ªad_obje˘s_txt
();

1168 
	`ªad_obj_txt
();

1171 
	`™im_upd©e_gfx
(
FALSE
);

1174 
glb_ds1edô
.
ticks_ñ≠£d
 = 0;

1178 i‡(
ﬁd_mou£_b
 & 1)

1181 i‡(
glb_ds1edô
.
mode
 =
MOD_T
)

1183 i‡(
∑°e_pos
.
°¨t
 =
TRUE
)

1186 
	`edôtûe_∑°e_föÆ
(
ds1_idx
);

1187 
∑°e_pos
.
°¨t
 = 
FALSE
;

1188 
mou£_b
 & 1)

1193 i‡(
tmp_£l
.
°¨t
 =
FALSE
)

1195 i‡–(
key
[
KEY_I
]) &&

1196 (
cx
 !
ﬁd_idítiˇl_x
Ë&& (
cy
 !
ﬁd_idítiˇl_y
)

1201 i‡(
key
[
KEY_LSHIFT
] || key[
KEY_RSHIFT
])

1204 
ôy≥
 = 
IT_ADD
;

1206 i‡(
key
[
KEY_LCONTROL
] || key[
KEY_RCONTROL
])

1209 
ôy≥
 = 
IT_DEL
;

1214 
ôy≥
 = 
IT_NEW
;

1216 
	`edôtûe_idítiˇl
(
ds1_idx
, 
ôy≥
, 
cx
, 
cy
);

1217 
ﬁd_idítiˇl_x
 = 
cx
;

1218 
ﬁd_idítiˇl_y
 = 
cy
;

1220 i‡–! 
key
[
KEY_I
])

1223 
ﬁd_idítiˇl_x
 = -1;

1224 
ﬁd_idítiˇl_y
 = -1;

1226 
tmp_£l
.
°¨t
 = 
TRUE
;

1227 
tmp_£l
.
x1
 =Åmp_£l.
x2
 =Åmp_£l.
ﬁd_x2
 = 
cx
;

1228 
tmp_£l
.
y1
 =Åmp_£l.
y2
 =Åmp_£l.
ﬁd_y2
 = 
cy
;

1229 
	`edôtûe_dñëe_Æl_tmp£l
(
ds1_idx
);

1230 
	`edôtûe_£t_tmp£l
(
ds1_idx
, & 
tmp_£l
);

1235 i‡((
tmp_£l
.
ﬁd_x2
 !
cx
Ë|| (tmp_£l.
ﬁd_y2
 !
cy
))

1238 
tmp_£l
.
x2
 =Åmp_£l.
ﬁd_x2
 = 
cx
;

1239 
tmp_£l
.
y2
 =Åmp_£l.
ﬁd_y2
 = 
cy
;

1240 
	`edôtûe_dñëe_Æl_tmp£l
(
ds1_idx
);

1241 
	`edôtûe_£t_tmp£l
(
ds1_idx
, & 
tmp_£l
);

1249 i‡(
glb_ds1edô
.
mode
 =
MOD_T
)

1251 i‡(
tmp_£l
.
°¨t
 =
TRUE
)

1254 i‡(
key
[
KEY_H
])

1255 
tmp_£l
.
ty≥
 = 
TMP_HIDE
;

1256 i‡(
key
[
KEY_LSHIFT
] || key[
KEY_RSHIFT
])

1257 
tmp_£l
.
ty≥
 = 
TMP_ADD
;

1258 i‡(
key
[
KEY_LCONTROL
] || key[
KEY_RCONTROL
])

1259 
tmp_£l
.
ty≥
 = 
TMP_DEL
;

1261 
tmp_£l
.
ty≥
 = 
TMP_NEW
;

1262 
tmp_£l
.
ty≥
)

1264 
TMP_NEW
 :

1265 
	`edôtûe_dñëe_Æl_tmp£l
(
ds1_idx
);

1266 
	`edôtûe_ch™ge_to_√w_≥rm™ít_£l
(
ds1_idx
, & 
tmp_£l
);

1267 
tmp_£l
.
°¨t
 = 
FALSE
;

1268 
tmp_£l
.
ty≥
 = 
TMP_NULL
;

1269 
tmp_£l
.
x1
 =Åmp_£l.
x2
 =Åmp_£l.
y1
 =Åmp_£l.
y2
 = 0;

1270 
tmp_£l
.
ﬁd_x2
 =Åmp_£l.
ﬁd_y2
 = 0;

1273 
TMP_ADD
 :

1274 
	`edôtûe_dñëe_Æl_tmp£l
(
ds1_idx
);

1275 
	`edôtûe_ch™ge_to_add_≥rm™ít_£l
(
ds1_idx
, & 
tmp_£l
);

1276 
tmp_£l
.
°¨t
 = 
FALSE
;

1277 
tmp_£l
.
ty≥
 = 
TMP_NULL
;

1278 
tmp_£l
.
x1
 =Åmp_£l.
x2
 =Åmp_£l.
y1
 =Åmp_£l.
y2
 = 0;

1279 
tmp_£l
.
ﬁd_x2
 =Åmp_£l.
ﬁd_y2
 = 0;

1282 
TMP_HIDE
 :

1283 
	`edôtûe_dñëe_Æl_tmp£l
(
ds1_idx
);

1284 
	`edôtûe_ch™ge_to_hide_£l
(
ds1_idx
, & 
tmp_£l
);

1285 
tmp_£l
.
°¨t
 = 
FALSE
;

1286 
tmp_£l
.
ty≥
 = 
TMP_NULL
;

1287 
tmp_£l
.
x1
 =Åmp_£l.
x2
 =Åmp_£l.
y1
 =Åmp_£l.
y2
 = 0;

1288 
tmp_£l
.
ﬁd_x2
 =Åmp_£l.
ﬁd_y2
 = 0;

1291 
TMP_DEL
 :

1292 
	`edôtûe_dñëe_Æl_tmp£l
(
ds1_idx
);

1293 
	`edôtûe_ch™ge_to_dñ_£l
(
ds1_idx
, & 
tmp_£l
);

1294 
tmp_£l
.
°¨t
 = 
FALSE
;

1295 
tmp_£l
.
ty≥
 = 
TMP_NULL
;

1296 
tmp_£l
.
x1
 =Åmp_£l.
x2
 =Åmp_£l.
y1
 =Åmp_£l.
y2
 = 0;

1297 
tmp_£l
.
ﬁd_x2
 =Åmp_£l.
ﬁd_y2
 = 0;

1301 i‡(
∑°e_pos
.
°¨t
 =
TRUE
)

1303 i‡((
∑°e_pos
.
ﬁd_x
 !
cx
) ||

1304 (
∑°e_pos
.
ﬁd_y
 !
cy
) ||

1305 (
∑°e_pos
.
ﬁd_ds1_idx
 !
ds1_idx
)

1308 
	`edôtûe_∑°e_undo
(
∑°e_pos
.
ﬁd_ds1_idx
);

1309 
	`edôtûe_∑°e_¥evõw
(
ds1_idx
,

1310 
cx
 - 
∑°e_pos
.
°¨t_x
,

1311 
cy
 - 
∑°e_pos
.
°¨t_y
,

1312 & 
∑°e_pos


1314 
∑°e_pos
.
ﬁd_x
 = 
cx
;

1315 
∑°e_pos
.
ﬁd_y
 = 
cy
;

1316 
∑°e_pos
.
ﬁd_ds1_idx
 = 
ds1_idx
;

1323 i‡(
ﬁd_mou£_b
 & 2)

1325 i‡(
glb_ds1edô
.
mode
 =
MOD_T
)

1327 
mou£_b
 & 2)

1331 i‡–(
key
[
KEY_LCONTROL
] || key[
KEY_RCONTROL
]) &&

1332 (
key
[
KEY_LSHIFT
] || key[
KEY_RSHIFT
]) )

1335 
	`wbôs_maö
(
ds1_idx
, 
cx
, 
cy
);

1336 
	`posôi⁄_mou£
(
ﬁd_mou£_x
, 
ﬁd_mou£_y
);

1340 
	`wedô_ã°
(
ds1_idx
, 
cx
, 
cy
);

1341 
	`£t_cﬁ‹_dïth
(8);

1342 
	`posôi⁄_mou£
(
ﬁd_mou£_x
, 
ﬁd_mou£_y
);

1348 i‡(
key
[
KEY_ESC
] && (
glb_ds1
[
ds1_idx
].
døw_edô_obj
 =
FALSE
))

1350 
key
[
KEY_ESC
])

1354 
ªt
 = 
	`msg_quô_maö
();

1355 
ªt
)

1359 
	`ds1_ßve
(
ds1_idx
, 
TRUE
);

1360 
d⁄e
 = 
TRUE
;

1365 
i
=0; i < 
DS1_MAX
; i++)

1367 i‡(
	`°æí
(
glb_ds1
[
ds1_idx
].
«me
))

1368 
	`ds1_ßve
(
i
, 
FALSE
);

1370 
d⁄e
 = 
TRUE
;

1375 
	`ds1_ßve
(
ds1_idx
, 
TRUE
);

1376 
d⁄e
 = 
TRUE
;

1386 
	}
}

	@interfac.h

1 #i‚de‡
_INTERFAC_H_


3 
	#_INTERFAC_H_


	)

5 
öãrÁc_u£r_h™dÀr
 (
°¨t_ds1_idx
);

	@main.c

11 
	#COMPILER_NAME
 "VisuÆ C++ 2010 Ex¥es†Edôi⁄"

	)

12 
	#WINDS1EDIT_GUI_LOADER_LINK
 "hâp://d2mods.com/f‹um/võwt›ic.php?f=81&t=21281"

	)

13 
	#DS1EDIT_GOOD_DLL
 "AŒegrÿ4.4.2, MSVC"

	)

14 
	#DS1EDIT_DLL_LINK
 "hâp://∑ul.súamy.‰ì.‰/_divîs/ds1/ÆÀgro-4.4.2-m⁄ﬁôh-md.zù"

	)

16 #ifde‡
WIN32


17 
	#DS1EDIT_BUILD
 
__DATE__


	)

19 
	#DS1EDIT_BUILD
 "?"

	)

22 #ifde‡
_DEBUG


23 
	#DS1EDIT_BUILD_MODE
 "Debug"

	)

24 #ñi‡
NDEBUG


25 
	#DS1EDIT_BUILD_MODE
 "Rñó£"

	)

27 
	#DS1EDIT_BUILD_MODE
 "unknown"

	)

30 
	~"°ru˘s.h
"

31 
	~"îr‹.h
"

32 
	~"mpq/mpqvõw.h
"

33 
	~"dt1misc.h
"

34 
	~"ds1misc.h
"

35 
	~"™im.h
"

36 
	~"wEdô.h
"

37 
	~"undo.h
"

38 
	~"txåód.h
"

39 
	~"misc.h
"

40 
	~"öi¸ót.h
"

41 
	~"öúód.h
"

42 
	~"™imd©a.h
"

43 
	~"öãrÁc.h
"

46 
WRKSPC_DATAS_S
 
	gglb_wrk•c_d©as
[
WRKSPC_MAX
] =

55 
GAMMA_S
 
	gglb_gamma_°r
[
GC_MAX
] =

57 {"0.60", 
GC_060
}, {"0.62", 
GC_062
}, {"0.64", 
GC_064
},

58 {"0.66", 
GC_066
}, {"0.68", 
GC_068
}, {"0.70", 
GC_070
},

59 {"0.72", 
GC_072
}, {"0.74", 
GC_074
}, {"0.76", 
GC_076
},

60 {"0.78", 
GC_078
}, {"0.80", 
GC_080
}, {"0.82", 
GC_082
},

61 {"0.84", 
GC_084
}, {"0.86", 
GC_086
}, {"0.88", 
GC_088
},

62 {"0.90", 
GC_090
}, {"0.92", 
GC_092
}, {"0.94", 
GC_094
},

63 {"0.96", 
GC_096
}, {"0.98", 
GC_098
}, {"1.00", 
GC_100
},

64 {"1.10", 
GC_110
}, {"1.20", 
GC_120
}, {"1.30", 
GC_130
},

65 {"1.40", 
GC_140
}, {"1.50", 
GC_150
}, {"1.60", 
GC_160
},

66 {"1.70", 
GC_170
}, {"1.80", 
GC_180
}, {"1.90", 
GC_190
},

67 {"2.00", 
GC_200
}, {"2.10", 
GC_210
}, {"2.20", 
GC_220
},

68 {"2.30", 
GC_230
}, {"2.40", 
GC_240
}, {"2.50", 
GC_250
},

69 {"2.60", 
GC_260
}, {"2.70", 
GC_270
}, {"2.80", 
GC_280
},

70 {"2.90", 
GC_290
}, {"3.00", 
GC_300
}

73 * 
	gtxt_def_lv…y≥_ªq
[] =

83 
NULL


86 * 
	gtxt_def_lvÕª°_ªq
[] =

90 
NULL


93 * 
	gtxt_def_obj_ªq
[] =

114 
NULL


117 * 
	gtxt_def_obje˘s_ªq
[] =

217 
NULL


220 ** 
	gglb_txt_ªq_±r
[
RQ_MAX
] = {
NULL
, NULL, NULL, NULL};

222 
CONFIG_S
 
	gglb_c⁄fig
;

223 
GLB_DS1EDIT_S
 
	gglb_ds1edô
;

224 
GLB_MPQ_S
 
	gglb_mpq_°ru˘
 [
MAX_MPQ_FILE
];

225 
DS1_S
 * 
	gglb_ds1
 = 
NULL
;

226 
DT1_S
 * 
	gglb_dt1
 = 
NULL
;

227 
	gglb_tûes_∑th
 [] = "Data\\Global\\Tiles\\";

228 
	gglb_ds1edô_d©a_dú
 [] = "Data\\";

229 
	gglb_ds1edô_tmp_dú
 [] = "Tmp\\";

232 * 
	gglb_∑th_lv…y≥s_mem
 = "Debug\\Editor.lvltypes.memory.bin";

233 * 
	gglb_∑th_lv…y≥s_def
 = "Debug\\D2.lvltypes.headers.txt";

234 * 
	gglb_∑th_lvÕª°_mem
 = "Debug\\Editor.lvlprest.memory.bin";

235 * 
	gglb_∑th_lvÕª°_def
 = "Debug\\D2.lvlprest.headers.txt";

236 * 
	gglb_∑th_obj_mem
 = "Debug\\Editor.obj.memory.bin";

237 * 
	gglb_∑th_obj_def
 = "Debug\\Editor.obj.headers.txt";

238 * 
	gglb_∑th_obje˘s_mem
 = "Debug\\Editor.objects.memory.bin";

239 * 
	gglb_∑th_obje˘s_def
 = "Debug\\D2.objects.headers.txt";

244 
	$ds1edô_öô
()

246 
FILE
 * 
out
;

249 
«me
[40];

250 
MODE_E
 
idx
;

251 } 
curs‹
[
MOD_MAX
] = {

252 {"pcx\\curs‹_t.pcx", 
MOD_T
},

253 {"pcx\\curs‹_o.pcx", 
MOD_O
},

254 {"pcx\\curs‹_p.pcx", 
MOD_P
},

255 {"pcx\\curs‹_l.pcx", 
MOD_L
}

257 
i
, 
o
;

259 
dú4
[4] = { 0, 1, 2, 3},

260 
dú8
[8] = { 4, 0, 5, 1, 6, 2, 7, 3},

262 
dú16
[16] = { 4, 8, 0, 9, 5, 10, 1, 11,

265 
dú32
[32] = { 4, 16, 8, 17, 0, 18, 9, 19,

270 
obj_sub_tûe
[5][5] = {

277 
tmp
[80];

281 
	`¥ötf
("ds1edit_init()\n");

282 
	`mem£t
–& 
glb_c⁄fig
, 0, (glb_config));

283 
	`mem£t
–& 
glb_ds1edô
, 0, (glb_ds1edit));

286 
i
 = (
DS1_S
Ë* 
DS1_MAX
;

287 
	`¥ötf
("\«Œoˇã %òbyã†f‹ glb_ds1[%i]\n", 
i
, 
DS1_MAX
);

288 
glb_ds1
 = (
DS1_S
 *Ë
	`mÆloc
(
i
);

289 i‡(
glb_ds1
 =
NULL
)

291 
	`•rötf
(

292 
tmp
,

294 "C™'àÆloˇã %òbyã†f‹Åhêglb_ds1[%i]ÅabÀ.", 
i
, 
DS1_MAX


296 
	`ds1edô_îr‹
(
tmp
);

298 
	`mem£t
(
glb_ds1
, 0, 
i
);

300 
i
 = (
DT1_S
Ë* 
DT1_MAX
;

301 
	`¥ötf
("Æloˇã %òbyã†f‹ glb_dt1[%i]\n\n", 
i
, 
DT1_MAX
);

302 
glb_dt1
 = (
DT1_S
 *Ë
	`mÆloc
(
i
);

303 i‡(
glb_dt1
 =
NULL
)

305 
	`•rötf
(

306 
tmp
,

308 "C™'àÆloˇã %òbyã†f‹Åhêglb_dt1[%i]ÅabÀ.", 
i
, 
DT1_MAX


310 
	`ds1edô_îr‹
(
tmp
);

312 
	`mem£t
(
glb_dt1
, 0, 
i
);

315 
glb_ds1edô
.
vîsi⁄_buûd
 = 
DS1EDIT_BUILD
;

316 
glb_ds1edô
.
vîsi⁄_dŒ
 = 
DS1EDIT_GOOD_DLL
;

317 
	`°r˝y
(
glb_ds1edô
.
vîsi⁄
, 
DS1EDIT_BUILD
);

318 
	`¥ötf
(".exêvîsi⁄ : %s", 
COMPILER_NAME
);

319 
	`¥ötf
(

321 
glb_ds1edô
.
vîsi⁄
,

322 
DS1EDIT_BUILD_MODE


326 
	`•rötf
(
tmp
, "%svîsi⁄", 
glb_ds1edô_d©a_dú
);

327 
out
 = 
	`f›í
(
tmp
, "wb");

328 i‡(
out
 !
NULL
)

330 
	`•rötf
(
tmp
, "Buûd D©ê%s", 
glb_ds1edô
.
vîsi⁄
);

331 
	`fwrôe
(
tmp
, 
	`°æí
—mp), 1, 
out
);

332 
	`f˛o£
(
out
);

335 
i
=0; i<
MAX_MPQ_FILE
; i++)

337 
	`mem£t
–& 
glb_mpq_°ru˘
[
i
], 0, (
GLB_MPQ_S
));

338 
glb_mpq_°ru˘
[
i
].
is_›í
 = 
FALSE
;

342 
i
=0; i<
MOD_MAX
; i++)

344 
glb_ds1edô
.
mou£_curs‹
[
i
] =

345 
	`lﬂd_pcx
(
curs‹
[
i
].
«me
, 
glb_ds1edô
.
dummy_∑l
);

346 i‡(
glb_ds1edô
.
mou£_curs‹
[
i
] =
NULL
)

348 
	`•rötf
(

349 
tmp
,

351 "C™'à›íÅhêfûê\"%s\".", 
curs‹
[
i
].
«me


353 
	`ds1edô_îr‹
(
tmp
);

358 
glb_txt_ªq_±r
[
RQ_LVLTYPE
] = 
txt_def_lv…y≥_ªq
;

359 
glb_txt_ªq_±r
[
RQ_LVLPREST
] = 
txt_def_lvÕª°_ªq
;

360 
glb_txt_ªq_±r
[
RQ_OBJ
] = 
txt_def_obj_ªq
;

361 
glb_txt_ªq_±r
[
RQ_OBJECTS
] = 
txt_def_obje˘s_ªq
;

364 
	`ªmove
(
glb_∑th_lv…y≥s_mem
);

365 
	`ªmove
(
glb_∑th_lv…y≥s_def
);

366 
	`ªmove
(
glb_∑th_lvÕª°_mem
);

367 
	`ªmove
(
glb_∑th_lvÕª°_def
);

368 
	`ªmove
(
glb_∑th_obj_mem
);

369 
	`ªmove
(
glb_∑th_obj_def
);

370 
	`ªmove
(
glb_∑th_obje˘s_mem
);

371 
	`ªmove
(
glb_∑th_obje˘s_def
);

374 
glb_ds1edô
.
√w_dú1
[0] = 0;

376 
i
=0; i < 4; i++)

377 
glb_ds1edô
.
√w_dú4
[
i
] = 
dú4
[i];

379 
i
=0; i < 8; i++)

380 
glb_ds1edô
.
√w_dú8
[
i
] = 
dú8
[i];

382 
i
=0; i < 16; i++)

383 
glb_ds1edô
.
√w_dú16
[
i
] = 
dú16
[i];

385 
i
=0; i < 32; i++)

386 
glb_ds1edô
.
√w_dú32
[
i
] = 
dú32
[i];

389 
i
=0; i < 5; i++)

390 
o
=0; o < 5; o++)

391 
glb_ds1edô
.
obj_sub_tûe_‹dî
[
i
][
o
] = 
obj_sub_tûe
[i][o];

394 
glb_ds1edô
.
cmd_löe
.
ds1_fûíame
 = 
NULL
;

395 
glb_ds1edô
.
cmd_löe
.
öi_fûíame
 = 
NULL
;

396 
glb_ds1edô
.
cmd_löe
.
lv…y≥_id
 = -1;

397 
glb_ds1edô
.
cmd_löe
.
lvÕª°_def
 = -1;

398 
glb_ds1edô
.
cmd_löe
.
ªsize_width
 = -1;

399 
glb_ds1edô
.
cmd_löe
.
ªsize_height
 = -1;

400 
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 = -1;

401 
glb_ds1edô
.
cmd_löe
.
no_check_a˘
 = 
FALSE
;

402 
glb_ds1edô
.
cmd_löe
.
dt1_li°_num
 = -1;

403 
i
=0; i < 
DT1_IN_DS1_MAX
; i++)

404 
glb_ds1edô
.
cmd_löe
.
dt1_li°_fûíame
[
i
] = 
NULL
;

407 
glb_ds1edô
.
show_2nd_row
 = 
FALSE
;

410 
glb_ds1edô
.
video_∑ge_num
 = 0;

411 
	}
}

415 
UDWORD
 
	$ds1edô_gë_bôm≠_size
(
BITMAP
 * 
bmp
)

417 
UDWORD
 
size
 = 0;

419 i‡(
bmp
 =
NULL
)

422 
size
 +(
BITMAP
);

423 
size
 +((
UBYTE
 *Ë* 
bmp
->
h
);

425 
	`bôm≠_cﬁ‹_dïth
(
bmp
))

427 8 : 
size
 +
bmp
->
w
 * bmp->
h
; ;

429 16 : 
size
 +2 * (
bmp
->
w
 * bmp->
h
); ;

430 24 : 
size
 +3 * (
bmp
->
w
 * bmp->
h
); ;

431 32 : 
size
 +4 * (
bmp
->
w
 * bmp->
h
); ;

436  
size
;

437 
	}
}

442 
UDWORD
 
	$ds1edô_gë_RLE_bôm≠_size
(
RLE_SPRITE
 * 
æe
)

444 
UDWORD
 
size
 = 0;

446 i‡(
æe
 =
NULL
)

449 
size
 +(
RLE_SPRITE
);

450 
size
 +
æe
->size;

452  
size
;

453 
	}
}

458 
	$ds1edô_exô
()

460 
i
, 
z
, 
b
;

463 
	`¥ötf
("\nds1edit_exit()\n");

466 
i
=0; i<
MAX_MPQ_FILE
; i++)

468 i‡(
glb_mpq_°ru˘
[
i
].
is_›í
 !
FALSE
)

470 
	`Ârötf
(
°dîr
, "˛osög %s\n", 
glb_mpq_°ru˘
[
i
].
fûe_«me
);

471 
	`fÊush
(
°dîr
);

473 
glb_mpq
 = & 
glb_mpq_°ru˘
[
i
];

474 
	`mpq_b©ch_˛o£
();

476 
	`mem£t
–& 
glb_mpq_°ru˘
[
i
], 0, (
GLB_MPQ_S
));

477 
glb_mpq_°ru˘
[
i
].
is_›í
 = 
FALSE
;

482 
	`Ârötf
(
°dîr
, "exit, memory free :\n");

483 
	`fÊush
(
°dîr
);

486 
	`Ârötf
(
°dîr
, " * mouse cursor...\n");

487 
	`fÊush
(
°dîr
);

488 
	`show_mou£
(
NULL
);

489 
i
=0; i<
MOD_MAX
; i++)

491 i‡(
glb_ds1edô
.
mou£_curs‹
[
i
] !
NULL
)

493 
	`de°roy_bôm≠
(
glb_ds1edô
.
mou£_curs‹
[
i
]);

494 
glb_ds1edô
.
mou£_curs‹
[
i
] = 
NULL
;

499 
	`Ârötf
(
°dîr
, " * screen buffer...\n");

500 
	`fÊush
(
°dîr
);

501 i‡(
glb_ds1edô
.
s¸ìn_buff
 !
NULL
)

503 
	`de°roy_bôm≠
(
glb_ds1edô
.
s¸ìn_buff
);

504 
glb_ds1edô
.
s¸ìn_buff
 = 
NULL
;

507 i‡(
glb_ds1edô
.
big_s¸ìn_buff
 !
NULL
)

509 
	`de°roy_bôm≠
(
glb_ds1edô
.
big_s¸ìn_buff
);

510 
glb_ds1edô
.
big_s¸ìn_buff
 = 
NULL
;

514 
	`Ârötf
(
°dîr
, " * config, mpqÇames...\n");

515 
	`fÊush
(
°dîr
);

516 
i
=0; i<
MAX_MPQ_FILE
; i++)

518 if(
glb_c⁄fig
.
mpq_fûe
[
i
] !
NULL
)

519 
	`‰ì
(
glb_c⁄fig
.
mpq_fûe
[
i
]);

523 
	`Ârötf
(
°dîr
, " * config, mod directoryÇame...\n");

524 
	`fÊush
(
°dîr
);

525 
i
=0; i<
MAX_MOD_DIR
; i++)

527 if(
glb_c⁄fig
.
mod_dú
[
i
] !
NULL
)

528 
	`‰ì
(
glb_c⁄fig
.
mod_dú
[
i
]);

532 
	`Ârötf
(
°dîr
, " *Öalettes...\n");

533 
	`fÊush
(
°dîr
);

534 
i
=0; i<
ACT_MAX
; i++)

536 if(
glb_ds1edô
.
d2_∑l
[
i
] !
NULL
)

538 
	`‰ì
(
glb_ds1edô
.
d2_∑l
[
i
]);

539 
glb_ds1edô
.
d2_∑l
[
i
] = 
NULL
;

540 
glb_ds1edô
.
∑l_size
[
i
] = 0;

545 
	`Ârötf
(
°dîr
, " * DT1 files...\n");

546 
	`fÊush
(
°dîr
);

547 i‡(
glb_dt1
 !
NULL
)

549 
i
=0; i<
DT1_MAX
; i++)

550 
	`dt1_‰ì
(
i
);

554 
	`Ârötf
(
°dîr
, " * DS1 files...\n");

555 
	`fÊush
(
°dîr
);

556 i‡(
glb_ds1
 !
NULL
)

558 
i
=0; i<
DS1_MAX
; i++)

559 
	`ds1_‰ì
(
i
);

563 
	`Ârötf
(
°dîr
, " * objects descriptions...\n");

564 
	`fÊush
(
°dîr
);

565 i‡(
glb_ds1edô
.
obj_desc
 !
NULL
)

567 
	`™im_exô
();

568 
	`‰ì
(
glb_ds1edô
.
obj_desc
);

569 
glb_ds1edô
.
obj_desc
 = 
NULL
;

570 
glb_ds1edô
.
obj_desc_num
 = 0;

574 
	`Ârötf
(
°dîr
, " * buttons &Åab...\n");

575 
	`fÊush
(
°dîr
);

576 
	`wedô_‰ì
();

579 
	`Ârötf
(
°dîr
, " * undo buffers...\n");

580 
	`fÊush
(
°dîr
);

581 i‡(
glb_ds1
 !
NULL
)

582 
	`undo_exô
();

585 
	`Ârötf
(
°dîr
, " * walkable infoÅiles...\n");

586 
	`fÊush
(
°dîr
);

587 
z
=0; z<
ZM_MAX
; z++)

589 
i
=0; i<25; i++)

591 i‡(
glb_ds1edô
.
subtûe_nowÆk
[
z
][
i
] !
NULL
)

593 
	`de°roy_æe_•rôe
(
glb_ds1edô
.
subtûe_nowÆk
[
z
][
i
]);

594 
glb_ds1edô
.
subtûe_nowÆk
[
z
][
i
] = 
NULL
;

597 i‡(
glb_ds1edô
.
subtûe_nojump
[
z
][
i
] !
NULL
)

599 
	`de°roy_æe_•rôe
(
glb_ds1edô
.
subtûe_nojump
[
z
][
i
]);

600 
glb_ds1edô
.
subtûe_nojump
[
z
][
i
] = 
NULL
;

605 i‡(
glb_ds1edô
.
subtûe_hñp
 !
NULL
)

607 
	`de°roy_bôm≠
(
glb_ds1edô
.
subtûe_hñp
);

608 
glb_ds1edô
.
subtûe_hñp
 = 
NULL
;

613 
	`Ârötf
(
°dîr
, " * walkable infoÅiles combinations...\n");

614 
	`fÊush
(
°dîr
);

615 
b
=0; b<256; b++)

617 
z
=0; z<
ZM_MAX
; z++)

619 
i
=0; i<25; i++)

621 i‡(
glb_ds1edô
.
subtûe_Êag
[
b
][
z
][
i
] !
NULL
)

623 
	`de°roy_æe_•rôe
(
glb_ds1edô
.
subtûe_Êag
[
b
][
z
][
i
]);

624 
glb_ds1edô
.
subtûe_Êag
[
b
][
z
][
i
] = 
NULL
;

631 
	`Ârötf
(
°dîr
, " * .txt buffers ...\n");

632 
	`fÊush
(
°dîr
);

633 i‡(
glb_ds1edô
.
lv…y≥s_buff
 !
NULL
)

634 
glb_ds1edô
.
lv…y≥s_buff
 = 
	`txt_de°roy
(glb_ds1edit.lvltypes_buff);

635 i‡(
glb_ds1edô
.
lvÕª°_buff
 !
NULL
)

636 
glb_ds1edô
.
lvÕª°_buff
 = 
	`txt_de°roy
(glb_ds1edit.lvlprest_buff);

637 i‡(
glb_ds1edô
.
obj_buff
 !
NULL
)

638 
glb_ds1edô
.
obj_buff
 = 
	`txt_de°roy
(glb_ds1edit.obj_buff);

641 
	`Ârötf
(
°dîr
, " *ánimdata.d2 buffer ...\n");

642 
	`fÊush
(
°dîr
);

643 i‡(
glb_ds1edô
.
™im_d©a
.
buf„r
)

644 
	`‰ì
(
glb_ds1edô
.
™im_d©a
.
buf„r
);

647 
	`Ârötf
(
°dîr
, " * glb_ds1[] & glb_dt1[] & glb_ds1[].obj & glb_ds1[].obj_undo ...\n");

648 
	`fÊush
(
°dîr
);

651 i‡(
glb_ds1
 !
NULL
)

653 
i
=0; i < 
DS1_MAX
; i++)

655 i‡(
glb_ds1
[
i
].
obj
 !
NULL
)

656 
	`‰ì
(
glb_ds1
[
i
].
obj
);

657 i‡(
glb_ds1
[
i
].
obj_undo
 !
NULL
)

658 
	`‰ì
(
glb_ds1
[
i
].
obj_undo
);

660 
	`‰ì
(
glb_ds1
);

662 i‡(
glb_dt1
 !
NULL
)

663 
	`‰ì
(
glb_dt1
);

665 
	`fÊush
(
°dîr
);

666 
	}
}

671 
	$ds1edô_debug
()

673 
	`¥ötf
("\n");

674 
	`¥ötf
("d2ch¨ = %s\n", 
glb_c⁄fig
.
mpq_fûe
[3]);

675 
	`¥ötf
("d2d©® = %s\n", 
glb_c⁄fig
.
mpq_fûe
[2]);

676 
	`¥ötf
("d2ex∞ = %s\n", 
glb_c⁄fig
.
mpq_fûe
[1]);

677 
	`¥ötf
("∑tch_d2 = %s\n", 
glb_c⁄fig
.
mpq_fûe
[0]);

678 
	`¥ötf
("mod_dú = %s\n", 
glb_c⁄fig
.
mod_dú
[0]);

679 
	`¥ötf
("fuŒs¸ì¿ = %s\n", 
glb_c⁄fig
.
fuŒs¸ìn
 ? "YES" : "NO");

680 
	`¥ötf
("s¸ìn_width = %i\n", 
glb_c⁄fig
.
s¸ìn
.
width
);

681 
	`¥ötf
("s¸ìn_heighà = %i\n", 
glb_c⁄fig
.
s¸ìn
.
height
);

682 
	`¥ötf
("s¸ìn_dïth = %i\n", 
glb_c⁄fig
.
s¸ìn
.
dïth
);

683 
	`¥ötf
("ª‰esh_øã = %i\n", 
glb_c⁄fig
.
s¸ìn
.
ª‰esh
);

684 
	`¥ötf
("keyb_s¸ﬁl_x = %i\n", 
glb_c⁄fig
.
s¸ﬁl
.
keyb
.
x
);

685 
	`¥ötf
("keyb_s¸ﬁl_y = %i\n", 
glb_c⁄fig
.
s¸ﬁl
.
keyb
.
y
);

686 
	`¥ötf
("mou£_s¸ﬁl_x = %i\n", 
glb_c⁄fig
.
s¸ﬁl
.
mou£
.
x
);

687 
	`¥ötf
("mou£_s¸ﬁl_y = %i\n", 
glb_c⁄fig
.
s¸ﬁl
.
mou£
.
y
);

688 
	`¥ötf
("edô_s¸ﬁl_x = %i\n", 
glb_c⁄fig
.
s¸ﬁl
.
edô
.
x
);

689 
	`¥ötf
("edô_s¸ﬁl_y = %i\n", 
glb_c⁄fig
.
s¸ﬁl
.
edô
.
y
);

690 
	`¥ötf
("obj_edô_s¸ﬁ» = %i\n", 
glb_c⁄fig
.
s¸ﬁl
.
obj_edô
);

691 
	`¥ötf
("mou£_•ìd_x = %i\n", 
glb_c⁄fig
.
mou£_•ìd
.
x
);

692 
	`¥ötf
("mou£_•ìd_y = %i\n", 
glb_c⁄fig
.
mou£_•ìd
.
y
);

693 
	`¥ötf
("gamma_c‹ª˘i⁄ = %s\n", 
glb_gamma_°r
[
glb_c⁄fig
.
gamma
].
°r
);

694 
	`¥ötf
("⁄ly_n‹mÆ_ty≥2 = %s\n", 
glb_c⁄fig
.
n‹mÆ_ty≥2
 ? "YES" : "NO");

695 
	`¥ötf
("Æways_max_œyî† = %s\n", 
glb_c⁄fig
.
Æways_max_œyîs
 ? "YES" : "NO");

696 
	`¥ötf
("°ªtch_•rôe† = %s\n", 
glb_c⁄fig
.
°ªtch_•rôes
 ? "YES" : "NO");

697 
	`¥ötf
("wöobj_ˇn_s¸ﬁl_keyb = %s\n", 
glb_c⁄fig
.
wöobj_s¸ﬁl_keyb
 ? "YES" : "NO");

698 
	`¥ötf
("wöobj_ˇn_s¸ﬁl_mou£ = %s\n", 
glb_c⁄fig
.
wöobj_s¸ﬁl_mou£
 ? "YES" : "NO");

700 
	`¥ötf
("center_zoom = ");

701 
glb_c⁄fig
.
˚¡î_zoom
)

703 -1 : 
	`¥ötf
("NO_CHANGE\n"); ;

704 
ZM_11
 : 
	`¥ötf
("1:1\n"); ;

705 
ZM_12
 : 
	`¥ötf
("1:2\n"); ;

706 
ZM_14
 : 
	`¥ötf
("1:4\n"); ;

707 
ZM_18
 : 
	`¥ötf
("1:8\n"); ;

708 
ZM_116
: 
	`¥ötf
("1:16\n"); ;

709  : 
	`¥ötf
("?\n"); ;

712 
	`¥ötf
("nb_ty≥1_≥r_a˘ = %i\n", 
glb_c⁄fig
.
nb_ty≥1_≥r_a˘
);

713 
	`¥ötf
("nb_ty≥2_≥r_a˘ = %i\n", 
glb_c⁄fig
.
nb_ty≥2_≥r_a˘
);

714 
	`¥ötf
("ds1_ßved_möimizê = %s\n", 
glb_c⁄fig
.
möimize_ds1
 ? "YES" : "NO");

715 
	`¥ötf
("lowî_•ìd_zoom_ouà = %s\n", 
glb_c⁄fig
.
lowî_•ìd_zoom_out
 ? "YES" : "NO");

716 
	`¥ötf
("w‹k•a˚_íabÀ = %s\n", 
glb_c⁄fig
.
w‹k•a˚_íabÀ
 ? "YES" : "NO");

717 
	`¥ötf
("\n");

718 
	}
}

723 
	$ds1edô_cou¡î_tick
()

725 
glb_ds1edô
.
ticks_ñ≠£d
++;

726 
	}
}

727 
END_OF_FUNCTION
(
ds1edô_cou¡î_tick
);

732 
	$ds1edô_cou¡î_Âs
()

734 
glb_ds1edô
.
ﬁd_Âs
 = glb_ds1edô.
Âs
;

735 
glb_ds1edô
.
Âs
 = 0;

736 
	}
}

737 
END_OF_FUNCTION
(
ds1edô_cou¡î_Âs
);

742 
	$ds1edô_›í_Æl_mpq
()

744 
i
;

746 
	`¥ötf
("ds1edit_open_all_mpq()\n");

747 
i
=0; i<
MAX_MPQ_FILE
; i++)

749 i‡(
glb_c⁄fig
.
mpq_fûe
[
i
] !
NULL
)

751 
	`Ârötf
(
°dout
, "›íög mpq %ò: %s\n", 
i
, 
glb_c⁄fig
.
mpq_fûe
[i]);

752 
	`Ârötf
(
°dîr
, "›íög %s\n", 
glb_c⁄fig
.
mpq_fûe
[
i
]);

753 
	`fÊush
(
°dout
);

754 
	`fÊush
(
°dîr
);

755 
glb_mpq
 = & 
glb_mpq_°ru˘
[
i
];

756 
	`mpq_b©ch_›í
(
glb_c⁄fig
.
mpq_fûe
[
i
]);

759 
	}
}

764 
	$ds1edô_lﬂd_∑Àâes
()

766 
i
, 
íåy
;

767 
∑ ame
[80], 
tmp
[150];

769 
	`Ârötf
(
°dîr
, "loadingÖalettes");

770 
	`Ârötf
(
°dout
, "\nloadingÖalettes\n");

771 
	`fÊush
(
°dîr
);

772 
	`fÊush
(
°dout
);

774 
i
=0; i<
ACT_MAX
; i++)

776 
glb_ds1edô
.
∑l_lﬂded
[
i
] = 
TRUE
;

778 i‡(
	`misc_lﬂd_∑l_‰om_disk
(
i
Ë=
FALSE
)

781 
glb_ds1edô
.
∑l_lﬂded
[
i
] = 
FALSE
;

784 
	`•rötf
(
∑ ame
, "D©a\\GlobÆ\\PÆëã\\A˘%i\\PÆ.∂2", 
i
+1);

787 
	`¥ötf
("w™àtÿªadáÖÆëã from mpq : %s\n", 
∑ ame
);

788 
íåy
 = 
	`misc_lﬂd_mpq_fûe
(

789 
∑ ame
,

790 (**Ë& 
glb_ds1edô
.
d2_∑l
[
i
],

791 & 
glb_ds1edô
.
∑l_size
[
i
],

792 
TRUE


794 i‡(
íåy
 == -1)

796 
	`•rötf
(

797 
tmp
,

800 
∑ ame


802 i‡(
i
 < 4)

803 
	`ds1edô_îr‹
(
tmp
);

805 
	`¥ötf
("w¨nög :\n%s\n", 
tmp
);

809 
	`misc_ßve_∑l_⁄_disk
(
i
, 
glb_ds1edô
.
d2_∑l
[i]);

813 
	`misc_∂2_c‹ª˘
(
i
);

814 
	`misc_∑l_d2_2_vga
(
i
);

815 
	`Ârötf
(
°dîr
, ".");

816 
	`fÊush
(
°dîr
);

818 
	`Ârötf
(
°dîr
, "\n");

819 
	`fÊush
(
°dîr
);

820 
	`¥ötf
("\n");

821 
	}
}

826 
	$maö
(
¨gc
, * 
¨gv
[])

828 
i
, 
mpq_num
=0, 
mod_num
=0, 
ds1_idx
=0;

829 * 
ööame
 = "ds1edit.ini";

830 
ªs_w
, 
ªs_h
;

831 
tmp
 [512];

832 
tmp2
 [512];

835 
	`§™d
(
	`time
(
NULL
));

836 
	`ÆÀgro_öô
();

838 
	`£t_gfx_mode
(
GFX_TEXT
, 80, 25, 0, 0);

840 i‡(
	`ö°Æl_keybﬂrd
() != 0)

841 
	`ds1edô_îr‹
("main(),Érror.\nCan't installÅhe Keyboard Handler.");

842 i‡(
	`ö°Æl_timî
() != 0)

843 
	`ds1edô_îr‹
("main(),Érror.\nCan't installÅhe Timer Handler.");

845 
	`£t_cﬁ‹_dïth
(8);

846 i‡(
	`©exô
(
ds1edô_exô
) != 0)

847 
	`ds1edô_îr‹
("main(),Érror.\nCan't installÅhe 'atexit' Handler.");

849 
	`ds1edô_öô
();

852 
	`¥ötf
("\n[allegro var]\n");

853 
	`¥ötf
("ÆÀgro_id = \"%s\"\n", 
ÆÀgro_id
);

854 
	`¥ötf
("os_type = ");

855 
os_ty≥
)

857 
OSTYPE_UNKNOWN
 : 
	`¥ötf
("unknown, orÑegular MSDOS\n"); ;

858 
OSTYPE_WIN3
 : 
	`¥ötf
("Windows 3.1 orÉarlier\n"); ;

859 
OSTYPE_WIN95
 : 
	`¥ötf
("Windows 95\n"); ;

860 
OSTYPE_WIN98
 : 
	`¥ötf
("Windows 98\n"); ;

861 
OSTYPE_WINME
 : 
	`¥ötf
("Windows ME\n"); ;

862 
OSTYPE_WINNT
 : 
	`¥ötf
("Windows NT\n"); ;

863 
OSTYPE_WIN2000
 : 
	`¥ötf
("Windows 2000\n"); ;

864 
OSTYPE_WINXP
 : 
	`¥ötf
("Windows XP\n"); ;

865 
OSTYPE_WIN2003
 : 
	`¥ötf
("Windows 2003\n"); ;

866 
OSTYPE_WINVISTA
 : 
	`¥ötf
("Windows Vista\n"); ;

867 
OSTYPE_WIN7
 : 
	`¥ötf
("Windows Seven\n"); ;

868 
OSTYPE_OS2
 : 
	`¥ötf
("OS/2\n"); ;

869 
OSTYPE_WARP
 : 
	`¥ötf
("OS/2 Warp 3\n"); ;

870 
OSTYPE_DOSEMU
 : 
	`¥ötf
("Linux DOSEMU\n"); ;

871 
OSTYPE_OPENDOS
 : 
	`¥ötf
("Caldera OpenDOS\n"); ;

872 
OSTYPE_LINUX
 : 
	`¥ötf
("Linux\n"); ;

873 
OSTYPE_SUNOS
 : 
	`¥ötf
("SunOS/Solaris\n"); ;

874 
OSTYPE_FREEBSD
 : 
	`¥ötf
("FreeBSD\n"); ;

875 
OSTYPE_NETBSD
 : 
	`¥ötf
("NetBSD\n"); ;

876 
OSTYPE_IRIX
 : 
	`¥ötf
("IRIX\n"); ;

877 
OSTYPE_DARWIN
 : 
	`¥ötf
("Darwin\n"); ;

878 
OSTYPE_QNX
 : 
	`¥ötf
("QNX\n"); ;

879 
OSTYPE_UNIX
 : 
	`¥ötf
("Unknown Unix variant\n"); ;

880 
OSTYPE_BEOS
 : 
	`¥ötf
("BeOS\n"); ;

881 
OSTYPE_HAIKU
 : 
	`¥ötf
("Haiku\n"); ;

882 
OSTYPE_MACOS
 : 
	`¥ötf
("MacOS\n"); ;

883 
OSTYPE_MACOSX
 : 
	`¥ötf
("MacOS X\n"); ;

884 
OSTYPE_PSP
 : 
	`¥ötf
("Psp\n"); ;

885  : 
	`¥ötf
("?\n"); ;

887 
	`¥ötf
("os_vîsi⁄ = %i\n", 
os_vîsi⁄
);

888 
	`¥ötf
("os_ªvisi⁄ = %i\n", 
os_ªvisi⁄
);

889 
	`¥ötf
("os_mu…ôaskög = %s\n", 
os_mu…ôaskög
 ? "TRUE" : "FALSE");

890 
	`¥ötf
("˝u_víd‹ = %s\n", 
˝u_víd‹
);

891 
	`¥ötf
("cpu_family = ");

892 
˝u_Ámûy
)

894 
CPU_FAMILY_UNKNOWN
 : 
	`¥ötf
("unknown\n"); ;

895 
CPU_FAMILY_I386
 : 
	`¥ötf
("Intel-compatible 386\n"); ;

896 
CPU_FAMILY_I486
 : 
	`¥ötf
("Intel-compatible 486\n"); ;

897 
CPU_FAMILY_I586
 : 
	`¥ötf
("Pentium orÉquivalent\n"); ;

898 
CPU_FAMILY_I686
 : 
	`¥ötf
("Pentium Pro, II, III orÉquivalent\n"); ;

899 
CPU_FAMILY_ITANIUM
 : 
	`¥ötf
("ItaniumÖrocessor\n"); ;

900 
CPU_FAMILY_POWERPC
 : 
	`¥ötf
("PowerPCÖrocessor\n"); ;

901 
CPU_FAMILY_EXTENDED
 : 
	`¥ötf
("needsÅo beÑead fromÅhe cpu_model\n"); ;

902  : 
	`¥ötf
("?\n"); ;

904 
	`¥ötf
("cpu_model = ");

905 i‡(
˝u_Ámûy
 =
CPU_FAMILY_I586
)

907 
˝u_modñ
)

909 
CPU_MODEL_PENTIUM
 : 
	`¥ötf
("CPU_MODEL_PENTIUM\n"); ;

910 
CPU_MODEL_K5
 : 
	`¥ötf
("CPU_MODEL_K5\n"); ;

911 
CPU_MODEL_K6
 : 
	`¥ötf
("CPU_MODEL_K6\n"); ;

912  : 
	`¥ötf
("?\n"); ;

915 i‡(
˝u_Ámûy
 =
CPU_FAMILY_I686
)

917 
˝u_modñ
)

919 
CPU_MODEL_PENTIUMPRO
 : 
	`¥ötf
("CPU_MODEL_PENTIUMPRO\n"); ;

920 
CPU_MODEL_PENTIUMII
 : 
	`¥ötf
("CPU_MODEL_PENTIUMII\n"); ;

921 
CPU_MODEL_PENTIUMIIIKATMAI
 : 
	`¥ötf
("CPU_MODEL_PENTIUMIIIKATMAI\n"); ;

922 
CPU_MODEL_PENTIUMIIICOPPERMINE
 : 
	`¥ötf
("CPU_MODEL_PENTIUMIIICOPPERMINE\n"); ;

923 
CPU_MODEL_ATHLON
 : 
	`¥ötf
("CPU_MODEL_ATHLON\n"); ;

924 
CPU_MODEL_DURON
 : 
	`¥ötf
("CPU_MODEL_DURON\n"); ;

925  : 
	`¥ötf
("?\n"); ;

928 i‡(
˝u_Ámûy
 =
CPU_FAMILY_EXTENDED
)

930 
˝u_modñ
)

932 
CPU_MODEL_PENTIUMIV
 : 
	`¥ötf
("CPU_MODEL_PENTIUMIV\n"); ;

933 
CPU_MODEL_XEON
 : 
	`¥ötf
("CPU_MODEL_XEON\n"); ;

934 
CPU_MODEL_ATHLON64
 : 
	`¥ötf
("CPU_MODEL_ATHLON64\n"); ;

935 
CPU_MODEL_OPTERON
 : 
	`¥ötf
("CPU_MODEL_OPTERON\n"); ;

936  : 
	`¥ötf
("?\n"); ;

939 i‡(
˝u_Ámûy
 =
CPU_FAMILY_POWERPC
)

941 
˝u_modñ
)

943 
CPU_MODEL_POWERPC_601
 : 
	`¥ötf
("CPU_MODEL_POWERPC_601\n"); ;

944 
CPU_MODEL_POWERPC_602
 : 
	`¥ötf
("CPU_MODEL_POWERPC_602\n"); ;

945 
CPU_MODEL_POWERPC_603
 : 
	`¥ötf
("CPU_MODEL_POWERPC_603\n"); ;

946 
CPU_MODEL_POWERPC_604
 : 
	`¥ötf
("CPU_MODEL_POWERPC_604\n"); ;

947 
CPU_MODEL_POWERPC_620
 : 
	`¥ötf
("CPU_MODEL_POWERPC_620\n"); ;

948 
CPU_MODEL_POWERPC_750
 : 
	`¥ötf
("CPU_MODEL_POWERPC_750\n"); ;

949 
CPU_MODEL_POWERPC_7400
 : 
	`¥ötf
("CPU_MODEL_POWERPC_7400\n"); ;

950 
CPU_MODEL_POWERPC_7450
 : 
	`¥ötf
("CPU_MODEL_POWERPC_7450\n"); ;

951  : 
	`¥ötf
("?\n"); ;

955 
	`¥ötf
("-\n");

956 
	`¥ötf
("˝u_ˇ∑bûôõ† = 0x%08X\n", 
˝u_ˇ∑bûôõs
);

957 
	`¥ötf
("deskt›_cﬁ‹_dïth = %ibµ\n", 
	`deskt›_cﬁ‹_dïth
());

958 
	`gë_deskt›_ªsﬁuti⁄
–& 
ªs_w
, & 
ªs_h
);

959 
	`¥ötf
("deskt›_ªsﬁuti⁄ = %ò* %i\n", 
ªs_w
, 
ªs_h
);

960 
	`¥ötf
("\n");

962 
	`•rötf
(

963 
tmp
,

965 
DS1EDIT_BUILD_MODE
,

966 
glb_ds1edô
.
vîsi⁄
,

967 
ÆÀgro_id


969 
	`£t_wödow_tôÀ
(
tmp
);

972 i‡(
	`°rcmp
(
ÆÀgro_id
, 
DS1EDIT_GOOD_DLL
) != 0)

974 
	`•rötf
(
tmp
,

988 
ÆÀgro_id
,

989 
DS1EDIT_GOOD_DLL
,

990 
DS1EDIT_DLL_LINK


992 
	`ds1edô_îr‹
(
tmp
);

996 
	`•rötf
(
tmp
, "%s%s\\.", 
glb_ds1edô_d©a_dú
, 
glb_ds1edô_tmp_dú
);

997 i‡(
	`fûe_exi°s
(
tmp
, -1, 
NULL
) == 0)

1000 
	`•rötf
(
tmp
, "%s%s", 
glb_ds1edô_d©a_dú
, 
glb_ds1edô_tmp_dú
);

1001 i‡(
	`°æí
(
tmp
))

1002 
tmp
[
	`°æí
(tmp) - 1] = 0;

1003 i‡(
	`mkdú
(
tmp
) != 0)

1006 
	`•rötf
(

1007 
tmp
,

1010 
glb_ds1edô_d©a_dú
, 
glb_ds1edô_tmp_dú
);

1011 
tmp
[
	`°æí
(tmp) - 1] = 0;

1012 
	`ds1edô_îr‹
(
tmp
);

1017 
	`•rötf
(
tmp
, "ds1edit.ini");

1018 i‡(
	`fûe_exi°s
(
tmp
, -1, 
NULL
) == 0)

1020 
	`öi_¸óã
(
tmp
);

1021 
	`ÆÀgro_mesßge
(

1027 
	`exô
(
DS1ERR_INICREATE
);

1031 
	`öi_ªad
(
ööame
);

1032 
	`ds1edô_debug
();

1035 
mod_num
 = 0;

1036 i‡(
glb_c⁄fig
.
mod_dú
[0] !
NULL
)

1038 
	`•rötf
(
tmp
, "%s\\.", 
glb_c⁄fig
.
mod_dú
[0]);

1039 i‡(
	`fûe_exi°s
(
tmp
, -1, 
NULL
) == 0)

1041 
	`•rötf
(

1042 
tmp2
,

1046 
tmp


1048 
	`¥ötf
("%s\n", 
tmp2
);

1049 
	`ÆÀgro_mesßge
(
tmp2
);

1052 
mod_num
 = 1;

1055 
i
=0; i<
MAX_MPQ_FILE
; i++)

1057 i‡(
glb_c⁄fig
.
mpq_fûe
[
i
] !
NULL
)

1059 i‡(
	`fûe_exi°s
(
glb_c⁄fig
.
mpq_fûe
[
i
], -1, 
NULL
) == 0)

1061 
	`•rötf
(

1062 
tmp2
,

1066 
glb_c⁄fig
.
mpq_fûe
[
i
]

1068 
	`¥ötf
("%s\n", 
tmp2
);

1069 
	`ÆÀgro_mesßge
(
tmp2
);

1072 
mpq_num
++;

1075 i‡((
mod_num
 =0Ë&& (
mpq_num
 == 0))

1077 
	`•rötf
(

1078 
tmp
,

1081 
	`ds1edô_îr‹
(
tmp
);

1082 
	`ÆÀgro_mesßge
(
tmp
);

1084 i‡(
mpq_num
 < 4)

1085 
	`¥ötf
("warning :ÇotállÅhe 4 mpq have been found\n");

1088 
glb_ds1edô
.
cur_gamma
 = 
glb_c⁄fig
.
gamma
;

1089 
	`misc_ªad_gamma
();

1092 
glb_ds1edô
.
wö_¥evõw
.
x0
 = 0;

1093 
glb_ds1edô
.
wö_¥evõw
.
y0
 = 0;

1094 
glb_ds1edô
.
wö_¥evõw
.
w
 = 
glb_c⁄fig
.
s¸ìn
.
width
;

1095 
glb_ds1edô
.
wö_¥evõw
.
h
 = 
glb_c⁄fig
.
s¸ìn
.
height
;

1098 
	`wedô_ªad_pcx
();

1099 
	`wedô_make_2nd_buâ⁄s
();

1100 
	`misc_wÆkabÀ_tûe_öfo_pcx
();

1110 
glb_c⁄fig
.
s¸ìn
.
width
 += 600;

1111 
glb_c⁄fig
.
s¸ìn
.
height
 += 600;

1112 
glb_ds1edô
.
big_s¸ìn_buff
 = 
	`¸óã_bôm≠
(

1113 
glb_c⁄fig
.
s¸ìn
.
width
,

1114 
glb_c⁄fig
.
s¸ìn
.
height


1116 i‡(
glb_ds1edô
.
big_s¸ìn_buff
 =
NULL
)

1118 
	`•rötf
(
tmp
, "main(),Érror.\nCan't create big_screen_buff (%i*%iÖixels).",

1119 
glb_c⁄fig
.
s¸ìn
.
width
,

1120 
glb_c⁄fig
.
s¸ìn
.
height


1122 
	`ds1edô_îr‹
(
tmp
);

1124 
glb_c⁄fig
.
s¸ìn
.
width
 -= 600;

1125 
glb_c⁄fig
.
s¸ìn
.
height
 -= 600;

1127 
glb_ds1edô
.
s¸ìn_buff
 = 
	`¸óã_sub_bôm≠
(

1128 
glb_ds1edô
.
big_s¸ìn_buff
,

1131 
glb_c⁄fig
.
s¸ìn
.
width
,

1132 
glb_c⁄fig
.
s¸ìn
.
height


1134 i‡(
glb_ds1edô
.
s¸ìn_buff
 =
NULL
)

1136 
	`•rötf
(
tmp
, "main(),Érror.\nCan't create sub-bitmap screen_buff (%i*%iÖixels).",

1137 
glb_c⁄fig
.
s¸ìn
.
width
,

1138 
glb_c⁄fig
.
s¸ìn
.
height


1140 
	`ds1edô_îr‹
(
tmp
);

1144 
	`ds1edô_›í_Æl_mpq
();

1147 
	`ds1edô_lﬂd_∑Àâes
();

1150 i‡(
	`misc_cmd_löe_∑r£
 (
¨gc
, 
¨gv
))

1151 
	`ds1edô_îr‹
("main(),Érror.\nProblem inÅhe commandÜine.");

1154 i‡(
glb_ds1edô
.
cmd_löe
.
debug_mode
 =
TRUE
)

1155 
	`mkdú
("Debug");

1158 
	`Ârötf
(
°dîr
, "reading objects.txt...");

1159 
	`ªad_obje˘s_txt
();

1160 
	`Ârötf
(
°dîr
, "done\n");

1163 
	`Ârötf
(
°dîr
, "reading Obj.txt...");

1164 
	`ªad_obj_txt
();

1165 
	`Ârötf
(
°dîr
, "done\n");

1167 i‡(
glb_ds1edô
.
cmd_löe
.
ds1_fûíame
 !
NULL
)

1172 i‡(
glb_ds1edô
.
cmd_löe
.
dt1_li°_num
 != -1)

1175 
	`misc_›í_1_ds1_f‹˚_dt1
(
ds1_idx
);

1180 
	`misc_›í_1_ds1
(

1181 
ds1_idx
,

1182 
glb_ds1edô
.
cmd_löe
.
ds1_fûíame
,

1183 
glb_ds1edô
.
cmd_löe
.
lv…y≥_id
,

1184 
glb_ds1edô
.
cmd_löe
.
lvÕª°_def
,

1185 
glb_ds1edô
.
cmd_löe
.
ªsize_width
,

1186 
glb_ds1edô
.
cmd_löe
.
ªsize_height


1190 i‡(
glb_ds1edô
.
cmd_löe
.
öi_fûíame
 !
NULL
)

1195 
glb_ds1edô
.
show_2nd_row
 = 
TRUE
;

1198 
	`misc_›í_£vîÆ_ds1
(
¨gv
[1]);

1203 
	`ds1edô_îr‹
("main(),Érror.\nBug :Çeither .DS1Çorá .INI inÅhe commandÜine.");

1207 
	`¥ötf
("============================================================\n");

1208 i‡(
¨gc
 >= 4)

1211 i‡(
¨gc
 == 2)

1216 
	`¥ötf
("syntaxe 1 : ds1edit <file.ds1> <lvlTypes.txt Id> <lvlPrest.txt Def> [options]\n");

1217 
	`¥ötf
("syntaxe 2 : ds1edit <file.ini>\n"

1221 
	`ÆÀgro_mesßge
(

1227 
WINDS1EDIT_GUI_LOADER_LINK


1229 
	`exô
(
DS1ERR_CMDLINE
);

1231 
	`¥ötf
("============================================================\n");

1234 
	`¥ötf
("\nanimdata_load()\n");

1235 
	`fÊush
(
°dout
);

1236 
	`fÊush
(
°dîr
);

1237 
	`™imd©a_lﬂd
();

1240 
	`¥ötf
("loading ds1 objectsánimations :\n");

1241 
	`Ârötf
(
°dîr
, "loading ds1 objectsánimations : ");

1242 
	`fÊush
(
°dout
);

1243 
	`fÊush
(
°dîr
);

1245 
	`™im_upd©e_gfx
(
TRUE
);

1247 
	`¥ötf
("\n");

1248 
	`Ârötf
(
°dîr
, "\n");

1249 
	`fÊush
(
°dout
);

1250 
	`fÊush
(
°dîr
);

1253 
	`¥ötf
("\ncolor maps...");

1254 
	`Ârötf
(
°dîr
, "color maps");

1255 
	`misc_make_cm≠s
();

1256 
	`¥ötf
("done\n");

1257 
	`Ârötf
(
°dîr
, "done\n");

1260 
	`fÊush
(
°dout
);

1261 
	`fÊush
(
°dîr
);

1262 i‡–(
glb_c⁄fig
.
s¸ìn
.
dïth
 != 8) &&

1263 (
glb_c⁄fig
.
s¸ìn
.
dïth
 != 15) &&

1264 (
glb_c⁄fig
.
s¸ìn
.
dïth
 != 16) &&

1265 (
glb_c⁄fig
.
s¸ìn
.
dïth
 != 24) &&

1266 (
glb_c⁄fig
.
s¸ìn
.
dïth
 != 32)

1269 
	`•rötf
(

1270 
tmp
,

1272 
glb_c⁄fig
.
s¸ìn
.
dïth


1274 
	`ds1edô_îr‹
(
tmp
);

1278 
	`£t_cﬁ‹_dïth
(
glb_c⁄fig
.
s¸ìn
.
dïth
);

1280 
	`ªque°_ª‰esh_øã
(
glb_c⁄fig
.
s¸ìn
.
ª‰esh
);

1281 i‡(
glb_c⁄fig
.
fuŒs¸ìn
 =
TRUE
)

1283 i‡(
	`£t_gfx_mode
(
GFX_AUTODETECT_FULLSCREEN
, 
glb_c⁄fig
.
s¸ìn
.
width
,

1284 
glb_c⁄fig
.
s¸ìn
.
height
, 0, 0) != 0)

1286 
	`•rötf
(

1287 
tmp
,

1290 
glb_c⁄fig
.
s¸ìn
.
width
,

1291 
glb_c⁄fig
.
s¸ìn
.
height
,

1292 
glb_c⁄fig
.
s¸ìn
.
dïth
,

1293 
glb_c⁄fig
.
s¸ìn
.
ª‰esh
,

1295 
ÆÀgro_îr‹


1297 
	`ds1edô_îr‹
(
tmp
);

1302 i‡(
	`£t_gfx_mode
(
GFX_AUTODETECT_WINDOWED
, 
glb_c⁄fig
.
s¸ìn
.
width
,

1303 
glb_c⁄fig
.
s¸ìn
.
height
, 0, 0) != 0)

1305 
	`•rötf
(

1306 
tmp
,

1309 
glb_c⁄fig
.
s¸ìn
.
width
,

1310 
glb_c⁄fig
.
s¸ìn
.
height
,

1311 
glb_c⁄fig
.
s¸ìn
.
dïth
,

1312 
glb_c⁄fig
.
s¸ìn
.
ª‰esh
,

1314 
ÆÀgro_îr‹


1316 
	`ds1edô_îr‹
(
tmp
);

1319 
glb_ds1edô
.
cuºít_ª‰esh_øã
 = 
	`gë_ª‰esh_øã
();

1322 
glb_ds1edô
.
video_∑ge
[0] = 
	`¸óã_video_bôm≠
(

1323 
glb_c⁄fig
.
s¸ìn
.
width
,

1324 
glb_c⁄fig
.
s¸ìn
.
height


1326 i‡(
glb_ds1edô
.
video_∑ge
[0] =
NULL
)

1328 
	`•rötf
(
tmp
, "main(),Érror.\nCan't create videoÖage 1.",

1329 
glb_c⁄fig
.
s¸ìn
.
width
,

1330 
glb_c⁄fig
.
s¸ìn
.
height


1332 
	`ds1edô_îr‹
(
tmp
);

1335 
glb_ds1edô
.
video_∑ge
[1] = 
	`¸óã_video_bôm≠
(

1336 
glb_c⁄fig
.
s¸ìn
.
width
,

1337 
glb_c⁄fig
.
s¸ìn
.
height


1339 i‡(
glb_ds1edô
.
video_∑ge
[1] =
NULL
)

1341 
	`•rötf
(
tmp
, "main(),Érror.\nCan't create videoÖage 2.",

1342 
glb_c⁄fig
.
s¸ìn
.
width
,

1343 
glb_c⁄fig
.
s¸ìn
.
height


1345 
	`ds1edô_îr‹
(
tmp
);

1349 
	`£t_di•œy_swôch_mode
(
SWITCH_PAUSE
);

1352 
	`£t_cﬁ‹_dïth
(8);

1354 
	`ãxt_mode
(-1);

1356 
	`LOCK_VARIABLE
(
glb_ds1edô
.
ﬁd_Âs
);

1357 
	`LOCK_VARIABLE
(
glb_ds1edô
.
Âs
);

1358 
	`LOCK_VARIABLE
(
glb_ds1edô
.
ticks_ñ≠£d
);

1359 
	`LOCK_FUNCTION
(
ds1edô_cou¡î_tick
);

1360 
	`LOCK_FUNCTION
(
ds1edô_cou¡î_Âs
);

1362 i‡(
	`ö°Æl_öt
(
ds1edô_cou¡î_tick
, 1000 / 25) != 0)

1364 
	`•rötf
(

1365 
tmp
,

1368 
	`ds1edô_îr‹
(
tmp
);

1370 i‡(
	`ö°Æl_öt
(
ds1edô_cou¡î_Âs
, 1000) != 0)

1372 
	`•rötf
(

1373 
tmp
,

1376 
	`ds1edô_îr‹
(
tmp
);

1379 i‡(
	`ö°Æl_mou£
() == -1)

1381 
	`•rötf
(

1382 
tmp
,

1385 
	`ds1edô_îr‹
(
tmp
);

1387 
	`£t_mou£_•ìd
(
glb_c⁄fig
.
mou£_•ìd
.
x
, glb_c⁄fig.mou£_•ìd.
y
);

1391 
glb_ds1edô
.
wö_¥evõw
.
x0
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.x0;

1392 
glb_ds1edô
.
wö_¥evõw
.
y0
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.y0;

1393 
glb_ds1edô
.
wö_¥evõw
.
w
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.w ;

1394 
glb_ds1edô
.
wö_¥evõw
.
h
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.h ;

1398 
	`‰e›í
("°dîr.txt", "wt", 
°dîr
);

1399 
	`öãrÁc_u£r_h™dÀr
(
ds1_idx
);

1401 i‡(
glb_ds1edô
.
video_∑ge
[0] !
NULL
)

1402 
	`de°roy_bôm≠
(
glb_ds1edô
.
video_∑ge
[0]);

1404 i‡(
glb_ds1edô
.
video_∑ge
[1] !
NULL
)

1405 
	`de°roy_bôm≠
(
glb_ds1edô
.
video_∑ge
[1]);

1408 
	`£t_gfx_mode
(
GFX_TEXT
, 80, 25, 0, 0);

1410 
	`fÊush
(
°dout
);

1411 
	`fÊush
(
°dîr
);

1412  
DS1ERR_OK
;

1413 
	}
}

1414 
END_OF_MAIN
();

	@misc.c

1 
	~<°rög.h
>

2 
	~"°ru˘s.h
"

3 
	~"îr‹.h
"

4 
	~"ds1misc.h
"

5 
	~"txåód.h
"

6 
	~"dt1misc.h
"

7 
	~"mpq/mpqvõw.h
"

8 
	~"misc.h
"

13 
	$misc_∑l_d2_2_vga
(
∑l_idx
)

15 
UBYTE
 
r
, 
g
, 
b
;

16 
i
, 
ridx
;

18 i‡(
glb_ds1edô
.
d2_∑l
[
∑l_idx
] =
NULL
)

20 
i
=0; i<256; i++)

22 
glb_ds1edô
.
vga_∑l
[
∑l_idx
][
i
].
r
 = i >> 2;

23 
glb_ds1edô
.
vga_∑l
[
∑l_idx
][
i
].
g
 = i >> 2;

24 
glb_ds1edô
.
vga_∑l
[
∑l_idx
][
i
].
b
 = i >> 2;

29 
i
=0; i<256; i++)

31 
ridx
 = 4 * 
i
;

32 
r
 = 
glb_ds1edô
.
d2_∑l
[
∑l_idx
][
ridx
];

33 
g
 = 
glb_ds1edô
.
d2_∑l
[
∑l_idx
][
ridx
 + 1];

34 
b
 = 
glb_ds1edô
.
d2_∑l
[
∑l_idx
][
ridx
 + 2];

35 
r
 = 
glb_ds1edô
.
gamma_èbÀ
[glb_ds1edô.
cur_gamma
][r];

36 
g
 = 
glb_ds1edô
.
gamma_èbÀ
[glb_ds1edô.
cur_gamma
][g];

37 
b
 = 
glb_ds1edô
.
gamma_èbÀ
[glb_ds1edô.
cur_gamma
][b];

38 
glb_ds1edô
.
vga_∑l
[
∑l_idx
][
i
].
r
 =Ñ >> 2;

39 
glb_ds1edô
.
vga_∑l
[
∑l_idx
][
i
].
g
 = g >> 2;

40 
glb_ds1edô
.
vga_∑l
[
∑l_idx
][
i
].
b
 = b >> 2;

42 
	}
}

47 
	$misc_qs‹t_hñ≥r_block_èbÀ_1
(c⁄° * 
e1
, c⁄° * 
e2
)

49 
BLOCK_TABLE_S
 * 
bt1
, * 
bt2
;

50 
n1
=0, 
n2
=0;

52 
bt1
 = (
BLOCK_TABLE_S
 *Ë
e1
;

53 
bt2
 = (
BLOCK_TABLE_S
 *Ë
e2
;

54 i‡(
bt1
->
‹õ¡©i⁄
 !
bt2
->orientation)

56 
n1
 = 
bt1
->
‹õ¡©i⁄
;

57 
n2
 = 
bt2
->
‹õ¡©i⁄
;

59 i‡(
bt1
->
maö_ödex
 !
bt2
->main_index)

61 
n1
 = 
bt1
->
maö_ödex
;

62 
n2
 = 
bt2
->
maö_ödex
;

64 i‡(
bt1
->
sub_ödex
 !
bt2
->sub_index)

66 
n1
 = 
bt1
->
sub_ödex
;

67 
n2
 = 
bt2
->
sub_ödex
;

69 i‡(
bt1
->
dt1_idx
 !
bt2
->dt1_idx)

71 
n1
 = 
bt1
->
dt1_idx_f‹_ds1
;

72 
n2
 = 
bt2
->
dt1_idx_f‹_ds1
;

74 i‡(
n1
 =0Ën1 = 
DT1_MAX
;

75 i‡(
n2
 =0Ën2 = 
DT1_MAX
;

77 i‡(
bt1
->
ørôy
 !
bt2
->rarity)

79 
n1
 = 
bt1
->
ørôy
;

80 
n2
 = 
bt2
->
ørôy
;

82 i‡(
bt1
->
block_idx
 !
bt2
->block_idx)

84 
n1
 = 
bt1
->
block_idx
;

85 
n2
 = 
bt2
->
block_idx
;

87  
n1
 - 
n2
;

88 
	}
}

93 
	$misc_qs‹t_hñ≥r_block_èbÀ_2
(c⁄° * 
e1
, c⁄° * 
e2
)

95 
BLOCK_TABLE_S
 * 
bt1
, * 
bt2
;

96 
n1
=0, 
n2
=0;

98 
bt1
 = (
BLOCK_TABLE_S
 *Ë
e1
;

99 
bt2
 = (
BLOCK_TABLE_S
 *Ë
e2
;

109 i‡(
bt1
->
maö_ödex
 !
bt2
->main_index)

111 
n1
 = 
bt1
->
maö_ödex
;

112 
n2
 = 
bt2
->
maö_ödex
;

114 i‡(
bt1
->
‹õ¡©i⁄
 !
bt2
->orientation)

116 
n1
 = 
bt1
->
‹õ¡©i⁄
;

117 
n2
 = 
bt2
->
‹õ¡©i⁄
;

119 i‡(
bt1
->
sub_ödex
 !
bt2
->sub_index)

121 
n1
 = 
bt1
->
sub_ödex
;

122 
n2
 = 
bt2
->
sub_ödex
;

126 i‡(
bt1
->
dt1_idx
 !
bt2
->dt1_idx)

128 
n1
 = 
bt1
->
dt1_idx
;

129 
n2
 = 
bt2
->
dt1_idx
;

133 i‡(
bt1
->
ørôy
 !
bt2
->rarity)

135 
n1
 = 
bt1
->
ørôy
;

136 
n2
 = 
bt2
->
ørôy
;

138 i‡(
bt1
->
block_idx
 !
bt2
->block_idx)

140 
n1
 = 
bt1
->
block_idx
;

141 
n2
 = 
bt2
->
block_idx
;

143  
n1
 - 
n2
;

144 
	}
}

150 
	$misc_check_tûes_c⁄Êi˘s
(
ds1_idx
)

152 
BLOCK_TABLE_S
 * 
bt
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
;

153 
ﬁd_o
, 
ﬁd_m
, 
ﬁd_s
, 
o
, 
m
, 
s
;

154 
ﬁd_d
, 
d
, 
d⁄e
 = 
FALSE
, 
d⁄e2
, 
°¨t_i
 = 0, 
i
, 
íd_i
, 
r
;

155 
œ°_block
, 
fú°_block
;

156 
bt_max
 = 
glb_ds1
[
ds1_idx
].
bt_num
, 
b
;

157 
sum_ørôy
, 
max_ørôy
;

160  ! 
d⁄e
)

162 
ﬁd_o
 = 
bt
[
°¨t_i
].
‹õ¡©i⁄
;

163 
ﬁd_m
 = 
bt
[
°¨t_i
].
maö_ödex
;

164 
ﬁd_s
 = 
bt
[
°¨t_i
].
sub_ödex
;

165 
ﬁd_d
 = 
bt
[
°¨t_i
].
dt1_idx
;

167 
bt
[
°¨t_i
].
u£d_by_game
 = bt[°¨t_i].
u£d_by_edô‹
 = 
FALSE
;

170 
d⁄e2
 = 
FALSE
;

171 
sum_ørôy
 = 
bt
[
°¨t_i
].
ørôy
;

172 
œ°_block
 = 
°¨t_i
;

173 
i
 = 
°¨t_i
 + 1;

174 
max_ørôy
 = -1;

175 i‡(
bt
[
°¨t_i
].
ørôy
)

176 
fú°_block
 = 
°¨t_i
;

178 
fú°_block
 = -1;

179  ! 
d⁄e2
)

181 
o
 = 
bt
[
i
].
‹õ¡©i⁄
;

182 
m
 = 
bt
[
i
].
maö_ödex
;

183 
s
 = 
bt
[
i
].
sub_ödex
;

184 
d
 = 
bt
[
i
].
dt1_idx
;

185 
r
 = 
bt
[
i
].
ørôy
;

186 i‡((
ﬁd_o
 !
o
Ë|| (
ﬁd_m
 !
m
Ë|| (
ﬁd_s
 !
s
Ë|| (
i
 >
bt_max
))

187 
d⁄e2
 = 
TRUE
;

190 
bt
[
i
].
u£d_by_game
 = bt[i].
u£d_by_edô‹
 = 
FALSE
;

191 i‡(
d
 =
ﬁd_d
)

192 
œ°_block
 = 
i
;

193 i‡(
r
)

195 i‡(
fú°_block
 == -1)

196 
fú°_block
 = 
i
;

198 i‡(
r
 > 
max_ørôy
)

200 
fú°_block
 = 
i
;

201 
max_ørôy
 = 
r
;

204 
sum_ørôy
 +
r
;

205 
i
++;

208 
íd_i
 = 
i
 - 1;

211 i‡(
sum_ørôy
 == 0)

214 
bt
[
œ°_block
].
u£d_by_game
 = bt[œ°_block].
u£d_by_edô‹
 = 
TRUE
;

219 
bt
[
fú°_block
].
u£d_by_edô‹
 = 
TRUE
;

222 
b
 = 
°¨t_i
; b <
íd_i
; b++)

224 i‡(
bt
[
b
].
ørôy
)

225 
bt
[
b
].
u£d_by_game
 = 
TRUE
;

230 i‡(
i
 >
bt_max
)

231 
d⁄e
 = 
TRUE
;

233 
°¨t_i
 = 
i
;

235 
	}
}

240 
	$misc_make_block_èbÀ
(
ds1_idx
)

242 
BLOCK_TABLE_S
 * 
bt_±r
;

243 
BLOCK_S
 * 
b_±r
;

244 
tmp_°r
[80];

245 
i
, 
d
, 
b
, 
size
, 
n
 = 0;

247 
i
=0; i<
DT1_IN_DS1_MAX
; i++)

249 
d
 = 
glb_ds1
[
ds1_idx
].
dt1_idx
[
i
];

250 i‡(
d
 != -1)

251 
n
 +
glb_dt1
[
d
].
block_num
;

253 
n
++;

254 
size
 = (
BLOCK_TABLE_S
Ë* 
n
;

255 
glb_ds1
[
ds1_idx
].
block_èbÀ
 = (
BLOCK_TABLE_S
 *Ë
	`mÆloc
(
size
);

256 i‡(
glb_ds1
[
ds1_idx
].
block_èbÀ
 =
NULL
)

258 
	`•rötf
(
tmp_°r
, "make_block_table(%i),ÇotÉnough mem for %i bytes\n",

259 
ds1_idx
, 
size
);

260 
	`ds1edô_îr‹
(
tmp_°r
);

262 
	`mem£t
(
glb_ds1
[
ds1_idx
].
block_èbÀ
, 0, 
size
);

263 
glb_ds1
[
ds1_idx
].
bt_num
 = 
n
;

266 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
;

268 
bt_±r
->
‹õ¡©i⁄
 = -1;

269 
bt_±r
->
maö_ödex
 = -1;

270 
bt_±r
->
sub_ödex
 = -1;

271 
bt_±r
->
ørôy
 = -1;

272 
bt_±r
->
dt1_idx_f‹_ds1
 = -1;

273 
bt_±r
->
dt1_idx
 = -1;

274 
bt_±r
->
block_idx
 = -1;

275 
bt_±r
->
roof_y
 = -1;

276 
bt_±r
->
ty≥
 = -1;

277 
bt_±r
->
zîo_löe
 = -1;

278 
bt_±r
++;

280 
i
=0; i<
DT1_IN_DS1_MAX
; i++)

282 
d
 = 
glb_ds1
[
ds1_idx
].
dt1_idx
[
i
];

283 i‡(
d
 != -1)

285 
b_±r
 = 
glb_dt1
[
d
].
bh_buf„r
;

286 
b
=0; b<
glb_dt1
[
d
].
block_num
; b++)

289 
bt_±r
->
‹õ¡©i⁄
 = 
b_±r
->orientation;

290 
bt_±r
->
maö_ödex
 = 
b_±r
->main_index;

291 
bt_±r
->
sub_ödex
 = 
b_±r
->sub_index;

292 
bt_±r
->
ørôy
 = 
b_±r
->rarity;

295 
bt_±r
->
dt1_idx_f‹_ds1
 = 
i
;

296 
bt_±r
->
dt1_idx
 = 
d
;

297 
bt_±r
->
block_idx
 = 
b
;

298 
bt_±r
->
roof_y
 = 0;

299 
bt_±r
->
zîo_löe
 = 0;

302 i‡(
bt_±r
->
‹õ¡©i⁄
 == 0)

305 
bt_±r
->
zîo_löe
 = 0;

306 i‡(
b_±r
->
™im©ed
 == 0x01)

309 
bt_±r
->
ty≥
 = 
BT_ANIMATED
;

314 
bt_±r
->
ty≥
 = 
BT_STATIC
;

317 i‡(
bt_±r
->
‹õ¡©i⁄
 == 13)

320 
bt_±r
->
ty≥
 = 
BT_SHADOW
;

321 
bt_±r
->
zîo_löe
 = - 
b_±r
->
size_y
;

326 i‡((
bt_±r
->
‹õ¡©i⁄
 == 10) || (bt_ptr->orientation == 11))

329 
bt_±r
->
ty≥
 = 
BT_SPECIAL
;

330 
bt_±r
->
zîo_löe
 = - 
b_±r
->
size_y
;

332 i‡(
bt_±r
->
‹õ¡©i⁄
 == 15)

335 
bt_±r
->
ty≥
 = 
BT_ROOF
;

336 
bt_±r
->
roof_y
 = 
b_±r
->roof_y;

337 
bt_±r
->
zîo_löe
 = 0;

339 i‡(
bt_±r
->
‹õ¡©i⁄
 < 15)

342 
bt_±r
->
ty≥
 = 
BT_WALL_UP
;

343 
bt_±r
->
zîo_löe
 = - 
b_±r
->
size_y
;

345 i‡(
bt_±r
->
‹õ¡©i⁄
 > 15)

348 
bt_±r
->
ty≥
 = 
BT_WALL_DOWN
;

349 
bt_±r
->
zîo_löe
 = 96;

354 
bt_±r
++;

355 
b_±r
++;

361 
	`¥ötf
("\ndt1_idx file\n"

363 
d
=0; d<
DT1_IN_DS1_MAX
; d++)

365 i‡(
glb_ds1
[
ds1_idx
].
dt1_idx
[
d
] != -1)

367 
i
=0; i<
DT1_MAX
; i++)

369 i‡(
i
 =
glb_ds1
[
ds1_idx
].
dt1_idx
[
d
])

371 i‡(
glb_dt1
[
i
].
ds1_ußge
 > 0)

372 
	`¥ötf
("%7ò%s\n", 
i
, 
glb_dt1
[i].
«me
);

379 
	`qs‹t
(
glb_ds1
[
ds1_idx
].
block_èbÀ
, 
n
, (
BLOCK_TABLE_S
),

380 
misc_qs‹t_hñ≥r_block_èbÀ_1
);

383 
	`misc_check_tûes_c⁄Êi˘s
(
ds1_idx
);

386 
	`qs‹t
(
glb_ds1
[
ds1_idx
].
block_èbÀ
, 
n
, (
BLOCK_TABLE_S
),

387 
misc_qs‹t_hñ≥r_block_èbÀ_2
);

390 
	`¥ötf
("\ns‹ãd block_èbÀ o‡glb_ds1[%i] (%òblocksË:\n", 
ds1_idx
, 
n
);

391 
	`¥ötf
("block orientation main_idx sub_idx frame dt1_idx blk_idxÑoof_yÅypeÜine0\n");

392 
	`¥ötf
("----- ----------- -------- ------- ----- ------- ------- ------ ---- -----\n");

393 
b
=0; b<
glb_ds1
[
ds1_idx
].
bt_num
; b++)

395 
	`¥ötf
("%5i %11li %8li %7li %5li %7li %7li %6i %4i %5i",

396 
b
,

397 
glb_ds1
[
ds1_idx
].
block_èbÀ
[
b
].
‹õ¡©i⁄
,

398 
glb_ds1
[
ds1_idx
].
block_èbÀ
[
b
].
maö_ödex
,

399 
glb_ds1
[
ds1_idx
].
block_èbÀ
[
b
].
sub_ödex
,

400 
glb_ds1
[
ds1_idx
].
block_èbÀ
[
b
].
ørôy
,

401 
glb_ds1
[
ds1_idx
].
block_èbÀ
[
b
].
dt1_idx
,

402 
glb_ds1
[
ds1_idx
].
block_èbÀ
[
b
].
block_idx
,

403 
glb_ds1
[
ds1_idx
].
block_èbÀ
[
b
].
roof_y
,

404 
glb_ds1
[
ds1_idx
].
block_èbÀ
[
b
].
ty≥
,

405 
glb_ds1
[
ds1_idx
].
block_èbÀ
[
b
].
zîo_löe


407 
glb_ds1
[
ds1_idx
].
block_èbÀ
[
b
].
c⁄Êi˘
 = 
FALSE
;

408 i‡(
glb_ds1
[
ds1_idx
].
block_èbÀ
[
b
].
ørôy
 == 0)

410 i‡(
b
>1)

412 i‡–(
glb_ds1
[
ds1_idx
].
block_èbÀ
[
b
].
‹õ¡©i⁄
 == glb_ds1[ds1_idx].block_table[b-1].orientation) &&

413 (
glb_ds1
[
ds1_idx
].
block_èbÀ
[
b
].
maö_ödex
 == glb_ds1[ds1_idx].block_table[b-1].main_index) &&

414 (
glb_ds1
[
ds1_idx
].
block_èbÀ
[
b
].
sub_ödex
 == glb_ds1[ds1_idx].block_table[b-1].sub_index)

416 
glb_ds1
[
ds1_idx
].
block_èbÀ
[
b
].
c⁄Êi˘
 = 
TRUE
;

418 i‡(
b
 < (
glb_ds1
[
ds1_idx
].
bt_num
-1))

420 i‡–(
glb_ds1
[
ds1_idx
].
block_èbÀ
[
b
].
‹õ¡©i⁄
 == glb_ds1[ds1_idx].block_table[b+1].orientation) &&

421 (
glb_ds1
[
ds1_idx
].
block_èbÀ
[
b
].
maö_ödex
 == glb_ds1[ds1_idx].block_table[b+1].main_index) &&

422 (
glb_ds1
[
ds1_idx
].
block_èbÀ
[
b
].
sub_ödex
 == glb_ds1[ds1_idx].block_table[b+1].sub_index)

424 
glb_ds1
[
ds1_idx
].
block_èbÀ
[
b
].
c⁄Êi˘
 = 
TRUE
;

426 } i‡(
glb_ds1
[
ds1_idx
].
block_èbÀ
[
b
].
c⁄Êi˘
)

427 
	`¥ötf
(" *");

428 
	`¥ötf
("\n");

430 
	}
}

435 
	$misc_ªad_gamma
()

437 
FILE
 * 
ö
;

438 
gt
, 
i
, 
v
;

439 
tmp
[150], 
gamma_∑th
[100];

441 
	`•rötf
(
gamma_∑th
, "%s%s", 
glb_ds1edô_d©a_dú
, "gamma.dat");

442 
	`Ârötf
(
°dîr
, "ªad gamm®c‹ª˘i⁄ÅabÀ (%s)\n", 
gamma_∑th
);

443 
ö
 = 
	`f›í
(
gamma_∑th
, "rb");

444 i‡(
ö
 =
NULL
)

446 
	`•rötf
(
tmp
, "misc_ªad_gamma(Ë: c™'à›í %s", 
gamma_∑th
);

447 
	`ds1edô_îr‹
(
tmp
);

449 
gt
=
GC_060
; gt<
GC_MAX
; gt++)

451 
i
=0; i<256; i++)

453 
v
 = 
	`fgëc
(
ö
);

454 
glb_ds1edô
.
gamma_èbÀ
[
gt
][
i
] = 
v
;

457 
	`f˛o£
(
ö
);

458 
	}
}

463 
	$misc_upd©e_∑l_wôh_gamma
()

465 
i
;

467 
i
=0; i<
ACT_MAX
; i++)

468 
	`misc_∑l_d2_2_vga
(
i
);

469 
	}
}

476 
	$misc_pcx_put_d2_∑Àâe
(* 
«me
, 
∑l_idx
)

478 
FILE
 * 
ö
;

479 
i
, 
r
, 
g
, 
b
, 
ridx
;

481 
ö
 = 
	`f›í
(
«me
, "rb+");

482 i‡(
ö
 =
NULL
)

484 
	`¥ötf
("w¨nög : c™'àmodifyÖÆëã o‡fûê%s\n", 
«me
);

488 
	`f£ek
(
ö
, -768, 
SEEK_END
);

489 
i
=0; i<256; i++)

491 
ridx
 = 4 * 
i
;

492 
r
 = 
glb_ds1edô
.
d2_∑l
[
∑l_idx
][
ridx
];

493 
g
 = 
glb_ds1edô
.
d2_∑l
[
∑l_idx
][
ridx
 + 1];

494 
b
 = 
glb_ds1edô
.
d2_∑l
[
∑l_idx
][
ridx
 + 2];

495 
	`Âutc
(
glb_ds1edô
.
gamma_èbÀ
[glb_ds1edô.
cur_gamma
][
r
], 
ö
);

496 
	`Âutc
(
glb_ds1edô
.
gamma_èbÀ
[glb_ds1edô.
cur_gamma
][
g
], 
ö
);

497 
	`Âutc
(
glb_ds1edô
.
gamma_èbÀ
[glb_ds1edô.
cur_gamma
][
b
], 
ö
);

499 
	`f˛o£
(
ö
);

500 
	}
}

505 
	$misc_make_cm≠s_hñ≥r
(c⁄° 
PALETTE
 
∑l
, 
x
, 
y
, 
RGB
 * 
rgb
)

507 i‡(
x
 =
COL_SHADOW
)

510 
rgb
->
r
 = 63;

511 
rgb
->
g
 = 63;

512 
rgb
->
b
 = 63;

514 i‡(
x
 =
COL_MOUSE
)

518 
rgb
->
r
 = (
∑l
[
x
].∏+ÖÆ[
y
].r * 4) / 3;

519 
rgb
->
g
 = (
∑l
[
x
].g +ÖÆ[
y
].g * 4) / 3;

520 
rgb
->
b
 = (
∑l
[
x
].b +ÖÆ[
y
].b * 4) / 3;

521 i‡(
rgb
->
r
 > 63)Ñgb->r = 63;

522 i‡(
rgb
->
g
 > 63)Ñgb->g = 63;

523 i‡(
rgb
->
b
 > 63)Ñgb->b = 63;

528 
rgb
->
r
 = (
∑l
[
x
].∏+ÖÆ[
y
].r) >> 1;

529 
rgb
->
g
 = (
∑l
[
x
].g +ÖÆ[
y
].g) >> 1;

530 
rgb
->
b
 = (
∑l
[
x
].b +ÖÆ[
y
].b) >> 1;

532 
	}
}

537 
	$misc_make_cm≠s
()

539 
CMAP_E
 
cm
;

540 
a
, 
cm≠_ok
, 
i
, 
c
, 
°¨t
;

541 
tmp
[100];

542 
FILE
 * 
out
, * 
ö
;

544 
	`¥ötf
("\n");

545 
cm
=0; cm < 
CM_MAX
; cm++)

547 
a
=0;á < 
ACT_MAX
;á++)

549 
	`Ârötf
(
°dîr
, ".");

550 
	`•rötf
(
tmp
, "%scm≠%i_%i.bö", 
glb_ds1edô_d©a_dú
, 
a
, 
cm
);

551 
cm≠_ok
 = 
FALSE
;

552 i‡(
	`fûe_exi°s
(
tmp
, -1, 
NULL
Ë&& (
glb_ds1edô
.
∑l_lﬂded
[
a
] =
TRUE
))

555 
ö
 = 
	`f›í
(
tmp
, "rb");

556 i‡(
ö
 =
NULL
)

557 
	`¥ötf
("ˇn'àªad %s\n", 
tmp
);

560 
	`¥ötf
("lﬂdög %s\n", 
tmp
);

561 
	`‰ód
(& 
glb_ds1edô
.
cm≠
[
cm
][
a
], (
COLOR_MAP
), 1, 
ö
);

562 
	`f˛o£
(
ö
);

563 
cm≠_ok
 = 
TRUE
;

567 i‡(
cm≠_ok
 =
FALSE
)

571 i‡(
cm
 =
CM_SELECT
)

574 
	`¸óã_cﬁ‹_èbÀ
(& 
glb_ds1edô
.
cm≠
[
cm
][
a
],

575 
glb_ds1edô
.
vga_∑l
[
a
],

576 
misc_make_cm≠s_hñ≥r
,

577 
NULL
);

580 i‡(
cm
 =
CM_TRANS
)

582 
	`¸óã_å™s_èbÀ
(& 
glb_ds1edô
.
cm≠
[
cm
][
a
],

583 
glb_ds1edô
.
vga_∑l
[
a
],

585 
NULL
);

587 i‡(
cm
 =
CM_SHADOW
)

589 
c
=0; c < 256; c++)

591 
°¨t
 = 1024 + (256 * (
c
/8));

592 
i
=0; i<256; i++)

594 
glb_ds1edô
.
cm≠
[
cm
][
a
].
d©a
[
c
][
i
] =

595 
glb_ds1edô
.
d2_∑l
[
a
][
°¨t
 + 
i
];

600 
out
 = 
	`f›í
(
tmp
, "wb");

601 i‡(
out
 =
NULL
)

602 
	`¥ötf
("ˇn'àwrôê%s\n", 
tmp
);

605 
	`¥ötf
("ßvög %s\n", 
tmp
);

606 
	`fwrôe
(& 
glb_ds1edô
.
cm≠
[
cm
][
a
], (
COLOR_MAP
), 1, 
out
);

607 
	`f˛o£
(
out
);

612 
	}
}

617 
	$misc_lﬂd_∑l_‰om_disk
(
∑l_idx
)

619 
tmp
[100];

620 
FILE
 * 
ö
;

621 
size
;

623 
	`•rötf
(
tmp
, "%•Æ%i.bö", 
glb_ds1edô_d©a_dú
, 
∑l_idx
);

624 i‡(
	`fûe_exi°s
(
tmp
, -1, 
NULL
))

627 
ö
 = 
	`f›í
(
tmp
, "rb");

628 i‡(
ö
 =
NULL
)

629 
	`¥ötf
("ˇn'àªad %s\n", 
tmp
);

633 
	`f£ek
(
ö
, 0, 
SEEK_END
);

634 
size
 = 
	`·ñl
(
ö
);

635 
	`f£ek
(
ö
, 0, 
SEEK_SET
);

638 
glb_ds1edô
.
d2_∑l
[
∑l_idx
] = (
UBYTE
 *Ë
	`mÆloc
(
size
);

639 i‡(
glb_ds1edô
.
d2_∑l
[
∑l_idx
] =
NULL
)

641 
	`•rötf
(
tmp
, "misc_load_pal_from_disk() : "

642 "nŸÉnough mem (%lòbyãsËf‹ÖÆëã %i", 
size
, 
∑l_idx
);

643 
	`ds1edô_îr‹
(
tmp
);

647 
	`¥ötf
("lﬂdög %s\n", 
tmp
);

648 
	`‰ód
(
glb_ds1edô
.
d2_∑l
[
∑l_idx
], 
size
, 1, 
ö
);

649 
	`f˛o£
(
ö
);

650 
glb_ds1edô
.
∑l_size
[
∑l_idx
] = 
size
;

651  
TRUE
;

654  
FALSE
;

655 
	}
}

660 
	$misc_ßve_∑l_⁄_disk
(
∑l_idx
, 
UBYTE
 * 
d2_∑l_±r
)

662 
tmp
[100];

663 
FILE
 * 
out
;

665 
	`•rötf
(
tmp
, "%•Æ%i.bö", 
glb_ds1edô_d©a_dú
, 
∑l_idx
);

666 
out
 = 
	`f›í
(
tmp
, "wb");

667 i‡(
out
 =
NULL
)

668 
	`¥ötf
("ˇn'àwrôê%s\n", 
tmp
);

671 
	`¥ötf
("ßvög %s\n", 
tmp
);

672 
	`fwrôe
(
d2_∑l_±r
, 
glb_ds1edô
.
∑l_size
[
∑l_idx
], 1, 
out
);

673 
	`f˛o£
(
out
);

675 
	}
}

681 
	$misc_my_fgës
(* 
d°
, 
max
, 
FILE
 * 
ö
)

683 
i
=0, 
c
;

685 i‡(
max
 <= 0)

690 
c
 = 
	`fgëc
(
ö
);

691 i‡(
c
 =
EOF
)

693 
d°
[
i
] = 0;

694 i‡(
i
)

699 i‡((
i
 >(
max
 - 1)Ë|| (
c
 < 32))

701 
d°
[
i
] = 0;

702 (
c
 < 32Ë&& (¯!
EOF
))

703 
c
 = 
	`fgëc
(
ö
);

704 i‡(
c
 !
EOF
)

705 
	`ungëc
(
c
, 
ö
);

708 
d°
[
i
] = 
c
;

709 
i
++;

711 
	}
}

716 * 
	$misc_£¨ch_«me
(* 
tmp
)

718 
max
, 
i
=0;

720 
max
 = 
	`°æí
(
tmp
);

721 i‡(
max
 < 1)

722  
NULL
;

725 (
i
 < 
max
Ë&& (
tmp
[i] <= 32))

726 
i
++;

727 i‡(
i
 >
max
)

728  
NULL
;

731 (
i
 < 
max
Ë&& (
tmp
[i] > 32))

732 
i
++;

733 i‡(
i
 >
max
)

734  
NULL
;

737 (
i
 < 
max
Ë&& (
tmp
[i] <= 32))

738 
i
++;

739 i‡(
i
 >
max
)

740  
NULL
;

743 (
i
 < 
max
Ë&& (
tmp
[i] > 32))

744 
i
++;

745 i‡(
i
 >
max
)

746  
NULL
;

749 (
i
 < 
max
Ë&& (
tmp
[i] <= 32))

750 
i
++;

751 i‡(
i
 >
max
)

752  
NULL
;

755  & 
tmp
[
i
];

756 
	}
}

761 
	$misc_›í_1_ds1
(
ds1_idx
, * 
«me
, 
ty≥
, 
def
,

762 
√w_width
, 
√w_height
)

765 
	`¥ötf
("\ƒódög ds1 : %s\n", 
«me
);

766 
	`fÊush
(
°dout
);

767 
	`Ârötf
(
°dîr
, "ªadög %s...", 
«me
);

768 
	`ds1_ªad
(
«me
, 
ds1_idx
, 
√w_width
, 
√w_height
);

769 
	`Ârötf
(
°dîr
, "done\n");

772 
	`Ârötf
(
°dîr
, "searching Dt1Mask...");

773 
	`ªad_lvÕª°_txt
(
ds1_idx
, 
def
);

774 
	`Ârötf
(
°dîr
, "done\n");

776 
	`¥ötf
("\nloading dt1 from mpq...\n");

777 
glb_ds1
[
ds1_idx
].
txt_a˘
 = 
	`ªad_lv…y≥s_txt
(ds1_idx, 
ty≥
);

778 
	`¥ötf
("\ndone\n");

779 
	`¥ötf
("txt_a˘ = %i\n", 
glb_ds1
[
ds1_idx
].
txt_a˘
);

782 
	`misc_make_block_èbÀ
(
ds1_idx
);

785 
	`ds1_make_¥›_2_block
(
ds1_idx
);

786 
	}
}

791 
	$misc_›í_1_ds1_f‹˚_dt1
(
ds1_idx
)

793 
d
;

794 * 
ds1_«me
 = 
glb_ds1edô
.
cmd_löe
.
ds1_fûíame
;

795 
√w_width
 = 
glb_ds1edô
.
cmd_löe
.
ªsize_width
;

796 
√w_height
 = 
glb_ds1edô
.
cmd_löe
.
ªsize_height
;

797 
ds1edt_fûe
[] = "ds1edit.dt1";

798 
tmp
[150];

802 
	`¥ötf
("\ƒódög ds1 : %s\n", 
ds1_«me
);

803 
	`fÊush
(
°dout
);

804 
	`Ârötf
(
°dîr
, "ªadög %s...", 
ds1_«me
);

805 
	`ds1_ªad
(
ds1_«me
, 
ds1_idx
, 
√w_width
, 
√w_height
);

806 
	`Ârötf
(
°dîr
, "done\n");

809 
	`•rötf
(
tmp
, "%s%s", 
glb_ds1edô_d©a_dú
, 
ds1edt_fûe
);

810 
	`¥ötf
("\nw™àtÿªadá dt1 : %s\n", 
tmp
);

811 
glb_ds1
[
ds1_idx
].
dt1_idx
[0] = 
	`dt1_add_•ecül
(
tmp
);

814 
d
=0; d < 
DT1_IN_DS1_MAX
; d++)

815 
glb_ds1
[
ds1_idx
].
dt1_idx
[
d
 + 1] = -1;

817 
	`¥ötf
("\nloading dt1 from disk...\n");

819 
d
=0; d < 
glb_ds1edô
.
cmd_löe
.
dt1_li°_num
; d++)

821 
	`¥ötf
("\nw™àtÿªadá dt1 : %s\n", 
glb_ds1edô
.
cmd_löe
.
dt1_li°_fûíame
[
d
]);

822 
glb_ds1
[
ds1_idx
].
dt1_idx
[
d
 + 1] = 
	`dt1_add_•ecül
(
glb_ds1edô
.
cmd_löe
.
dt1_li°_fûíame
[d]);

825 
glb_ds1
[
ds1_idx
].
txt_a˘
 = glb_ds1[ds1_idx].
a˘
;

826 
	`¥ötf
("\ndone\n");

829 
	`misc_make_block_èbÀ
(
ds1_idx
);

832 
	`ds1_make_¥›_2_block
(
ds1_idx
);

833 
	}
}

838 
	$misc_›í_£vîÆ_ds1
(* 
fûíame
)

840 
FILE
 * 
ö
;

841 
ty≥
, 
def
, 
ªt
, 
ds1_idx
=0;

842 
tmp
[1000], * 
«me
;

845 
ö
 = 
	`f›í
(
fûíame
, "rt");

846 i‡(
ö
 =
NULL
)

848 
	`•rötf
(
tmp
, "misc_›í_£vîÆ_ds1(), c™'à›í %s", 
fûíame
);

849 
	`ds1edô_îr‹
(
tmp
);

852 
ªt
 = 
	`misc_my_fgës
(
tmp
, —mp), 
ö
);

853 
ªt
 != 0)

855 
	`ssˇnf
(
tmp
, "%ò%i", &
ty≥
, &
def
);

856 
«me
 = 
	`misc_£¨ch_«me
(
tmp
);

859 i‡(
glb_ds1edô
.
cmd_löe
.
dt1_li°_num
 != -1)

862 
	`misc_›í_1_ds1_f‹˚_dt1
(
ds1_idx
);

867 
	`misc_›í_1_ds1
(

868 
ds1_idx
,

869 
«me
,

870 
ty≥
,

871 
def
,

872 
glb_ds1edô
.
cmd_löe
.
ªsize_width
,

873 
glb_ds1edô
.
cmd_löe
.
ªsize_height


877 
ds1_idx
++;

878 
ªt
 = 
	`misc_my_fgës
(
tmp
, —mp), 
ö
);

881 
	`f˛o£
(
ö
);

882 
	}
}

887 
	$misc_wÆkabÀ_tûe_öfo_pcx
()

889 
pcx«me
[11][30] = {

902 
lo›
, 
i
, 
x0
, 
y0
, 
z
, 
w
=0, 
h
=0;

903 
BITMAP
 * 
tmpbmp
, * 
subtûe
, * 
subtûe2
;

904 
tmp
[150];

905 
b
=0;

908 
	`Ârötf
(
°dîr
, "walkableÅile infos");

909 
	`fÊush
(
°dîr
);

910 
glb_ds1edô
.
subtûe_hñp
 = 
	`lﬂd_pcx
("pcx/°_hñp.pcx", glb_ds1edô.
dummy_∑l
);

911 i‡(
glb_ds1edô
.
subtûe_hñp
 =
NULL
)

913 
	`•rötf
(
tmp
, "misc_walkable_tile_info_pcx(), can't openÖcx/st_help.pcx");

914 
	`ds1edô_îr‹
(
tmp
);

917 
lo›
=0;Üoop<11;Üoop++)

919 
	`Ârötf
(
°dîr
, ".");

920 
	`fÊush
(
°dîr
);

921 
tmpbmp
 = 
	`lﬂd_pcx
(
pcx«me
[
lo›
], 
glb_ds1edô
.
dummy_∑l
);

922 i‡(
tmpbmp
 =
NULL
)

924 
	`•rötf
(
tmp
, "misc_walkable_tile_info_pcx(), can't open %s",

925 
pcx«me
[
lo›
]);

926 
	`ds1edô_îr‹
(
tmp
);

928 
i
=0; i<25; i++)

930 
subtûe
 = 
	`¸óã_bôm≠
(160, 80);

931 i‡(
subtûe
 =
NULL
)

933 
	`•rötf
(
tmp
, "misc_walkable_tile_info_pcx(), can't create "

934 "thê(%ò- %iËbôm≠ ", 
lo›
, 
i
);

935 
	`ds1edô_îr‹
(
tmp
);

937 
	`˛ór
(
subtûe
);

938 
x0
 = 64 - ((
i
/5) * 16) + ((i%5) * 16);

939 
y0
 = ((
i
/5) * 8) + ((i%5) * 8);

940 
	`døw_•rôe
(
subtûe
, 
tmpbmp
, 
x0
, 
y0
);

942 i‡(
lo›
 < 9)

943 
glb_ds1edô
.
subtûe_Êag
[
lo›
][
ZM_11
][
i
] = 
	`gë_æe_•rôe
(
subtûe
);

944 i‡(
lo›
 == 9)

945 
glb_ds1edô
.
subtûe_nowÆk
[
ZM_11
][
i
] = 
	`gë_æe_•rôe
(
subtûe
);

947 
glb_ds1edô
.
subtûe_nojump
[
ZM_11
][
i
] = 
	`gë_æe_•rôe
(
subtûe
);

949 
z
=0; z<
ZM_MAX
; z++)

951 i‡(
z
 =
ZM_11
)

953 
z
)

955 
ZM_12
 : 
w
 = 160 / 2; 
h
 = 80 / 2; ;

956 
ZM_14
 : 
w
 = 160 / 4; 
h
 = 80 / 4; ;

957 
ZM_18
 : 
w
 = 160 / 8; 
h
 = 80 / 8; ;

958 
ZM_116
 : 
w
 = 160 / 16; 
h
 = 80 / 16; ;

960 
subtûe2
 = 
	`¸óã_bôm≠
(
w
, 
h
);

961 
	`˛ór
(
subtûe2
);

962 i‡(
subtûe2
 =
NULL
)

964 
	`•rötf
(
tmp
, "misc_walkable_tile_info_pcx(), can't create "

965 "thê(%ò- %iËbôm≠áàzoom %i", 
lo›
, 
i
, 
z
);

966 
	`ds1edô_îr‹
(
tmp
);

968 
	`°ªtch_blô
(
subtûe
, 
subtûe2
, 0, 0, 160, 80, 0, 0, 
w
, 
h
);

970 i‡(
lo›
 < 9)

971 
glb_ds1edô
.
subtûe_Êag
[
lo›
][
z
][
i
] = 
	`gë_æe_•rôe
(
subtûe2
);

972 i‡(
lo›
 == 9)

973 
glb_ds1edô
.
subtûe_nowÆk
[
z
][
i
] = 
	`gë_æe_•rôe
(
subtûe2
);

975 
glb_ds1edô
.
subtûe_nojump
[
z
][
i
] = 
	`gë_æe_•rôe
(
subtûe2
);

977 
	`de°roy_bôm≠
(
subtûe2
);

979 
	`de°roy_bôm≠
(
subtûe
);

981 
	`de°roy_bôm≠
(
tmpbmp
);

985 
	`Ârötf
(
°dîr
, "\nwalkableÅile infos combinations");

986 
	`fÊush
(
°dîr
);

987 
i
=0; i<25; i++)

989 
	`Ârötf
(
°dîr
, ".");

990 
	`fÊush
(
°dîr
);

991 
z
=0; z<
ZM_MAX
; z++)

993 
w
 = 
glb_ds1edô
.
subtûe_Êag
[0][
z
][
i
]->w;

994 
h
 = 
glb_ds1edô
.
subtûe_Êag
[0][
z
][
i
]->h;

996 
lo›
=0;Üoop<256;Üoop++)

998 
subtûe2
 = 
	`¸óã_bôm≠
(
w
, 
h
);

999 
	`˛ór
(
subtûe2
);

1000 i‡(
subtûe2
 =
NULL
)

1002 
	`•rötf
(
tmp
, "misc_walkable_tile_info_pcx(), can't create "

1003 "thê(%ò- %iËbôm≠áàzoom %i", 
lo›
, 
i
, 
z
);

1004 
	`ds1edô_îr‹
(
tmp
);

1007 
	`døw_æe_•rôe
(
subtûe2
, 
glb_ds1edô
.
subtûe_Êag
[0][
z
][
i
], 0, 0);

1008 
b
=0; b < 8; b++)

1010 i‡(
lo›
 & (1 << 
b
))

1012 
	`døw_æe_•rôe
(

1013 
subtûe2
,

1014 
glb_ds1edô
.
subtûe_Êag
[
b
+1][
z
][
i
],

1020 
glb_ds1edô
.
subtûe_Êag_combö©i⁄
[
lo›
][
z
][
i
] =

1021 
	`gë_æe_•rôe
(
subtûe2
);

1023 
	`de°roy_bôm≠
(
subtûe2
);

1029 
b
=0; b<9; b++)

1031 
z
=0; z<
ZM_MAX
; z++)

1033 
i
=0; i<25; i++)

1035 i‡(
glb_ds1edô
.
subtûe_Êag
[
b
][
z
][
i
] !
NULL
)

1037 
	`de°roy_æe_•rôe
(
glb_ds1edô
.
subtûe_Êag
[
b
][
z
][
i
]);

1038 
glb_ds1edô
.
subtûe_Êag
[
b
][
z
][
i
] = 
NULL
;

1044 
	`Ârötf
(
°dîr
, "\n");

1045 
	`fÊush
(
°dîr
);

1046 
	}
}

1052 
	$misc_£ach_block_‹4
(
ds1_idx
, 
BLOCK_TABLE_S
 * 
bt_±r
, 
b
,

1053 
m
, 
s
)

1057 i‡(
b
 >
glb_ds1
[
ds1_idx
].
bt_num
)

1061 i‡–(
bt_±r
[
b
].
‹õ¡©i⁄
 == 4) &&

1062 (
bt_±r
[
b
].
maö_ödex
 =
m
) &&

1063 (
bt_±r
[
b
].
sub_ödex
 =
s
)

1066  
b
;

1069 
b
++;

1071 
	}
}

1076 
	$misc_£¨ch_wÆk_öfos
(
ds1_idx
, 
x
, 
y
, 
UBYTE
 * 
d°èbÀ
)

1078 
BLOCK_TABLE_S
 * 
bt_±r
;

1079 
CELL_F_S
 * 
f_±r
;

1080 
CELL_W_S
 * 
w_±r
;

1081 
tf
, 
tw
, 
b
, 
f
, 
w
, 
di
, 
bi
, 
i
;

1082 
BLOCK_S
 * 
bh_±r
;

1083 
UBYTE
 * 
u_±r
, 
Æl_Êo‹_¥›s
 = 0;

1086 
tf
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

1087 
tw
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

1088 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
tf
;

1089 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
tw
;

1092 
i
=0; i<25; i++)

1093 
d°èbÀ
[
i
] = 0;

1094 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
;

1097 
f
=0; f < 
glb_ds1
[
ds1_idx
].
Êo‹_num
; f++)

1099 
Æl_Êo‹_¥›s
 |
f_±r
[
f
].
¥›1
 | f_±r[f].
¥›2
 |

1100 
f_±r
[
f
].
¥›3
 | f_±r[f].
¥›4
;

1101 i‡(
f_±r
[
f
].
¥›3
 & 0x02)

1104 
i
=0; i<25; i++)

1105 
d°èbÀ
[
i
] |= 1;

1107 
b
 = 
f_±r
[
f
].
bt_idx
;

1108 i‡(
b
 > 0)

1110 
di
 = 
bt_±r
[
b
].
dt1_idx
;

1111 
bi
 = 
bt_±r
[
b
].
block_idx
;

1112 
bh_±r
 = 
glb_dt1
[
di
].
bh_buf„r
;

1113 
u_±r
 = 
bh_±r
[
bi
].
sub_tûes_Êags
;

1116 
i
=0; i<25; i++)

1117 
d°èbÀ
[
i
] |
u_±r
[i];

1122 i‡(
glb_ds1
[
ds1_idx
].
Êo‹_num
 == 1)

1124 i‡(
f_±r
[0].
¥›1
 == 0)

1126 
i
=0; i<25; i++)

1127 
d°èbÀ
[
i
] |= 1;

1130 i‡(
glb_ds1
[
ds1_idx
].
Êo‹_num
 == 2)

1132 i‡((
f_±r
[0].
¥›1
 == 0) && (f_ptr[1].prop1 == 0))

1134 
i
=0; i<25; i++)

1135 
d°èbÀ
[
i
] |= 1;

1140 
w
=0; w < 
glb_ds1
[
ds1_idx
].
wÆl_num
; w++)

1142 i‡(
w_±r
[
w
].
¥›3
 & 0x02)

1145 
i
=0; i<25; i++)

1146 
d°èbÀ
[
i
] |= 1;

1148 
b
 = 
w_±r
[
w
].
bt_idx
;

1149 i‡(
b
 > 0)

1151 
di
 = 
bt_±r
[
b
].
dt1_idx
;

1152 
bi
 = 
bt_±r
[
b
].
block_idx
;

1153 
bh_±r
 = 
glb_dt1
[
di
].
bh_buf„r
;

1154 
u_±r
 = 
bh_±r
[
bi
].
sub_tûes_Êags
;

1157 
i
=0; i<25; i++)

1158 
d°èbÀ
[
i
] |
u_±r
[i];

1161 i‡(
w_±r
[
w
].
‹õ¡©i⁄
 == 3)

1163 
i
 = 
	`misc_£ach_block_‹4
(
ds1_idx
,

1164 
bt_±r
,

1165 
b
,

1166 
bt_±r
[
b
].
maö_ödex
,

1167 
bt_±r
[
b
].
sub_ödex


1169 i‡(
i
 != -1)

1171 
b
 = 
i
;

1172 
di
 = 
bt_±r
[
b
].
dt1_idx
;

1173 
bi
 = 
bt_±r
[
b
].
block_idx
;

1174 
bh_±r
 = 
glb_dt1
[
di
].
bh_buf„r
;

1175 
u_±r
 = 
bh_±r
[
bi
].
sub_tûes_Êags
;

1178 
i
=0; i<25; i++)

1179 
d°èbÀ
[
i
] |
u_±r
[i];

1184 
	}
}

1190 
	$misc_lﬂd_mpq_fûe
(* 
fûíame
, ** 
buf„r
, * 
buf_Àn
, 
ouçut
)

1192 
i
, 
íåy
, 
max
;

1197 
	`°r˝y
(
glb_ds1edô
.
°πmp
, 
fûíame
);

1198 
max
 = 
	`°æí
(
glb_ds1edô
.
°πmp
);

1199 
i
=0; i < 
max
; i++)

1201 i‡(
glb_ds1edô
.
°πmp
[
i
] == '/')

1202 
glb_ds1edô
.
°πmp
[
i
] = '\\';

1206 
i
=0; i<
MAX_MOD_DIR
; i++)

1208 
íåy
 = 
	`mod_lﬂd_ö_mem
(

1209 
glb_c⁄fig
.
mod_dú
[
i
],

1210 
glb_ds1edô
.
°πmp
,

1211 
buf„r
,

1212 
buf_Àn


1214 i‡(
íåy
 != -1)

1216 i‡(
ouçut
)

1217 
	`¥ötf
(", found i¿%s\n", 
glb_c⁄fig
.
mod_dú
[
i
]);

1218  
íåy
;

1223 
i
=0; i<
MAX_MPQ_FILE
; i++)

1225 i‡(
glb_mpq_°ru˘
[
i
].
is_›í
 !
FALSE
)

1227 
glb_mpq
 = & 
glb_mpq_°ru˘
[
i
];

1228 
íåy
 = 
	`mpq_b©ch_lﬂd_ö_mem
(

1229 
glb_ds1edô
.
°πmp
,

1230 
buf„r
,

1231 
buf_Àn
,

1232 
ouçut


1234 i‡(
íåy
 != -1)

1236 i‡(
ouçut
)

1237 
	`¥ötf
(", found i¿%s\n", 
glb_c⁄fig
.
mpq_fûe
[
i
]);

1238  
íåy
;

1245 
	}
}

1250 
	$misc_gë_txt_cﬁumn_num
(
RQ_ENUM
 
txt_idx
, * 
cﬁ_«me
)

1252 
i
 = 0;

1253 * 
desc
, 
tmp_°r
[256],

1254 
txt_li°
[
RQ_MAX
][80] = {

1261 i‡(
txt_idx
 >
RQ_MAX
)

1265 
desc
 = 
glb_txt_ªq_±r
[
txt_idx
][
i
];

1266 i‡(
desc
 =
NULL
)

1268 
	`•rötf
(
tmp_°r
, "misc_get_txt_column_num() :\n"

1270 
cﬁ_«me
, 
txt_idx
, 
txt_li°
[txt_idx]

1272 
	`ds1edô_îr‹
(
tmp_°r
);

1276 i‡(
	`°ricmp
(
cﬁ_«me
, 
desc
) == 0)

1277  
i
;

1279 
i
++;

1282 
	}
}

1286 
	$misc_is_numîiˇl
(* 
°r
)

1288 
i
, 
max
 = 
	`°æí
(
°r
);

1290 
i
=0; i < 
max
; i++)

1292 i‡–(
°r
[
i
] == '-') ||

1293 (
°r
[
i
] == '+') ||

1294 (
°r
[
i
] == '.') ||

1295 ((
°r
[
i
] >= '0') && (str[i] <= '9'))

1301  
FALSE
;

1303  
TRUE
;

1304 
	}
}

1309 
	$misc_∂2_c‹ª˘
(
i
)

1311 
UBYTE
 * 
b±r
;

1312 
c
;

1313 
COLOR_MAP
 * 
cm≠
;

1315 
b±r
 = 
glb_ds1edô
.
d2_∑l
[
i
];

1316 
c
=0; c < 256; c++)

1318 
cm≠
 = (
COLOR_MAP
 *Ë& 
b±r
[
COF_75TRANS
 * 256];

1319 
cm≠
->
d©a
[0][
c
] = c;

1321 
cm≠
 = (
COLOR_MAP
 *Ë& 
b±r
[
COF_50TRANS
 * 256];

1322 
cm≠
->
d©a
[0][
c
] = c;

1324 
cm≠
 = (
COLOR_MAP
 *Ë& 
b±r
[
COF_25TRANS
 * 256];

1325 
cm≠
->
d©a
[0][
c
] = c;

1327 
cm≠
 = (
COLOR_MAP
 *Ë& 
b±r
[
COF_ALPHA
 * 256];

1328 
cm≠
->
d©a
[0][
c
] = c;

1330 
cm≠
 = (
COLOR_MAP
 *Ë& 
b±r
[
COF_LUMINANCE
 * 256];

1331 
cm≠
->
d©a
[0][
c
] = c;

1333 
cm≠
 = (
COLOR_MAP
 *Ë& 
b±r
[
COF_ALPHABRIGHT
 * 256];

1334 
cm≠
->
d©a
[0][
c
] = c;

1336 
	}
}

1342 
	$misc_cmd_löe_∑r£
(
¨gc
, ** 
¨gv
)

1344 
i
 = 0;

1345 
f‹˚_dt1_¥e£¡
 = 
FALSE
;

1346 * 
ext
 = 
NULL
;

1347 
n
 = 0;

1348 
lv…y≥_id_found
 = 0;

1349 
lvÕª°_def_found
 = 0;

1353 
i
=1; i < 
¨gc
; i++)

1355 i‡(
	`°ricmp
(
¨gv
[
i
], "-force_dt1") == 0)

1356 
f‹˚_dt1_¥e£¡
 = 
TRUE
;

1360 
i
=1; i < 
¨gc
; i++)

1362 i‡(
i
 == 1)

1365 
ext
 = 
	`gë_exãnsi⁄
(
¨gv
[
i
]);

1366 i‡(
	`°ricmp
(
ext
, "ini") == 0)

1367 
glb_ds1edô
.
cmd_löe
.
öi_fûíame
 = 
¨gv
[
i
];

1368 i‡(
	`°ricmp
(
ext
, "ds1") == 0)

1369 
glb_ds1edô
.
cmd_löe
.
ds1_fûíame
 = 
¨gv
[
i
];

1372 
	`¥ötf
("misc_cmd_löe_∑r£(),Éº‹ :Åhêfú°árgumíàmu° bê®.INI o∏®.DS1 fûê(cuºíàexãnsi⁄ = \"%s\")\n", 
ext
);

1376 i‡(
	`°ricmp
(
¨gv
[
i
], "-debug") == 0)

1379 
glb_ds1edô
.
cmd_löe
.
debug_mode
 = 
TRUE
;

1381 i‡(
	`°ricmp
(
¨gv
[
i
], "-no_vis_debug") == 0)

1384 
glb_ds1edô
.
cmd_löe
.
no_vis_debug
 = 
TRUE
;

1386 i‡(
	`°ricmp
(
¨gv
[
i
], "-force_dt1") == 0)

1389 
i
++;

1390 
n
=0; ((
i
 +ÇË< 
¨gc
Ë&& (
	`°ricmp
(
	`gë_exãnsi⁄
(
¨gv
[i +Ç]), "dt1") == 0);Ç++)

1392 i‡((
n
 < 1Ë|| (¿> 
DT1_IN_DS1_MAX
))

1394 
	`¥ötf
("misc_cmd_löe_∑r£(),Éº‹ :Åhîêmu° bêbëwì¿1ánd %ò.DT1 fûe†fﬁowögÅhê-f‹˚_dt1Ö¨amëî\n", 
DT1_IN_DS1_MAX
);

1397 
glb_ds1edô
.
cmd_löe
.
dt1_li°_num
 = 
n
;

1398 
n
=0;Ç < 
glb_ds1edô
.
cmd_löe
.
dt1_li°_num
;Ç++)

1399 
glb_ds1edô
.
cmd_löe
.
dt1_li°_fûíame
[
n
] = 
¨gv
[
i
 +Ç];

1400 
i
 +(
n
 - 1);

1402 i‡(
	`°ricmp
(
¨gv
[
i
], "-resize") == 0)

1405 
i
++;

1406 i‡(
i
 >
¨gc
)

1408 
	`¥ötf
("misc_cmd_line_parse(),Érror :Åhe -resizeÖarameter should be folowed by widthánd height values\n");

1411 i‡(
	`misc_is_numîiˇl
(
¨gv
[
i
]))

1412 
glb_ds1edô
.
cmd_löe
.
ªsize_width
 = 
	`©oi
(
¨gv
[
i
]);

1415 
	`¥ötf
("misc_cmd_line_parse(),Érror :Åhe width value folowingÅhe -resizeÖarameter isÇotáÇumerical value\n");

1419 
i
++;

1420 i‡(
i
 >
¨gc
)

1422 
	`¥ötf
("misc_cmd_line_parse(),Érror :Åhe -resizeÖarameter is folowed by justá width value,Åhe height value is missing\n");

1425 i‡(
	`misc_is_numîiˇl
(
¨gv
[
i
]))

1426 
glb_ds1edô
.
cmd_löe
.
ªsize_height
 = 
	`©oi
(
¨gv
[
i
]);

1429 
	`¥ötf
("misc_cmd_line_parse(),Érror :Åhe height value folowingÅhe -resizeÖarameter isÇotáÇumerical value\n");

1433 i‡(
	`°ricmp
(
¨gv
[
i
], "-force_pal") == 0)

1436 
i
++;

1437 i‡(
i
 >
¨gc
)

1439 
	`¥ötf
("misc_cmd_line_parse(),Érror :ÅheÖarameter -force_pal should be folowed byánáct value\n");

1442 i‡(
	`misc_is_numîiˇl
(
¨gv
[
i
]))

1444 
n
 = 
	`©oi
(
¨gv
[
i
]);

1445 i‡((
n
 < 1) || (n > 5))

1447 
	`¥ötf
("misc_cmd_line_parse(),Érror :Åheáct value folowingÅhe -force_palÖarameter must be between 1ánd 5\n");

1450 
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 = 
n
;

1454 
	`¥ötf
("misc_cmd_line_parse(),Érror :Åheáct value folowingÅhe -force_palÖarameter isÇotáÇumerical value\n");

1458 i‡(
	`°ricmp
(
¨gv
[
i
], "-no_check_act") == 0)

1461 
glb_ds1edô
.
cmd_löe
.
no_check_a˘
 = 
TRUE
;

1463 i‡((
f‹˚_dt1_¥e£¡
 =
FALSE
Ë&& (
glb_ds1edô
.
cmd_löe
.
ds1_fûíame
 !
NULL
))

1465 i‡–! 
lv…y≥_id_found
)

1468 
lv…y≥_id_found
 = 1;

1469 i‡(
	`misc_is_numîiˇl
(
¨gv
[
i
]))

1470 
glb_ds1edô
.
cmd_löe
.
lv…y≥_id
 = 
	`©oi
(
¨gv
[
i
]);

1473 
	`¥ötf
("misc_cmd_line_parse(),Érror :Åhe LvlType.txt ID value isÇotáÇumerical value\n");

1477 i‡–! 
lvÕª°_def_found
)

1480 
lvÕª°_def_found
 = 1;

1481 i‡(
	`misc_is_numîiˇl
(
¨gv
[
i
]))

1482 
glb_ds1edô
.
cmd_löe
.
lvÕª°_def
 = 
	`©oi
(
¨gv
[
i
]);

1485 
	`¥ötf
("misc_cmd_line_parse(),Érror :Åhe LvlPrest.txt DEF value isÇotáÇumerical value\n");

1491 
	`¥ötf
("misc_cmd_löe_∑r£(),Éº‹ : u√x≥˘ed \"%s\"Ö¨amëî\n", 
¨gv
[
i
]);

1498 
	}
}

1502 
	$misc_døw_s¸ìn
(
mx
, 
my
)

1504 
BITMAP
 * 
video_bmp
 = 
glb_ds1edô
.
video_∑ge
[glb_ds1edô.
video_∑ge_num
];

1505 
BITMAP
 * 
mou£_•rôe
 = 
glb_ds1edô
.
mou£_curs‹
[glb_ds1edô.
mode
];

1508 
	`blô
(

1509 
glb_ds1edô
.
s¸ìn_buff
,

1510 
video_bmp
,

1513 
glb_c⁄fig
.
s¸ìn
.
width
,

1514 
glb_c⁄fig
.
s¸ìn
.
height


1516 
	`døw_•rôe
(
video_bmp
, 
mou£_•rôe
, 
mx
, 
my
);

1517 
	`show_video_bôm≠
(
video_bmp
);

1518 
glb_ds1edô
.
video_∑ge_num
 = (glb_ds1edit.video_page_num + 1) % 2;

1519 
	}
}

1524 
	$misc_ö¸ó£_ds1_obje˘s_max
(
ds1_idx
, 
nb_obje˘s
)

1526 
ﬁd_max
;

1527 
√w_max
;

1528 * 
√w_buf„r
;

1529 
ﬁd_size
;

1530 
√w_size
;

1531 
nb_gøn
;

1534 i‡(
nb_obje˘s
 < 0)

1537 
nb_gøn
 = 1 + (
nb_obje˘s
 / 
OBJ_MAX_GRANULARITY
);

1538 
ﬁd_max
 = 
glb_ds1
[
ds1_idx
].
cuºít_obj_max
;

1539 
√w_max
 = 
ﬁd_max
 + (
nb_gøn
 * 
OBJ_MAX_GRANULARITY
);

1542 
ﬁd_size
 = 
ﬁd_max
 * ();

1543 
√w_size
 = 
√w_max
 * ();

1544 
√w_buf„r
 = (*Ë
	`mÆloc
(
√w_size
);

1545 i‡(
√w_buf„r
 =
NULL
)

1547 
	`mem£t
(
√w_buf„r
, 0x00, 
√w_size
);

1548 
	`mem˝y
(
√w_buf„r
, 
glb_ds1
[
ds1_idx
].
døwög_‹dî
, 
ﬁd_size
);

1549 
	`‰ì
(
glb_ds1
[
ds1_idx
].
døwög_‹dî
);

1550 
glb_ds1
[
ds1_idx
].
døwög_‹dî
 = (*Ë
√w_buf„r
;

1553 
ﬁd_size
 = 
ﬁd_max
 * (
OBJ_S
);

1554 
√w_size
 = 
√w_max
 * (
OBJ_S
);

1555 
√w_buf„r
 = (
OBJ_S
 *Ë
	`mÆloc
(
√w_size
);

1556 i‡(
√w_buf„r
 =
NULL
)

1559 
	`mem£t
(
√w_buf„r
, 0x00, 
√w_size
);

1560 
	`mem˝y
(
√w_buf„r
, 
glb_ds1
[
ds1_idx
].
obj
, 
ﬁd_size
);

1561 
	`‰ì
(
glb_ds1
[
ds1_idx
].
obj
);

1562 
glb_ds1
[
ds1_idx
].
obj
 = (
OBJ_S
 *Ë
√w_buf„r
;

1565 
ﬁd_size
 = 
ﬁd_max
 * (
OBJ_S
);

1566 
√w_size
 = 
√w_max
 * (
OBJ_S
);

1567 
√w_buf„r
 = (
OBJ_S
 *Ë
	`mÆloc
(
√w_size
);

1568 i‡(
√w_buf„r
 =
NULL
)

1570 
	`mem£t
(
√w_buf„r
, 0x00, 
√w_size
);

1571 
	`mem˝y
(
√w_buf„r
, 
glb_ds1
[
ds1_idx
].
obj_undo
, 
ﬁd_size
);

1572 
	`‰ì
(
glb_ds1
[
ds1_idx
].
obj_undo
);

1573 
glb_ds1
[
ds1_idx
].
obj_undo
 = (
OBJ_S
 *Ë
√w_buf„r
;

1575 
glb_ds1
[
ds1_idx
].
cuºít_obj_max
 = 
√w_max
;

1577 
	}
}

	@misc.h

1 #i‚de‡
_MISC_H_


3 
	#_MISC_H_


	)

5 
misc_∑l_d2_2_vga
 (
∑l_idx
);

6 
misc_qs‹t_hñ≥r_block_èbÀ_1
 (c⁄° * 
e1
, c⁄° * 
e2
);

7 
misc_qs‹t_hñ≥r_block_èbÀ_2
 (c⁄° * 
e1
, c⁄° * 
e2
);

8 
misc_check_tûes_c⁄Êi˘s
 (
ds1_idx
);

9 
misc_make_block_èbÀ
 (
ds1_idx
);

10 
misc_ªad_gamma
 ();

11 
misc_upd©e_∑l_wôh_gamma
 ();

12 
misc_pcx_put_d2_∑Àâe
 (* 
«me
, 
∑l_idx
);

13 
misc_make_cm≠s_hñ≥r
 (c⁄° 
PALETTE
 
∑l
, 
x
, 
y
, 
RGB
 * 
rgb
);

14 
misc_make_cm≠s
 ();

15 
misc_lﬂd_∑l_‰om_disk
 (
∑l_idx
);

16 
misc_ßve_∑l_⁄_disk
 (
∑l_idx
, 
UBYTE
 * 
d2_∑l_±r
);

17 
misc_my_fgës
 (* 
d°
, 
max
, 
FILE
 * 
ö
);

18 * 
misc_£¨ch_«me
 (* 
tmp
);

19 
misc_›í_1_ds1
 (
ds1_idx
, * 
«me
, 
ty≥
, 
def
, 
√w_width
, 
√w_height
);

20 
misc_›í_£vîÆ_ds1
 (* 
fûíame
);

21 
misc_wÆkabÀ_tûe_öfo_pcx
 ();

22 
misc_£ach_block_‹4
 (
ds1_idx
, 
BLOCK_TABLE_S
 * 
bt_±r
, 
b
, 
m
, 
s
);

23 
misc_£¨ch_wÆk_öfos
 (
ds1_idx
, 
x
, 
y
, 
UBYTE
 * 
d°èbÀ
);

24 
misc_lﬂd_mpq_fûe
 (* 
fûíame
, ** 
buf„r
, * 
buf_Àn
, 
ouçut
);

25 
misc_gë_txt_cﬁumn_num
 (
RQ_ENUM
 
txt_idx
, * 
cﬁ_«me
);

26 
misc_›í_1_ds1_f‹˚_dt1
 (
ds1_idx
);

27 
misc_∂2_c‹ª˘
 (
i
);

28 
misc_cmd_löe_∑r£
 (
¨gc
, ** 
¨gv
);

35 
misc_døw_s¸ìn
 (
mx
, 
my
);

36 
misc_ö¸ó£_ds1_obje˘s_max
 (
ds1_idx
, 
nb_obje˘s
);

	@mpq/Dcl_tbl.c

3 
	~"DCLib.h
"

5 c⁄° 
UI¡8
 
	gd˛_èbÀ
[] =

	@mpq/Dclib.h

3 
	~"mpqTy≥s.h
"

5 
	#CMP_BUFFER_SIZE
 36312L

	)

6 
	#EXP_BUFFER_SIZE
 12596L

	)

7 
	#CMP_BINARY
 0

	)

8 
	#CMP_ASCII
 1

	)

9 
	#DICT_SIZE_1
 1024

	)

10 
	#DICT_SIZE_2
 2048

	)

11 
	#DICT_SIZE_4
 4096

	)

13 
	#DCL_NO_ERROR
 0L

	)

14 
	#DCL_ERROR_1
 1L

	)

15 
	#DCL_ERROR_2
 2L

	)

16 
	#DCL_ERROR_3
 3L

	)

17 
	#DCL_ERROR_4
 4L

	)

19 
UI¡16
 
	tªad_d©a_¥oc
 (
	tUI¡8
 * 
	tbuf„r
, 
	tUI¡16
 
	tsize
, * 
	t∑øm
);

20 
	twrôe_d©a_¥oc
 (
	tUI¡8
 * 
	tbuf„r
, 
	tUI¡16
 
	tsize
, * 
	t∑øm
);

22 c⁄° 
UI¡8
 
d˛_èbÀ
[];

24 
UI¡32
 
im∂ode
 (
ªad_d©a_¥oc
 
ªad_d©a
,

25 
wrôe_d©a_¥oc
 
wrôe_d©a
,

26 
UI¡8
 * 
w‹k_buff
,

27 * 
∑øm
,

28 
UI¡16
 
ty≥
,

29 
UI¡16
 
size
);

31 
UI¡32
 
ex∂ode
 (
ªad_d©a_¥oc
 
ªad_d©a
,

32 
wrôe_d©a_¥oc
 
wrôe_d©a
,

33 * 
∑øm
);

35 
UI¡32
 
¸c32
 (
UI¡8
 * 
buf„r
,

36 
UI¡32
 
size
,

37 
UI¡32
 
ﬁd_¸c
);

	@mpq/Explode.c

1 #ifde‡
WIN32


2 #¥agm®
w¨nög
 (
push
)

3 #¥agm®
w¨nög
 (
dißbÀ
 : 4244 4306 4311 4312 )

8 
	~<°dio.h
>

9 
	~"DCLib.h
"

11 
UI¡16
 
__ex∂ode_1
 (
UI¡8
 *
buf
);

12 
UI¡16
 
__ex∂ode_2
 (
UI¡8
 *
buf
);

13 
UI¡16
 
__ex∂ode_3
 (
UI¡8
 *
buf
, UI¡16 
ªsu…
);

14 
UI¡16
 
__ex∂ode_4
 (
UI¡8
 *
buf
, 
UI¡32
 
Êag
);

15 
__ex∂ode_5
 (
UI¡16
 
cou¡
, 
UI¡8
 *
buf_1
, c⁄° UI¡8 *
èbÀ
, UI¡8 *
buf_2
);

16 
__ex∂ode_6
 (
UI¡8
 *
buf
, c⁄° UI¡8 *
èbÀ
);

17 
__ex∂ode_7
 (
UI¡8
 *
buf
, c⁄° UI¡8 *
èbÀ
, 
UI¡32
 
cou¡
);

23 
UI¡32
 
	$ex∂ode
(
ªad_d©a_¥oc
 
ªad_d©a
, 
wrôe_d©a_¥oc
 
wrôe_d©a
, * 
∑øm
)

25 
UI¡32
 
ªsu…
;

26 
UI¡16
 
ªad_ªsu…
;

27 c⁄° 
UI¡8
 * 
èbÀ
 = 
d˛_èbÀ
;

28 
UI¡8
 * 
w‹k_buff
;

32 
w‹k_buff
 = (
UI¡8
 *Ë
glb_mpq
->
ex∂ode_buf„r
;

34 *((
UI¡32
 *Ë(
w‹k_buff
 + 0x16)Ë(UI¡32Ë
ªad_d©a
;

35 *((
UI¡32
 *Ë(
w‹k_buff
 + 0x1A)Ë(UI¡32Ë
wrôe_d©a
;

36 *((**Ë(
w‹k_buff
 + 0x12)Ë
∑øm
;

37 *((
UI¡16
 *Ë(
w‹k_buff
 + 0x0E)) = 0x0800;

38 
ªad_ªsu…
 = 
	`ªad_d©a
(
w‹k_buff
 + 0x2222, 0x0800, 
∑øm
);

39 i‡(
ªad_ªsu…
 =
DCL_ERROR_4
)

41 
ªsu…
 = 
DCL_ERROR_3
;

45 
UI¡16
 
Êag_0
 = *(
w‹k_buff
 + 0x2222),

46 
Êag_1
 = *(
w‹k_buff
 + 0x2223),

47 
Êag_2
 = *(
w‹k_buff
 + 0x2224);

49 *((
UI¡16
 *Ë(
w‹k_buff
 + 0x02)Ë
Êag_0
;

50 *((
UI¡16
 *Ë(
w‹k_buff
 + 0x06)Ë
Êag_1
;

51 *((
UI¡16
 *Ë(
w‹k_buff
 + 0x0A)Ë
Êag_2
;

52 *((
UI¡16
 *Ë(
w‹k_buff
 + 0x0C)) = 0x00;

53 *((
UI¡16
 *Ë(
w‹k_buff
 + 0x0E)) = 0x03;

54 *((
UI¡16
 *Ë(
w‹k_buff
 + 0x10)Ë
ªad_ªsu…
;

55 i‡((
Êag_1
 < 0x04) || (flag_1 > 0x06))

57 
ªsu…
 = 
DCL_ERROR_1
;

61 *((
UI¡16
 *Ë(
w‹k_buff
 + 0x08)Ë(UI¡16Ë(0x0000FFFFL >> (0x0010 - 
Êag_1
));

62 i‡(
Êag_0
 > 0x01)

64 
ªsu…
 = 
DCL_ERROR_2
;

68 i‡(
Êag_0
)

70 
	`__ex∂ode_7
(
w‹k_buff
 + 0x2FA2, 
èbÀ
 + 0x00D0, 0x0100);

71 
	`__ex∂ode_6
(
w‹k_buff
, 
èbÀ
 + 0x01D0);

73 
	`__ex∂ode_7
(
w‹k_buff
 + 0x30E2, 
èbÀ
 + 0x00B0, 0x0010);

74 
	`__ex∂ode_5
(0x0010, 
w‹k_buff
 + 0x30E2, 
èbÀ
 + 0x00C0, work_buff + 0x2B22);

75 
	`__ex∂ode_7
(
w‹k_buff
 + 0x30F2, 
èbÀ
 + 0x0080, 0x0010);

76 
	`__ex∂ode_7
(
w‹k_buff
 + 0x3102, 
èbÀ
 + 0x0090, 0x0020);

77 
	`__ex∂ode_7
(
w‹k_buff
 + 0x30A2, 
èbÀ
, 0x0040);

78 
	`__ex∂ode_5
(0x0040, 
w‹k_buff
 + 0x30A2, 
èbÀ
 + 0x0040, work_buff + 0x2A22);

79 i‡(
	`__ex∂ode_1
(
w‹k_buff
) != 0x0306)

81 
ªsu…
 = 
DCL_NO_ERROR
;

85 
ªsu…
 = 
DCL_ERROR_4
;

91  
ªsu…
;

92 
	}
}

96 
UI¡16
 
	$__ex∂ode_1
(
UI¡8
 *
buf
)

98 
UI¡32
 
ªsu…
, 
ãmp
;

99 
UI¡8
 *
s
, *
d
;

100 
wrôe_d©a_¥oc
 *
wrôe_d©a
;

101 *
∑øm
;

103 *((
UI¡16
 *Ë(
buf
 + 0x04)) = 0x1000;

104 
ªsu…
 = 
	`__ex∂ode_2
(
buf
), (
UI¡16
)Ñesult < 0x0305)

106 i‡((
UI¡16
Ë
ªsu…
 < 0x0100)

108 
ãmp
 = *((
UI¡16
 *Ë(
buf
 + 0x04));

109 *((
UI¡16
 *Ë(
buf
 + 0x04)Ë(UI¡16Ë(
ãmp
 + 0x01);

110 *(
buf
 + 
ãmp
 + 0x1EË=(
UI¡8
Ë
ªsu…
;

114 
ªsu…
 -= 0x00FE;

115 
s
 = (
UI¡8
 *Ë
	`__ex∂ode_3
(
buf
, (
UI¡16
)
ªsu…
);

116 i‡(!
s
)

118 
ªsu…
 = 0x0306;

123 
ãmp
 = *((
UI¡16
 *Ë(
buf
 + 0x04));

124 
d
 = 
ãmp
 + 0x1E + 
buf
;

125 *((
UI¡16
 *Ë(
buf
 + 0x04)Ë=(UI¡16Ë(
ãmp
 + 
ªsu…
);

126 
s
 = (
UI¡8
 *)((
UI¡32
)
d
 - (UInt32)s);

129 
ªsu…
--;

130 *(
d
++Ë*(
s
++);

131 } 
ªsu…
);

134 i‡(*((
UI¡16
 *Ë(
buf
 + 4)) >= 0x2000)

136 
ªsu…
 = 0x1000;

137 
wrôe_d©a
 = (
wrôe_d©a_¥oc
 *Ë*((
UI¡32
 *Ë(
buf
 + 0x1A));

138 
∑øm
 = (*Ë*((
UI¡32
 *Ë(
buf
 + 0x12));

139 
	`wrôe_d©a
(
buf
 + 0x101E, 0x1000, 
∑øm
);

140 
	`__ex∂ode_7
(
buf
 + 0x001E, bu‡+ 0x101E, *((
UI¡16
 *) (buf + 0x04)) - 0x1000);

141 *((
UI¡16
 *Ë(
buf
 + 0x04)) -= 0x1000;

144 
wrôe_d©a
 = (
wrôe_d©a_¥oc
 *Ë*((
UI¡32
 *Ë(
buf
 + 0x1A));

145 
∑øm
 = (*Ë*((
UI¡32
 *Ë(
buf
 + 0x12));

146 
	`wrôe_d©a
(
buf
 + 0x101E, (
UI¡16
)(*((UI¡16 *Ë(bu‡+ 0x04)Ë- 0x1000), 
∑øm
);

147  (
UI¡16
Ë
ªsu…
;

148 
	}
}

152 
UI¡16
 
	$__ex∂ode_2
(
UI¡8
 *
buf
)

154 
UI¡32
 
ªsu…
, 
Êag
, 
Êag_1
;

156 i‡(*((
UI¡16
 *Ë(
buf
 + 0x0A)) & 0x01)

158 i‡(
	`__ex∂ode_4
(
buf
, 0x01))  0x0306;

159 
ªsu…
 = *(
buf
 + ((
UI¡8
Ë*((
UI¡16
 *) (buf + 0x0A))) + 0x2B22);

160 i‡(
	`__ex∂ode_4
(
buf
, *(bu‡+ ((
UI¡16
Ë
ªsu…
) + 0x30E2)))  0x0306;

161 
Êag
 = *(
buf
 + ((
UI¡16
Ë
ªsu…
) + 0x30F2);

162 i‡(
Êag
)

164 
Êag_1
 = (*((
UI¡16
 *Ë(
buf
 + 0x0A))Ë& ((0x01 << 
Êag
) - 0x01);

165 i‡(
	`__ex∂ode_4
(
buf
, 
Êag
))

167 i‡((((
UI¡16
Ë
ªsu…
Ë+ ((UI¡16Ë
Êag_1
)) != 0x010E)  0x0306;

169 
ªsu…
 = *((
UI¡16
 *Ë(
buf
 + (((UI¡16Ëªsu…Ë<< 0x01Ë+ 0x3102)Ë+ 
Êag_1
;

171 
ªsu…
 += 0x0100;

175 i‡(
	`__ex∂ode_4
(
buf
, 0x01))  0x0306;

176 i‡(!*((
UI¡16
 *Ë(
buf
 + 0x02)))

178 
ªsu…
 = (
UI¡8
Ë*((
UI¡16
 *Ë(
buf
 + 0x0A));

179 i‡(
	`__ex∂ode_4
(
buf
, 0x08))  0x0306;

183 
Êag
 = *((
UI¡16
 *Ë(
buf
 + 0x0A));

184 i‡((
UI¡8
Ë
Êag
)

186 
ªsu…
 = *(
buf
 + ((
UI¡8
Ë
Êag
) + 0x2C22);

187 i‡(((
UI¡16
Ë
ªsu…
) == 0x00FF)

189 i‡(
Êag
 & 0x003F)

191 i‡(
	`__ex∂ode_4
(
buf
, 0x04))  0x0306;

192 
ªsu…
 = *(
buf
 + ((
UI¡8
Ë*((
UI¡16
 *) (buf + 0x0A))) + 0x2D22);

196 i‡(
	`__ex∂ode_4
(
buf
, 0x06))  0x0306;

197 
ªsu…
 = *(
buf
 + ((*((
UI¡16
 *) (buf + 0x0A))) & 0x007F) + 0x2E22);

203 i‡(
	`__ex∂ode_4
(
buf
, 0x08))  0x0306;

204 
ªsu…
 = *(
buf
 + ((
UI¡8
Ë*((
UI¡16
 *) (buf + 0x0A))) + 0x2EA2);

206 
Êag
 = *(
buf
 + ((
UI¡16
Ë
ªsu…
) + 0x2FA2);

207 i‡(
	`__ex∂ode_4
(
buf
, 
Êag
))  0x0306;

210  (
UI¡16
)
ªsu…
;

211 
	}
}

215 
UI¡16
 
	$__ex∂ode_3
(
UI¡8
 *
buf
, 
UI¡16
 
Êag
)

217 
UI¡32
 
ªsu…
, 
Êag_1
;

219 
ªsu…
 = *(
buf
 + ((
UI¡8
Ë*((
UI¡16
 *) (buf + 0x0A))) + 0x2A22);

220 i‡(
	`__ex∂ode_4
(
buf
, *(bu‡+ ((
UI¡16
Ë
ªsu…
) + 0x30A2)))  0x00;

221 i‡(((
UI¡16
Ë
Êag
) == 0x02)

223 
ªsu…
 <<= 0x02;

224 
ªsu…
 |*((
UI¡16
 *Ë(
buf
 + 0x0A)) & 0x03;

225 i‡(
	`__ex∂ode_4
(
buf
, 0x02))  0x00;

229 
Êag_1
 = *((
UI¡16
 *Ë(
buf
 + 0x06));

230 
ªsu…
 <<
Êag_1
;

231 
ªsu…
 |*((
UI¡16
 *Ë(
buf
 + 0x08)) & *((UInt16 *) (buf + 0x0A));

232 i‡(
	`__ex∂ode_4
(
buf
, 
Êag_1
))  0x00;

234  (
UI¡16
Ë(
ªsu…
 + 0x01);

235 
	}
}

239 
UI¡16
 
	$__ex∂ode_4
(
UI¡8
 *
buf
, 
UI¡32
 
Êag
)

241 
UI¡32
 
ªsu…
;

242 
UI¡16
 
ªad_ªsu…
;

243 
ªad_d©a_¥oc
 *
ªad_d©a
 = (ªad_d©a_¥o¯*Ë*((
UI¡32
 *Ë(
buf
 + 0x16));

244 *
∑øm
 = (*Ë*((
UI¡32
 *Ë(
buf
 + 0x12));

246 
ªsu…
 = *((
UI¡16
 *Ë(
buf
 + 0x0C));

247 i‡((
UI¡16
Ë
Êag
 <
ªsu…
)

249 *((
UI¡16
 *Ë(
buf
 + 0x0A)Ë>>
Êag
;

250 *((
UI¡16
 *Ë(
buf
 + 0x0C)Ë-(UI¡16)
Êag
;

251 
ªsu…
 = 0x00;

255 *((
UI¡16
 *Ë(
buf
 + 0x0A)Ë>>
ªsu…
;

256 
ªsu…
 = *((
UI¡16
 *Ë(
buf
 + 0x0E));

257 i‡(
ªsu…
 =*((
UI¡16
 *Ë(
buf
 + 0x10)))

259 *((
UI¡16
 *Ë(
buf
 + 0x0E)) = 0x0800;

260 
ªad_ªsu…
 = 
	`ªad_d©a
(
buf
 + 0x2222, 0x0800, 
∑øm
);

261 *((
UI¡16
 *Ë(
buf
 + 0x10)Ë
ªad_ªsu…
;

262 i‡(!
ªad_ªsu…
)  0x01;

263 *((
UI¡16
 *Ë(
buf
 + 0x0E)) = 0x00;

265 
ªsu…
 = *((
UI¡16
 *Ë(
buf
 + 0x0E)) + 0x2222;

266 *((
UI¡16
 *Ë(
buf
 + 0x0A)Ë|*(bu‡+ 
ªsu…
) << 0x08;

267 *((
UI¡16
 *Ë(
buf
 + 0x0E)) += 0x01;

268 *((
UI¡16
 *Ë(
buf
 + 0x0A)Ë>>
Êag
 - *((UInt16 *) (buf + 0x0C));

269 *((
UI¡16
 *Ë(
buf
 + 0x0C)Ë(UI¡16)(0x08 - (
Êag
 - *((UInt16 *) (buf + 0x0C))));

270 
ªsu…
 = 0x00;

272  (
UI¡16
Ë
ªsu…
;

273 
	}
}

277 
	$__ex∂ode_5
(
UI¡16
 
cou¡
, 
UI¡8
 *
buf_1
, c⁄° UI¡8 *
èbÀ
, UI¡8 *
buf_2
)

279 
SI¡16
 
i
 = (SI¡16)(
cou¡
 - 1);

280 
UI¡32
 
idx_1
, 
idx_2
;

282 ; 
i
 >= 0; i--)

284 
idx_1
 = *(
èbÀ
 + 
i
);

285 
idx_2
 = 0x01 << *(
buf_1
 + 
i
);

288 *(
buf_2
 + (
UI¡16
Ë
idx_1
Ë(
UI¡8
Ë
i
;

289 
idx_1
 +
idx_2
;

290 i‡((
UI¡16
Ë
idx_1
 >= 0x0100) ;

293 
	}
}

297 
	$__ex∂ode_6
(
UI¡8
 *
buf
, c⁄° UI¡8 *
èbÀ
)

299 
SI¡16
 
i
;

300 
UI¡32
 
idx_1
, 
idx_2
;

302 
i
 = 0x00FF; i >= 0; i--)

304 
idx_1
 = *(
buf
 + 
i
 + 0x2FA2);

305 i‡(
idx_1
 <= 0x08 )

307 
idx_2
 = *((
UI¡16
 *Ë(
èbÀ
 + (
i
 << 0x01)));

308 
idx_1
 = 0x01 << idx_1;

311 *(
buf
 + 
idx_2
 + 0x2C22Ë=(
UI¡8
Ë
i
;

312 
idx_2
 +
idx_1
;

313 } (
UI¡16
Ë
idx_2
 < 0x0100);

317 
idx_2
 = *((
UI¡16
 *Ë(
èbÀ
 + (
i
 << 0x01)));

318 i‡((
UI¡8
Ë
idx_2
)

321 *(
buf
 + (
UI¡8
Ë
idx_2
 + 0x2C22) = 0xFF;

322 i‡(*((
UI¡16
 *Ë(
èbÀ
 + (
i
 << 0x01))) & 0x003F)

324 *(
buf
 + 
i
 + 0x2FA2) -= 0x04;

325 
idx_1
 = 0x01 << *(
buf
 + 
i
 + 0x2FA2);

326 
idx_2
 = *((
UI¡16
 *Ë(
èbÀ
 + (
i
 << 0x01))) >> 0x04;

329 *(
buf
 + 
idx_2
 + 0x2D22Ë=(
UI¡8
Ë
i
;

330 
idx_2
 +
idx_1
;

331 } (
UI¡16
Ë
idx_2
 < 0x0100);

335 *(
buf
 + 
i
 + 0x2FA2) -= 0x06;

336 
idx_1
 = 0x01 << *(
buf
 + 
i
 + 0x2FA2);

337 
idx_2
 = *((
UI¡16
 *Ë(
èbÀ
 + (
i
 << 0x01))) >> 0x06;

340 *(
buf
 + 
idx_2
 + 0x2E22Ë(
UI¡8
)
i
;

341 
idx_2
 +
idx_1
;

342 } (
UI¡16
Ë
idx_2
 < 0x0080);

347 *(
buf
 + 
i
 + 0x2FA2) -= 0x08;

348 
idx_1
 = 0x01 << *(
buf
 + 
i
 + 0x2FA2);

349 
idx_2
 = *((
UI¡16
 *Ë(
èbÀ
 + (
i
 << 0x01))) >> 0x08;

352 *(
buf
 + 
idx_2
 + 0x2EA2Ë(
UI¡8
)
i
;

353 
idx_2
 +
idx_1
;

354 } (
UI¡16
Ë
idx_2
 < 0x0100);

358 
	}
}

362 
	$__ex∂ode_7
(
UI¡8
 *
buf
, c⁄° UI¡8 *
èbÀ
, 
UI¡32
 
cou¡
)

364 
UI¡32
 
hÆf_cou¡
 = 
cou¡
 >> 0x02;

365 
UI¡8
 *
buf_íd
;

367 i‡(
hÆf_cou¡
)

369 
buf_íd
 = 
buf
 + (
hÆf_cou¡
 << 0x02);

372 *((
UI¡32
 *Ë
buf
Ë*((UI¡32 *Ë
èbÀ
);

373 
buf
 += 4;

374 
èbÀ
 += 4;

375 } 
buf
 < 
buf_íd
);

377 
cou¡
 - (
hÆf_cou¡
 << 0x02))

380 *(
buf
++Ë*(
èbÀ
++);

383 *(
buf
++Ë*(
èbÀ
++);

386 *
buf
 = *
èbÀ
;

391 
	}
}

393 #ifde‡
WIN32


394 #¥agm®
w¨nög
 (
p›
)

	@mpq/MpqView.c

1 #ifde‡
WIN32


2 #¥agm®
w¨nög
 (
push
)

3 #¥agm®
w¨nög
 (
dißbÀ
 : 4057 )

6 
	~<°dio.h
>

7 
	~<°dlib.h
>

8 
	~<°rög.h
>

9 
	~"mpqTy≥s.h
"

10 
	~"D˛ib.h
"

12 
	~"../°ru˘s.h
"

13 
	~"../îr‹.h
"

16 
UI¡32
 
ExtWavU≈1
 (UInt32,UInt32,UInt32,UInt32);

17 
UI¡32
 
ExtWavU≈2
 (UInt32,UInt32,UInt32,UInt32);

18 
UI¡32
 
ExtWavU≈3
 (UInt32,UInt32,UInt32,UInt32);

21 
ã°_¥ï¨e_¨chive
 ();

22 
DWORD
 
ã°_ãŒ_íåy
 (* 
fûíame
);

24 
BuûdBa£Massive
 ();

25 
InôülizeLoˇls
 ();

26 
FªeLoˇls
 ();

27 
DWORD
 
Crc
 (* 
°rög
, DWORD * 
massive_ba£
, DWORD 
massive_ba£_off£t
);

28 
Decode
 (
DWORD
 * 
d©a_ö
, DWORD * 
massive_ba£
, DWORD 
¸c
, DWORD 
Ànght
);

29 
UI¡16
 
ªad_d©a
 (
UI¡8
 * 
buf„r
, UI¡16 
size
, * 
¸≠
);

30 
wrôe_d©a
 (
UI¡8
 * 
buf„r
, 
UI¡16
 
size
, * 
¸≠
);

31 
Exåa˘To
 (
FILE
 * 
Â_√w
, 
DWORD
 
íåy
);

32 
Exåa˘ToMem
 (* 
mp_√w
, 
DWORD
 
íåy
);

35 
	s∑øms


37 * 
	mbuf_ö
;

38 * 
	mbuf_out
;

39 } 
	t∑øms
;

41 
GLB_MPQ_S
 * 
	gglb_mpq
 = 
NULL
;

46 
	$mod_lﬂd_ö_mem
(

47 * 
moddú
,

48 * 
fûíame
,

49 ** 
buf„r
,

50 * 
buf_Àn
,

51 
ouçut


54 
FILE
 * 
ö
 = 
NULL
;

55 
size
 = 0;

56 
°πmp
[256] = "";

60 * 
buf„r
 = (*Ë
NULL
;

61 * 
buf_Àn
 = 0;

64 
	`•rötf
(
°πmp
, "%s\\%s", 
moddú
, 
fûíame
);

65 
ö
 = 
	`f›í
(
°πmp
, "rb");

66 i‡(
ö
 =
NULL
)

70 
	`f£ek
(
ö
, 0, 
SEEK_END
);

71 
size
 = 
	`·ñl
(
ö
) + 1;

72 
	`f£ek
(
ö
, 0, 
SEEK_SET
);

73 * 
buf„r
 = (*Ë
	`mÆloc
(
size
);

74 i‡(* 
buf„r
 =
NULL
)

76 
	`f˛o£
(
ö
);

77 
	`•rötf
(
°πmp
, "notÉnough mem (%li bytes) for %s (from Mod Directory)",

78 
size
, 
fûíame
);

79 
	`ds1edô_îr‹
(
°πmp
);

81 
size
--;

82 * 
buf_Àn
 = 
size
;

85 
	`‰ód
(* 
buf„r
, 
size
, 1, 
ö
);

86 * ( ((*Ë(* 
buf„r
)Ë+ 
size
) = 0;

89 i‡(
ouçut
)

90 
	`¥ötf
("ok (%lòbyãs)", 
size
);

91 
	`f˛o£
(
ö
);

93 
	}
}

97 
	$mpq_b©ch_›í
(* 
mpq«me
)

99 
°πmp
[256];

102 i‡(
glb_mpq
 =
NULL
)

104 
	`•rötf
(
°πmp
, "mpq_batch_open_mpq() :Öointer glb_mpq == NULL");

105 
	`ds1edô_îr‹
(
°πmp
);

107 i‡(
glb_mpq
->
is_›í
 !
FALSE
)

109 
	`•rötf
(
°πmp
, "mpq_batch_open_mpq() : glb_mpq->is_open != FALSE");

110 
	`ds1edô_îr‹
(
°πmp
);

112 i‡(
mpq«me
 =
NULL
)

114 
	`•rötf
(
°πmp
, "mpq_batch_open_mpq() : mpqname == NULL");

115 
	`ds1edô_îr‹
(
°πmp
);

119 
glb_mpq
->
avaû_mëods
[0] = 0x08;

120 
glb_mpq
->
avaû_mëods
[1] = 0x01;

121 
glb_mpq
->
avaû_mëods
[2] = 0x40;

122 
glb_mpq
->
avaû_mëods
[3] = 0x80;

125 
	`°r˝y
(
glb_mpq
->
fûe_«me
, 
mpq«me
);

126 
glb_mpq
->
ÂMpq
 = 
	`f›í
(glb_mpq->
fûe_«me
, "rb");

127 if–! 
glb_mpq
->
ÂMpq
)

129 
	`•rötf
(
°πmp
, "\nmpq_b©ch_›í_mpq(Ë: c™'à›í %s", 
glb_mpq
->
fûe_«me
);

130 
	`ds1edô_îr‹
(
°πmp
);

134 i‡(
	`ã°_¥ï¨e_¨chive
())

135 
	`exô
(
DS1ERR_INITMPQ
);

138 
glb_mpq
->
is_›í
 = 
TRUE
;

139 
	}
}

143 
	$mpq_b©ch_lﬂd_ö_mem
(* 
fûíame
, ** 
buf„r
, * 
buf_Àn
,

144 
ouçut
)

146 
num_íåy
, 
size_u≈ack
;

147 * 
mp_√w
;

148 
°πmp
[256];

151 i‡(
glb_mpq
 =
NULL
)

153 
	`•rötf
(
°πmp
, "mpq_batch_load_in_mem_mpq() :Öointer glb_mpq == NULL");

154 
	`ds1edô_îr‹
(
°πmp
);

156 i‡(
glb_mpq
->
is_›í
 =
FALSE
)

158 
	`•rötf
(
°πmp
, "mpq_batch_load_in_mem_mpq() : glb_mpq->is_open == FALSE");

159 
	`ds1edô_îr‹
(
°πmp
);

161 i‡(
fûíame
 =
NULL
)

163 
	`•rötf
(
°πmp
, "mpq_batch_load_in_mem_mpq() : filename == NULL");

164 
	`ds1edô_îr‹
(
°πmp
);

166 i‡(
	`°æí
(
fûíame
) == 0)

168 
	`•rötf
(
°πmp
, "mpq_batch_load_in_mem_mpq() : strlen(filename) == 0");

169 
	`ds1edô_îr‹
(
°πmp
);

173 
num_íåy
 = 
	`ã°_ãŒ_íåy
(
fûíame
);

174 i‡(
num_íåy
 != -1)

176 
size_u≈ack
 = * (
glb_mpq
->
block_èbÀ
 + (
num_íåy
 * 4) + 2);

177 if(
num_íåy
 < 0 ||Çum_íåy > (Ë
glb_mpq
->
cou¡_fûes
 - 1)

179 
	`•rötf
(
°πmp
, "Error! InvalidÉntryÇumber %i (ValidÉntryÇumbersáre 1-%i)\n",

180 
num_íåy
 + 1,

181 
glb_mpq
->
cou¡_fûes


183 
	`ds1edô_îr‹
(
°πmp
);

188 
mp_√w
 = (*Ë
	`mÆloc
(
size_u≈ack
);

189 i‡(
mp_√w
 =
NULL
)

191 
	`•rötf
(
°πmp
, "mpq_b©ch_lﬂd_ö_mem(Ë:ÇŸÉnough mem‹y f‹ %òbyãs\n", 
size_u≈ack
);

192 
	`ds1edô_îr‹
(
°πmp
);

194 
	`Exåa˘ToMem
(
mp_√w
, 
num_íåy
);

195 * 
buf„r
 = 
mp_√w
;

196 * 
buf_Àn
 = 
size_u≈ack
;

197 i‡(
ouçut
)

198 
	`¥ötf
("ok (%òbyãs)", 
size_u≈ack
);

201  
num_íåy
;

202 
	}
}

206 
	$mpq_b©ch_˛o£
()

208 
	`f˛o£
(
glb_mpq
->
ÂMpq
);

209 
	`FªeLoˇls
();

210 
	}
}

215 
	$ã°_¥ï¨e_¨chive
()

217 
DWORD
 
mpq_hódî
[2] = {0x1a51504d, 0x00000020};

218 
DWORD
 
dëe˘ed
 = 0;

219 
DWORD
 
tmp
;

220 
«me_hèbÀ
[] = "(hashÅable)";

221 
«me_bèbÀ
[] = "(blockÅable)";

225 
	`‰ód
(&
tmp
,(
DWORD
),1,
glb_mpq
->
ÂMpq
)) {

226 if(
mpq_hódî
[0]==
tmp
) {

227 
	`‰ód
(&
tmp
,(
DWORD
),1,
glb_mpq
->
ÂMpq
);

228 if(
mpq_hódî
[1]==
tmp
) {

229 
dëe˘ed
=1;

234 if(!
dëe˘ed
) {

235 
	`¥ötf
("\nEº‹: Fûê\'%s\' i†nŸá vÆid MPQárchive", 
glb_mpq
->
fûe_«me
);

236 
	`f˛o£
(
glb_mpq
->
ÂMpq
);

242 
glb_mpq
->
off£t_mpq
 = 
	`·ñl
(glb_mpq->
ÂMpq
) - 8;

245 
	`‰ód
(&
glb_mpq
->
Ànght_mpq_∑π
,(
DWORD
),1,glb_mpq->
ÂMpq
);

248 
	`f£ek
(
glb_mpq
->
ÂMpq
,glb_mpq->
off£t_mpq
 + 16,
SEEK_SET
);

251 
	`‰ód
(&
glb_mpq
->
off£t_htbl
,(
DWORD
),1,glb_mpq->
ÂMpq
);

254 
	`‰ód
(&
glb_mpq
->
off£t_btbl
,(
DWORD
),1,glb_mpq->
ÂMpq
);

257 
	`‰ód
(&
glb_mpq
->
Ànght_htbl
,(
DWORD
),1,glb_mpq->
ÂMpq
);

258 
glb_mpq
->
Ànght_htbl
 *= 4;

261 
	`‰ód
(&
glb_mpq
->
Ànght_btbl
,(
DWORD
),1,glb_mpq->
ÂMpq
);

264 
glb_mpq
->
cou¡_fûes
 = glb_mpq->
Ànght_btbl
;

265 
glb_mpq
->
Ànght_btbl
 *= 4;

268 
	`BuûdBa£Massive
();

269 if(
	`InôülizeLoˇls
()) {

270 
	`f˛o£
(
glb_mpq
->
ÂMpq
);

275 
	`f£ek
(
glb_mpq
->
ÂMpq
,glb_mpq->
off£t_mpq
+glb_mpq->
off£t_htbl
,
SEEK_SET
);

276 
	`‰ód
(
glb_mpq
->
hash_èbÀ
,(
DWORD
),glb_mpq->
Ànght_htbl
,glb_mpq->
ÂMpq
);

279 
	`f£ek
(
glb_mpq
->
ÂMpq
,glb_mpq->
off£t_mpq
+glb_mpq->
off£t_btbl
,
SEEK_SET
);

280 
	`‰ód
(
glb_mpq
->
block_èbÀ
,(
DWORD
),glb_mpq->
Ànght_btbl
,glb_mpq->
ÂMpq
);

284 
tmp
=
	`Crc
(
«me_hèbÀ
,
glb_mpq
->
massive_ba£
,0x300);

285 
	`Decode
(
glb_mpq
->
hash_èbÀ
,glb_mpq->
massive_ba£
,
tmp
,glb_mpq->
Ànght_htbl
);

288 
tmp
=
	`Crc
(
«me_bèbÀ
,
glb_mpq
->
massive_ba£
,0x300);

289 
	`Decode
(
glb_mpq
->
block_èbÀ
,glb_mpq->
massive_ba£
,
tmp
,glb_mpq->
Ànght_btbl
);

293 
	}
}

297 
DWORD
 
	$ã°_ãŒ_íåy
(* 
fûíame
)

299 
DWORD
 
s¸c1
, 
s¸c2
, 
s¸c3
, 
poöãr_ht
;

301 
s¸c1
 = 
	`Crc
(
fûíame
, 
glb_mpq
->
massive_ba£
, 0);

302 
s¸c2
 = 
	`Crc
(
fûíame
, 
glb_mpq
->
massive_ba£
, 0x100);

303 
s¸c3
 = 
	`Crc
(
fûíame
, 
glb_mpq
->
massive_ba£
, 0x200);

304 
poöãr_ht
 = (
s¸c1
 & (
glb_mpq
->
Ànght_htbl
/4-1) ) * 4;

305 ; 
poöãr_ht
<
glb_mpq
->
Ànght_htbl
;Öointer_ht += 4)

307 if–(* (
glb_mpq
->
hash_èbÀ
+
poöãr_ht
Ë=
s¸c2
) &&

308 (* (
glb_mpq
->
hash_èbÀ
+
poöãr_ht
+1Ë=
s¸c3
)

310  * (
glb_mpq
->
hash_èbÀ
 + 
poöãr_ht
 + 3);

312  (
DWORD
) -1;

313 
	}
}

323 
	$InôülizeLoˇls
()

325 
glb_mpq
->
globÆ_buf„r
 = (
UI¡8
 *Ë
	`mÆloc
(0x60000);

326 if(!
glb_mpq
->
globÆ_buf„r
) {

327 
	`¥ötf
("\nError! Insufficient memory");

330 
glb_mpq
->
ªad_buf„r_°¨t
=glb_mpq->
globÆ_buf„r
;

331 
glb_mpq
->
wrôe_buf„r_°¨t
=glb_mpq->
globÆ_buf„r
+0x1000;

332 
glb_mpq
->
ex∂ode_buf„r
=glb_mpq->
globÆ_buf„r
+0x2000;

333 
glb_mpq
->
fûe_hódî
=(
DWORD
 *)(glb_mpq->
globÆ_buf„r
+0x6000);

335 
glb_mpq
->
hash_èbÀ
=(
DWORD
 *)
	`mÆloc
(glb_mpq->
Ànght_htbl
*4);

336 
glb_mpq
->
block_èbÀ
=(
DWORD
 *)
	`mÆloc
(glb_mpq->
Ànght_btbl
*4);

337 
glb_mpq
->
fûíame_èbÀ
=(*)
	`ˇŒoc
(glb_mpq->
Ànght_btbl
/4,
MPQTYPES_MAX_PATH
);

338 
glb_mpq
->
idítify_èbÀ
=(*)
	`ˇŒoc
(glb_mpq->
Ànght_btbl
/4, ());

339 if(
glb_mpq
->
hash_èbÀ
 && glb_mpq->
block_èbÀ
 && glb_mpq->
fûíame_èbÀ
 && glb_mpq->
idítify_èbÀ
)

342 
	`¥ötf
("\nError! Insufficient memory");

345 
	}
}

352 
	$FªeLoˇls
()

354 if(
glb_mpq
->
globÆ_buf„r
)

355 
	`‰ì
(
glb_mpq
->
globÆ_buf„r
);

356 if(
glb_mpq
->
hash_èbÀ
)

357 
	`‰ì
(
glb_mpq
->
hash_èbÀ
);

358 if(
glb_mpq
->
block_èbÀ
)

359 
	`‰ì
(
glb_mpq
->
block_èbÀ
);

360 if(
glb_mpq
->
fûíame_èbÀ
)

361 
	`‰ì
(
glb_mpq
->
fûíame_èbÀ
);

362 if(
glb_mpq
->
idítify_èbÀ
)

363 
	`‰ì
(
glb_mpq
->
idítify_èbÀ
);

365 
	}
}

372 
	$BuûdBa£Massive
()

374 
DWORD
 
s1
;

375 
i
,
j
;

376 
ldiv_t
 
divªs
;

378 
divªs
.
ªm
=0x100001;

379 
i
=0;i<0x100;i++) {

380 
j
=0;j<5;j++) {

381 
divªs
=
	`ldiv
(divªs.
ªm
*125+3,0x002AAAAB);

382 
s1
=(
divªs
.
ªm
&0xFFFFL)<<0x10;

383 
divªs
=
	`ldiv
(divªs.
ªm
*125+3,0x002AAAAB);

384 
s1
=s1|(
divªs
.
ªm
&0xFFFFL);

385 
glb_mpq
->
massive_ba£
[
i
+0x100*
j
]=
s1
;

389 
	}
}

396 
DWORD
 
	$Crc
(*
°rög
,
DWORD
 *
massive_ba£
,DWORD 
massive_ba£_off£t
)

398 
byã
;

399 
DWORD
 
¸c
=0x7fed7fed;

400 
DWORD
 
s1
=0xEEEEEEEE;

402 
byã
=*
°rög
;

403 
byã
) {

404 if(
byã
>0x60 && byte<0x7B)

405 
byã
-=0x20;

406 
¸c
=*(
massive_ba£
+
massive_ba£_off£t
+
byã
)^(¸c+
s1
);

407 
s1
+=
¸c
+(s1<<5)+
byã
+3;

408 
°rög
++;

409 
byã
=*
°rög
;

411  
¸c
;

412 
	}
}

419 
UI¡16
 
	$ªad_d©a
(
UI¡8
 *
buf„r
,
UI¡16
 
size
,*
¸≠
)

421 
∑øms
 *
∑øm
=’¨am†*)
¸≠
;

422 
	`mem˝y
(
buf„r
,
∑øm
->
buf_ö
,
size
);

423 
∑øm
->
buf_ö
+=
size
;

424  
size
;

425 
	}
}

431 
	$wrôe_d©a
(
UI¡8
 *
buf„r
,
UI¡16
 
size
,*
¸≠
)

433 
∑øms
 *
∑øm
=’¨am†*)
¸≠
;

434 
	`mem˝y
(
∑øm
->
buf_out
,
buf„r
,
size
);

435 
∑øm
->
buf_out
+=
size
;

436 
glb_mpq
->
Ànght_wrôe
+=
size
;

437 
	}
}

445 
	$Decode
(
DWORD
 *
d©a_ö
, DWORD *
massive_ba£
, DWORD 
¸c
, DWORD 
Ànght
)

447 
DWORD
 
i
,
dec
;

448 
DWORD
 
s1
=0xEEEEEEEE;

449 
i
=0;i<
Ànght
;i++) {

450 
s1
+=*(
massive_ba£
+0x400+(
¸c
&0xFFL));

451 
dec
=*(
d©a_ö
+
i
)^(
s1
+
¸c
);

452 
s1
+=
dec
+(s1<<5)+3;

453 *(
d©a_ö
+
i
)=
dec
;

454 
¸c
=(crc>>0x0b)|(0x11111111+((crc^0x7FFL)<<0x15));

457 
	}
}

464 
DWORD
 
	$GëUnknowCrc
(
DWORD
 
íåy
)

466 
DWORD
 
tmp
,
i
,
j
,
coded_dw‹d
,
¸c_fûe
=0;

467 
DWORD
 
Êag
,
size_∑ck
,
size_u≈ack
,
num_block
,
off£t_body
;

468 
DWORD
 
sign_riff1
=0x46464952;

469 
DWORD
 
sign_riff3
=0x45564157;

470 
DWORD
 
sign_mpq1
=0x1a51504d;

471 
DWORD
 
sign_mpq2
=0x00000020;

472 
ldiv_t
 
divªs
;

474 
off£t_body
=*(
glb_mpq
->
block_èbÀ
+
íåy
*4);

475 
Êag
=*(
glb_mpq
->
block_èbÀ
+
íåy
*4+3);

476 
	`f£ek
(
glb_mpq
->
ÂMpq
,glb_mpq->
off£t_mpq
+
off£t_body
,
SEEK_SET
);

477 
	`‰ód
(&
coded_dw‹d
,(
DWORD
),1,
glb_mpq
->
ÂMpq
);

479 if(
Êag
&0x200 || flag&0x100) {

480 
size_u≈ack
=*(
glb_mpq
->
block_èbÀ
+
íåy
*4+2);

481 
size_∑ck
=*(
glb_mpq
->
block_èbÀ
+
íåy
*4+1);

482 
divªs
=
	`ldiv
(
size_u≈ack
-1,0x1000);

483 
num_block
=
divªs
.
quŸ
+2;

484 
j
=0;j<=0xff;j++) {

485 
¸c_fûe
=((
num_block
*4)^
coded_dw‹d
)-0xìììì - *(
glb_mpq
->
massive_ba£
+0x400+
j
);

486 if((
¸c_fûe
&0xffLË=
j
) {

487 
	`f£ek
(
glb_mpq
->
ÂMpq
,glb_mpq->
off£t_mpq
+
off£t_body
,
SEEK_SET
);

488 
	`‰ód
(
glb_mpq
->
fûe_hódî
,(
DWORD
),
num_block
,glb_mpq->
ÂMpq
);

489 
	`Decode
(
glb_mpq
->
fûe_hódî
,glb_mpq->
massive_ba£
,
¸c_fûe
,
num_block
);

490 
tmp
=
num_block
*4;

491 if(
tmp
 =*
glb_mpq
->
fûe_hódî
) {

492 
i
=0;i<
num_block
-1;i++) {

493 
tmp
+=*(
glb_mpq
->
fûe_hódî
+
i
+1)-*(glb_mpq->file_header+i);

494 if(*(
glb_mpq
->
fûe_hódî
+
i
+1)-*(glb_mpq->file_header+i)>0x1000) {

495 
tmp
=0xffffffff;

499 if(
tmp
!=0xffffffff) {

500 
¸c_fûe
++;

505 
¸c_fûe
=0;

509 
j
=0;j<=0xff;j++) {

510 
¸c_fûe
=(
sign_riff1
^
coded_dw‹d
)-0xìììì - *(
glb_mpq
->
massive_ba£
+0x400+
j
);

511 if((
¸c_fûe
&0xff)==
j
) {

512 
	`f£ek
(
glb_mpq
->
ÂMpq
,glb_mpq->
off£t_mpq
+
off£t_body
,
SEEK_SET
);

513 
	`‰ód
(
glb_mpq
->
fûe_hódî
,(
DWORD
),3,glb_mpq->
ÂMpq
);

514 
	`Decode
(
glb_mpq
->
fûe_hódî
,glb_mpq->
massive_ba£
,
¸c_fûe
,3);

515 if(
sign_riff1
==*
glb_mpq
->
fûe_hódî
) {

516 if(
sign_riff3
==*(
glb_mpq
->
fûe_hódî
+2))

520 
¸c_fûe
=0;

522 if(!
¸c_fûe
) {

523 
j
=0;j<=0xff;j++) {

524 
¸c_fûe
=(
sign_mpq1
^
coded_dw‹d
)-0xìììì - *(
glb_mpq
->
massive_ba£
+0x400+
j
);

525 if((
¸c_fûe
&0xffLË=
j
) {

526 
	`f£ek
(
glb_mpq
->
ÂMpq
,glb_mpq->
off£t_mpq
+
off£t_body
,
SEEK_SET
);

527 
	`‰ód
(
glb_mpq
->
fûe_hódî
,(
DWORD
),2,glb_mpq->
ÂMpq
);

528 
	`Decode
(
glb_mpq
->
fûe_hódî
,glb_mpq->
massive_ba£
,
¸c_fûe
,2);

529 if(
sign_mpq1
 =*
glb_mpq
->
fûe_hódî
) {

530 if(
sign_mpq2
 =*(
glb_mpq
->
fûe_hódî
+1))

534 
¸c_fûe
=0;

538  
¸c_fûe
;

539 
	}
}

546 
	$Exåa˘To
(
FILE
 *
Â_√w
,
DWORD
 
íåy
)

548 
DWORD
 
size_∑ck
,
size_u≈ack
;

549 
UI¡8
 *
ªad_buf„r
,*
wrôe_buf„r
;

550 
UI¡32
 
i
,
j
,
off£t_body
,
Êag
,
¸c_fûe
=0;

551 
UI¡32
 
num_block
,
Ànght_ªad
,
ôî©i⁄
;

552 
UI¡8
 *
szNameFûe
;

553 
UI¡8
 
mëod
;

554 
ldiv_t
 
divªs
;

555 
∑øms
 
∑øm
;

557 
off£t_body
=*(
glb_mpq
->
block_èbÀ
+
íåy
*4);

558 
size_u≈ack
=*(
glb_mpq
->
block_èbÀ
+
íåy
*4+2);

559 
Êag
=*(
glb_mpq
->
block_èbÀ
+
íåy
*4+3);

561 if(
Êag
&0x30000) {

562 if(*(
glb_mpq
->
idítify_èbÀ
+
íåy
)&0x1) {

563 
szNameFûe
=
glb_mpq
->
fûíame_èbÀ
+
MPQTYPES_MAX_PATH
*
íåy
;

564 if(
	`°ºchr
(
szNameFûe
,'\\'))

565 
szNameFûe
=
	`°ºchr
(szNameFile,'\\')+1;

566 
¸c_fûe
=
	`Crc
(
szNameFûe
,
glb_mpq
->
massive_ba£
,0x300);

567 if((
Êag
&0x20200) == 0x20200)

568 
¸c_fûe
=(¸c_fûe+
off£t_body
)^
size_u≈ack
;

571 
¸c_fûe
=
	`GëUnknowCrc
(
íåy
);

574 if(
Êag
&0x200 || flag&0x100) {

575 
divªs
=
	`ldiv
(
size_u≈ack
-1,0x1000);

576 
num_block
=
divªs
.
quŸ
+2;

577 
	`f£ek
(
glb_mpq
->
ÂMpq
,glb_mpq->
off£t_mpq
+
off£t_body
,
SEEK_SET
);

578 
	`‰ód
(
glb_mpq
->
fûe_hódî
,(
DWORD
),
num_block
,glb_mpq->
ÂMpq
);

579 if(
Êag
&0x30000)

580 
	`Decode
(
glb_mpq
->
fûe_hódî
,glb_mpq->
massive_ba£
,(
¸c_fûe
-1),
num_block
);

581 
ªad_buf„r
=
glb_mpq
->
ªad_buf„r_°¨t
;

582 
j
=0;j<(
num_block
-1);j++) {

583 
Ànght_ªad
=*(
glb_mpq
->
fûe_hódî
+
j
+1)-*(glb_mpq->file_header+j);

584 
	`‰ód
(
ªad_buf„r
,(),
Ànght_ªad
,
glb_mpq
->
ÂMpq
);

585 if(
Êag
&0x30000)

586 
	`Decode
((
DWORD
 *)
ªad_buf„r
,
glb_mpq
->
massive_ba£
,
¸c_fûe
,
Ànght_ªad
/4);

587 if(
Ànght_ªad
==0x1000 || (
j
==
num_block
-2 &&Üíght_ªad==(
size_u≈ack
&0xFFF)))

589 
	`fwrôe
(
ªad_buf„r
,(),
Ànght_ªad
,
Â_√w
);

591 if(
Êag
&0x200) {

592 
mëod
=*
ªad_buf„r
;

593 
ôî©i⁄
=0;

594 
i
=0;i<4;i++) {

595 if(
mëod
&
glb_mpq
->
avaû_mëods
[
i
])

596 
ôî©i⁄
++;

598 
ªad_buf„r
+=1;

599 
Ànght_ªad
-=1;

601 
ôî©i⁄
=1;

602 
mëod
=8;

604 
wrôe_buf„r
=
glb_mpq
->
wrôe_buf„r_°¨t
;

605 if(
mëod
&0x08) {

606 
∑øm
.
buf_ö
 =
ªad_buf„r
;

607 
∑øm
.
buf_out
=
wrôe_buf„r
;

608 
glb_mpq
->
Ànght_wrôe
=0;

609 
	`ex∂ode
(&
ªad_d©a
,&
wrôe_d©a
,&
∑øm
);

610 
Ànght_ªad
=
glb_mpq
->
Ànght_wrôe
;

611 
ôî©i⁄
--;

612 if(
ôî©i⁄
) {

613 
ªad_buf„r
=
wrôe_buf„r
;

614 
wrôe_buf„r
=
glb_mpq
->
ªad_buf„r_°¨t
;

617 if(
mëod
&0x01) {

618 
Ànght_ªad
=
	`ExtWavU≈1
((
UI¡32
)
ªad_buf„r
,(UI¡32Óíght_ªad,(UI¡32)
wrôe_buf„r
,0x1000);

619 
ôî©i⁄
--;

620 if(
ôî©i⁄
) {

621 
ªad_buf„r
=
wrôe_buf„r
;

622 
wrôe_buf„r
=
glb_mpq
->
ªad_buf„r_°¨t
;

625 if(
mëod
&0x40)

626 
Ànght_ªad
=
	`ExtWavU≈2
((
UI¡32
)
ªad_buf„r
,(UI¡32Óíght_ªad,(UI¡32)
wrôe_buf„r
,0x1000);

627 if(
mëod
&0x80)

628 
Ànght_ªad
=
	`ExtWavU≈3
((
UI¡32
)
ªad_buf„r
,(UI¡32Óíght_ªad,(UI¡32)
wrôe_buf„r
,0x1000);

630 
	`fwrôe
(
wrôe_buf„r
,1,
Ànght_ªad
,
Â_√w
);

631 
ªad_buf„r
=
glb_mpq
->
ªad_buf„r_°¨t
;

633 
¸c_fûe
++;

638 
size_∑ck
=*(
glb_mpq
->
block_èbÀ
+
íåy
*4+1);

639 if(
Êag
&0x30000)

640 
Ànght_ªad
=0x1000;

642 
Ànght_ªad
=0x60000;

643 if(
size_∑ck
<
Ànght_ªad
)

644 
Ànght_ªad
=
size_∑ck
;

645 
ªad_buf„r
=
glb_mpq
->
ªad_buf„r_°¨t
;

646 if(
Ànght_ªad
) {

647 
divªs
=
	`ldiv
(
size_∑ck
,
Ànght_ªad
);

648 
num_block
=
divªs
.
quŸ
;

650 
num_block
=0;

651 
divªs
.
ªm
=0;

653 
	`f£ek
(
glb_mpq
->
ÂMpq
,glb_mpq->
off£t_mpq
+
off£t_body
,
SEEK_SET
);

654 
j
=0;j<
num_block
;j++) {

655 
	`‰ód
(
ªad_buf„r
,1,
Ànght_ªad
,
glb_mpq
->
ÂMpq
);

656 if(
Êag
&0x30000) {

657 
	`Decode
((
DWORD
 *)
ªad_buf„r
,
glb_mpq
->
massive_ba£
,
¸c_fûe
,
Ànght_ªad
/4);

658 
¸c_fûe
++;

661 
	`fwrôe
(
ªad_buf„r
,1,
Ànght_ªad
,
Â_√w
);

663 if(
divªs
.
ªm
) {

664 
	`‰ód
(
ªad_buf„r
,1,
divªs
.
ªm
,
glb_mpq
->
ÂMpq
);

665 if(
Êag
&0x30000)

666 
	`Decode
((
DWORD
 *)
ªad_buf„r
,
glb_mpq
->
massive_ba£
,
¸c_fûe
,
divªs
.
ªm
/4);

668 
	`fwrôe
(
ªad_buf„r
,1,
divªs
.
ªm
,
Â_√w
);

672 
	}
}

679 
	$Exåa˘ToMem
(* 
mp_√w
, 
DWORD
 
íåy
)

681 
DWORD
 
size_∑ck
,
size_u≈ack
;

682 
UI¡8
 * 
ªad_buf„r
,*
wrôe_buf„r
;

683 
UI¡32
 
i
,
j
,
off£t_body
,
Êag
,
¸c_fûe
=0;

684 
UI¡32
 
num_block
,
Ànght_ªad
,
ôî©i⁄
;

685 
UI¡8
 * 
szNameFûe
;

686 
UI¡8
 
mëod
;

687 
ldiv_t
 
divªs
;

688 
∑øms
 
∑øm
;

689 
UBYTE
 * 
buff_±r
 = 
mp_√w
;

691 
off£t_body
=*(
glb_mpq
->
block_èbÀ
+
íåy
*4);

692 
size_u≈ack
=*(
glb_mpq
->
block_èbÀ
+
íåy
*4+2);

693 
Êag
=*(
glb_mpq
->
block_èbÀ
+
íåy
*4+3);

695 if(
Êag
&0x30000) {

696 if(*(
glb_mpq
->
idítify_èbÀ
+
íåy
)&0x1) {

697 
szNameFûe
=
glb_mpq
->
fûíame_èbÀ
+
MPQTYPES_MAX_PATH
*
íåy
;

698 if(
	`°ºchr
(
szNameFûe
,'\\'))

699 
szNameFûe
=
	`°ºchr
(szNameFile,'\\')+1;

700 
¸c_fûe
=
	`Crc
(
szNameFûe
,
glb_mpq
->
massive_ba£
,0x300);

707 i‡((
Êag
 & 0x20200) == 0x20200)

709 
¸c_fûe
=(¸c_fûe+
off£t_body
)^
size_u≈ack
;

712 
¸c_fûe
=
	`GëUnknowCrc
(
íåy
);

715 if(
Êag
&0x200 || flag&0x100) {

716 
divªs
=
	`ldiv
(
size_u≈ack
-1,0x1000);

717 
num_block
=
divªs
.
quŸ
+2;

718 
	`f£ek
(
glb_mpq
->
ÂMpq
,glb_mpq->
off£t_mpq
+
off£t_body
,
SEEK_SET
);

719 
	`‰ód
(
glb_mpq
->
fûe_hódî
,(
DWORD
),
num_block
,glb_mpq->
ÂMpq
);

720 if(
Êag
&0x30000)

721 
	`Decode
(
glb_mpq
->
fûe_hódî
,glb_mpq->
massive_ba£
,(
¸c_fûe
-1),
num_block
);

722 
ªad_buf„r
=
glb_mpq
->
ªad_buf„r_°¨t
;

723 
j
=0;j<(
num_block
-1);j++) {

724 
Ànght_ªad
=*(
glb_mpq
->
fûe_hódî
+
j
+1)-*(glb_mpq->file_header+j);

725 
	`‰ód
(
ªad_buf„r
,(),
Ànght_ªad
,
glb_mpq
->
ÂMpq
);

726 if(
Êag
&0x30000)

727 
	`Decode
((
DWORD
 *)
ªad_buf„r
,
glb_mpq
->
massive_ba£
,
¸c_fûe
,
Ànght_ªad
/4);

728 if(
Ànght_ªad
==0x1000 || (
j
==
num_block
-2 &&Üíght_ªad==(
size_u≈ack
&0xFFF)))

732 
	`mem˝y
(
buff_±r
, 
ªad_buf„r
, 
Ànght_ªad
);

733 
buff_±r
 +
Ànght_ªad
;

736 if(
Êag
&0x200) {

737 
mëod
=*
ªad_buf„r
;

738 
ôî©i⁄
=0;

739 
i
=0;i<4;i++) {

740 if(
mëod
&
glb_mpq
->
avaû_mëods
[
i
])

741 
ôî©i⁄
++;

743 
ªad_buf„r
+=1;

744 
Ànght_ªad
-=1;

746 
ôî©i⁄
=1;

747 
mëod
=8;

749 
wrôe_buf„r
=
glb_mpq
->
wrôe_buf„r_°¨t
;

750 if(
mëod
&0x08) {

751 
∑øm
.
buf_ö
 =
ªad_buf„r
;

752 
∑øm
.
buf_out
=
wrôe_buf„r
;

753 
glb_mpq
->
Ànght_wrôe
=0;

754 
	`ex∂ode
(&
ªad_d©a
,&
wrôe_d©a
,&
∑øm
);

755 
Ànght_ªad
=
glb_mpq
->
Ànght_wrôe
;

756 
ôî©i⁄
--;

757 if(
ôî©i⁄
) {

758 
ªad_buf„r
=
wrôe_buf„r
;

759 
wrôe_buf„r
=
glb_mpq
->
ªad_buf„r_°¨t
;

762 if(
mëod
&0x01) {

763 
Ànght_ªad
=
	`ExtWavU≈1
((
UI¡32
)
ªad_buf„r
,(UI¡32Óíght_ªad,(UI¡32)
wrôe_buf„r
,0x1000);

764 
ôî©i⁄
--;

765 if(
ôî©i⁄
) {

766 
ªad_buf„r
=
wrôe_buf„r
;

767 
wrôe_buf„r
=
glb_mpq
->
ªad_buf„r_°¨t
;

770 if(
mëod
&0x40)

771 
Ànght_ªad
=
	`ExtWavU≈2
((
UI¡32
)
ªad_buf„r
,(UI¡32Óíght_ªad,(UI¡32)
wrôe_buf„r
,0x1000);

772 if(
mëod
&0x80)

773 
Ànght_ªad
=
	`ExtWavU≈3
((
UI¡32
)
ªad_buf„r
,(UI¡32Óíght_ªad,(UI¡32)
wrôe_buf„r
,0x1000);

776 
	`mem˝y
(
buff_±r
, 
wrôe_buf„r
, 
Ànght_ªad
);

777 
buff_±r
 +
Ànght_ªad
;

779 
ªad_buf„r
=
glb_mpq
->
ªad_buf„r_°¨t
;

781 
¸c_fûe
++;

786 
size_∑ck
=*(
glb_mpq
->
block_èbÀ
+
íåy
*4+1);

787 if(
Êag
&0x30000)

788 
Ànght_ªad
=0x1000;

790 
Ànght_ªad
=0x60000;

791 if(
size_∑ck
<
Ànght_ªad
)

792 
Ànght_ªad
=
size_∑ck
;

793 
ªad_buf„r
=
glb_mpq
->
ªad_buf„r_°¨t
;

794 if(
Ànght_ªad
) {

795 
divªs
=
	`ldiv
(
size_∑ck
,
Ànght_ªad
);

796 
num_block
=
divªs
.
quŸ
;

798 
num_block
=0;

799 
divªs
.
ªm
=0;

801 
	`f£ek
(
glb_mpq
->
ÂMpq
,glb_mpq->
off£t_mpq
+
off£t_body
,
SEEK_SET
);

802 
j
=0;j<
num_block
;j++) {

803 
	`‰ód
(
ªad_buf„r
,1,
Ànght_ªad
,
glb_mpq
->
ÂMpq
);

804 if(
Êag
&0x30000) {

805 
	`Decode
((
DWORD
 *)
ªad_buf„r
,
glb_mpq
->
massive_ba£
,
¸c_fûe
,
Ànght_ªad
/4);

806 
¸c_fûe
++;

810 
	`mem˝y
(
buff_±r
, 
ªad_buf„r
, 
Ànght_ªad
);

811 
buff_±r
 +
Ànght_ªad
;

813 if(
divªs
.
ªm
) {

814 
	`‰ód
(
ªad_buf„r
,1,
divªs
.
ªm
,
glb_mpq
->
ÂMpq
);

815 if(
Êag
&0x30000)

816 
	`Decode
((
DWORD
 *)
ªad_buf„r
,
glb_mpq
->
massive_ba£
,
¸c_fûe
,
divªs
.
ªm
/4);

819 
	`mem˝y
(
buff_±r
, 
ªad_buf„r
, 
divªs
.
ªm
);

820 
buff_±r
 +
divªs
.
ªm
;

824 
	}
}

826 #ifde‡
WIN32


827 #¥agm®
w¨nög
 (
p›
)

	@mpq/MpqView.h

1 #i‚de‡
_MPQVIEW_H_


3 
	#_MPQVIEW_H_


	)

5 
mod_lﬂd_ö_mem
 (* 
moddú
, * 
fûíame
, ** 
buf„r
, * 
buf_Àn
);

6 
mpq_lﬂd_ö_mem
 (* 
mpq«me
, * 
fûíame
, ** 
buf„r
, * 
buf_Àn
, 
ouçut
);

7 
mpq_b©ch_›í
 (* 
mpq«me
);

8 
mpq_b©ch_lﬂd_ö_mem
 (* 
fûíame
, ** 
buf„r
, * 
buf_Àn
, 
ouçut
);

9 
mpq_b©ch_˛o£
 ();

	@mpq/Wav_unp.c

1 #ifde‡
WIN32


2 #¥agm®
w¨nög
 (
push
)

3 #¥agm®
w¨nög
 (
dißbÀ
 : 4100 4127 4311 4312 4127)

8 
	~"mpqTy≥s.h
"

9 
	~"Wav_u≈.h
"

10 
	~<°dlib.h
>

12 
UI¡32
 
ExtWavU≈1
 (UInt32,UInt32,UInt32,UInt32);

13 
UI¡32
 
ExtWavU≈2
 (UInt32,UInt32,UInt32,UInt32);

14 
UI¡32
 
ExtWavU≈3
 (UInt32,UInt32,UInt32,UInt32);

15 
Sub_WavU≈1
 (
UI¡32
,UInt32);

16 
UI¡32
 
Sub_WavU≈2
 (UInt32,UInt32,UInt32);

17 
Sub_WavU≈3
 (
UI¡32
);

18 
Sub_WavU≈4
 (
UI¡32
,UInt32,UInt32,UInt32);

19 
UI¡32
 
Sub_WavU≈5
 (UInt32);

20 
Sub_WavU≈6
 (
UI¡32
);

21 
UI¡32
 
Sub_WavU≈7
 (UInt32);

22 
UI¡32
 
Sub_WavU≈8
 (UInt32);

23 
Sub_WavU≈9
 (
UI¡32
,UInt32);

24 
Sub_WavU≈10
 (
UI¡32
,UInt32);

25 
UI¡32
 
Sub_WavU≈11
 (UInt32,UInt32,UInt32,UInt32);

26 
Sub_WavU≈12
 (
UI¡32
);

27 
UI¡32
 
Sub_WavU≈13
 (UInt32,UInt32,UInt32,UInt32,UInt32);

31 
UI¡32
 
	$ExtWavU≈3
(
UI¡32
 
buf_ö
,UI¡32 
size_ö
,UI¡32 
buf_out
,UI¡32 
size_out
)

33  
	`Sub_WavU≈13
(
buf_ö
,
size_ö
,2,
buf_out
,
size_out
);

34 
	}
}

38 
UI¡32
 
	$ExtWavU≈2
(
UI¡32
 
buf_ö
,UI¡32 
size_ö
,UI¡32 
buf_out
,UI¡32 
size_out
)

40  
	`Sub_WavU≈13
(
buf_ö
,
size_ö
,1,
buf_out
,
size_out
);

41 
	}
}

45 
UI¡32
 
	$Sub_WavU≈13
(
UI¡32
 
buf_ö
,UI¡32 
size_ö
,UI¡32 
Êag
,UI¡32 
buf_out
,UI¡32 
size_out
)

47 
UI¡32
 
v¨14
=0,
v¨18
=0,
v¨1c
=0;

48 
UI¡32
 
tmp0
=0,
tmp1
=0,
tmp2
=0,
tmp3
=0,
tmp4
=0;

49 
UI¡32
 
v¨8
[2]={0, 0};

50 
UI¡32
 
v¨10
[2]={0, 0};

53 
v¨14
=
buf_ö
;

54 
size_ö
+=
buf_ö
;

55 
tmp0
=
v¨14
+2;

56 
v¨1c
=
size_out
;

57 
tmp3
=
buf_out
;

58 
v¨18
=
buf_out
;

59 
v¨10
[0]=0x2C;

60 
v¨10
[1]=0x2C;

61 if((
SI¡32
)
Êag
>0) {

62 
tmp2
=0;tmp2<
Êag
;tmp2++) {

63 
v¨8
[
tmp2
]=(
SI¡32
)*((
SI¡16
 *)
tmp0
);

64 
tmp0
+=2;

65 if(
size_out
<2)

66  
tmp3
-
v¨18
;

67 *((
UI¡16
 *)
tmp3
)=(UI¡16Ë
v¨8
[
tmp2
];

68 
tmp3
+=2;

69 
v¨1c
-=2;

72 
tmp2
=
Êag
-1;

73 
tmp0
<
size_ö
) {

74 if(
Êag
==2) {

75 if(
tmp2
==0)

76 
tmp2
=1;

78 
tmp2
=0;

80 
tmp1
=(
UI¡32
)*((
UI¡8
 *)
tmp0
);

81 
tmp0
++;

82 
buf_ö
=
tmp0
;

83 if(
tmp1
&0x80) {

84 
tmp1
&=0x7F;

85 
tmp4
=1;

86 if(
tmp1
==0) {

87 if(
v¨10
[
tmp2
])

88 
v¨10
[
tmp2
]--;

89 if(
v¨1c
<2)

90  
tmp3
-
v¨18
;

91 *((
UI¡16
 *)
tmp3
)=(UI¡16)
v¨8
[
tmp2
];

92 
tmp3
+=2;

93 
v¨1c
-=2;

94 if((
tmp4
==0)&&(
Êag
==2)) {

95 if(
tmp2
==0)

96 
tmp2
=1;

98 
tmp2
=0;

101 
tmp1
--;

102 if(
tmp1
==0) {

103 
v¨10
[
tmp2
]+=8;

104 
tmp4
=
v¨10
[
tmp2
];

105 if(
tmp4
>0x58)

106 
v¨10
[
tmp2
]=0x58;

107 
tmp4
=0;

108 if(
tmp4
==0 && 
Êag
==2) {

109 if(
tmp2
==0)

110 
tmp2
=1;

112 
tmp2
=0;

115 
tmp1
--;

116 if(
tmp1
==0) {

117 
v¨10
[
tmp2
]+=0xFFFFFFF8;

118 if((
SI¡32
)
v¨10
[
tmp2
]<0)

119 
v¨10
[
tmp2
]=0;

120 
tmp4
=0;

122 if((
tmp4
==0)&&(
Êag
==2)) {

123 if(
tmp2
==0)

124 
tmp2
=1;

126 
tmp2
=0;

131 
tmp0
=
smÆl_tbl1
[
v¨10
[
tmp2
]];

132 
tmp4
=
tmp0
>>(*((
UI¡8
 *)(
v¨14
+1)));

133 if(
tmp1
&1)

134 
tmp4
+=
tmp0
;

135 if(
tmp1
&2)

136 
tmp4
+=
tmp0
>>1;

137 if(
tmp1
&4)

138 
tmp4
+=
tmp0
>>2;

139 if(
tmp1
&8)

140 
tmp4
+=
tmp0
>>3;

141 if(
tmp1
&0x10)

142 
tmp4
+=
tmp0
>>4;

143 if(
tmp1
&0x20)

144 
tmp4
+=
tmp0
>>5;

145 
tmp0
=
v¨8
[
tmp2
];

146 if((
tmp1
&0xFF)&0x40) {

147 
tmp0
-=
tmp4
;

148 if((
SI¡32
)
tmp0
<=(SInt32)0xFFFF8000)

149 
tmp0
=0xFFFF8000;

151 
tmp0
+=
tmp4
;

152 if((
SI¡32
)
tmp0
>=0x7FFF)

153 
tmp0
=0x7FFF;

155 
v¨8
[
tmp2
]=
tmp0
;

156 
tmp0
=
v¨1c
;

157 if(
tmp0
<2)

158  
tmp3
-
v¨18
;

159 *((
UI¡16
 *)
tmp3
)=(UI¡16)
v¨8
[
tmp2
];

160 
tmp1
&=0x1F;

161 
tmp3
+=2;

162 
v¨1c
-=2;

163 
tmp4
=
v¨10
[
tmp2
]+
smÆl_tbl2
[
tmp1
];

164 
v¨10
[
tmp2
]=
tmp4
;

165 if((
SI¡32
)
tmp4
<0)

166 
v¨10
[
tmp2
]=0;

168 if(
tmp4
>0x58)

169 
v¨10
[
tmp2
]=0x58;

171 
tmp0
=
buf_ö
;

174  
tmp3
-
v¨18
;

175 
	}
}

179 
UI¡32
 
	$ExtWavU≈1
(
UI¡32
 
buf_ö
, UI¡32 
size_ö
, UI¡32 
buf_out
, UI¡32 
size_out
)

181 
UI¡32
 
w‹k_buff
=0,
ba£
=0;

182 
UI¡32
 
tmp1
=0,
tmp2
=0,
tmp3
=0;

183 
SI¡32
 
i
=0;

186 
w‹k_buff
=(
UI¡32
)(
UI¡8
 *)
	`mÆloc
(0x3a80);

187 *((
UI¡32
 *)
w‹k_buff
)=
buf_ö
+4;

188 *((
UI¡32
 *)(
w‹k_buff
+4))=*((UI¡32 *)
buf_ö
);

189 *((
UI¡32
 *)(
w‹k_buff
+8))=0x20;

190 
ba£
=
w‹k_buff
+0xC;

191 
	`Sub_WavU≈12
(
ba£
);

192 
size_out
=
	`Sub_WavU≈11
(
buf_out
,size_out,
w‹k_buff
,
ba£
);

194 
tmp2
=*((
UI¡32
 *)(
w‹k_buff
+0x3070));

195 if((
SI¡32
)
tmp2
<=0)

197 
tmp3
=
	`Sub_WavU≈5
(
tmp2
);

198 *((
UI¡32
 *)
tmp3
)=*((UI¡32 *)
tmp2
);

199 
tmp3
=*((
UI¡32
 *)
tmp2
);

200 *((
UI¡32
 *)(
tmp3
+4))=*((UI¡32 *)(
tmp2
+4));

201 *((
UI¡32
 *)
tmp2
)=0;

202 *((
UI¡32
 *)(
tmp2
+4))=0;

204 if(*((
UI¡32
 *)(
w‹k_buff
+0x306C))) {

205 
tmp3
=
	`Sub_WavU≈5
(*((
UI¡32
 *)(
w‹k_buff
+0x306C)));

206 *((
UI¡32
 *)
tmp3
)=*((UI¡32 *)(
w‹k_buff
+0x306C));

207 
tmp3
=*((
UI¡32
 *)(
w‹k_buff
+0x306C));

208 *((
UI¡32
 *)(
tmp3
+4))=*((UI¡32 *)(
w‹k_buff
+0x3070));

209 *((
UI¡32
 *)(
w‹k_buff
+0x306C))=0;

210 *((
UI¡32
 *)(
w‹k_buff
+0x3070))=0;

213 
tmp2
=*((
UI¡32
 *)(
w‹k_buff
+0x3064));

214 if((
SI¡32
)
tmp2
<=0)

216 
tmp3
=
	`Sub_WavU≈5
(
tmp2
);

217 *((
UI¡32
 *)
tmp3
)=*((UI¡32 *)
tmp2
);

218 
tmp3
=*((
UI¡32
 *)
tmp2
);

219 *((
UI¡32
 *)(
tmp3
+4))=*((UI¡32 *)(
tmp2
+4));

220 *((
UI¡32
 *)
tmp2
)=0;

221 *((
UI¡32
 *)(
tmp2
+4))=0;

223 if(*((
UI¡32
 *)(
w‹k_buff
+0x3060))) {

224 
tmp3
=
	`Sub_WavU≈5
(*((
UI¡32
 *)(
w‹k_buff
+0x3060)));

225 *((
UI¡32
 *)
tmp3
)=*((UI¡32 *)(
w‹k_buff
+0x3060));

226 
tmp3
=*((
UI¡32
 *)(
w‹k_buff
+0x3060));

227 *((
UI¡32
 *)(
tmp3
+4))=*((UI¡32 *)(
w‹k_buff
+0x3064));

228 *((
UI¡32
 *)(
w‹k_buff
+0x3060))=0;

229 *((
UI¡32
 *)(
w‹k_buff
+0x3064))=0;

231 
tmp2
=
w‹k_buff
+0x305C;

232 
i
=0x203;i!=0;i--) {

233 
tmp3
=*((
UI¡32
 *)(
tmp2
-0x18));

234 
tmp2
-=0x18;

235 if(
tmp3
) {

236 
tmp3
=
	`Sub_WavU≈5
(
tmp2
);

237 *((
UI¡32
 *)
tmp3
)=*((UI¡32 *)
tmp2
);

238 
tmp3
=*((
UI¡32
 *)
tmp2
);

239 *((
UI¡32
 *)(
tmp3
+4))=*((UI¡32 *)(
tmp2
+4));

240 *((
UI¡32
 *)
tmp2
)=0;

241 *((
UI¡32
 *)(
tmp2
+4))=0;

243 
tmp1
=*((
UI¡32
 *)
tmp2
);

244 if(
tmp1
) {

245 
tmp3
=*((
UI¡32
 *)(
tmp2
+4));

246 if((
SI¡32
)
tmp3
<0)

247 
tmp3
=~tmp3;

249 
tmp3
=
tmp2
+tmp3-*((
UI¡32
 *)(
tmp1
+4));

250 *((
UI¡32
 *)
tmp3
)=
tmp1
;

251 
tmp3
=*((
UI¡32
 *)
tmp2
);

252 *((
UI¡32
 *)(
tmp3
+4))=*((UI¡32 *)(
tmp2
+4));

253 *((
UI¡32
 *)
tmp2
)=0;

254 *((
UI¡32
 *)(
tmp2
+4))=0;

257 
	`‰ì
((
UI¡8
 *)
w‹k_buff
);

258  
size_out
;

259 
	}
}

263 
	$Sub_WavU≈12
(
UI¡32
 
ba£
)

265 
UI¡32
 
tmp
=0;

266 
SI¡32
 
i
=0;

269 
	`Sub_WavU≈6
(
ba£
);

270 
tmp
=
ba£
+0x3474;

271 
i
=0x80;i!=0;i--) {

272 *((
UI¡32
 *Ë
tmp
)=0;

273 
tmp
+=0xC;

276 
	}
}

280 
UI¡32
 
	$Sub_WavU≈11
(
UI¡32
 
buf_out
,UI¡32 
size_out
,UI¡32 
w‹k_buff
,UI¡32 
ba£
)

282 
UI¡32
 
v¨4
=0,
v¨8
=0,
v¨c
=0,
v¨10
=0,
v¨14
=0;

283 
UI¡32
 
Êag
=0,
tmp0
=0,
tmp1
=0,
tmp2
=0,
tmp3
=0,
tmp4
=0,
tmp5
=0;

286 if(
size_out
==0)

288 
tmp0
=
w‹k_buff
;

289 if(*((
UI¡32
 *)(
tmp0
+8))<=8) {

290 
tmp3
=*((
UI¡32
 *)
tmp0
);

291 *((
UI¡32
 *)(
tmp0
+4))|=((UI¡32)*((
UI¡16
 *)
tmp3
)&0xFFFF)<<(*((UInt32 *)(tmp0+8))&0xFF);

292 *((
UI¡32
 *)(
tmp0
+8))+=0x10;

293 *((
UI¡32
 *)
tmp0
)+=2;

295 *((
UI¡32
 *)(
tmp0
+8))+=0xFFFFFFF8;

296 
v¨c
=*((
UI¡32
 *)(
tmp0
+4))&0xFF;

297 *((
UI¡32
 *)(
tmp0
+4))=*((UInt32 *)(tmp0+4))>>8;

298 
	`Sub_WavU≈1
(
v¨c
,
ba£
);

299 if((
v¨c
&0xFF)==0)

300 *((
UI¡32
 *)
ba£
)=1;

302 *((
UI¡32
 *)
ba£
)=0;

303 
v¨c
=
buf_out
;

306 if(*((
UI¡32
 *)(
tmp0
+8))<=7) {

307 
tmp3
=*((
UI¡32
 *)
tmp0
);

308 *((
UI¡32
 *)(
tmp0
+4))|=((UI¡32)*((
UI¡16
 *)
tmp3
)&0xFFFF)<<(*((UInt32 *)(tmp0+8))&0xFF);

309 *((
UI¡32
 *)(
tmp0
+8))+=0x10;

310 *((
UI¡32
 *)
tmp0
)+=2;

312 
tmp3
=*((
UI¡32
 *)(
tmp0
+4));

313 
tmp4
=
tmp3
&0x7F;

314 
tmp2
=
ba£
+(
tmp4
+0x45F)*12;

315 
tmp1
=*((
UI¡32
 *)
tmp2
);

316 
v¨8
=0;

317 
Êag
=1;

318 if(
tmp1
==*((
UI¡32
 *)(
ba£
+4))) {

319 
v¨8
=1;

320 
tmp5
=*((
UI¡32
 *)(
tmp2
+4));

321 if(
tmp5
>7) {

322 *((
UI¡32
 *)(
tmp0
+4))=*((UInt32 *)(tmp0+4))>>7;

323 *((
UI¡32
 *)(
tmp0
+8))+=0xFFFFFFF9;

324 
v¨14
=*((
UI¡32
 *)(
tmp2
+8));

326 *((
UI¡32
 *)(
tmp0
+4))=*((UI¡32 *)—mp0+4))>>(*((UI¡32 *)(
tmp2
+4))&0xFF);

327 *((
UI¡32
 *)(
tmp0
+8))-=*((UI¡32 *)(
tmp2
+4));

328 
tmp5
=*((
UI¡32
 *)(
tmp2
+8));

329 
Êag
=0;

332 
tmp5
=*((
UI¡32
 *)(
ba£
+0x3060));

333 
tmp3
=*((
UI¡32
 *)
tmp5
);

334 
v¨14
=*((
UI¡32
 *)(
tmp3
+4));

335 
tmp3
=
v¨14
;

336 if((
SI¡32
)
v¨14
<=0)

337 
v¨14
=0;

339 if(
Êag
) {

340 
v¨10
=0;

342 
v¨14
=*((
UI¡32
 *)(var14+0x14));

343 if(
	`Sub_WavU≈8
(
tmp0
)) {

344 
tmp3
=*((
UI¡32
 *)(
v¨14
+4));

345 
v¨14
=
tmp3
;

347 
tmp3
=
v¨14
;

348 
v¨10
++;

349 if(
v¨10
==7)

350 
v¨4
=
tmp3
;

351 } *((
UI¡32
 *)(
tmp3
+0x14)));

352 if(
v¨8
==0) {

353 if(
v¨10
>7) {

354 *((
UI¡32
 *)
tmp2
)=*((UI¡32 *)(
ba£
+4));

355 *((
UI¡32
 *)(
tmp2
+4))=
v¨10
;

356 *((
UI¡32
 *)(
tmp2
+8))=
v¨4
;

358 
tmp3
=(((
v¨10
|0xFFFFFFFF)>>((0x20-v¨10)&0xFF)))&
tmp4
;

359 
tmp1
=1<<(
v¨10
&0xFF);

360 
tmp5
=
ba£
+0x347C+
tmp3
*12;

361 
tmp2
=(
tmp1
*3)<<2;

363 
tmp3
+=
tmp1
;

364 *((
UI¡32
 *)(
tmp5
-8))=*((UI¡32 *)(
ba£
+4));

365 *((
UI¡32
 *)(
tmp5
-4))=
v¨10
;

366 *((
UI¡32
 *)
tmp5
)=*((UI¡32 *)(
v¨14
+8));

367 
tmp5
+=
tmp2
;

368 } 
tmp3
<=0x7F);

371 
v¨10
=*((
UI¡32
 *)(
v¨14
+8));

372 
tmp5
=
v¨10
;

374 if(
tmp5
==0x101) {

375 
tmp5
=*((
UI¡32
 *)(
tmp0
+8));

376 if(
tmp5
<=8) {

377 
tmp3
=*((
UI¡32
 *)
tmp0
);

378 *((
UI¡32
 *)(
tmp0
+4))|=((UI¡32)*((
UI¡16
 *)
tmp3
)&0xFFFF)<<(*((UInt32 *)(tmp0+8))&0xFF);

379 *((
UI¡32
 *)(
tmp0
+8))+=0x10;

380 *((
UI¡32
 *)
tmp0
)+=2;

382 
tmp2
=*((
UI¡32
 *)(
tmp0
+4))&0xFF;

383 *((
UI¡32
 *)(
tmp0
+4))=*((UInt32 *)(tmp0+4))>>8;

384 *((
UI¡32
 *)(
tmp0
+8))+=0xFFFFFFF8;

385 
v¨10
=
tmp2
;

386 
	`Sub_WavU≈9
(
tmp2
,
ba£
);

387 if(*((
UI¡32
 *)
ba£
)==0) {

388 
tmp2
=*((
UI¡32
 *)(
ba£
+tmp2*4+0x306C));

389 if(
tmp2
) {

390 
tmp2
) {

391 
tmp3
=*((
UI¡32
 *)(
tmp2
+0xC));

392 
tmp3
++;

393 *((
UI¡32
 *)(
tmp2
+0xC))=
tmp3
;

394 
tmp0
=
tmp2
;

395 
tmp5
=
tmp3
;

397 
tmp4
=*((
UI¡32
 *)(
tmp0
+4));

398 if((
SI¡32
)
tmp4
<0)

399 
tmp4
=0;

400 if(
tmp4
) {

401 if(*((
UI¡32
 *)(
tmp4
+0xC))<
tmp5
)

402 
tmp0
=
tmp4
;

408 if(
tmp0
!=
tmp2
) {

409 
	`Sub_WavU≈4
(
tmp0
,2,
tmp2
,
ba£
+0x305C);

410 
	`Sub_WavU≈4
(
tmp2
,2,
tmp4
,
ba£
+0x305C);

411 
tmp3
=*((
UI¡32
 *)(
tmp0
+0x10));

412 
tmp5
=*((
UI¡32
 *)(
tmp3
+0x14));

413 
tmp3
=*((
UI¡32
 *)(
tmp2
+0x10));

414 if(*((
UI¡32
 *)(
tmp3
+0x14))==
tmp2
)

415 *((
UI¡32
 *)(
tmp3
+0x14))=
tmp0
;

416 if(
tmp5
==
tmp0
) {

417 
tmp5
=*((
UI¡32
 *)(
tmp0
+0x10));

418 *((
UI¡32
 *)(
tmp5
+0x14))=
tmp2
;

420 
tmp3
=*((
UI¡32
 *)(
tmp2
+0x10));

421 *((
UI¡32
 *)(
tmp2
+0x10))=*((UI¡32 *)(
tmp0
+0x10));

422 *((
UI¡32
 *)(
tmp0
+0x10))=
tmp3
;

423 *((
UI¡32
 *)(
ba£
+4))+=1;

425 
tmp2
=*((
UI¡32
 *)(tmp2+0x10));

427 
tmp5
=
v¨10
;

428 
tmp0
=
w‹k_buff
;

431 
tmp5
=
v¨10
;

434 
tmp5
=
v¨10
;

436 
tmp3
=
v¨c
;

437 if(
tmp5
!=0x100)

439 
size_out
--;

440 *((
UI¡8
 *)
v¨c
)=(UI¡8)
tmp5
&0xFF;

441 
tmp3
++;

442 
v¨c
=
tmp3
;

443 if(
size_out
) {

444 if(*((
UI¡32
 *)
ba£
)) {

445 
tmp3
=*((
UI¡32
 *)(
ba£
+
tmp5
*4+0x306C));

446 
	`Sub_WavU≈10
(
tmp3
,
ba£
);

449  
tmp3
-
buf_out
;

452  
tmp3
-
buf_out
;

454 
	}
}

458 
	$Sub_WavU≈1
(
UI¡32
 
¨g1
,UI¡32 
ba£
)

460 
UI¡32
 
v¨_4
=0,
v¨_8
=0,
v¨_c
=0;

461 
UI¡32
 
tmp0
=0,
tmp1
=0,
tmp2
=0,
tmp3
=0,
tmp4
=0;

462 
SI¡32
 
i
=0;

465 (
SI¡32
)*((
UI¡32
 *)(
ba£
+0x3064))>0) {

466 
tmp0
=
	`Sub_WavU≈2
(0,*((
UI¡32
 *)(
ba£
+0x3050)),*((UInt32 *)(base+0x3064)));

467 if(*((
UI¡32
 *Ë
tmp0
))

468 
	`Sub_WavU≈3
(
tmp0
);

469 
tmp2
=
ba£
+0x3054;

470 *((
UI¡32
 *)(
tmp0
))=
tmp2
;

471 *((
UI¡32
 *)(
tmp0
+4))=*((UI¡32 *)(
tmp2
+4));

472 
tmp3
=*((
UI¡32
 *)(
tmp2
+4));

473 if((
SI¡32
)
tmp3
<=0)

474 
tmp3
=~tmp3;

475 
tmp3
=
	`Sub_WavU≈2
(0,*((
UI¡32
 *)(
ba£
+0x3050)),tmp3);

476 *((
UI¡32
 *)
tmp3
)=(UI¡32)
tmp0
;

477 *((
UI¡32
 *)(
tmp2
+4))=
ba£
;

479 
tmp0
=
ba£
+0x306c;

480 
i
=0x102;i!=0;i--) {

481 *((
UI¡32
 *)
tmp0
)=0;

482 
tmp0
+=4;

484 
v¨_c
=0;

485 
v¨_8
=
ba£
+0x306C;

486 
tmp1
=(
UI¡32
)
wav_èbÀ
+(((
¨g1
&0xff)<<7)+(arg1&0xff))*2;

487 
v¨_4
=
tmp1
;

488 
tmp0
=0;

489 
tmp0
<0x100) {

490 if(*((
UI¡8
 *)(
tmp0
+
tmp1
))) {

491 
tmp2
=*((
UI¡32
 *)(
ba£
+0x3058));

492 if((
SI¡32
)
tmp2
<=0) {

493 
tmp2
=*((
UI¡32
 *)(
ba£
+0x3068))*24+base+8;

494 *((
UI¡32
 *)(
ba£
+0x3068))=*((UInt32 *)(base+0x3068))+1;

496 
	`Sub_WavU≈4
(
tmp2
,2,0,
ba£
+0x305C);

497 *((
UI¡32
 *)(
tmp2
+0x10))=0;

498 *((
UI¡32
 *)(
tmp2
+0x14))=0;

499 *((
UI¡32
 *)
v¨_8
)=
tmp2
;

500 *((
UI¡32
 *)(
tmp2
+8))=
tmp0
;

501 
tmp3
=*((
UI¡32
 *)(
tmp0
+
tmp1
))&0xFF;

502 *((
UI¡32
 *)(
tmp2
+0xC))=
tmp3
;

503 if(
tmp3
>=
v¨_c
)

504 
v¨_c
=
tmp3
;

506 
tmp1
=*((
UI¡32
 *)(
ba£
+0x3064));

507 if((
SI¡32
)
tmp1
>0) {

508 
tmp1
) {

509 if(*((
UI¡32
 *)(
tmp1
+0xC))<
tmp3
)

510 
tmp1
=*((
UI¡32
 *)(tmp1+4));

515 
tmp1
=0;

516 
¨g1
=
	`Sub_WavU≈2
(0,*((
UI¡32
 *)(
ba£
+0x305C)),
tmp2
);

517 if(*((
UI¡32
 *)
¨g1
))

518 
	`Sub_WavU≈3
(
¨g1
);

519 if(
tmp1
)

520 
tmp3
=
	`Sub_WavU≈2
(0,*((
UI¡32
 *)(
ba£
+0x305C)),
tmp1
);

522 
tmp3
=
ba£
+0x3060;

523 
tmp4
=*((
UI¡32
 *)
tmp3
);

524 *((
UI¡32
 *)
¨g1
)=
tmp4
;

525 *((
UI¡32
 *)(
¨g1
+4))=*((UI¡32 *)(
tmp4
+4));

526 
tmp1
=
v¨_4
;

527 *((
UI¡32
 *)(
tmp4
+4))=
tmp2
;

528 *((
UI¡32
 *)
tmp3
)=
¨g1
;

531 
v¨_8
+=4;

532 
tmp0
++;

534 if(
tmp0
<0x102) {

535 
tmp1
=
ba£
+
tmp0
*4+0x306C;

536 
tmp0
<0x102) {

537 
tmp2
=*((
UI¡32
 *)(
ba£
+0x3058));

538 if((
SI¡32
)
tmp2
<=0) {

539 
tmp2
=
ba£
+*((
UI¡32
 *)(base+0x3068))*24+8;

540 *((
UI¡32
 *)(
ba£
+0x3068))=*((UInt32 *)(base+0x3068))+1;

543 
	`Sub_WavU≈4
(
tmp2
,1,0,
ba£
+0x305C);

544 
tmp1
+=4;

545 *((
UI¡32
 *)(
tmp2
+0x10))=0;

546 *((
UI¡32
 *)(
tmp2
+0x14))=0;

547 *((
UI¡32
 *)(
tmp1
-4))=
tmp2
;

548 *((
UI¡32
 *)(
tmp2
+8))=
tmp0
;

549 
tmp0
++;

550 *((
UI¡32
 *)(
tmp2
+0xC))=1;

553 
tmp0
=*((
UI¡32
 *)(
ba£
+0x3064));

554 if((
SI¡32
)
tmp0
<=0)

555 
tmp0
=0;

556 
tmp0
) {

557 
tmp1
=*((
UI¡32
 *)(
tmp0
+4));

558 if((
SI¡32
)
tmp1
<=0)

559 
tmp1
=0;

560 
¨g1
=
tmp1
;

561 if(
tmp1
) {

562 
tmp2
=*((
UI¡32
 *)(
ba£
+0x3058));

563 if((
SI¡32
)
tmp2
<=0) {

564 
tmp2
=
ba£
+*((
UI¡32
 *)(base+0x3068))*24+8;

565 *((
UI¡32
 *)(
ba£
+0x3068))=*((UInt32 *)(base+0x3068))+1;

567 
	`Sub_WavU≈4
(
tmp2
,2,0,
ba£
+0x305C);

568 *((
UI¡32
 *)(
tmp2
+0x10))=0;

569 *((
UI¡32
 *)(
tmp2
+0x14))=0;

570 *((
UI¡32
 *)(
tmp2
+0x14))=
tmp0
;

571 *((
UI¡32
 *)(
tmp2
+0xC))=*((UI¡32 *)(
tmp1
+0xC))+*((UI¡32 *)(
tmp0
+0xC));

572 *((
UI¡32
 *)(
tmp0
+0x10))=
tmp2
;

573 *((
UI¡32
 *)(
tmp1
+0x10))=
tmp2
;

574 
tmp3
=*((
UI¡32
 *)(
tmp2
+0xC));

575 if(
tmp3
>=
v¨_c
)

576 
v¨_c
=
tmp3
;

578 
tmp1
=*((
UI¡32
 *)(tmp1+4));

579 
tmp0
=
tmp1
;

580 if((
SI¡32
)
tmp0
<=0)

581 
tmp0
=0;

582 
tmp0
) {

583 if(*((
UI¡32
 *)(
tmp0
+0xC))<
tmp3
) {

584 
tmp0
=*((
UI¡32
 *)(tmp0+4));

585 if((
SI¡32
)
tmp0
<=0)

586 
tmp0
=0;

591 
tmp1
=
	`Sub_WavU≈2
(0,*((
UI¡32
 *)(
ba£
+0x305C)),
tmp2
);

592 if(*((
UI¡32
 *)(
tmp1
))) {

593 
tmp3
=
	`Sub_WavU≈5
(
tmp1
);

594 *((
UI¡32
 *)(
tmp3
))=*((UI¡32 *)(
tmp1
));

595 
tmp4
=*((
UI¡32
 *)
tmp1
);

596 *((
UI¡32
 *)(
tmp4
+4))=*((UI¡32 *)(
tmp1
+4));

597 *((
UI¡32
 *)
tmp1
)=0;

598 *((
UI¡32
 *)(
tmp1
+4))=0;

600 if(
tmp0
)

601 
tmp3
=
	`Sub_WavU≈2
(0,*((
UI¡32
 *)(
ba£
+0x305C)),
tmp0
);

603 
tmp3
=
ba£
+0x3060;

604 
tmp4
=*((
UI¡32
 *)(
tmp3
));

605 *((
UI¡32
 *)(
tmp1
))=
tmp4
;

606 *((
UI¡32
 *)(
tmp1
+4))=*((UI¡32 *)(
tmp4
+4));

607 *((
UI¡32
 *)(
tmp4
+4))=
tmp2
;

608 *((
UI¡32
 *)(
tmp3
))=
tmp1
;

609 
tmp1
=
¨g1
;

611 
tmp0
=*((
UI¡32
 *)(
tmp1
+4));

612 if((
SI¡32
)
tmp0
<=0)

613 
tmp0
=0;

617 *((
UI¡32
 *)(
ba£
+4))=1;

619 
	}
}

623 
	$Sub_WavU≈9
(
UI¡32
 
¨g1
,UI¡32 
¨g2
)

625 
UI¡32
 
v¨4
=0,
v¨8
=0,
tmp0
=0,
tmp1
=0,
tmp2
=0,
tmp3
=0,
tmp4
=0;

628 
tmp0
=*((
UI¡32
 *)(
¨g2
+0x3064));

629 if((
SI¡32
)
tmp0
<0)

630 
tmp0
=0;

631 
tmp2
=*((
UI¡32
 *)(
¨g2
+0x3058));

632 if((
SI¡32
)
tmp2
<0)

633 
tmp2
=0;

634 
v¨4
=
¨g2
;

635 if(
tmp2
==0) {

636 
tmp2
=
v¨4
+*((
UI¡32
 *)(var4+0x3068))*24+8;

637 *((
UI¡32
 *)(
v¨4
+0x3068))+=1;

639 
v¨8
=
¨g2
+0x305C;

640 
tmp1
=
	`Sub_WavU≈2
(0,*((
UI¡32
 *)
v¨8
),
tmp2
);

641 if(*((
UI¡32
 *)
tmp1
)) {

642 
tmp3
=
	`Sub_WavU≈5
(
tmp1
);

643 *((
UI¡32
 *)
tmp3
)=*((UI¡32 *)
tmp1
);

644 
tmp3
=*((
UI¡32
 *)
tmp1
);

645 *((
UI¡32
 *)(
tmp3
+4))=*((UI¡32 *)(
tmp1
+4));

646 *((
UI¡32
 *)
tmp1
)=0;

647 *((
UI¡32
 *)(
tmp1
+4))=0;

649 *((
UI¡32
 *)
tmp1
)=
v¨8
+4;

650 *((
UI¡32
 *)(
tmp1
+4))=*((UI¡32 *)(
v¨8
+8));

651 
tmp3
=
	`Sub_WavU≈2
(0,*((
UI¡32
 *)
v¨8
),
	`Sub_WavU≈7
(var8+4));

652 *((
UI¡32
 *)
tmp3
)=
tmp1
;

653 *((
UI¡32
 *)(
v¨8
+8))=
tmp2
;

654 *((
UI¡32
 *)(
tmp2
+0x10))=0;

655 *((
UI¡32
 *)(
tmp2
+0x14))=0;

656 *((
UI¡32
 *)(
tmp2
+8))=*((UI¡32 *)(
tmp0
+8));

657 *((
UI¡32
 *)(
tmp2
+0xC))=*((UI¡32 *)(
tmp0
+0xC));

658 *((
UI¡32
 *)(
tmp2
+0x10))=
tmp0
;

659 *((
UI¡32
 *)(
v¨4
+*((UI¡32 *)(
tmp0
+8))*4+0x306C))=
tmp2
;

660 
tmp2
=*((
UI¡32
 *)(
v¨4
+0x3058));

661 if((
SI¡32
)
tmp2
<0)

662 
tmp2
=0;

663 if(
tmp2
==0) {

664 
tmp2
=
v¨4
+*((
UI¡32
 *)(var4+0x3068))*24+8;

665 *((
UI¡32
 *)(
v¨4
+0x3068))+=1;

667 
tmp1
=
	`Sub_WavU≈2
(0,*((
UI¡32
 *)
v¨8
),
tmp2
);

668 if(*((
UI¡32
 *)
tmp1
)) {

669 
tmp3
=
	`Sub_WavU≈5
(
tmp1
);

670 *((
UI¡32
 *)
tmp3
)=*((UI¡32 *)
tmp1
);

671 
tmp3
=*((
UI¡32
 *)
tmp1
);

672 *((
UI¡32
 *)(
tmp3
+4))=*((UI¡32 *)(
tmp1
+4));

673 *((
UI¡32
 *)
tmp1
)=0;

674 *((
UI¡32
 *)(
tmp1
+4))=0;

676 *((
UI¡32
 *)
tmp1
)=
v¨8
+4;

677 *((
UI¡32
 *)(
tmp1
+4))=*((UI¡32 *)(
v¨8
+8));

678 
tmp3
=
	`Sub_WavU≈2
(0,*((
UI¡32
 *)
v¨8
),
	`Sub_WavU≈7
(var8+4));

679 *((
UI¡32
 *)
tmp3
)=
tmp1
;

680 
tmp3
=
¨g1
;

681 *((
UI¡32
 *)(
v¨8
+8))=
tmp2
;

682 *((
UI¡32
 *)(
tmp2
+0x14))=0;

683 *((
UI¡32
 *)(
tmp2
+8))=
tmp3
;

684 *((
UI¡32
 *)(
tmp2
+0xC))=0;

685 *((
UI¡32
 *)(
tmp2
+0x10))=
tmp0
;

686 *((
UI¡32
 *)(
v¨4
+
tmp3
*4+0x306C))=
tmp2
;

687 *((
UI¡32
 *)(
tmp0
+0x14))=
tmp2
;

688 
tmp2
) {

689 
tmp4
=
tmp2
;

690 *((
UI¡32
 *)(
tmp2
+0xC))+=1;

691 
tmp3
=*((
UI¡32
 *)(
tmp2
+0xC));

693 
tmp1
=*((
UI¡32
 *)(
tmp4
+4));

694 if((
SI¡32
)
tmp1
<=0) {

695 
tmp1
=0;

698 if(*((
UI¡32
 *)(
tmp1
+0xC))>=
tmp3
)

700 
tmp4
=
tmp1
;

702 if(
tmp4
!=
tmp2
) {

703 
	`Sub_WavU≈4
(
tmp4
,2,
tmp2
,
v¨8
);

704 
	`Sub_WavU≈4
(
tmp2
,2,
tmp1
,
v¨8
);

705 
tmp3
=*((
UI¡32
 *)(
tmp4
+0x10));

706 
tmp1
=*((
UI¡32
 *)(
tmp2
+0x10));

707 
tmp0
=*((
UI¡32
 *)(
tmp3
+0x14));

708 
tmp3
=*((
UI¡32
 *)(
tmp1
+0x14));

709 if(
tmp3
==
tmp2
)

710 *((
UI¡32
 *)(
tmp1
+0x14))=
tmp4
;

711 if(
tmp0
==
tmp4
) {

712 
tmp1
=*((
UI¡32
 *)(
tmp4
+0x10));

713 *((
UI¡32
 *)(
tmp1
+0x14))=
tmp2
;

715 
tmp3
=*((
UI¡32
 *)(
tmp2
+0x10));

716 *((
UI¡32
 *)(
tmp2
+0x10))=*((UI¡32 *)(
tmp4
+0x10));

717 *((
UI¡32
 *)(
tmp4
+0x10))=
tmp3
;

718 *((
UI¡32
 *)(
v¨4
+4))+=1;

720 
tmp2
=*((
UI¡32
 *)(tmp2+0x10));

723 
	}
}

727 
	$Sub_WavU≈6
(
UI¡32
 
±r_ba£
)

729 
UI¡32
 
±r1
=0;

730 
SI¡32
 
i
=0;

733 
±r1
=
±r_ba£
+8;

734 
i
=0x203;i!=0;i--) {

735 *((
UI¡32
 *)
±r1
)=0;

736 *((
UI¡32
 *)(
±r1
+4))=0;

737 
±r1
+=0x18;

739 
±r1
=
±r_ba£
+0x3054;

740 *((
UI¡32
 *)
±r1
)=0;

741 *((
UI¡32
 *)(
±r1
+4))=0;

742 *((
UI¡32
 *)
±r1
)=ptr1;

743 *((
UI¡32
 *)(
±r_ba£
+0x3050))=0;

744 *((
UI¡32
 *)(
±r_ba£
+0x3058))=~
±r1
;

745 
±r1
=
±r_ba£
+0x3060;

746 *((
UI¡32
 *)
±r1
)=0;

747 *((
UI¡32
 *)(
±r1
+4))=0;

748 *((
UI¡32
 *)
±r1
)=(UInt32)Ötr1;

749 *((
UI¡32
 *)(
±r_ba£
+0x305C))=0;

750 *((
UI¡32
 *)(
±r_ba£
+0x3064))=~
±r1
;

751 *((
UI¡32
 *)(
±r_ba£
+0x3068))=0;

752 *((
UI¡32
 *)(
±r_ba£
+4))=1;

754 
	}
}

758 
UI¡32
 
	$Sub_WavU≈2
(
UI¡32
 
¨g1
,UI¡32 
¨g2
,UI¡32 
¨g3
)

760 if(
¨g1
)

761  
¨g3
+
¨g2
;

762  
¨g3
;

763 
	}
}

767 
	$Sub_WavU≈3
(
UI¡32
 
±r
)

769 
UI¡32
 
±r0
=0,
±r1
=0;

772 
±r0
=*((
UI¡32
 *)
±r
);

773 if(
±r0
) {

774 
±r1
=*((
UI¡32
 *)(
±r
+4));

775 if((
SI¡32
)
±r1
<0)

776 
±r1
=~ptr1;

778 
±r1
ıå1+
±r
-*((
UI¡32
 *)(
±r0
+4));

779 *((
UI¡32
 *)
±r1
)=
±r0
;

780 *((
UI¡32
 *)(
±r0
+4))=*((UI¡32 *)(
±r
+4));

781 *((
UI¡32
 *)
±r
)=0;

782 *((
UI¡32
 *)(
±r
+4))=0;

785 
	}
}

789 
	$Sub_WavU≈4
(
UI¡32
 
¨g1
,UI¡32 
¨g2
,UI¡32 
¨g3
,UI¡32 
¨g4
)

791 
UI¡32
 
tmp0
=0,
tmp1
=0;

794 
tmp0
=*((
UI¡32
 *)
¨g1
);

795 if(
tmp0
) {

796 
tmp1
=*((
UI¡32
 *)(
¨g1
+4));

797 if((
SI¡32
)
tmp1
<0)

798 
tmp1
=~tmp1;

800 
tmp1
+=
¨g1
-*((
UI¡32
 *)(
tmp0
+4));

801 *((
UI¡32
 *)
tmp1
)=(UI¡32)
tmp0
;

802 *((
UI¡32
 *)(
tmp0
+4))=*((UI¡32 *)(
¨g1
+4));

803 *((
UI¡32
 *)
¨g1
)=0;

804 *((
UI¡32
 *)(
¨g1
+4))=0;

806 if(
¨g3
==0)

807 
¨g3
=
¨g4
+4;

808 if(
¨g2
-1) {

809 if((
¨g2
-2)==0) {

810 
tmp1
=*((
UI¡32
 *)
¨g3
);

811 *((
UI¡32
 *)
¨g1
)=
tmp1
;

812 *((
UI¡32
 *)(
¨g1
+4))=*((UI¡32 *)(
tmp1
+4));

813 *((
UI¡32
 *)(
tmp1
+4))=
¨g1
;

814 *((
UI¡32
 *)
¨g3
)=
¨g1
;

818 *((
UI¡32
 *)
¨g1
)=
¨g3
;

819 *((
UI¡32
 *)(
¨g1
+4))=*((UI¡32 *)(
¨g3
+4));

820 
tmp1
=*((
UI¡32
 *)(
¨g3
+4));

821 if((
SI¡32
)
tmp1
<=0)

822 
tmp1
=~tmp1;

823 *((
UI¡32
 *)
tmp1
)=
¨g1
;

824 *((
UI¡32
 *)(
¨g3
+4))=
¨g1
;

826 
	}
}

830 
UI¡32
 
	$Sub_WavU≈5
(
UI¡32
 
¨g1
)

832 
UI¡32
 
tmp0
=0,
tmp1
=0;

835 
tmp0
=*((
UI¡32
 *)(
¨g1
+4));

836 if((
SI¡32
)
tmp0
<0)

837  ~
tmp0
;

838 
tmp1
=*((
UI¡32
 *)
¨g1
);

839 
tmp0
+=
¨g1
-*((
UI¡32
 *)(
tmp1
+4));

840  
tmp0
;

841 
	}
}

845 
UI¡32
 
	$Sub_WavU≈7
(
UI¡32
 
¨g1
)

847 
UI¡32
 
tmp
=0;

850 
tmp
=*((
UI¡32
 *)(
¨g1
+4));

851 if((
SI¡32
)
tmp
<=0)

852  ~
tmp
;

853  
tmp
;

854 
	}
}

858 
UI¡32
 
	$Sub_WavU≈8
(
UI¡32
 
¨g1
)

860 
UI¡32
 
tmp0
=0,
tmp1
=0;

863 
tmp0
=*((
UI¡32
 *)(
¨g1
+4));

864 *((
UI¡32
 *)(
¨g1
+4))=
tmp0
>>1;

865 
tmp0
&=1;

866 *((
UI¡32
 *)(
¨g1
+8))-=1;

867 if(*((
UI¡32
 *)(
¨g1
+8))==0) {

868 
tmp1
=*((
UI¡32
 *)
¨g1
);

869 *((
UI¡32
 *)
¨g1
)+=4;

870 *((
UI¡32
 *)(
¨g1
+4))=*((UI¡32 *)
tmp1
);

871 *((
UI¡32
 *)(
¨g1
+8))=0x20;

873  
tmp0
;

874 
	}
}

878 
	$Sub_WavU≈10
(
UI¡32
 
¨g1
,UI¡32 
¨g2
)

880 
UI¡32
 
tmp0
=0,
tmp1
=0,
tmp2
=0,
tmp3
=0,
¨g2_ﬁd
=0;

883 
¨g2_ﬁd
=
¨g2
;

884 
¨g1
) {

885 
tmp2
=
¨g1
;

886 *((
UI¡32
 *)(
¨g1
+0xC))+=1;

887 
tmp3
=*((
UI¡32
 *)(
¨g1
+0xC));

889 
tmp0
=*((
UI¡32
 *)(
tmp2
+4));

890 if((
SI¡32
)
tmp0
<=0) {

891 
tmp0
=0;

894 if(*((
UI¡32
 *)(
tmp0
+0xC))>=
tmp3
)

896 
tmp2
=
tmp0
;

898 if(
tmp2
!=
¨g1
) {

899 if(*((
UI¡32
 *)
tmp2
)) {

900 
tmp3
=
	`Sub_WavU≈5
(
tmp2
);

901 *((
UI¡32
 *)
tmp3
)=*((UI¡32 *)
tmp2
);

902 
tmp1
=*((
UI¡32
 *)
tmp2
);

903 *((
UI¡32
 *)(
tmp1
+4))=*((UI¡32 *)(
tmp2
+4));

904 *((
UI¡32
 *)
tmp2
)=0;

905 *((
UI¡32
 *)(
tmp2
+4))=0;

907 
tmp1
=
¨g1
;

908 if(
tmp1
==0)

909 
tmp1
=
¨g2
+0x3060;

910 
tmp3
=*((
UI¡32
 *)
tmp1
);

911 *((
UI¡32
 *)
tmp2
)=
tmp3
;

912 *((
UI¡32
 *)(
tmp2
+4))=*((UI¡32 *)(
tmp3
+4));

913 *((
UI¡32
 *)
tmp1
)=
tmp2
;

914 
¨g2
=
	`Sub_WavU≈2
(0,*((
UI¡32
 *)◊rg2+0x205C)),
¨g1
);

915 if(*((
UI¡32
 *)
¨g2
)) {

916 
tmp3
=
	`Sub_WavU≈5
(
¨g2
);

917 *((
UI¡32
 *)
tmp3
)=*((UI¡32 *)
¨g2
);

918 
tmp1
=*((
UI¡32
 *)
¨g2
);

919 *((
UI¡32
 *)(
tmp1
+4))=*((UI¡32 *)(
¨g2
+4));

920 *((
UI¡32
 *)
¨g2
)=0;

921 *((
UI¡32
 *)(
¨g2
+4))=0;

923 if(
tmp0
)

924 
tmp3
=
	`Sub_WavU≈2
(0,*((
UI¡32
 *)(
¨g2_ﬁd
+0x305C)),
tmp0
);

926 
tmp3
=
¨g2_ﬁd
+0x3060;

927 
tmp1
=*((
UI¡32
 *)
tmp3
);

928 *((
UI¡32
 *)
¨g2
)=
tmp1
;

929 
tmp0
=*((
UI¡32
 *)(
tmp1
+4));

930 *((
UI¡32
 *)(
¨g2
+4))=
tmp0
;

931 *((
UI¡32
 *)(
tmp1
+4))=
¨g1
;

932 *((
UI¡32
 *)
tmp3
)=
¨g2
;

933 
tmp3
=*((
UI¡32
 *)(
tmp2
+0x10));

934 
tmp1
=*((
UI¡32
 *)(
tmp3
+0x14));

935 
tmp3
=*((
UI¡32
 *)(
¨g1
+0x10));

936 if(*((
UI¡32
 *)(
tmp3
+0x14))==
¨g1
)

937 *((
UI¡32
 *)(
tmp3
+0x14))=
tmp2
;

938 if(
tmp1
==
tmp2
) {

939 
tmp1
=*((
UI¡32
 *)(
tmp2
+0x10));

940 *((
UI¡32
 *)(
tmp1
+0x14))=
¨g1
;

942 
tmp3
=*((
UI¡32
 *)(
¨g1
+0x10));

943 *((
UI¡32
 *)(
¨g1
+0x10))=*((UI¡32 *)(
tmp2
+0x10));

944 *((
UI¡32
 *)(
tmp2
+0x10))=
tmp3
;

945 
¨g2
=
¨g2_ﬁd
;

946 *((
UI¡32
 *)(
¨g2_ﬁd
+4))+=1;

948 
¨g1
=*((
UI¡32
 *)(arg1+0x10));

951 
	}
}

953 #ifde‡
WIN32


954 #¥agm®
w¨nög
 (
p›
)

	@mpq/Wav_unp.h

3 
	~"mpqTy≥s.h
"

5 
UI¡8
 
	gwav_èbÀ
[2512] =

322 
UI¡32
 
	gsmÆl_tbl1
[90] =

335 
UI¡32
 
	gsmÆl_tbl2
[32] =

	@mpq/mpqtypes.h

1 #i‚de‡
_MPQTYPES_H_


3 
	#_MPQTYPES_H_


	)

5 
	~<°dio.h
>

7 
	#UI¡8
 

	)

8 
	#UI¡16
 

	)

9 
	#SI¡16
 

	)

10 
	#UI¡32
 

	)

11 
	#SI¡32
 

	)

13 
	#DWORD
 

	)

15 
	#MPQTYPES_MAX_PATH
 256

	)

19 
	sGLB_MPQ_S


21 
	mis_›í
;

23 
DWORD
 
	moff£t_mpq
;

24 
DWORD
 
	moff£t_htbl
;

25 
DWORD
 
	moff£t_btbl
;

26 
DWORD
 
	mÀnght_mpq_∑π
;

27 
DWORD
 
	mÀnght_htbl
;

28 
DWORD
 
	mÀnght_btbl
;

29 
DWORD
 *
	mhash_èbÀ
;

30 
DWORD
 *
	mblock_èbÀ
;

31 
DWORD
 
	mcou¡_fûes
;

32 
DWORD
 
	mmassive_ba£
[0x500];

33 *
	mfûíame_èbÀ
;

34 *
	midítify_èbÀ
;

36 
	mfûe_«me
[257];

37 
	mw‹k_dú
[
MPQTYPES_MAX_PATH
];

38 
	m¥nbuf
[
MPQTYPES_MAX_PATH
+100];

39 
	mdeÁu…_li°
[
MPQTYPES_MAX_PATH
];

40 
FILE
 *
	mÂMpq
;

43 
DWORD
 
	mavaû_mëods
[4];

44 
DWORD
 
	mÀnght_wrôe
;

45 
UI¡8
 * 
	mglobÆ_buf„r
, * 
	mªad_buf„r_°¨t
, * 
	mwrôe_buf„r_°¨t
, * 
	mex∂ode_buf„r
;

46 
UI¡32
 * 
	mfûe_hódî
;

47 } 
	tGLB_MPQ_S
;

49 
GLB_MPQ_S
 * 
glb_mpq
;

	@msg_quit.c

1 
	~"°ru˘s.h
"

2 
	~"wMsg.h
"

3 
	~"msg_quô.h
"

13 
	$msg_quô_maö
()

15 
WMSG_BUT_S
 
buâ⁄s
[4];

16 
WMSG_S
 
wmsg_quô
;

17 
cﬁ_bœck
 = 
	`makecﬁ
(0, 0, 0),

18 
cﬁ_midgªí
 = 
	`makecﬁ
(0, 128, 0),

19 
cﬁ_whôe
 = 
	`makecﬁ
(255, 255, 255),

20 
cﬁ_gªí
 = 
	`makecﬁ
(0, 255, 0);

24 
	`mem£t
(
buâ⁄s
, 0, (buttons));

27 
buâ⁄s
[0].
ãxt
 = "(S) SAVE ALL & QUIT";

28 
buâ⁄s
[0].
right_•a˚s
 = 3;

29 
buâ⁄s
[0].
⁄
.
fg
 = 
cﬁ_bœck
;

30 
buâ⁄s
[0].
⁄
.
bg
 = 
cﬁ_midgªí
;

31 
buâ⁄s
[0].
⁄
.
b‹dî
 = 
cﬁ_whôe
;

32 
buâ⁄s
[0].
off
.
fg
 = 
cﬁ_gªí
;

33 
buâ⁄s
[0].
off
.
bg
 = 
cﬁ_bœck
;

34 
buâ⁄s
[0].
off
.
b‹dî
 = 
cﬁ_gªí
;

35 
buâ⁄s
[0].
sh‹tcut
[0].
key
[0] = 
KEY_S
;

38 
buâ⁄s
[1].
ãxt
 = " (Q) QUIT ";

39 
buâ⁄s
[1].
right_•a˚s
 = 3;

40 
buâ⁄s
[1].
⁄
.
fg
 = 
cﬁ_bœck
;

41 
buâ⁄s
[1].
⁄
.
bg
 = 
cﬁ_midgªí
;

42 
buâ⁄s
[1].
⁄
.
b‹dî
 = 
cﬁ_whôe
;

43 
buâ⁄s
[1].
off
.
fg
 = 
cﬁ_gªí
;

44 
buâ⁄s
[1].
off
.
bg
 = 
cﬁ_bœck
;

45 
buâ⁄s
[1].
off
.
b‹dî
 = 
cﬁ_gªí
;

46 
buâ⁄s
[1].
sh‹tcut
[0].
key
[0] = 
KEY_A
;

47 
buâ⁄s
[1].
sh‹tcut
[1].
key
[0] = 
KEY_Q
;

50 
buâ⁄s
[2].
ãxt
 = " (Esc) CANCEL ";

51 
buâ⁄s
[2].
right_•a˚s
 = 0;

52 
buâ⁄s
[2].
⁄
.
fg
 = 
cﬁ_bœck
;

53 
buâ⁄s
[2].
⁄
.
bg
 = 
cﬁ_midgªí
;

54 
buâ⁄s
[2].
⁄
.
b‹dî
 = 
cﬁ_whôe
;

55 
buâ⁄s
[2].
off
.
fg
 = 
cﬁ_gªí
;

56 
buâ⁄s
[2].
off
.
bg
 = 
cﬁ_bœck
;

57 
buâ⁄s
[2].
off
.
b‹dî
 = 
cﬁ_gªí
;

58 
buâ⁄s
[2].
sh‹tcut
[0].
key
[0] = 
KEY_ESC
;

61 
wmsg_quô
.
tôÀ
 = "WARNING";

62 
wmsg_quô
.
ãxt
 = "\nYouáreáboutÅo quitÅhe DS1 Editor. What do you wantÅo do ?";

63 
wmsg_quô
.
f⁄t_width
 = 8;

64 
wmsg_quô
.
f⁄t_height
 = 8;

65 
wmsg_quô
.
cﬁ_wö
.
bg
 = 
cﬁ_bœck
;

66 
wmsg_quô
.
cﬁ_wö
.
fg
 = 
cﬁ_whôe
;

67 
wmsg_quô
.
cﬁ_tôÀ
.
bg
 = 
cﬁ_gªí
;

68 
wmsg_quô
.
cﬁ_tôÀ
.
fg
 = 
cﬁ_bœck
;

69 
wmsg_quô
.
cﬁ_ãxt
.
bg
 = -1;

70 
wmsg_quô
.
cﬁ_ãxt
.
fg
 = 
cﬁ_gªí
;

71 
wmsg_quô
.
buâ⁄
 = & 
buâ⁄s
[0];

73  
	`wmsg_maö
–& 
wmsg_quô
);

74 
	}
}

	@msg_quit.h

1 #i‚de‡
_MSG_QUIT_H_


3 
	#_MSG_QUIT_H_


	)

5 
msg_quô_maö
();

	@msg_save.c

1 
	~"°ru˘s.h
"

2 
	~"wMsg.h
"

3 
	~"msg_ßve.h
"

12 
	$msg_ßve_maö
()

14 
WMSG_BUT_S
 
buâ⁄s
[2];

15 
WMSG_S
 
wmsg_ßve
;

16 
cﬁ_bœck
 = 
	`makecﬁ
(0, 0, 0),

17 
cﬁ_midgªí
 = 
	`makecﬁ
(0, 128, 0),

18 
cﬁ_whôe
 = 
	`makecﬁ
(255, 255, 255),

19 
cﬁ_gªí
 = 
	`makecﬁ
(0, 255, 0);

23 
	`mem£t
(
buâ⁄s
, 0, (buttons));

26 
buâ⁄s
[0].
ãxt
 = " OK ";

27 
buâ⁄s
[0].
right_•a˚s
 = 0;

28 
buâ⁄s
[0].
⁄
.
fg
 = 
cﬁ_bœck
;

29 
buâ⁄s
[0].
⁄
.
bg
 = 
cﬁ_midgªí
;

30 
buâ⁄s
[0].
⁄
.
b‹dî
 = 
cﬁ_whôe
;

31 
buâ⁄s
[0].
off
.
fg
 = 
cﬁ_gªí
;

32 
buâ⁄s
[0].
off
.
bg
 = 
cﬁ_bœck
;

33 
buâ⁄s
[0].
off
.
b‹dî
 = 
cﬁ_gªí
;

34 
buâ⁄s
[0].
sh‹tcut
[0].
key
[0] = 
KEY_ENTER
;

35 
buâ⁄s
[0].
sh‹tcut
[1].
key
[0] = 
KEY_ENTER_PAD
;

36 
buâ⁄s
[0].
sh‹tcut
[2].
key
[0] = 
KEY_ESC
;

39 
wmsg_ßve
.
tôÀ
 = "Information";

40 
wmsg_ßve
.
ãxt
 = "\nYour DS1 has been saved";

41 
wmsg_ßve
.
f⁄t_width
 = 8;

42 
wmsg_ßve
.
f⁄t_height
 = 8;

43 
wmsg_ßve
.
cﬁ_wö
.
bg
 = 
cﬁ_bœck
;

44 
wmsg_ßve
.
cﬁ_wö
.
fg
 = 
cﬁ_whôe
;

45 
wmsg_ßve
.
cﬁ_tôÀ
.
bg
 = 
cﬁ_gªí
;

46 
wmsg_ßve
.
cﬁ_tôÀ
.
fg
 = 
cﬁ_bœck
;

47 
wmsg_ßve
.
cﬁ_ãxt
.
bg
 = -1;

48 
wmsg_ßve
.
cﬁ_ãxt
.
fg
 = 
cﬁ_gªí
;

49 
wmsg_ßve
.
buâ⁄
 = & 
buâ⁄s
[0];

51  
	`wmsg_maö
–& 
wmsg_ßve
);

52 
	}
}

	@msg_save.h

1 #i‚de‡
_MSG_SAVE_H_


3 
	#_MSG_SAVE_H_


	)

5 
msg_ßve_maö
();

	@structs.h

1 #i‚de‡
_WINDS1EDIT_STRUCTS_H_


3 
	#_WINDS1EDIT_STRUCTS_H_


	)

6 
	#USE_CONSOLE


	)

8 
	~"ty≥s.h
"

9 
	~<°dio.h
>

10 
	~<°rög.h
>

11 
	~<ÆÀgro.h
>

12 
	~"mpq\\mpqty≥s.h
"

14 
	#MAX_MPQ_FILE
 4

	)

15 
	#MAX_MOD_DIR
 1

	)

16 
	#DT1_IN_DS1_MAX
 33

	)

17 
	#DS1_MAX
 100

	)

18 
	#DT1_MAX
 300

	)

19 
	#ACT_MAX
 5

	)

20 
	#FLOOR_MAX_LAYER
 2

	)

21 
	#SHADOW_MAX_LAYER
 1

	)

22 
	#TAG_MAX_LAYER
 1

	)

23 
	#WALL_MAX_LAYER
 4

	)

24 
	#OBJ_MAX_START
 100

	)

25 
	#OBJ_MAX_GRANULARITY
 50

	)

26 
	#WINDS1EDIT_PATH_MAX
 100

	)

28 
	#TXT_COL_NAME_LENGTH
 30

	)

30 
	#FLG_SELECTED
 1

	)

31 
	#FLG_HIDE
 2

	)

32 
	#FLG_TMP_SELECT
 4

	)

33 
	#FLG_COPY_INFO
 8

	)

34 
	#FLG_COPY_STATE
 16

	)

37 
	#FLG_MOUSE_OVER
 32

	)

38 
	#FLG_MOVING
 64

	)

39 
	#FLG_ACTIVATED
 128

	)

41 
	#IS_SELECTED
(
x
Ë((xË& 
FLG_SELECTED
)

	)

42 
	#IS_HIDE
(
x
Ë((xË& 
FLG_HIDE
)

	)

43 
	#IS_TMP_SELECT
(
x
Ë((xË& 
FLG_TMP_SELECT
)

	)

44 
	#IS_COPY_INFO
(
x
Ë((xË& 
FLG_COPY_INFO
)

	)

45 
	#IS_COPY_STATE
(
x
Ë((xË& 
FLG_COPY_STATE
)

	)

46 
	#IS_MOUSE_OVER
(
x
Ë((xË& 
FLG_MOUSE_OVER
)

	)

47 
	#IS_MOVING
(
x
Ë((xË& 
FLG_MOVING
)

	)

48 
	#IS_ACTIVATED
(
x
Ë((xË& 
FLG_ACTIVATED
)

	)

50 
	#SET_SELECTED
(
x
Ë((xË|
FLG_SELECTED
)

	)

51 
	#SET_HIDE
(
x
Ë((xË|
FLG_HIDE
)

	)

52 
	#SET_TMP_SELECT
(
x
Ë((xË|
FLG_TMP_SELECT
)

	)

53 
	#SET_COPY_INFO
(
x
Ë((xË|
FLG_COPY_INFO
)

	)

54 
	#SET_COPY_STATE
(
x
Ë((xË|
FLG_COPY_STATE
)

	)

55 
	#SET_MOUSE_OVER
(
x
Ë((xË|
FLG_MOUSE_OVER
)

	)

56 
	#SET_MOVING
(
x
Ë((xË|
FLG_MOVING
)

	)

57 
	#SET_ACTIVATED
(
x
Ë((xË|
FLG_ACTIVATED
)

	)

59 
	#DEL_SELECTED
(
x
Ë((xË&~
FLG_SELECTED
)

	)

60 
	#DEL_HIDE
(
x
Ë((xË&~
FLG_HIDE
)

	)

61 
	#DEL_TMP_SELECT
(
x
Ë((xË&~
FLG_TMP_SELECT
)

	)

62 
	#DEL_COPY_INFO
(
x
Ë((xË&~
FLG_COPY_INFO
)

	)

63 
	#DEL_COPY_STATE
(
x
Ë((xË&~
FLG_COPY_STATE
)

	)

64 
	#DEL_MOUSE_OVER
(
x
Ë((xË&~
FLG_MOUSE_OVER
)

	)

65 
	#DEL_MOVING
(
x
Ë((xË&~
FLG_MOVING
)

	)

66 
	#DEL_ACTIVATED
(
x
Ë((xË&~
FLG_ACTIVATED
)

	)

69 
	#DF_P1
 1

	)

70 
	#DF_P2
 2

	)

71 
	#DF_P3
 4

	)

72 
	#DF_P4
 8

	)

73 
	#DF_OR
 16

	)

74 
	#DF_BT
 32

	)

75 
	#DF_FL
 64

	)

78 
	#MW_SHORTCUT_NUM
 5

	)

79 
	#MW_COMBINATION_KEY_NUM
 5

	)

82 
	#COF_25TRANS
 53

	)

83 
	#COF_50TRANS
 309

	)

84 
	#COF_75TRANS
 565

	)

85 
	#COF_ALPHA
 821

	)

86 
	#COF_LUMINANCE
 1077

	)

87 
	#COF_ALPHABRIGHT
 1461

	)

89 
glb_tûes_∑th
 [30];

90 
glb_ds1edô_d©a_dú
 [80];

91 
glb_ds1edô_tmp_dú
 [80];

92 
GLB_MPQ_S
 
glb_mpq_°ru˘
 [
MAX_MPQ_FILE
];

94 
	sSCREEN_S


96 
	mwidth
;

97 
	mheight
;

98 
	mdïth
;

99 
	mª‰esh
;

100 } 
	tSCREEN_S
;

102 
	sXY_S


104 
	mx
;

105 
	my
;

106 } 
	tXY_S
;

108 
	sSCROLL_S


110 
XY_S
 
	mkeyb
;

111 
XY_S
 
	mmou£
;

112 
XY_S
 
	medô
;

113 
	mobj_edô
;

114 } 
	tSCROLL_S
;

116 
	eGC_ENUM


118 
	mGC_060
, 
	mGC_062
, 
	mGC_064
, 
	mGC_066
, 
	mGC_068
,

119 
	mGC_070
, 
	mGC_072
, 
	mGC_074
, 
	mGC_076
, 
	mGC_078
,

120 
	mGC_080
, 
	mGC_082
, 
	mGC_084
, 
	mGC_086
, 
	mGC_088
,

121 
	mGC_090
, 
	mGC_092
, 
	mGC_094
, 
	mGC_096
, 
	mGC_098
,

122 
	mGC_100
,

123 
	mGC_110
, 
	mGC_120
, 
	mGC_130
, 
	mGC_140
, 
	mGC_150
,

124 
	mGC_160
, 
	mGC_170
, 
	mGC_180
, 
	mGC_190
, 
	mGC_200
,

125 
	mGC_210
, 
	mGC_220
, 
	mGC_230
, 
	mGC_240
, 
	mGC_250
,

126 
	mGC_260
, 
	mGC_270
, 
	mGC_280
, 
	mGC_290
, 
	mGC_300
,

127 
	mGC_MAX


128 } 
	tGC_ENUM
;

130 
	sGAMMA_S


132 
	m°r
[5];

133 
GC_ENUM
 
	mvÆ
;

134 } 
	tGAMMA_S
;

136 
GAMMA_S
 
glb_gamma_°r
[
GC_MAX
];

138 
	sCONFIG_S


140 
	mfuŒs¸ìn
;

141 * 
	mmpq_fûe
[
MAX_MPQ_FILE
];

142 * 
	mmod_dú
[
MAX_MOD_DIR
];

143 
SCREEN_S
 
	ms¸ìn
;

144 
SCROLL_S
 
	ms¸ﬁl
;

145 
GC_ENUM
 
	mgamma
;

146 
XY_S
 
	mmou£_•ìd
;

147 
	mn‹mÆ_ty≥2
;

148 
	mÆways_max_œyîs
;

149 
	m°ªtch_•rôes
;

150 
	mwöobj_s¸ﬁl_keyb
;

151 
	mwöobj_s¸ﬁl_mou£
;

152 
	m˚¡î_zoom
;

153 
	mnb_ty≥1_≥r_a˘
;

154 
	mnb_ty≥2_≥r_a˘
;

155 
	mmöimize_ds1
;

156 
	mlowî_•ìd_zoom_out
;

157 
	mw‹k•a˚_íabÀ
;

158 } 
	tCONFIG_S
;

160 
CONFIG_S
 
glb_c⁄fig
;

162 
	sWIN_PREVIEW_S


164 
	mx0
;

165 
	my0
;

166 
	mw
;

167 
	mh
;

168 } 
	tWIN_PREVIEW_S
;

170 
	eBUT_STATE_E


172 
	mBS_OFF
,

173 
	mBS_ON


174 } 
	tBUT_STATE_E
;

176 
	sBUTTON_S


178 
	mx0
, 
	my0
;

179 
	mw
, 
	mh
;

180 
	ma˘ive
;

181 
	mèb_have_tûes
;

182 
BUT_STATE_E
 
	m°©e
;

183 
	mmou£_ovî
;

184 
BITMAP
 * 
	mbmp
[2];

185 } 
	tBUTTON_S
;

187 
	eBLK_TYP_E


189  
	mBT_NULL
,

190  
	mBT_STATIC
, 
	mBT_ANIMATED
,

191  
	mBT_WALL_UP
, 
	mBT_WALL_DOWN
, 
	mBT_ROOF
, 
	mBT_SPECIAL
, 
	mBT_WALL_ANIMATED
,

192  
	mBT_SHADOW
,

193 
	mBT_MAX


194 } 
	tBLK_TYP_E
;

196 
	eBUT_TYP_E


198  
	mBU_NULL
,

199  
	mBU_FLOOR1
, 
	mBU_FLOOR2
,

200  
	mBU_SHADOW
,

201  
	mBU_WALL1
, 
	mBU_WALL2
, 
	mBU_WALL3
, 
	mBU_WALL4
,

202  
	mBU_OK
, 
	mBU_CANCEL
,

203  
	mBU_VIEW_RAND
,

204 
	mBU_MAX


205 } 
	tBUT_TYP_E
;

207 
	sWIN_ELEMENT_S


210 
	mb_x0
, 
	mb_y0
;

211 
RLE_SPRITE
 * 
	mb‹dî
;

214 
	mi_x0
, 
	mi_y0
;

215 
BITMAP
 * 
	möside
;

216 } 
	tWIN_ELEMENT_S
;

219 
	sSUB_ELM_S


221 
	mbt_idx_èb
;

222 
	mx1
;

223 
	my1
;

224 
	mx2
;

225 
	my2
;

226 
	mis_døw
;

227 } 
	tSUB_ELM_S
;

229 
	sMAIN_LINE_S


231 
SUB_ELM_S
 * 
	msub_ñm
;

232 
	mbt_idx_num
;

233 
	mmax_height
;

234 } 
	tMAIN_LINE_S
;

236 
	sWIN_EDIT_S


238 
BUTTON_S
 
	mbuâ⁄
 [
BU_MAX
];

239 
BUTTON_S
 
	mèb
 [
BT_MAX
];

240 
WIN_ELEMENT_S
 
	mw_¥evõw
;

241 
WIN_ELEMENT_S
 
	mw_tûes
;

242 
MAIN_LINE_S
 * 
	mmaö_löe_èb
[
BT_MAX
];

243 
	mmaö_löe_num
[
BT_MAX
];

244 
BITMAP
 * 
	mtmp_edô
;

245 } 
	tWIN_EDIT_S
;

247 
	eZOOM_E


249 
	mZM_11
,

250 
	mZM_12
,

251 
	mZM_14
,

252 
	mZM_18
,

253 
	mZM_116
,

254 
	mZM_MAX


255 } 
	tZOOM_E
;

258 
	eCMAP_E


260 
	mCM_SELECT
,

261 
	mCM_TRANS
,

262 
	mCM_SHADOW
,

263 
	mCM_MAX


264 } 
	tCMAP_E
;

266 
	eCOL_E


268 
	mCOL_FLOOR
 = 29,

269 
	mCOL_FLOOR_M
 = 32,

270 
	mCOL_WALL
 = 151,

271 
	mCOL_WALL_M
 = 162,

272 
	mCOL_MOUSE
 = 255,

273 
	mCOL_TMPSEL
 = 92,

274 
	mCOL_TMPSEL_M
 = 108,

275 
	mCOL_PASTE_OK
 = 132,

276 
	mCOL_PASTE_KO
 = 98,

277 
	mCOL_SHADOW
 = 168

278 } 
	tCOL_E
;

280 
	eMODE_E


282 
	mMOD_T
,

283 
	mMOD_O
,

284 
	mMOD_P
,

285 
	mMOD_L
,

286 
	mMOD_MAX


287 } 
	tMODE_E
;

290 
	#COMPOSIT_NB
 16

	)

292 
	sLAY_INF_S


294 
UBYTE
 
	mshad_a
;

295 
UBYTE
 
	mshad_b
;

296 
UBYTE
 
	må™s_a
;

297 
UBYTE
 
	må™s_b
;

298 
	mw˛ass
[4];

301 
	mbmp_num
;

302 
BITMAP
 ** 
	mbmp
;

303 
	moff_x
;

304 
	moff_y
;

305 
	mœ°_good_‰ame
;

306 } 
	tLAY_INF_S
;

308 
	sCOF_S


310 
UBYTE
 
	mœy
;

311 
UBYTE
 
	mÂd
;

312 
UBYTE
 
	mdú
;

313 
	mxoff£t
;

314 
	myoff£t
;

315 
LAY_INF_S
 
	mœy_öf
[
COMPOSIT_NB
];

316 
UBYTE
 * 
	m¥i‹ôy
;

317 
	mcur_‰ame
;

318 
	mcur_dú
;

319 
	m•d_mul
;

320 
	m•d_div
;

321 
	m•d_mod
;

322 
	m‹dîÊag
;

323 } 
	tCOF_S
;

325 
	sOBJ_DESC_S


327 
	ma˘
;

328 
	mty≥
;

329 
	mid
;

330 * 
	mdesc
;

331 
COF_S
 * 
	mcof
;

332 
	mobje˘s_löe
;

333 
	mm⁄°©s_löe
;

334 
	mußge_cou¡
;

335 } 
	tOBJ_DESC_S
;

339 
	sUNDO_DAT_FLG_S


341 
UBYTE
 
	mf
 [
FLOOR_MAX_LAYER
];

342 
UBYTE
 
	ms
 [
SHADOW_MAX_LAYER
];

343 
UBYTE
 
	mw
 [
WALL_MAX_LAYER
];

344 } 
	tUNDO_DAT_FLG_S
;

346 
	sUNDO_S


348 
FILE
 * 
	mÂå
;

349 
	mbuf_num
;

350 
	mcur_buf_num
;

351 
	m«me
[150];

352 
	mèg
[4];

353 
	mö_£g
;

354 
	m£g_off£t
;

355 
UBYTE
 
	m£g_num
;

356 
	m˚Œ_off£t
;

357 
UBYTE
 
	m˚Œ_num
;

358 
UBYTE
 
	mﬁd_x
, 
	mﬁd_y
;

359 
UNDO_DAT_FLG_S
 
	md©_Êg
;

360 } 
	tUNDO_S
;

362 
	eCOL_TYPE_NM


364 
	mCT_NULL
,

365 
	mCT_STR
,

366 
	mCT_NUM


367 } 
	tCOL_TYPE_NM
;

369 
	sTXT_COL_S


372 
	m«me
[
TXT_COL_NAME_LENGTH
];

375 
	mpos
;

376 
COL_TYPE_NM
 
	mty≥
;

377 
	msize
;

378 
	moff£t
;

379 } 
	tTXT_COL_S
;

381 
	sTXT_S


383 * 
	md©a
;

384 
	mlöe_num
;

385 
	mlöe_size
;

386 
	mnb_ªquúed_cﬁs
;

387 
	mcﬁ_num
;

388 
TXT_COL_S
 * 
	mcﬁ
;

389 } 
	tTXT_S
;

391 #¥agm®
∑ck
(1)

393 
	sANIM_DATA_RECORD_S


395 
	mcof_«me
[8];

396 
	m‰ames_≥r_dú
;

397 
	m•ìd
;

398 
UBYTE
 
	mÊags
[144];

399 } 
	tANIM_DATA_RECORD_S
;

401 #¥agm®
∑ck
()

403 
	sANIM_DATA_S


405 * 
	mbuf„r
;

406 
	mbuf„r_size
;

407 
ANIM_DATA_RECORD_S
 * 
	mblock_poöãr
 [256];

408 
	mnb_ªc‹ds
 [256];

409 } 
	tANIM_DATA_S
;

412 
	sCMD_LINE_S


415 * 
	mds1_fûíame
;

418 * 
	möi_fûíame
;

421 
	mlv…y≥_id
;

424 
	mlvÕª°_def
;

427 
	mªsize_width
;

430 
	mªsize_height
;

433 
	mf‹˚_∑l_num
;

436 
	mno_check_a˘
;

439 
	mdt1_li°_num
;

442 * 
	mdt1_li°_fûíame
[
DT1_IN_DS1_MAX
];

445 
	mdebug_mode
;

448 
	mno_vis_debug
;

449 } 
	tCMD_LINE_S
;

452 
	eTILEGRID_ENUM


454 
	mTG_OFF
 = 0,

455 
	mTG_OVERFLOOR
,

456 
	mTG_OVERWALL
,

457 
	mTG_MAX


458 } 
	tTILEGRID_ENUM
;

460 
	sGLB_DS1EDIT_S


462 
UBYTE
 * 
	md2_∑l
 [
ACT_MAX
];

463 
	m∑l_size
 [
ACT_MAX
];

464 
PALETTE
 
	mvga_∑l
 [
ACT_MAX
];

465 
PALETTE
 
	mdummy_∑l
;

466 
	m∑l_lﬂded
[
ACT_MAX
];

467 
BITMAP
 * 
	mmou£_curs‹
[
MOD_MAX
];

468 
WIN_PREVIEW_S
 
	mwö_¥evõw
;

469 
WIN_EDIT_S
 
	mwö_edô
;

470 
BITMAP
 * 
	mbig_s¸ìn_buff
;

471 
BITMAP
 * 
	ms¸ìn_buff
;

472 
BITMAP
 * 
	mvideo_∑ge
[2];

473 
	mvideo_∑ge_num
;

474 
UBYTE
 
	mgamma_èbÀ
[
GC_MAX
][256];

475 
GC_ENUM
 
	mcur_gamma
;

476 vﬁ©ûê
	mﬁd_Âs
;

477 vﬁ©ûê
	mÂs
;

478 vﬁ©ûê
	mticks_ñ≠£d
;

479 
	ms¸ìnshŸ_num
;

480 
COLOR_MAP
 
	mcm≠
[
CM_MAX
][
ACT_MAX
];

481 
OBJ_DESC_S
 * 
	mobj_desc
;

482 
	mobj_desc_num
;

483 
MODE_E
 
	mmode
;

484 
RLE_SPRITE
 * 
	msubtûe_Êag
[9][
ZM_MAX
][25];

485 
RLE_SPRITE
 * 
	msubtûe_Êag_combö©i⁄
[256][
ZM_MAX
][25];

486 
RLE_SPRITE
 * 
	msubtûe_nowÆk
[
ZM_MAX
][25];

487 
RLE_SPRITE
 * 
	msubtûe_nojump
[
ZM_MAX
][25];

488 
BITMAP
 * 
	msubtûe_hñp
;

489 
	mnight_mode
;

490 
TXT_S
 * 
	mlv…y≥s_buff
;

491 
TXT_S
 * 
	mlvÕª°_buff
;

492 
TXT_S
 * 
	mobj_buff
;

493 
TXT_S
 * 
	mobje˘s_buff
;

494 
	m√w_dú1
[1],

495 
	m√w_dú4
[4],

496 
	m√w_dú8
[8],

497 
	m√w_dú16
[16],

498 
	m√w_dú32
[32];

499 
	mobj_‹dî_ds1_idx
;

500 
	mobj_sub_tûe_‹dî
[5][5];

501 
	mvîsi⁄
[15];

502 
	mcuºít_ª‰esh_øã
;

503 
	mcﬁ_obj_id
;

504 
	mcﬁ_obje˘s_id
;

505 
	mcﬁ_‰ame_dñè
[8];

506 
	mcﬁ_‹dîÊag
[8];

507 
ANIM_DATA_S
 
	m™im_d©a
;

508 
CMD_LINE_S
 
	mcmd_löe
;

509 
	mds1_group_idx
;

510 
	mshow_2nd_row
;

511 
	m°πmp
[512];

512 
TILEGRID_ENUM
 
	mdi•œy_tûe_grid
;

513 * 
	mvîsi⁄_buûd
;

514 * 
	mvîsi⁄_dŒ
;

515 } 
	tGLB_DS1EDIT_S
;

517 
GLB_DS1EDIT_S
 
glb_ds1edô
;

519 
	sBLOCK_TABLE_S


522 
	mdt1_idx_f‹_ds1
;

523 
	mmaö_ödex
;

524 
	m‹õ¡©i⁄
;

525 
	msub_ödex
;

528 
	mdt1_idx
;

529 
	mørôy
;

530 
	mblock_idx
;

531 
BLK_TYP_E
 
	mty≥
;

532 
	mzîo_löe
;

533 
	mroof_y
;

536 
	mc⁄Êi˘
;

537 
	mu£d_by_game
;

538 
	mu£d_by_edô‹
;

541 
	mcuº_‰ame
;

542 
	mupd©ed
;

543 } 
	tBLOCK_TABLE_S
;

545 
	sPATH_S


547 
	mx
;

548 
	my
;

549 
	ma˘i⁄
;

550 
	mÊags
;

551 } 
	tPATH_S
;

553 
	sOBJ_LABEL_S


555 
	mrx
, 
	mry
;

557 
	mw
, 
	mh
;

558 
	mx0
, 
	my0
;

559 
	mÊags
;

562 
	mﬁd_rx
;

563 
	mﬁd_ry
;

565 } 
	tOBJ_LABEL_S
;

567 
	sOBJ_S


569 
	mty≥
;

570 
	mid
;

571 
	mx
;

572 
	my
;

573 
	mds1_Êags
;

575 
PATH_S
 
	m∑th
[
WINDS1EDIT_PATH_MAX
];

576 
	m∑th_num
;

577 
	mdesc_idx
;

578 
	mÊags
;

579 
OBJ_LABEL_S
 
	mœbñ
;

582 
	mﬁd_x
;

583 
	mﬁd_y
;

586 
	mtx
;

587 
	mty
;

588 
	msx
;

589 
	msy
;

592 
UBYTE
 
	m‰ame_dñè
;

593 } 
	tOBJ_S
;

595 
	sBOX_S


597 
	mx1
, 
	my1
, 
	mx2
, 
	my2
;

598 } 
	tBOX_S
;

600 
	sEDT_BUT_S


602 
BOX_S
 
	mbox
;

603 
XY_S
 
	mtxt
;

604 
	m«me
[10];

605 
	mÊags
;

606 } 
	tEDT_BUT_S
;

608 
	eEDT_BUT_E


610 
	mEB_OK
, 
	mEB_CANCEL
, 
	mEB_TYPE1
, 
	mEB_TYPE2
,

611 
	mEB_ACT1
, 
	mEB_ACT2
, 
	mEB_ACT3
, 
	mEB_ACT4
, 
	mEB_ACT5
,

612 
	mEB_MAX


613 } 
	tEDT_BUT_E
;

615 
	sWIN_EDT_OBJ_S


618 
	mx0
, 
	my0
;

619 
	mw
, 
	mh
;

620 
	mobj_idx
;

621 
	mcur_ty≥
;

622 
	m°¨t_a˘
;

623 
	mcur_a˘
;

626 
EDT_BUT_S
 
	mbuâ⁄
[
EB_MAX
];

629 
	mnum
;

630 
	m°¨t
;

631 
	mcur
;

633 
	mdesc_ch¨
;

634 
	mdesc_°¨t
;

635 
	mdesc_num
;

636 
	mdesc_íd
;

637 
	mdesc_cur
;

638 } 
	tWIN_EDT_OBJ_S
;

640 
	sCELL_W_S


642 
UBYTE
 
	m¥›1
;

643 
UBYTE
 
	m¥›2
;

644 
UBYTE
 
	m¥›3
;

645 
UBYTE
 
	m¥›4
;

646 
UBYTE
 
	m‹õ¡©i⁄
;

647 
	mbt_idx
;

648 
UBYTE
 
	mÊags
;

649 } 
	tCELL_W_S
;

651 
	sCELL_F_S


653 
UBYTE
 
	m¥›1
;

654 
UBYTE
 
	m¥›2
;

655 
UBYTE
 
	m¥›3
;

656 
UBYTE
 
	m¥›4
;

657 
	mbt_idx
;

658 
UBYTE
 
	mÊags
;

659 } 
	tCELL_F_S
;

661 
	sCELL_S_S


663 
UBYTE
 
	m¥›1
;

664 
UBYTE
 
	m¥›2
;

665 
UBYTE
 
	m¥›3
;

666 
UBYTE
 
	m¥›4
;

667 
	mbt_idx
;

668 
UBYTE
 
	mÊags
;

669 } 
	tCELL_S_S
;

671 
	sCELL_T_S


674 
UDWORD
 
	mnum
;

675 
UBYTE
 
	mÊags
;

676 } 
	tCELL_T_S
;

678 
	sGROUP_S


680 
UDWORD
 
	mtûe_x
;

681 
UDWORD
 
	mtûe_y
;

682 
UDWORD
 
	mwidth
;

683 
UDWORD
 
	mheight
;

684 
UDWORD
 
	munk
;

685 } 
	tGROUP_S
;

688 
	eOL_ENUM


690 
	mOL_NONE
,

691 
	mOL_TYPEID
,

692 
	mOL_SPEED
,

693 
	mOL_DESC
,

694 
	mOL_MAX


695 } 
	tOL_ENUM
;

698 
	sPATH_EDIT_BUT_COL_S


700 
	mbg
;

701 
	mfg
;

702 
	mb‹dî
;

703 } 
	tPATH_EDIT_BUT_COL_S
;

706 
	sPATH_EDIT_BUT_S


708 
	mshow
;

709 
	mx0
, 
	my0
, 
	mw
, 
	mh
;

710 * 
	mãxt
;

711 
	mãxt_x0
;

712 
PATH_EDIT_BUT_COL_S
 
	mcﬁ_⁄
;

713 
PATH_EDIT_BUT_COL_S
 
	mcﬁ_off
;

714 } 
	tPATH_EDIT_BUT_S
;

717 
	ePEB_E


719 
	mPEB_OK
,

720 
	mPEB_CANCEL
,

721 
	mPEB_ALLNEW
,

722 
	mPEB_STOP
,

723 
	mPEB_SETACTION
,

724 
	mPEB_MAX


725 } 
	tPEB_E
;

728 
	ePEM_E


730 
	mPEM_NONE
,

731 
	mPEM_ALLNEW
,

732 
	mPEM_MAX


733 } 
	tPEM_E
;

736 
	sPATH_EDIT_WIN_S


738 
	mx0
, 
	my0
;

739 
	mw
, 
	mh
;

740 
	mobj_idx
;

741 
	mobj_dúty
;

743 
	m∑th_°¨t_idx
;

746 
	mbut_x0
, 
	mbut_y0
;

747 
	mbut_w
, 
	mbut_h
;

748 
PATH_EDIT_BUT_S
 
	mbuâ⁄
[
PEB_MAX
];

751 
	mc_bœck
;

752 
	mc_whôe
;

753 
	mc_gªí
;

754 
	mc_d¨kgªí
;

755 
	mc_yñlow
;

756 
	mc_gøy
;

757 
	mc_d¨kgøy
;

760 
PATH_S
 
	m∑th_c›y
[
WINDS1EDIT_PATH_MAX
];

761 
	m∑th_c›y_num
;

764 
PEM_E
 
	mmode
;

767 
	mcuº_a˘i⁄
;

769 } 
	tPATH_EDIT_WIN_S
;

771 
	sDS1_S


773 
	mdt1_idx
[
DT1_IN_DS1_MAX
];

774 
	mdt1_mask
[
DT1_IN_DS1_MAX
];

775 
	mtxt_a˘
;

776 
BLOCK_TABLE_S
 * 
	mblock_èbÀ
;

777 
	mbt_num
;

778 
UBYTE
 
	mwÆl_œyî_mask
[
WALL_MAX_LAYER
];

779 
UBYTE
 
	mÊo‹_œyî_mask
[
FLOOR_MAX_LAYER
];

780 
	mshadow_œyî_mask
[
SHADOW_MAX_LAYER
];

781 
OL_ENUM
 
	mobje˘s_œyî_mask
;

782 
UBYTE
 
	m∑ths_œyî_mask
;

783 
UBYTE
 
	mwÆkabÀ_œyî_mask
;

784 
UBYTE
 
	m™im©i⁄s_œyî_mask
;

785 
UBYTE
 
	m•ecül_œyî_mask
;

786 
	msubtûe_hñp_di•œy
;

787 
	m«me
[256];

788 
	mfûíame
[50];

789 
UNDO_S
 
	mundo
;

792 
	mvîsi⁄
;

793 
	mèg_ty≥
;

794 
	mwidth
;

795 
	mheight
;

796 
	ma˘
;

799 
	mfûe_num
;

800 * 
	mfûe_buff
;

801 
	mfûe_Àn
;

804 
CELL_F_S
 * 
	mÊo‹_buff
,

805 * 
	mÊo‹_buff2
;

806 
	mÊo‹_buff_Àn
;

807 
	mÊo‹_num
;

808 
	mÊo‹_löe
;

809 
	mÊo‹_Àn
;

812 
CELL_S_S
 * 
	mshadow_buff
,

813 * 
	mshadow_buff2
;

814 
	mshadow_buff_Àn
;

815 
	mshadow_num
;

816 
	mshadow_löe
;

817 
	mshadow_Àn
;

820 
CELL_W_S
 * 
	mwÆl_buff
,

821 * 
	mwÆl_buff2
;

822 
	mwÆl_buff_Àn
;

823 
	mwÆl_num
;

824 
	mwÆl_löe
;

825 
	mwÆl_Àn
;

828 
CELL_T_S
 * 
	mèg_buff
,

829 * 
	mèg_buff2
;

830 
	mèg_buff_Àn
;

831 
	mèg_num
;

832 
	mèg_löe
;

833 
	mèg_Àn
;

836 
	mgroup_num
;

837 
	mgroup_size
;

838 
GROUP_S
 * 
	mgroup
;

841 
ZOOM_E
 
	mcur_zoom
;

842 
	mtûe_w
;

843 
	mtûe_h
;

844 
	mheight_mul
;

845 
	mheight_div
;

846 
SCROLL_S
 
	mcur_s¸ﬁl
;

849 
WIN_PREVIEW_S
 
	mown_w¥evõw
;

852 * 
	mdøwög_‹dî
;

853 
OBJ_S
 * 
	mobj
;

854 
OBJ_S
 * 
	mobj_undo
;

855 
	mobj_num
;

856 
	mobj_num_undo
;

857 
	mˇn_undo_obj
;

858 
	mdøw_edô_obj
;

859 
WIN_EDT_OBJ_S
 
	mwö_edt_obj
;

862 
	mcur_™im_Êo‹_‰ame
;

865 
PATH_EDIT_WIN_S
 
	m∑th_edô_wö
;

868 
UDWORD
 
	mßve_cou¡
;

871 
	mcuºít_obj_max
;

872 } 
	tDS1_S
;

874 
DS1_S
 * 
glb_ds1
;

876 
	sBLOCK_S


878 
	mdúe˘i⁄
;

879 
WORD
 
	mroof_y
;

880 
UBYTE
 
	msound
;

881 
UBYTE
 
	m™im©ed
;

882 
	msize_y
;

883 
	msize_x
;

885 
	m‹õ¡©i⁄
;

886 
	mmaö_ödex
;

887 
	msub_ödex
;

888 
	mørôy
;

895 
UBYTE
 
	msub_tûes_Êags
[25];

897 
	mtûes_±r
;

898 
	mtûes_Àngth
;

899 
	mtûes_numbî
;

901 } 
	tBLOCK_S
;

903 
	sDT1_S


905 
	mds1_ußge
;

906 
	m«me
[80];

907 * 
	mbuf„r
;

908 
	mbuff_Àn
;

909 
	mx1
;

910 
	mx2
;

911 
	mblock_num
;

912 
	mbh_°¨t
;

915 * 
	mbh_buf„r
;

916 
	mbh_buff_Àn
;

919 
BITMAP
 ** 
	mblock_zoom
[
ZM_MAX
];

921 
	mbz_size
[
ZM_MAX
];

922 } 
	tDT1_S
;

924 
DT1_S
 * 
glb_dt1
;

926 
	sSUB_TILE_S


928 
WORD
 
	mx_pos
;

929 
WORD
 
	my_pos
;

931 
	mx_grid
;

932 
	my_grid
;

933 
WORD
 
	mf‹m©
;

934 
	mÀngth
;

936 
	md©a_off£t
;

937 } 
	tSUB_TILE_S
;

939 
	sORDER_DATA_S


941 
	midx
;

942 
	mheight
;

943 } 
	tORDER_DATA_S
;

945 
	sTMP_SEL_S


947 
	ety≥
 {
	mTMP_NULL
, 
	mTMP_NEW
, 
	mTMP_ADD
, 
	mTMP_DEL
, 
	mTMP_HIDE
} 
	mty≥
;

948 
	m°¨t
;

949 
	mx1
, 
	my1
, 
	mx2
, 
	my2
, 
	mﬁd_x2
, 
	mﬁd_y2
;

950 } 
	tTMP_SEL_S
;

952 
	sPASTE_POS_S


954 
	m§c_ds1_idx
;

955 
	m°¨t
;

956 
	m°¨t_x
, 
	m°¨t_y
, 
	mﬁd_x
, 
	mﬁd_y
, 
	mﬁd_ds1_idx
;

957 
	mis_cut
;

958 
	mcut_ßved
;

959 } 
	tPASTE_POS_S
;

961 
	eIT_ENUM


963 
	mIT_NULL
,

964 
	mIT_NEW
,

965 
	mIT_ADD
,

966 
	mIT_DEL


967 } 
	tIT_ENUM
;

970 
	eRQ_ENUM


972 
	mRQ_LVLTYPE
,

973 
	mRQ_LVLPREST
,

974 
	mRQ_OBJ
,

975 
	mRQ_OBJECTS
,

976 
	mRQ_MAX


977 } 
	tRQ_ENUM
;

979 ** 
glb_txt_ªq_±r
 [
RQ_MAX
];

981 
	sWMSG_FGBG_S


983 
	mfg
;

984 
	mbg
;

985 } 
	tWMSG_FGBG_S
;

987 
	sWMSG_BUTCOL_S


989 
	mfg
;

990 
	mbg
;

991 
	mb‹dî
;

992 } 
	tWMSG_BUTCOL_S
;

994 
	sWMSG_BUTKEY_S


996 
	mkey
 [
MW_COMBINATION_KEY_NUM
];

997 
	mmb
;

998 } 
	tWMSG_BUTKEY_S
;

1000 
	sWMSG_BUT_S


1002 * 
	mãxt
;

1003 
	mright_•a˚s
;

1004 
WMSG_BUTCOL_S
 
	m⁄
;

1005 
WMSG_BUTCOL_S
 
	moff
;

1006 
WMSG_BUTKEY_S
 
	msh‹tcut
[
MW_SHORTCUT_NUM
];

1007 } 
	tWMSG_BUT_S
;

1009 
	sWMSG_S


1011 
	mf⁄t_width
;

1012 
	mf⁄t_height
;

1013 * 
	mtôÀ
;

1014 * 
	mãxt
;

1015 
WMSG_FGBG_S
 
	mcﬁ_wö
;

1016 
WMSG_FGBG_S
 
	mcﬁ_tôÀ
;

1017 
WMSG_FGBG_S
 
	mcﬁ_ãxt
;

1018 
WMSG_BUT_S
 * 
	mbuâ⁄
;

1019 } 
	tWMSG_S
;

1021 
	eDS1ERR_ENUM


1023 
	mDS1ERR_OK
 = 0,

1024 
	mDS1ERR_INICREATE
 = 1,

1025 
	mDS1ERR_CMDLINE
 = 2,

1026 
	mDS1ERR_NOHEIGHT
 = 3,

1027 
	mDS1ERR_INITMPQ
 = 4,

1028 
	mDS1ERR_OTHER
 = 255

1029 } 
	tDS1ERR_ENUM
;

1031 
	eWBITSTYPE_ENUM


1033 
	mWBITSTYPE_UNKNOWN
 = 0,

1034 
	mWBITSTYPE_SAME
,

1035 
	mWBITSTYPE_DIFFERENT


1036 } 
	tWBITSTYPE_ENUM
;

1038 
	sWBITSDATA_S


1041 
CELL_F_S
 
	mmix_f
[
FLOOR_MAX_LAYER
];

1042 
CELL_S_S
 
	mmix_s
[
SHADOW_MAX_LAYER
];

1043 
CELL_W_S
 
	mmix_w
[
WALL_MAX_LAYER
];

1044 
CELL_T_S
 
	mmix_t
[
TAG_MAX_LAYER
];

1047 
WBITSTYPE_ENUM
 
	mbô_ty≥_f
[
FLOOR_MAX_LAYER
 ][ 4][8];

1048 
WBITSTYPE_ENUM
 
	mbô_ty≥_s
[
SHADOW_MAX_LAYER
][ 4][8];

1049 
WBITSTYPE_ENUM
 
	mbô_ty≥_w
[
WALL_MAX_LAYER
 ][ 5][8];

1050 
WBITSTYPE_ENUM
 
	mbô_ty≥_t
[
TAG_MAX_LAYER
 ][32];

1051 } 
	tWBITSDATA_S
;

1054 
	eWRKSPC_ENUM


1056 
	mWRKSPC_TILE_X
 = 0,

1057 
	mWRKSPC_TILE_Y
,

1058 
	mWRKSPC_ZOOM
,

1059 
	mWRKSPC_VERSION
,

1060 
	mWRKSPC_SAVE_COUNT
,

1061 
	mWRKSPC_MAX


1062 } 
	tWRKSPC_ENUM
;

1064 
	sWRKSPC_DATAS_S


1066 * 
	mid
;

1067 } 
	tWRKSPC_DATAS_S
;

1069 
WRKSPC_DATAS_S
 
glb_wrk•c_d©as
[
WRKSPC_MAX
];

1072 * 
glb_∑th_lv…y≥s_mem
;

1073 * 
glb_∑th_lv…y≥s_def
;

1074 * 
glb_∑th_lvÕª°_mem
;

1075 * 
glb_∑th_lvÕª°_def
;

1076 * 
glb_∑th_obj_mem
;

1077 * 
glb_∑th_obj_def
;

1078 * 
glb_∑th_obje˘s_mem
;

1079 * 
glb_∑th_obje˘s_def
;

	@txtread.c

1 
	~<°rög.h
>

2 
	~"°ru˘s.h
"

3 
	~"îr‹.h
"

4 
	~"misc.h
"

5 
	~"dt1misc.h
"

6 
	~"mpq/MpqVõw.h
"

7 
	~"txåód.h
"

18 * 
	$txt_gës
(* 
b±r
, * 
nb_ch¨
, * 
is_√w_löe
, 
dñ_ch¨
)

20 * 
is_√w_löe
 = 
FALSE
;

21 * 
nb_ch¨
 = 0;

26 i‡(
b±r
[* 
nb_ch¨
] == 0)

29  
NULL
;

31 i‡(
b±r
[* 
nb_ch¨
] == '\t')

34 i‡(
dñ_ch¨
 =
TRUE
)

35 
b±r
[* 
nb_ch¨
] = 0;

36  
b±r
 + (* 
nb_ch¨
) + 1;

38 i‡(
b±r
[* 
nb_ch¨
] == 0x0A)

41 * 
is_√w_löe
 = 
TRUE
;

42 i‡(
dñ_ch¨
 =
TRUE
)

43 
b±r
[* 
nb_ch¨
] = 0;

44  
b±r
 + (* 
nb_ch¨
) + 1;

46 i‡(
b±r
[* 
nb_ch¨
] == 0x0D)

49 * 
is_√w_löe
 = 
TRUE
;

50 i‡(
dñ_ch¨
 =
TRUE
)

51 
b±r
[* 
nb_ch¨
] = 0;

52  
b±r
 + (* 
nb_ch¨
) + 2;

55 (* 
nb_ch¨
)++;

57 
	}
}

61 
	$txt_cou¡_hódî_cﬁs
(* 
cur_cﬁ
, * 
cﬁ_cou¡
)

63 
nb_ch¨
, 
is_√w_löe
;

64 * 
√xt_cﬁ
 = 
NULL
;

67 i‡((
cur_cﬁ
 =
NULL
Ë|| (
cﬁ_cou¡
 == NULL))

70 (* 
cﬁ_cou¡
) = 0;

71 
cur_cﬁ
 !
NULL
)

73 
√xt_cﬁ
 = 
	`txt_gës
(
cur_cﬁ
, & 
nb_ch¨
, & 
is_√w_löe
, 
FALSE
);

76 i‡(
nb_ch¨
)

78 i‡(
	`°∫icmp
(
cur_cﬁ
, "*eol", 4) != 0)

79 (* 
cﬁ_cou¡
)++;

83 i‡((
is_√w_löe
Ë|| (
√xt_cﬁ
 =
NULL
))

86 
cur_cﬁ
 = 
√xt_cﬁ
;

88 
	}
}

92 * 
	$txt_ªad_hódî
(* 
cur_cﬁ
, 
TXT_S
 * 
txt
)

94 
nb_ch¨
, 
i
, 
cﬁ_pos
 = 0, 
is_√w_löe
;

95 * 
√xt_cﬁ
 = 
NULL
;

98 
cur_cﬁ
 !
NULL
)

100 
√xt_cﬁ
 = 
	`txt_gës
(
cur_cﬁ
, & 
nb_ch¨
, & 
is_√w_löe
, 
TRUE
);

101 i‡(
nb_ch¨
)

104 
i
=0; i < 
txt
->
cﬁ_num
; i++)

106 i‡(
	`°ricmp
(
cur_cﬁ
, 
txt
->
cﬁ
[
i
].
«me
) == 0)

109 
txt
->
cﬁ
[
i
].
pos
 = 
cﬁ_pos
;

114 
cﬁ_pos
++;

117 i‡(
is_√w_löe
)

118  
√xt_cﬁ
;

120 
cur_cﬁ
 = 
√xt_cﬁ
;

122  
NULL
;

123 
	}
}

127 
	$txt_check_ty≥_™d_size
(* 
cur_cﬁ
, 
TXT_S
 * 
txt
)

129 
nb_ch¨
, 
i
, 
cﬁ_pos
 = 0, 
is_√w_löe
 = 
FALSE
, 
x
;

130 * 
√xt_cﬁ
;

132 i‡(
cur_cﬁ
 =
NULL
)

136 
txt
->
löe_num
 = 0;

137 
cﬁ_pos
 = 0;

138 
cur_cﬁ
 !
NULL
)

141 
√xt_cﬁ
 = 
	`txt_gës
(
cur_cﬁ
, & 
nb_ch¨
, & 
is_√w_löe
, 
FALSE
);

143 i‡(
nb_ch¨
)

146 
i
=0; i < 
txt
->
cﬁ_num
; i++)

148 i‡(
cﬁ_pos
 =
txt
->
cﬁ
[
i
].
pos
)

151 i‡(
nb_ch¨
 > 
txt
->
cﬁ
[
i
].
size
)

152 
txt
->
cﬁ
[
i
].
size
 = 
nb_ch¨
;

155 i‡(
i
 >
txt
->
nb_ªquúed_cﬁs
)

158 i‡(
txt
->
cﬁ
[
i
].
ty≥
 =
CT_NULL
)

159 
txt
->
cﬁ
[
i
].
ty≥
 = 
CT_STR
;

163 i‡(
txt
->
cﬁ
[
i
].
ty≥
 =
CT_NULL
)

164 
txt
->
cﬁ
[
i
].
ty≥
 = 
CT_NUM
;

166 i‡(
txt
->
cﬁ
[
i
].
ty≥
 !
CT_STR
)

168 
x
=0; x < 
nb_ch¨
; x++)

170 i‡–((
cur_cﬁ
[
x
] < '0') || (cur_col[x] > '9'))

172 
cur_cﬁ
[
x
] != '-')

174 
txt
->
cﬁ
[
i
].
ty≥
 = 
CT_STR
;

175 
x
 = 
nb_ch¨
;

185 
cﬁ_pos
++;

188 i‡(
is_√w_löe
)

190 
txt
->
löe_num
++;

191 
cﬁ_pos
 = 0;

193 
cur_cﬁ
 = 
√xt_cﬁ
;

196 
	}
}

200 
	$txt_fûl_d©a
(* 
cur_cﬁ
, 
TXT_S
 * 
txt
)

202 
nb_ch¨
, 
i
, 
cﬁ_pos
 = 0, 
is_√w_löe
, 
cur_löe
 = 0;

203 * 
√xt_cﬁ
, * 
d©a_±r
, * 
•å
;

204 * 
Õå
;

206 i‡((
cur_cﬁ
 =
NULL
Ë|| (
txt
->
d©a
 == NULL))

210 
cﬁ_pos
 = 0;

211 
d©a_±r
 = 
txt
->
d©a
;

212 
cur_cﬁ
 !
NULL
)

215 
√xt_cﬁ
 = 
	`txt_gës
(
cur_cﬁ
, & 
nb_ch¨
, & 
is_√w_löe
, 
TRUE
);

217 i‡(
nb_ch¨
)

220 
i
=0; i < 
txt
->
cﬁ_num
; i++)

222 i‡(
cﬁ_pos
 =
txt
->
cﬁ
[
i
].
pos
)

225 
•å
 = 
d©a_±r
 + 
txt
->
cﬁ
[
i
].
off£t
;

226 i‡(
txt
->
cﬁ
[
i
].
ty≥
 =
CT_STR
)

227 
	`°r˝y
(
•å
, 
cur_cﬁ
);

228 i‡(
txt
->
cﬁ
[
i
].
ty≥
 =
CT_NUM
)

230 
Õå
 = (*Ë
•å
;

231 * 
Õå
 = 
	`©ﬁ
(
cur_cﬁ
);

238 
cﬁ_pos
++;

241 i‡(
is_√w_löe
)

243 
cur_löe
++;

244 i‡(
cur_löe
 > 
txt
->
löe_num
)

248 
d©a_±r
 +
txt
->
löe_size
;

249 
cﬁ_pos
 = 0;

252 
cur_cﬁ
 = 
√xt_cﬁ
;

255 
	}
}

259 
TXT_S
 * 
	$txt_de°roy
(
TXT_S
 * 
txt
)

261 i‡(
txt
 =
NULL
)

262  
NULL
;

263 i‡(
txt
->
d©a
 !
NULL
)

264 
	`‰ì
(
txt
->
d©a
);

265 i‡(
txt
->
cﬁ
 !
NULL
)

266 
	`‰ì
(
txt
->
cﬁ
);

267 
	`‰ì
(
txt
);

268  
NULL
;

269 
	}
}

273 
	$txt_gë_u£r_fûãr_cﬁs
(* 
cur_cﬁ
, 
TXT_S
 * 
txt
)

275 
nb_ch¨
, 
is_√w_löe
;

276 * 
√xt_cﬁ
 = 
NULL
;

277 
i
 = 0;

278 
tmp
[500] = "";

279 
size
 = 0;

282 i‡((
cur_cﬁ
 =
NULL
Ë|| (
txt
 == NULL))

285 
cur_cﬁ
 !
NULL
)

287 
√xt_cﬁ
 = 
	`txt_gës
(
cur_cﬁ
, & 
nb_ch¨
, & 
is_√w_löe
, 
FALSE
);

290 i‡(
nb_ch¨
)

292 i‡(
	`°∫icmp
(
cur_cﬁ
, "*eol", 4) != 0)

295 
i
=0; i < 
txt
->
nb_ªquúed_cﬁs
; i++)

297 
size
 = 0;

298  (
cur_cﬁ
[
size
] != 0x00) && (cur_col[size] != '\t') &&

299 (
cur_cﬁ
[
size
] != 0x0D) && (cur_col[size] != 0x0A) )

301 
size
++;

304 i‡(
	`°∫icmp
(
txt
->
cﬁ
[
i
].
«me
, 
cur_cﬁ
, 
size
) == 0)

308 i‡(
i
 >
txt
->
nb_ªquúed_cﬁs
)

313 (
i
 < 
txt
->
cﬁ_num
Ë&& (
	`°æí
—xt->
cﬁ
[i].
«me
) > 0))

314 
i
++;

316 i‡(
i
 < 
txt
->
cﬁ_num
)

318 i‡(
size
 >
TXT_COL_NAME_LENGTH
)

320 
	`•rötf
(

321 
tmp


326 
TXT_COL_NAME_LENGTH
 - 1,

327 
TXT_COL_NAME_LENGTH
 - 1,

328 
cur_cﬁ
,

329 
size


331 
	`ds1edô_îr‹
(
tmp
);

333 
	`°∫˝y
(
txt
->
cﬁ
[
i
].
«me
, 
cur_cﬁ
, 
size
);

340 i‡((
is_√w_löe
Ë|| (
√xt_cﬁ
 =
NULL
))

343 
cur_cﬁ
 = 
√xt_cﬁ
;

345 
	}
}

350 
TXT_S
 * 
	$txt_lﬂd
(* 
mem
, 
RQ_ENUM
 
íum_txt
, * 
fûíame
)

352 
TXT_S
 * 
txt
 = 
NULL
;

353 
i
=0, 
size
=0, 
Æl_cﬁ_ok
 = 
TRUE
;

354 * 
fú°_löe
 = 
NULL
, 
tmp
[150] = "";

355 ** 
ªquúed_cﬁ
 = 
NULL
;

358 i‡(((
íum_txt
 < 0)Ë|| (íum_txà>
RQ_MAX
))

360 
	`•rötf
(
tmp
, "txt_lﬂd(Ë:Ö¨amëî 'íum_txt' = %i, should bêbëwì¿0ánd %i", 
íum_txt
, 
RQ_MAX
 - 1);

361 
	`ds1edô_îr‹
(
tmp
);

364 
ªquúed_cﬁ
 = 
glb_txt_ªq_±r
[
íum_txt
];

366 
	`¥ötf
("\¡xt_lﬂd(Ë:Üﬂdög %s\n", 
fûíame
);

367 
	`fÊush
(
°dout
);

370 
size
 = (
TXT_S
);

371 
txt
 = (
TXT_S
 *Ë
	`mÆloc
(
size
);

372 i‡(
txt
 =
NULL
)

374 
	`•rötf
(
tmp
, "txt_lﬂd(Ë: c™'àÆloˇã %òbyãs", 
size
);

375 
	`ds1edô_îr‹
(
tmp
);

377 
	`mem£t
(
txt
, 0, 
size
);

380 
txt
->
nb_ªquúed_cﬁs
 = 0;

381 
ªquúed_cﬁ
[
txt
->
nb_ªquúed_cﬁs
] !
NULL
)

382 
txt
->
nb_ªquúed_cﬁs
++;

385 
txt
->
cﬁ_num
 = 0;

386 i‡(
íum_txt
 =
RQ_OBJ
)

389 
	`txt_cou¡_hódî_cﬁs
(
mem
, & 
txt
->
cﬁ_num
);

392 
txt
->
cﬁ_num
 =Åxt->
nb_ªquúed_cﬁs
;

394 
txt
->
cﬁ
 = (
TXT_COL_S
 *Ë
	`ˇŒoc
—xt->
cﬁ_num
 + 1, (TXT_COL_S));

395 i‡(
txt
->
cﬁ
 =
NULL
)

397 
txt
 = 
	`txt_de°roy
(txt);

398 
	`•rötf
(
tmp
, "txt_lﬂd(Ë: cÆloc(Ëîr‹ f‹ %òñemíà* %òbyã†óch", 
txt
->
cﬁ_num
 + 1, (
TXT_COL_S
));

399 
	`ds1edô_îr‹
(
tmp
);

403 
i
=0; i < 
txt
->
cﬁ_num
; i++)

405 
txt
->
cﬁ
[
i
].
pos
 = -1;

406 i‡(
i
 < 
txt
->
nb_ªquúed_cﬁs
)

407 
	`°∫˝y
(
txt
->
cﬁ
[
i
].
«me
, 
ªquúed_cﬁ
[i], 
TXT_COL_NAME_LENGTH
);

411 i‡(
txt
->
nb_ªquúed_cﬁs
 !txt->
cﬁ_num
)

412 
	`txt_gë_u£r_fûãr_cﬁs
(
mem
, 
txt
);

415 
fú°_löe
 = 
	`txt_ªad_hódî
(
mem
, 
txt
);

416 
i
=0; i < 
txt
->
cﬁ_num
; i++)

418 i‡(
txt
->
cﬁ
[
i
].
pos
 == -1)

420 
	`¥ötf
("txt_lﬂd(Ë: didn'àfoundÑequúed cﬁum¿%ò(%s)\n", 
i
, 
txt
->
cﬁ
[i].
«me
);

421 
	`fÊush
(
°dout
);

422 
Æl_cﬁ_ok
 = 
FALSE
;

426 i‡(
Æl_cﬁ_ok
 !
TRUE
)

428 
txt
 = 
	`txt_de°roy
(txt);

429 
	`•rötf
(
tmp
, "txt_load() :Çotáll columns have been found");

430 
	`ds1edô_îr‹
(
tmp
);

434 i‡(
	`txt_check_ty≥_™d_size
(
fú°_löe
, 
txt
))

436 
txt
 = 
	`txt_de°roy
(txt);

437 
	`•rötf
(
tmp
, "txt_load() : stage 2,Érror shouldn't have happen");

438 
	`ds1edô_îr‹
(
tmp
);

442 
size
 = 0;

443 
i
=0; i < 
txt
->
cﬁ_num
; i++)

445 
txt
->
cﬁ
[
i
].
off£t
 = 
size
;

446 i‡(
txt
->
cﬁ
[
i
].
ty≥
 =
CT_NUM
)

447 
size
 += ();

448 i‡(
txt
->
cﬁ
[
i
].
ty≥
 =
CT_STR
)

449 
size
 +(
txt
->
cﬁ
[
i
].size + 1);

451 
txt
->
löe_size
 = 
size
;

453 
txt
->
d©a
 = (*Ë
	`ˇŒoc
—xt->
löe_num
 + 1,Åxt->
löe_size
);

454 i‡(
txt
->
d©a
 =
NULL
)

456 
txt
 = 
	`txt_de°roy
(txt);

457 
	`•rötf
(
tmp
, "txt_lﬂd(Ë: cÆloc(Ëîr‹ f‹ %òñemít†* %òbyã†óch", 
txt
->
löe_num
 + 1,Åxt->
löe_size
);

458 
	`ds1edô_îr‹
(
tmp
);

462 i‡(
	`txt_fûl_d©a
(
fú°_löe
, 
txt
))

464 
txt
 = 
	`txt_de°roy
(txt);

465 
	`•rötf
(
tmp
, "txt_load() : stage 4,Érror shouldn't have happen");

466 
	`ds1edô_îr‹
(
tmp
);

469  
txt
;

470 
	}
}

475 * 
	$txt_ªad_ö_mem
(* 
txäame
)

477 * 
buff
 = 
NULL
, * 
√w_buff
;

478 
íåy
;

479 
Àn
;

480 
tmp
[150];

482 
	`¥ötf
("\nw™àtÿªadáÅxà‰om mpq : %s\n", 
txäame
);

483 
íåy
 = 
	`misc_lﬂd_mpq_fûe
(
txäame
, (**Ë& 
buff
, & 
Àn
, 
TRUE
);

484 i‡((
íåy
 =-1Ë|| (
buff
 =
NULL
))

486 
	`•rötf
(
tmp
, "txt_ªad_ö_mem(Ë: fûê%†nŸ found", 
txäame
);

487 
	`ds1edô_îr‹
(
tmp
);

490 
Àn
++;

491 
√w_buff
 = 
	`ªÆloc
(
buff
, 
Àn
);

492 i‡(
√w_buff
 =
NULL
)

494 
	`•rötf
(
tmp
, "txt_read_in_mem() : can'tÑeallocate %i bytes for %s",

495 
Àn
, 
txäame
);

496 i‡(
buff
 !
NULL
)

497 
	`‰ì
(
buff
);

498 
	`ds1edô_îr‹
(
tmp
);

501 i‡(
√w_buff
 !
buff
)

502 
	`mem˝y
(
√w_buff
, 
buff
, 
Àn
 - 1);

504 * (((*Ë
√w_buff
Ë+ 
Àn
 - 1) = 0;

506  
buff
;

507 
	}
}

511 
	$txt_c⁄vît_¶ash
(* 
°r
)

513 
i
, 
s
 = 
	`°æí
(
°r
);

516 
i
=0; i < 
s
; i++)

517 i‡(
°r
[
i
] == '/')

518 
°r
[
i
] = '\\';

519 
	}
}

524 
	$txt_debug
(* 
fûe_∑th_mem
, * 
fûe_∑th_def
, 
TXT_S
 * 
txt
)

526 
FILE
 * 
out
 = 
NULL
;

527 
i
 = 0;

530 i‡(
glb_ds1edô
.
cmd_löe
.
debug_mode
 !
TRUE
)

533 i‡((
fûe_∑th_mem
 =
NULL
Ë|| (
fûe_∑th_def
 =NULLË|| (
txt
 == NULL))

536 
out
 = 
	`f›í
(
fûe_∑th_mem
, "wb");

537 i‡(
out
 !
NULL
)

539 
	`fwrôe
(
txt
->
d©a
,Åxt->
löe_size
,Åxt->
löe_num
, 
out
);

540 
	`f˛o£
(
out
);

543 
out
 = 
	`f›í
(
fûe_∑th_def
, "wt");

544 i‡(
out
 !
NULL
)

546 
	`Ârötf
(
out
, "mem‹y_cﬁ cﬁ_ty≥ %-*†txt_cﬁ_num d©a_ty≥Åxt_d©a_sizêmem‹y_off£t\n", 
TXT_COL_NAME_LENGTH
, "header_name");

547 
	`Ârötf
(
out
, "---------- -------- %-.*†----------- --------- ------------- -------------\n", 
TXT_COL_NAME_LENGTH
, "------------------------------");

549 
i
=0; i < 
txt
->
cﬁ_num
; i++)

551 
	`Ârötf
(

552 
out
,

554 
i
,

555 (
i
 >
txt
->
nb_ªquúed_cﬁs
) ? "Filter" : "Required",

556 
TXT_COL_NAME_LENGTH
,

557 
txt
->
cﬁ
[
i
].
«me
,

558 
txt
->
cﬁ
[
i
].
pos
,

559 
txt
->
cﬁ
[
i
].
ty≥
 =
CT_NUM
 ? "NUM" : "STR",

560 
txt
->
cﬁ
[
i
].
size
,

561 
txt
->
cﬁ
[
i
].
off£t


564 
	`f˛o£
(
out
);

566 
	}
}

571 
	$ªad_lv…y≥s_txt
(
ds1_idx
, 
ty≥
)

573 
TXT_S
 * 
txt
 = 
NULL
;

574 
lv…y≥s
[] = "Data\\Global\\Excel\\LvlTypes.txt",

575 
ds1edt_fûe
[] = "ds1edô.dt1", * 
buff
, * 
•å
;

576 
i
, 
f
;

577 * 
Õå
 = 
NULL
, 
a˘
;

578 
tmp
[150] = "", 
«me
[256] = "";

579 
cﬁ_idx
 = 0, 
fûe_1_idx
 = 0;

580 * 
tmp_l⁄g
 = 
NULL
;

584 i‡(
glb_ds1edô
.
lv…y≥s_buff
 =
NULL
)

586 
buff
 = 
	`txt_ªad_ö_mem
(
lv…y≥s
);

587 i‡(
buff
 =
NULL
)

591 
txt
 = 
	`txt_lﬂd
(
buff
, 
RQ_LVLTYPE
, 
lv…y≥s
);

592 
glb_ds1edô
.
lv…y≥s_buff
 = 
txt
;

593 
	`‰ì
(
buff
);

594 i‡(
txt
 =
NULL
)

598 i‡(
glb_ds1edô
.
cmd_löe
.
debug_mode
 =
TRUE
)

599 
	`txt_debug
(
glb_∑th_lv…y≥s_mem
, 
glb_∑th_lv…y≥s_def
, 
txt
);

602 
txt
 = 
glb_ds1edô
.
lv…y≥s_buff
;

605 
i
=0; i < 
txt
->
löe_num
; i++)

607 
•å
 = 
txt
->
d©a
 + (
i
 *Åxt->
löe_size
Ë+Åxt->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_LVLTYPE
, "ID")].
off£t
;

608 
Õå
 = (*Ë
•å
;

609 i‡((* 
Õå
Ë=
ty≥
)

612 
	`¥ötf
("Found ID %i in LvlTypes.txtátÑow %i, col %i\n",

613 
ty≥
, 
i
 + 1, 
txt
->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_LVLTYPE
, "ID")].
pos
);

614 
	`fÊush
(
°dout
);

617 
•å
 = 
txt
->
d©a
 + (
i
 *Åxt->
löe_size
Ë+Åxt->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_LVLTYPE
, "A˘")].
off£t
;

618 
Õå
 = (*Ë
•å
;

619 
a˘
 = * 
Õå
;

620 i‡((
a˘
 !
glb_ds1
[
ds1_idx
].a˘Ë&& (
glb_ds1edô
.
cmd_löe
.
no_check_a˘
 =
FALSE
))

622 
	`•rötf
(
tmp
, "read_lvltypes_txt() : Acts from LvlTypes.txt (%li)ándÅhe Ds1 (%li) "

624 
a˘
,

625 
glb_ds1
[
ds1_idx
].
a˘


627 
	`ds1edô_îr‹
(
tmp
);

631 
	`¥ötf
("Found dt1files :\n");

632 
fûe_1_idx
 = 
	`misc_gë_txt_cﬁumn_num
(
RQ_LVLTYPE
, "File 1");

633 
f
=0; f<33; f++)

635 
glb_ds1
[
ds1_idx
].
dt1_idx
[
f
] = -1;

636 i‡(
f
==0)

638 
	`•rötf
(
tmp
, "%s%s", 
glb_ds1edô_d©a_dú
, 
ds1edt_fûe
);

639 
	`¥ötf
("\nw™àtÿªadá dt1 : %s\n", 
tmp
);

640 
glb_ds1
[
ds1_idx
].
dt1_idx
[
f
] = 
	`dt1_add_•ecül
(
tmp
);

644 
cﬁ_idx
 = 
fûe_1_idx
 + (
f
 - 1);

645 
•å
 = 
txt
->
d©a
 + (
i
 *Åxt->
löe_size
Ë+Åxt->
cﬁ
[
cﬁ_idx
].
off£t
;

646 i‡(
txt
->
cﬁ
[
cﬁ_idx
].
ty≥
 =
CT_STR
)

647 
	`°r˝y
(
tmp
, 
•å
);

648 i‡(
txt
->
cﬁ
[
cﬁ_idx
].
ty≥
 =
CT_NUM
)

650 
tmp_l⁄g
 = (*Ë
•å
;

651 
	`•rötf
(
tmp
, "%li", * 
tmp_l⁄g
);

653 
	`txt_c⁄vît_¶ash
(
tmp
);

654 
	`°r˝y
(
«me
, 
glb_tûes_∑th
);

655 
	`°rˇt
(
«me
, 
tmp
);

656 i‡(
glb_ds1
[
ds1_idx
].
dt1_mask
[
f
])

658 
	`¥ötf
("\nw™àtÿªadá dt1 from mpq : %s\n", 
«me
);

659 
glb_ds1
[
ds1_idx
].
dt1_idx
[
f
] = 
	`dt1_add
(
«me
);

663 i‡((
tmp
[0] != '0') &&Åmp[1] != 0)

664 
	`¥ötf
("\n(skù %s)\n", 
tmp
);

670  
a˘
;

673 
	`•rötf
(
tmp
, "couldn'àfödÅhêID %òö LvlTy≥s.txt\n", 
ty≥
);

674 
	`ds1edô_îr‹
(
tmp
);

676 
	}
}

681 
	$ªad_lvÕª°_txt
(
ds1_idx
, 
def
)

683 
TXT_S
 * 
txt
;

684 * 
buff
, * 
lvÕª°
 = "Data\\Global\\Excel\\LvlPrest.txt";

685 
i
, 
b
;

686 * 
Õå
;

687 * 
•å
, 
tmp
[150], * 
found_±r
 = 
NULL
;

688 
mask
, 
fûíame_cﬁidx
[6], 
fûíame_idx
, 
Àngth
, 
c
, 
found_nb
, 
œ°_found
=0,

689 
œ°_¶ash
, 
found_cﬁ
=0;

693 i‡(
glb_ds1edô
.
lvÕª°_buff
 =
NULL
)

695 
buff
 = 
	`txt_ªad_ö_mem
(
lvÕª°
);

696 i‡(
buff
 =
NULL
)

700 
txt
 = 
	`txt_lﬂd
(
buff
, 
RQ_LVLPREST
, 
lvÕª°
);

701 
glb_ds1edô
.
lvÕª°_buff
 = 
txt
;

702 
	`‰ì
(
buff
);

703 i‡(
txt
 =
NULL
)

707 i‡(
glb_ds1edô
.
cmd_löe
.
debug_mode
 =
TRUE
)

708 
	`txt_debug
(
glb_∑th_lvÕª°_mem
, 
glb_∑th_lvÕª°_def
, 
txt
);

711 
txt
 = 
glb_ds1edô
.
lvÕª°_buff
;

714 i‡(
def
 == -1)

716 
	`¥ötf
("AUTOMATIC LVLPREST.DEF DETECTION\n");

717 
	`fÊush
(
°dout
);

720 
fûíame_cﬁidx
[0] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_LVLPREST
, "File1");

721 
fûíame_cﬁidx
[1] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_LVLPREST
, "File2");

722 
fûíame_cﬁidx
[2] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_LVLPREST
, "File3");

723 
fûíame_cﬁidx
[3] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_LVLPREST
, "File4");

724 
fûíame_cﬁidx
[4] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_LVLPREST
, "File5");

725 
fûíame_cﬁidx
[5] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_LVLPREST
, "File6");

727 
found_nb
 = 0;

728 
i
=0; i < 
txt
->
löe_num
; i++)

730 
fûíame_idx
 = 0; filename_idx < 6; filename_idx++)

732 
•å
 = 
txt
->
d©a
 + (
i
 *Åxt->
löe_size
Ë+Åxt->
cﬁ
[ 
fûíame_cﬁidx
[
fûíame_idx
] ].
off£t
;

733 i‡(
•å
 !
NULL
)

735 
Àngth
 = 
	`°æí
(
•å
);

736 if(
Àngth
 > 0)

739 
œ°_¶ash
 = 0;

740 
c
=0; c < 
Àngth
; c++)

742 i‡((
•å
[
c
] == '/') || (sptr[c] == '\\'))

743 
œ°_¶ash
 = 
c
;

747 i‡(
œ°_¶ash
)

748 
œ°_¶ash
++;

749 i‡(
œ°_¶ash
 >
Àngth
)

750 
œ°_¶ash
 = 
Àngth
 - 1;

751 i‡(
	`°ricmp
(
•å
 + 
œ°_¶ash
, 
glb_ds1
[
ds1_idx
].
fûíame
) == 0)

754 
found_nb
++;

755 
œ°_found
 = 
i
;

756 
found_±r
 = 
•å
;

757 
found_cﬁ
 = 
fûíame_idx
;

764 i‡(
found_nb
 == 1)

768 
i
 = 
œ°_found
;

770 
•å
 = 
txt
->
d©a
 + (
i
 *Åxt->
löe_size
Ë+Åxt->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_LVLPREST
, "Def")].
off£t
;

771 
Õå
 = (*Ë
•å
;

773 
	`¥ötf
("Found \"%s\" in LvlPrest.txtátÑow %i (DEF = %li, 'File%i' = \"%s\")\n",

774 
glb_ds1
[
ds1_idx
].
fûíame
,

775 
i
 + 1,

776 * 
Õå
,

777 
found_cﬁ
 + 1,

778 
found_±r


780 
	`fÊush
(
°dout
);

783 
•å
 = 
txt
->
d©a
 + (
i
 *Åxt->
löe_size
Ë+Åxt->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_LVLPREST
, "Dt1Mask")].
off£t
;

784 
Õå
 = (*Ë
•å
;

785 
mask
 = * 
Õå
;

787 
	`¥ötf
("DT1MASK = %li in LvlPrest.txtátÑow %i, col %i\n",

788 
mask
, 
i
 + 1, 
txt
->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_LVLPREST
, "Dt1Mask")].
pos
);

789 
	`fÊush
(
°dout
);

791 
b
=0; b < 
DT1_IN_DS1_MAX
; b++)

793 i‡(
b
 == 0)

794 
glb_ds1
[
ds1_idx
].
dt1_mask
[
b
] = 
TRUE
;

796 
glb_ds1
[
ds1_idx
].
dt1_mask
[
b
] = 
mask
 & (1 << (b-1)Ë? 
TRUE
 : 
FALSE
;

804 i‡(
found_nb
 >= 2)

806 
	`•rötf
(
tmp
, "couldn't found ds1 filename \"%s\" in LvlPrest.txt for sure :Öresent %iÅimes\n",

807 
glb_ds1
[
ds1_idx
].
fûíame
,

808 
found_nb


810 
	`ds1edô_îr‹
(
tmp
);

814 
	`•rötf
(
tmp
, "couldn't found ds1 filename \"%s\" in LvlPrest.txt\n",

815 
glb_ds1
[
ds1_idx
].
fûíame


817 
	`ds1edô_îr‹
(
tmp
);

823 
i
=0; i < 
txt
->
löe_num
; i++)

825 
•å
 = 
txt
->
d©a
 + (
i
 *Åxt->
löe_size
Ë+Åxt->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_LVLPREST
, "Def")].
off£t
;

826 
Õå
 = (*Ë
•å
;

827 i‡((* 
Õå
Ë=
def
)

830 
	`¥ötf
("Found DEF %i in LvlPrest.txtátÑow %i, col %i\n",

831 
def
, 
i
 + 1, 
txt
->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_LVLPREST
, "Def")].
pos
);

832 
	`fÊush
(
°dout
);

835 
•å
 = 
txt
->
d©a
 + (
i
 *Åxt->
löe_size
Ë+Åxt->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_LVLPREST
, "Dt1Mask")].
off£t
;

836 
Õå
 = (*Ë
•å
;

837 
mask
 = * 
Õå
;

839 
	`¥ötf
("DT1MASK = %li in LvlPrest.txtátÑow %i, col %i\n",

840 
mask
, 
i
 + 1, 
txt
->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_LVLPREST
, "Dt1Mask")].
pos
);

841 
	`fÊush
(
°dout
);

843 
b
=0; b < 
DT1_IN_DS1_MAX
; b++)

845 i‡(
b
 == 0)

846 
glb_ds1
[
ds1_idx
].
dt1_mask
[
b
] = 
TRUE
;

848 
glb_ds1
[
ds1_idx
].
dt1_mask
[
b
] = 
mask
 & (1 << (b-1)Ë? 
TRUE
 : 
FALSE
;

858 
	`•rötf
(
tmp
, "couldn'àfoundÅhêDEF %òö LvlPª°.txt\n", 
def
);

859 
	`ds1edô_îr‹
(
tmp
);

861 
	}
}

866 
	$ªad_obj_txt
()

868 
TXT_S
 * 
txt
;

869 * 
buff
, 
obj
[] = "Obj.txt";

870 
i
, 
size
;

871 * 
Õå
, 
Àn
;

872 * 
•å
, 
tmp
[150];

876 i‡(
glb_ds1edô
.
obj_buff
 =
NULL
)

878 
	`¥ötf
("\nw™àtÿªad %†‰om %s\n", 
obj
, 
glb_ds1edô_d©a_dú
);

879 i‡(
	`mod_lﬂd_ö_mem
(
glb_ds1edô_d©a_dú
, 
obj
, &
buff
, &
Àn
) == -1)

881 
	`•rötf
(
tmp
, "ªad_obj_txt(Ë: fûê%†nŸ found", 
obj
);

882 
	`ds1edô_îr‹
(
tmp
);

884 
	`¥ötf
(", found in .\n");

887 
txt
 = 
	`txt_lﬂd
(
buff
, 
RQ_OBJ
, 
obj
);

888 
glb_ds1edô
.
obj_buff
 = 
txt
;

889 
	`‰ì
(
buff
);

890 i‡(
txt
 =
NULL
)

894 i‡(
glb_ds1edô
.
cmd_löe
.
debug_mode
 =
TRUE
)

895 
	`txt_debug
(
glb_∑th_obj_mem
, 
glb_∑th_obj_def
, 
txt
);

899 
txt
 = 
glb_ds1edô
.
obj_buff
;

903 
glb_ds1edô
.
obj_desc_num
 = 
txt
->
löe_num
;

904 
size
 = 
glb_ds1edô
.
obj_desc_num
 * (
OBJ_DESC_S
);

905 
glb_ds1edô
.
obj_desc
 = (
OBJ_DESC_S
 *Ë
	`mÆloc
(
size
);

906 i‡(
glb_ds1edô
.
obj_desc
 =
NULL
)

908 
	`•rötf
(
tmp
, "ªad_obj_txt(Ë:ÇŸÉnough mem f‹ %òbyãs", 
size
);

909 
	`ds1edô_îr‹
(
tmp
);

911 
	`mem£t
(
glb_ds1edô
.
obj_desc
, 0, 
size
);

914 
i
=0; i < 
txt
->
löe_num
; i++)

917 
•å
 = 
txt
->
d©a
 + (
i
 *Åxt->
löe_size
Ë+Åxt->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJ
, "A˘")].
off£t
;

918 
Õå
 = (*Ë
•å
;

919 
glb_ds1edô
.
obj_desc
[
i
].
a˘
 = * 
Õå
;

922 
•å
 = 
txt
->
d©a
 + (
i
 *Åxt->
löe_size
Ë+Åxt->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJ
, "Ty≥")].
off£t
;

923 
Õå
 = (*Ë
•å
;

924 
glb_ds1edô
.
obj_desc
[
i
].
ty≥
 = * 
Õå
;

927 
•å
 = 
txt
->
d©a
 + (
i
 *Åxt->
löe_size
Ë+Åxt->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJ
, "ID")].
off£t
;

928 
Õå
 = (*Ë
•å
;

929 
glb_ds1edô
.
obj_desc
[
i
].
id
 = * 
Õå
;

932 
•å
 = 
txt
->
d©a
 + (
i
 *Åxt->
löe_size
Ë+Åxt->
cﬁ
[
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJ
, "Des¸ùti⁄")].
off£t
;

933 
glb_ds1edô
.
obj_desc
[
i
].
desc
 = 
•å
;

937 
glb_ds1edô
.
cﬁ_obj_id
 = 
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJ
, "Objects.txt_ID");

940 
	}
}

945 
	$ªad_obje˘s_txt
()

947 
TXT_S
 * 
txt
;

948 * 
buff
, * 
obje˘s
 = "Data\\Global\\Excel\\Objects.txt";

952 i‡(
glb_ds1edô
.
obje˘s_buff
 =
NULL
)

955 
buff
 = 
	`txt_ªad_ö_mem
(
obje˘s
);

956 i‡(
buff
 =
NULL
)

960 
txt
 = 
	`txt_lﬂd
(
buff
, 
RQ_OBJECTS
, 
obje˘s
);

961 
glb_ds1edô
.
obje˘s_buff
 = 
txt
;

962 
	`‰ì
(
buff
);

963 i‡(
txt
 =
NULL
)

967 i‡(
glb_ds1edô
.
cmd_löe
.
debug_mode
 =
TRUE
)

968 
	`txt_debug
(
glb_∑th_obje˘s_mem
, 
glb_∑th_obje˘s_def
, 
txt
);

971 
txt
 = 
glb_ds1edô
.
obje˘s_buff
;

975 
glb_ds1edô
.
cﬁ_obje˘s_id
 = 
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJECTS
, "Id");

977 
glb_ds1edô
.
cﬁ_‰ame_dñè
[0] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJECTS
, "FrameDelta0");

978 
glb_ds1edô
.
cﬁ_‰ame_dñè
[1] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJECTS
, "FrameDelta1");

979 
glb_ds1edô
.
cﬁ_‰ame_dñè
[2] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJECTS
, "FrameDelta2");

980 
glb_ds1edô
.
cﬁ_‰ame_dñè
[3] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJECTS
, "FrameDelta3");

981 
glb_ds1edô
.
cﬁ_‰ame_dñè
[4] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJECTS
, "FrameDelta4");

982 
glb_ds1edô
.
cﬁ_‰ame_dñè
[5] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJECTS
, "FrameDelta5");

983 
glb_ds1edô
.
cﬁ_‰ame_dñè
[6] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJECTS
, "FrameDelta6");

984 
glb_ds1edô
.
cﬁ_‰ame_dñè
[7] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJECTS
, "FrameDelta7");

986 
glb_ds1edô
.
cﬁ_‹dîÊag
[0] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJECTS
, "OrderFlag0");

987 
glb_ds1edô
.
cﬁ_‹dîÊag
[1] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJECTS
, "OrderFlag1");

988 
glb_ds1edô
.
cﬁ_‹dîÊag
[2] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJECTS
, "OrderFlag2");

989 
glb_ds1edô
.
cﬁ_‹dîÊag
[3] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJECTS
, "OrderFlag3");

990 
glb_ds1edô
.
cﬁ_‹dîÊag
[4] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJECTS
, "OrderFlag4");

991 
glb_ds1edô
.
cﬁ_‹dîÊag
[5] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJECTS
, "OrderFlag5");

992 
glb_ds1edô
.
cﬁ_‹dîÊag
[6] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJECTS
, "OrderFlag6");

993 
glb_ds1edô
.
cﬁ_‹dîÊag
[7] = 
	`misc_gë_txt_cﬁumn_num
(
RQ_OBJECTS
, "OrderFlag7");

995 
	}
}

	@txtread.h

1 #i‚de‡
_TXTREAD_H_


3 
	#_TXTREAD_H_


	)

5 * 
txt_gës
 (* 
b±r
, * 
nb_ch¨
, * 
is_√w_löe
, 
dñ_ch¨
);

6 
txt_cou¡_hódî_cﬁs
 (* 
cur_cﬁ
, * 
cﬁ_cou¡
);

7 * 
txt_ªad_hódî
 (* 
cur_cﬁ
, 
TXT_S
 * 
txt
);

8 
txt_check_ty≥_™d_size
 (* 
cur_cﬁ
, 
TXT_S
 * 
txt
);

9 
txt_fûl_d©a
 (* 
cur_cﬁ
, 
TXT_S
 * 
txt
);

10 
TXT_S
 * 
txt_de°roy
 (TXT_S * 
txt
);

11 
txt_gë_u£r_fûãr_cﬁs
 (* 
cur_cﬁ
, 
TXT_S
 * 
txt
);

12 
TXT_S
 * 
txt_lﬂd
 (* 
mem
, 
RQ_ENUM
 
íum_txt
, * 
fûíame
);

13 * 
txt_ªad_ö_mem
 (* 
txäame
);

14 
txt_c⁄vît_¶ash
 (* 
°r
);

15 
txt_debug
 (* 
fûe_∑th_mem
, * 
fûe_∑th_def
, 
TXT_S
 * 
txt
);

16 
ªad_lv…y≥s_txt
 (
ds1_idx
, 
ty≥
);

17 
ªad_lvÕª°_txt
 (
ds1_idx
, 
def
);

18 
ªad_obj_txt
 ();

19 
ªad_obje˘s_txt
 ();

	@types.h

1 #i‚de‡
_WINDS1EDIT_TYPES_H_


3 
	#_WINDS1EDIT_TYPES_H_


	)

5 
	tUBYTE
;

6 
	tWORD
;

7 
	tUWORD
;

8 
	tUDWORD
;

11 #¥agm®
w¨nög
(
dißbÀ
 : 4996)

	@undo.c

1 
	~"°ru˘s.h
"

2 
	~"îr‹.h
"

3 
	~"ds1misc.h
"

4 
	~"undo.h
"

9 
	$undo_ª£t_Êags
(
ds1_idx
)

11 
UNDO_DAT_FLG_S
 * 
df
 = & 
glb_ds1
[
ds1_idx
].
undo
.
d©_Êg
;

12 
i
;

14 
i
=0; i < 
FLOOR_MAX_LAYER
; i++)

15 
df
->
f
[
i
] = 0;

17 
i
=0; i < 
SHADOW_MAX_LAYER
; i++)

18 
df
->
s
[
i
] = 0;

20 
i
=0; i < 
WALL_MAX_LAYER
; i++)

21 
df
->
w
[
i
] = 0;

22 
	}
}

27 
	$undo_exô
()

29 
UNDO_S
 * 
u
;

30 
Æ_ffblk
 
f
;

31 
d⁄e
, 
i
;

32 
tmp
[150];

34 
i
=0; i<
DS1_MAX
; i++)

36 i‡(
	`°æí
(
glb_ds1
[
i
].
«me
))

38 
u
 = & 
glb_ds1
[
i
].
undo
;

39 i‡(
u
->
Âå
 !
NULL
)

41 
	`f˛o£
(
u
->
Âå
);

42 
u
->
Âå
 = 
NULL
;

43 
	`°r˝y
(
u
->
«me
, "");

48 
	`•rötf
(
tmp
, "%s%sundo*.bö", 
glb_ds1edô_d©a_dú
, 
glb_ds1edô_tmp_dú
);

49 
	`¥ötf
("\ƒemovögÅm∞undÿbuf„r†(%s)...", 
tmp
);

50 
	`Ârötf
(
°dîr
, " .ÑemovögÅm∞undÿbuf„r†(%s)...", 
tmp
);

51 
	`fÊush
(
°dîr
);

52 
	`fÊush
(
°dout
);

53 
d⁄e
 = 
	`Æ_födfú°
(
tmp
, &
f
, -1);

54  ! 
d⁄e
)

56 
	`•rötf
(
tmp
, "%s%s%s", 
glb_ds1edô_d©a_dú
, 
glb_ds1edô_tmp_dú
, 
f
.
«me
);

57 
	`ªmove
(
tmp
);

58 
d⁄e
 = 
	`Æ_föd√xt
(&
f
);

60 
	`Æ_föd˛o£
(&
f
);

61 
	`¥ötf
("done\n");

62 
	`Ârötf
(
°dîr
, "done\n");

63 
	`fÊush
(
°dîr
);

64 
	`fÊush
(
°dout
);

65 
	}
}

70 
	$undo_√w_tûe_buf„r
(
ds1_idx
)

72 
UNDO_S
 * 
u
 = & 
glb_ds1
[
ds1_idx
].
undo
;

73 
Áke
 = 0, 
i
;

74 
tmp
[150];

77 i‡(
u
->
Âå
 !
NULL
)

79 
	`f˛o£
(
u
->
Âå
);

80 
	`•rötf
(
tmp
, "undo_new_buffer() : undo fileÖointer wasÇot NULL, "

81 "tûêbuf„∏%s", 
u
->
«me
);

82 
	`ds1edô_îr‹
(
tmp
);

86 i‡(
u
->
cur_buf_num
 < u->
buf_num
 - 1)

89 
i
 = 
u
->
cur_buf_num
 + 1; i < u->
buf_num
; i++)

91 
	`•rötf
(
tmp
, "%s%sundo%ôûe%li.bö", 
glb_ds1edô_d©a_dú
,

92 
glb_ds1edô_tmp_dú
, 
ds1_idx
, 
i
);

93 
	`ªmove
(
tmp
);

97 
u
->
buf_num
 = u->
cur_buf_num
 + 1;

101 
	`•rötf
(
u
->
«me
, "%s%sundo%ôûe%li.bö", 
glb_ds1edô_d©a_dú
,

102 
glb_ds1edô_tmp_dú
, 
ds1_idx
, 
u
->
buf_num
);

103 
u
->
Âå
 = 
	`f›í
(u->
«me
, "wb");

104 i‡(
u
->
Âå
 =
NULL
)

106 
	`•rötf
(
tmp
, "undo_√w_tûe_buf„r(Ë: c™'à¸óã %s", 
u
->
«me
);

107 
	`ds1edô_îr‹
(
tmp
);

111 
	`fwrôe
(
u
->
èg
, (u->èg), 1, u->
Âå
);

114 
u
->
£g_off£t
 = 
	`·ñl
(u->
Âå
);

115 
	`fwrôe
(&
Áke
, (
u
->
£g_num
), 1, u->
Âå
);

118 
u
->
ö_£g
 = 
FALSE
;

119 
u
->
£g_num
 = 0;

120 
u
->
˚Œ_off£t
 = -1;

121 
u
->
˚Œ_num
 = 0;

122 
u
->
ﬁd_x
 = (
UBYTE
) -1;

123 
u
->
ﬁd_y
 = (
UBYTE
) -1;

124 
	`undo_ª£t_Êags
(
ds1_idx
);

125 
	}
}

130 
	$undo_°¨t_£g_ö_tûe_buf„r
(
ds1_idx
, 
UBYTE
 
x
, UBYTE 
y
)

132 
UNDO_S
 * 
u
 = & 
glb_ds1
[
ds1_idx
].
undo
;

133 
Áke
 = 0;

134 
tmp
[150];

137 i‡(
u
->
Âå
 =
NULL
)

139 
	`f˛o£
(
u
->
Âå
);

140 
	`•rötf
(
tmp
, "undo_start_seg_in_tile_buffer() : undo fileÖointer"

141 "i†NULL,Åûêbuf„∏%li", 
u
->
buf_num
);

142 
	`ds1edô_îr‹
(
tmp
);

146 i‡(
u
->
ö_£g
 !
FALSE
)

148 
	`f˛o£
(
u
->
Âå
);

149 
	`•rötf
(
tmp
, "undo_start_seg_in_tile_buffer() :ÅryÅo startá "

151 
	`ds1edô_îr‹
(
tmp
);

155 
u
->
ö_£g
 = 
TRUE
;

156 
u
->
£g_num
++;

159 
	`fwrôe
(&
x
, (x), 1, 
u
->
Âå
);

160 
	`fwrôe
(&
y
, (y), 1, 
u
->
Âå
);

163 
u
->
˚Œ_off£t
 = 
	`·ñl
(u->
Âå
);

164 
	`fwrôe
(&
Áke
, (
u
->
˚Œ_num
), 1, u->
Âå
);

167 
u
->
˚Œ_num
 = 0;

168 
u
->
ﬁd_x
 = 
x
 - 1;

169 
u
->
ﬁd_y
 = 
y
;

170 
	}
}

175 
	$undo_˛o£_£g_ö_tûe_buf„r
(
ds1_idx
)

177 
UNDO_S
 * 
u
 = & 
glb_ds1
[
ds1_idx
].
undo
;

178 
ﬁd_±r
;

179 
tmp
[150];

182 i‡(
u
->
Âå
 =
NULL
)

184 
	`f˛o£
(
u
->
Âå
);

185 
	`•rötf
(
tmp
, "undo_close_seg_in_tile_buffer() : undo fileÖointer"

186 "i†NULL,Åûêbuf„∏%li", 
u
->
buf_num
);

187 
	`ds1edô_îr‹
(
tmp
);

190 i‡(
u
->
£g_num
 != 0)

193 i‡(
u
->
ö_£g
 =
FALSE
)

195 
	`f˛o£
(
u
->
Âå
);

196 
	`•rötf
(
tmp
, "undo_close_seg_in_tile_buffer() :ÅryÅo closeá "

198 
	`ds1edô_îr‹
(
tmp
);

202 
ﬁd_±r
 = 
	`·ñl
(
u
->
Âå
);

203 
	`f£ek
(
u
->
Âå
, u->
˚Œ_off£t
, 
SEEK_SET
);

204 
	`fwrôe
(&
u
->
˚Œ_num
, (u->˚Œ_num), 1, u->
Âå
);

205 
	`f£ek
(
u
->
Âå
, 
ﬁd_±r
, 
SEEK_SET
);

209 
u
->
ö_£g
 = 
FALSE
;

210 
	}
}

215 
	$undo_add_to_tûe_buf„r
(
ds1_idx
, 
ix
, 
iy
)

217 
UNDO_S
 * 
u
 = & 
glb_ds1
[
ds1_idx
].
undo
;

218 
UNDO_DAT_FLG_S
 * 
df
 = & 
u
->
d©_Êg
;

219 
tf
 = (
iy
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
) +

220 (
ix
 * 
glb_ds1
[
ds1_idx
].
Êo‹_num
),

221 
ts
 = (
iy
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
) +

222 (
ix
 * 
glb_ds1
[
ds1_idx
].
shadow_num
),

223 
tw
 = (
iy
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
) +

224 (
ix
 * 
glb_ds1
[
ds1_idx
].
wÆl_num
),

225 
i
;

226 
CELL_F_S
 * 
f
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
tf
;

227 
CELL_S_S
 * 
s
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
ts
;

228 
CELL_W_S
 * 
w
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
tw
;

229 
UWORD
 
œyî_Êag
 = 0;

230 
UBYTE
 
x
 = 
ix
 & 0xFF, 
y
 = 
iy
 & 0xFF;

231 
tmp
[150];

234 i‡(
u
->
Âå
 =
NULL
)

236 
	`•rötf
(
tmp
, "undo_add_to_tile_buffer() : can't write in undoÅile buffer %li",

237 
u
->
buf_num
);

238 
	`ds1edô_îr‹
(
tmp
);

242 
i
=0; i < 
glb_ds1
[
ds1_idx
].
Êo‹_num
; i++)

243 i‡(
df
->
f
[
i
])

244 
œyî_Êag
 |1 << 
i
;

245 
i
=0; i < 
glb_ds1
[
ds1_idx
].
shadow_num
; i++)

246 i‡(
df
->
s
[
i
])

247 
œyî_Êag
 |1 << (
i
 + 
FLOOR_MAX_LAYER
);

248 
i
=0; i < 
glb_ds1
[
ds1_idx
].
wÆl_num
; i++)

249 i‡(
df
->
w
[
i
])

250 
œyî_Êag
 |1 << (
i
 + 
FLOOR_MAX_LAYER
 + 
SHADOW_MAX_LAYER
);

253 i‡(
œyî_Êag
)

256 i‡–(
u
->
£g_num
 =0Ë|| ((
x
 !(u->
ﬁd_x
 + 1)Ë|| (
y
 !u->
ﬁd_y
)) )

259 i‡(
u
->
ö_£g
 !
FALSE
)

262 
	`undo_˛o£_£g_ö_tûe_buf„r
(
ds1_idx
);

266 
	`undo_°¨t_£g_ö_tûe_buf„r
(
ds1_idx
, 
x
, 
y
);

270 
	`fwrôe
(&
œyî_Êag
, ÷ayî_Êag), 1, 
u
->
Âå
);

271 
i
=0; i < 
glb_ds1
[
ds1_idx
].
Êo‹_num
; i++)

273 i‡(
œyî_Êag
 & (1 << 
i
))

275 
	`fwrôe
(&
df
->
f
[
i
], (df->f[i]), 1, 
u
->
Âå
);

277 i‡(
df
->
f
[
i
] & 
DF_P1
)

278 
	`fwrôe
(&
f
[
i
].
¥›1
, (f[i].¥›1), 1, 
u
->
Âå
);

280 i‡(
df
->
f
[
i
] & 
DF_P2
)

281 
	`fwrôe
(&
f
[
i
].
¥›2
, (f[i].¥›2), 1, 
u
->
Âå
);

283 i‡(
df
->
f
[
i
] & 
DF_P3
)

284 
	`fwrôe
(&
f
[
i
].
¥›3
, (f[i].¥›3), 1, 
u
->
Âå
);

286 i‡(
df
->
f
[
i
] & 
DF_P4
)

287 
	`fwrôe
(&
f
[
i
].
¥›4
, (f[i].¥›4), 1, 
u
->
Âå
);

289 i‡(
df
->
f
[
i
] & 
DF_BT
)

290 
	`fwrôe
(&
f
[
i
].
bt_idx
, (f[i].bt_idx), 1, 
u
->
Âå
);

292 i‡(
df
->
f
[
i
] & 
DF_FL
)

293 
	`fwrôe
(&
f
[
i
].
Êags
, (f[i].Êags), 1, 
u
->
Âå
);

296 
i
=0; i < 
glb_ds1
[
ds1_idx
].
shadow_num
; i++)

298 i‡(
œyî_Êag
 & (1 << (
i
 + 
FLOOR_MAX_LAYER
)))

300 
	`fwrôe
(&
df
->
s
[
i
], (df->s[i]), 1, 
u
->
Âå
);

302 i‡(
df
->
s
[
i
] & 
DF_P1
)

303 
	`fwrôe
(&
s
[
i
].
¥›1
, (s[i].¥›1), 1, 
u
->
Âå
);

305 i‡(
df
->
s
[
i
] & 
DF_P2
)

306 
	`fwrôe
(&
s
[
i
].
¥›2
, (s[i].¥›2), 1, 
u
->
Âå
);

308 i‡(
df
->
s
[
i
] & 
DF_P3
)

309 
	`fwrôe
(&
s
[
i
].
¥›3
, (s[i].¥›3), 1, 
u
->
Âå
);

311 i‡(
df
->
s
[
i
] & 
DF_P4
)

312 
	`fwrôe
(&
s
[
i
].
¥›4
, (s[i].¥›4), 1, 
u
->
Âå
);

314 i‡(
df
->
s
[
i
] & 
DF_BT
)

315 
	`fwrôe
(&
s
[
i
].
bt_idx
, (s[i].bt_idx), 1, 
u
->
Âå
);

317 i‡(
df
->
s
[
i
] & 
DF_FL
)

318 
	`fwrôe
(&
s
[
i
].
Êags
, (s[i].Êags), 1, 
u
->
Âå
);

321 
i
=0; i < 
glb_ds1
[
ds1_idx
].
wÆl_num
; i++)

323 i‡(
œyî_Êag
 & (1 << (
i
 + 
FLOOR_MAX_LAYER
 + 
SHADOW_MAX_LAYER
)))

325 
	`fwrôe
(&
df
->
w
[
i
], (df->w[i]), 1, 
u
->
Âå
);

327 i‡(
df
->
w
[
i
] & 
DF_P1
)

328 
	`fwrôe
(&
w
[
i
].
¥›1
, (w[i].¥›1), 1, 
u
->
Âå
);

330 i‡(
df
->
w
[
i
] & 
DF_P2
)

331 
	`fwrôe
(&
w
[
i
].
¥›2
, (w[i].¥›2), 1, 
u
->
Âå
);

333 i‡(
df
->
w
[
i
] & 
DF_P3
)

334 
	`fwrôe
(&
w
[
i
].
¥›3
, (w[i].¥›3), 1, 
u
->
Âå
);

336 i‡(
df
->
w
[
i
] & 
DF_P4
)

337 
	`fwrôe
(&
w
[
i
].
¥›4
, (w[i].¥›4), 1, 
u
->
Âå
);

339 i‡(
df
->
w
[
i
] & 
DF_OR
)

340 
	`fwrôe
(&
w
[
i
].
‹õ¡©i⁄
, (w[i].‹õ¡©i⁄), 1, 
u
->
Âå
);

342 i‡(
df
->
w
[
i
] & 
DF_BT
)

343 
	`fwrôe
(&
w
[
i
].
bt_idx
, (w[i].bt_idx), 1, 
u
->
Âå
);

345 i‡(
df
->
w
[
i
] & 
DF_FL
)

346 
	`fwrôe
(&
w
[
i
].
Êags
, (w[i].Êags), 1, 
u
->
Âå
);

351 
	`undo_ª£t_Êags
(
ds1_idx
);

352 
u
->
ﬁd_x
++;

353 
u
->
˚Œ_num
++;

355 
	}
}

360 
	$undo_˛o£_tûe_buf„r
(
ds1_idx
)

362 
UNDO_S
 * 
u
 = & 
glb_ds1
[
ds1_idx
].
undo
;

363 
ﬁd_±r
;

364 
tmp
[150];

367 i‡(
u
->
Âå
 =
NULL
)

369 
	`•rötf
(
tmp
, "undo_close_tile_buffer() :Ço undoÅile bufferÖointer "

370 "tÿ˛o£ (%li)", 
u
->
buf_num
);

371 
	`ds1edô_îr‹
(
tmp
);

374 i‡(
u
->
ö_£g
 !
FALSE
)

375 
	`undo_˛o£_£g_ö_tûe_buf„r
(
ds1_idx
);

378 
ﬁd_±r
 = 
	`·ñl
(
u
->
Âå
);

379 
	`f£ek
(
u
->
Âå
, u->
£g_off£t
, 
SEEK_SET
);

380 
	`fwrôe
(&
u
->
£g_num
, (u->£g_num), 1, u->
Âå
);

381 
	`f£ek
(
u
->
Âå
, 
ﬁd_±r
, 
SEEK_SET
);

384 i‡(
	`f˛o£
(
u
->
Âå
) != 0)

386 
	`•rötf
(
tmp
, "undo_close_tile_buffer() : can't close undoÅile "

387 "buf„∏%li", 
u
->
buf_num
);

388 
	`ds1edô_îr‹
(
tmp
);

392 
u
->
cur_buf_num
 = u->
buf_num
;

393 
u
->
buf_num
++;

394 
u
->
Âå
 = 
NULL
;

395 
	`°r˝y
(
u
->
«me
, "");

396 
	}
}

401 
	$undo_≠∂y_tûe_buf„r
(
ds1_idx
)

403 
UNDO_S
 * 
u
 = & 
glb_ds1
[
ds1_idx
].
undo
;

404 
FILE
 * 
ö
;

405 
tf
, 
ts
, 
tw
, 
i
, 
c
, 
s
, 
£g_num
, 
˚Œ_num
, 
x
, 
y
, 
œyî_Êag
, 
d©a_Êag
;

406 
CELL_F_S
 * 
f
;

407 
CELL_S_S
 * 
sh
;

408 
CELL_W_S
 * 
w
;

409 
undo_fûe
[100], 
tmp
[100];

411 i‡((
u
->
buf_num
 <0Ë|| (u->
cur_buf_num
 < 0))

414 
	`•rötf
(
undo_fûe
, "%s%sundo%ôûe%li.bö", 
glb_ds1edô_d©a_dú
,

415 
glb_ds1edô_tmp_dú
, 
ds1_idx
, 
u
->
cur_buf_num
);

416 
ö
 = 
	`f›í
(
undo_fûe
, "rb");

417 i‡(
ö
 =
NULL
)

419 
	`•rötf
(
tmp
, "undo_≠∂y_tûe_buf„r(Ë: c™'à›í %s", 
undo_fûe
);

420 
	`ds1edô_îr‹
(
tmp
);

423 
i
=0; i < (
u
->
èg
); i++)

425 
c
 = 
	`fgëc
(
ö
);

426 i‡(
c
 !
u
->
èg
[
i
])

428 
	`f˛o£
(
ö
);

429 
	`•rötf
(
tmp
, "undo_≠∂y_tûe_buf„r(Ë: wr⁄gÅag i¿%s", 
u
->
«me
);

430 
	`ds1edô_îr‹
(
tmp
);

434 
£g_num
 = 
	`fgëc
(
ö
);

435 
s
=0; s < 
£g_num
; s++)

437 
x
 = 
	`fgëc
(
ö
);

438 
y
 = 
	`fgëc
(
ö
);

439 
˚Œ_num
 = 
	`fgëc
(
ö
);

440 
c
=0; c < 
˚Œ_num
; c++)

442 i‡–(
x
 < 0Ë|| (
y
 < 0) ||

443 (
x
 >
glb_ds1
[
ds1_idx
].
width
) ||

444 (
y
 >
glb_ds1
[
ds1_idx
].
height
)

447 
	`f˛o£
(
ö
);

448 
	`•rötf
(
tmp
, "undo_apply_tile_buffer() : wrong cell (%i, %i)",

449 
x
, 
y
);

450 
	`ds1edô_îr‹
(
tmp
);

452 
tf
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

453 
ts
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

454 
tw
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

455 
f
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
tf
;

456 
sh
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
ts
;

457 
w
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
tw
;

458 
	`‰ód
(&
œyî_Êag
, (
UWORD
), 1, 
ö
);

459 
i
=0; i < 
glb_ds1
[
ds1_idx
].
Êo‹_num
; i++)

461 i‡(
œyî_Êag
 & (1 << 
i
))

463 
d©a_Êag
 = 
	`fgëc
(
ö
);

465 i‡(
d©a_Êag
 & 
DF_P1
)

466 
f
[
i
].
¥›1
 = 
	`fgëc
(
ö
);

468 i‡(
d©a_Êag
 & 
DF_P2
)

469 
f
[
i
].
¥›2
 = 
	`fgëc
(
ö
);

471 i‡(
d©a_Êag
 & 
DF_P3
)

472 
f
[
i
].
¥›3
 = 
	`fgëc
(
ö
);

474 i‡(
d©a_Êag
 & 
DF_P4
)

475 
f
[
i
].
¥›4
 = 
	`fgëc
(
ö
);

477 i‡(
d©a_Êag
 & 
DF_BT
)

478 
	`‰ód
(&
f
[
i
].
bt_idx
, (f[i].bt_idx), 1, 
ö
);

480 
	`Âr›_2_block
(
ds1_idx
, &
f
[
i
]);

482 i‡(
d©a_Êag
 & 
DF_FL
)

483 
f
[
i
].
Êags
 = 
	`fgëc
(
ö
);

486 
i
=0; i < 
glb_ds1
[
ds1_idx
].
shadow_num
; i++)

488 i‡(
œyî_Êag
 & (1 << (
i
 + 
FLOOR_MAX_LAYER
)))

490 
d©a_Êag
 = 
	`fgëc
(
ö
);

492 i‡(
d©a_Êag
 & 
DF_P1
)

493 
sh
[
i
].
¥›1
 = 
	`fgëc
(
ö
);

495 i‡(
d©a_Êag
 & 
DF_P2
)

496 
sh
[
i
].
¥›2
 = 
	`fgëc
(
ö
);

498 i‡(
d©a_Êag
 & 
DF_P3
)

499 
sh
[
i
].
¥›3
 = 
	`fgëc
(
ö
);

501 i‡(
d©a_Êag
 & 
DF_P4
)

502 
sh
[
i
].
¥›4
 = 
	`fgëc
(
ö
);

504 i‡(
d©a_Êag
 & 
DF_BT
)

505 
	`‰ód
(&
sh
[
i
].
bt_idx
, (sh[i].bt_idx), 1, 
ö
);

507 
	`•r›_2_block
(
ds1_idx
, &
sh
[
i
]);

509 i‡(
d©a_Êag
 & 
DF_FL
)

510 
sh
[
i
].
Êags
 = 
	`fgëc
(
ö
);

513 
i
=0; i < 
glb_ds1
[
ds1_idx
].
wÆl_num
; i++)

515 i‡(
œyî_Êag
 & (1 << (
i
 + 
FLOOR_MAX_LAYER
 + 
SHADOW_MAX_LAYER
)))

517 
d©a_Êag
 = 
	`fgëc
(
ö
);

519 i‡(
d©a_Êag
 & 
DF_P1
)

520 
w
[
i
].
¥›1
 = 
	`fgëc
(
ö
);

522 i‡(
d©a_Êag
 & 
DF_P2
)

523 
w
[
i
].
¥›2
 = 
	`fgëc
(
ö
);

525 i‡(
d©a_Êag
 & 
DF_P3
)

526 
w
[
i
].
¥›3
 = 
	`fgëc
(
ö
);

528 i‡(
d©a_Êag
 & 
DF_P4
)

529 
w
[
i
].
¥›4
 = 
	`fgëc
(
ö
);

531 i‡(
d©a_Êag
 & 
DF_OR
)

532 
w
[
i
].
‹õ¡©i⁄
 = 
	`fgëc
(
ö
);

534 i‡(
d©a_Êag
 & 
DF_BT
)

535 
	`‰ód
(&
w
[
i
].
bt_idx
, (w[i].bt_idx), 1, 
ö
);

537 
	`w¥›_2_block
(
ds1_idx
, &
w
[
i
]);

539 i‡(
d©a_Êag
 & 
DF_FL
)

540 
w
[
i
].
Êags
 = 
	`fgëc
(
ö
);

543 
x
++;

546 
	`f˛o£
(
ö
);

547 
u
->
cur_buf_num
--;

548 
	}
}

554 
	$undo_add_this_tûe_to_buf„r
(
ds1_idx
, 
ix
, 
iy
,

555 
CELL_F_S
 * 
f
, 
CELL_W_S
 * 
w
, 
CELL_S_S
 * 
s
)

557 
UNDO_S
 * 
u
 = & 
glb_ds1
[
ds1_idx
].
undo
;

558 
UNDO_DAT_FLG_S
 * 
df
 = & 
u
->
d©_Êg
;

559 
i
;

560 
UWORD
 
œyî_Êag
 = 0;

561 
UBYTE
 
x
 = 
ix
 & 0xFF, 
y
 = 
iy
 & 0xFF;

562 
tmp
[150];

566 i‡(
u
->
Âå
 =
NULL
)

568 
	`•rötf
(
tmp
, "undo_add_to_tile_buffer() : can't write in undoÅile buffer %li",

569 
u
->
buf_num
);

570 
	`ds1edô_îr‹
(
tmp
);

574 
i
=0; i < 
glb_ds1
[
ds1_idx
].
Êo‹_num
; i++)

575 i‡(
df
->
f
[
i
])

576 
œyî_Êag
 |1 << 
i
;

578 
i
=0; i < 
glb_ds1
[
ds1_idx
].
shadow_num
; i++)

579 i‡(
df
->
s
[
i
])

580 
œyî_Êag
 |1 << (
i
 + 
FLOOR_MAX_LAYER
);

582 
i
=0; i < 
glb_ds1
[
ds1_idx
].
wÆl_num
; i++)

583 i‡(
df
->
w
[
i
])

584 
œyî_Êag
 |1 << (
i
 + 
FLOOR_MAX_LAYER
 + 
SHADOW_MAX_LAYER
);

588 i‡(
œyî_Êag
)

591 i‡–(
u
->
£g_num
 =0Ë|| ((
x
 !(u->
ﬁd_x
 + 1)Ë|| (
y
 !u->
ﬁd_y
)) )

594 i‡(
u
->
ö_£g
 !
FALSE
)

597 
	`undo_˛o£_£g_ö_tûe_buf„r
(
ds1_idx
);

601 
	`undo_°¨t_£g_ö_tûe_buf„r
(
ds1_idx
, 
x
, 
y
);

605 
	`fwrôe
(&
œyî_Êag
, ÷ayî_Êag), 1, 
u
->
Âå
);

606 
i
=0; i < 
glb_ds1
[
ds1_idx
].
Êo‹_num
; i++)

608 i‡(
œyî_Êag
 & (1 << 
i
))

610 
	`fwrôe
(&
df
->
f
[
i
], (df->f[i]), 1, 
u
->
Âå
);

612 i‡(
df
->
f
[
i
] & 
DF_P1
)

613 
	`fwrôe
(&
f
[
i
].
¥›1
, (f[i].¥›1), 1, 
u
->
Âå
);

615 i‡(
df
->
f
[
i
] & 
DF_P2
)

616 
	`fwrôe
(&
f
[
i
].
¥›2
, (f[i].¥›2), 1, 
u
->
Âå
);

618 i‡(
df
->
f
[
i
] & 
DF_P3
)

619 
	`fwrôe
(&
f
[
i
].
¥›3
, (f[i].¥›3), 1, 
u
->
Âå
);

621 i‡(
df
->
f
[
i
] & 
DF_P4
)

622 
	`fwrôe
(&
f
[
i
].
¥›4
, (f[i].¥›4), 1, 
u
->
Âå
);

624 i‡(
df
->
f
[
i
] & 
DF_BT
)

625 
	`fwrôe
(&
f
[
i
].
bt_idx
, (f[i].bt_idx), 1, 
u
->
Âå
);

627 i‡(
df
->
f
[
i
] & 
DF_FL
)

628 
	`fwrôe
(&
f
[
i
].
Êags
, (f[i].Êags), 1, 
u
->
Âå
);

631 
i
=0; i < 
glb_ds1
[
ds1_idx
].
shadow_num
; i++)

633 i‡(
œyî_Êag
 & (1 << (
i
 + 
FLOOR_MAX_LAYER
) ))

635 
	`fwrôe
(&
df
->
s
[
i
], (df->s[i]), 1, 
u
->
Âå
);

637 i‡(
df
->
s
[
i
] & 
DF_P1
)

638 
	`fwrôe
(&
s
[
i
].
¥›1
, (s[i].¥›1), 1, 
u
->
Âå
);

640 i‡(
df
->
s
[
i
] & 
DF_P2
)

641 
	`fwrôe
(&
s
[
i
].
¥›2
, (s[i].¥›2), 1, 
u
->
Âå
);

643 i‡(
df
->
s
[
i
] & 
DF_P3
)

644 
	`fwrôe
(&
s
[
i
].
¥›3
, (s[i].¥›3), 1, 
u
->
Âå
);

646 i‡(
df
->
s
[
i
] & 
DF_P4
)

647 
	`fwrôe
(&
s
[
i
].
¥›4
, (s[i].¥›4), 1, 
u
->
Âå
);

649 i‡(
df
->
s
[
i
] & 
DF_BT
)

650 
	`fwrôe
(&
s
[
i
].
bt_idx
, (s[i].bt_idx), 1, 
u
->
Âå
);

652 i‡(
df
->
s
[
i
] & 
DF_FL
)

653 
	`fwrôe
(&
s
[
i
].
Êags
, (s[i].Êags), 1, 
u
->
Âå
);

656 
i
=0; i < 
glb_ds1
[
ds1_idx
].
wÆl_num
; i++)

658 i‡(
œyî_Êag
 & (1 << (
i
 + 
FLOOR_MAX_LAYER
 + 
SHADOW_MAX_LAYER
)))

660 
	`fwrôe
(&
df
->
w
[
i
], (df->w[i]), 1, 
u
->
Âå
);

662 i‡(
df
->
w
[
i
] & 
DF_P1
)

663 
	`fwrôe
(&
w
[
i
].
¥›1
, (w[i].¥›1), 1, 
u
->
Âå
);

665 i‡(
df
->
w
[
i
] & 
DF_P2
)

666 
	`fwrôe
(&
w
[
i
].
¥›2
, (w[i].¥›2), 1, 
u
->
Âå
);

668 i‡(
df
->
w
[
i
] & 
DF_P3
)

669 
	`fwrôe
(&
w
[
i
].
¥›3
, (w[i].¥›3), 1, 
u
->
Âå
);

671 i‡(
df
->
w
[
i
] & 
DF_P4
)

672 
	`fwrôe
(&
w
[
i
].
¥›4
, (w[i].¥›4), 1, 
u
->
Âå
);

674 i‡(
df
->
w
[
i
] & 
DF_OR
)

675 
	`fwrôe
(&
w
[
i
].
‹õ¡©i⁄
, (w[i].‹õ¡©i⁄), 1, 
u
->
Âå
);

677 i‡(
df
->
w
[
i
] & 
DF_BT
)

678 
	`fwrôe
(&
w
[
i
].
bt_idx
, (w[i].bt_idx), 1, 
u
->
Âå
);

680 i‡(
df
->
w
[
i
] & 
DF_FL
)

681 
	`fwrôe
(&
w
[
i
].
Êags
, (w[i].Êags), 1, 
u
->
Âå
);

686 
	`undo_ª£t_Êags
(
ds1_idx
);

687 
u
->
ﬁd_x
++;

688 
u
->
˚Œ_num
++;

690 
	}
}

	@undo.h

1 #i‚de‡
_UNDO_H_


3 
	#_UNDO_H_


	)

5 
undo_ª£t_Êags
 (
ds1_idx
);

6 
undo_exô
 ();

7 
undo_√w_tûe_buf„r
 (
ds1_idx
);

8 
undo_°¨t_£g_ö_tûe_buf„r
 (
ds1_idx
, 
UBYTE
 
x
, UBYTE 
y
);

9 
undo_˛o£_£g_ö_tûe_buf„r
 (
ds1_idx
);

10 
undo_add_to_tûe_buf„r
 (
ds1_idx
, 
ix
, 
iy
);

11 
undo_˛o£_tûe_buf„r
 (
ds1_idx
);

12 
undo_≠∂y_tûe_buf„r
 (
ds1_idx
);

13 
undo_add_this_tûe_to_buf„r
 (
ds1_idx
, 
ix
, 
iy
, 
CELL_F_S
 * 
f
, 
CELL_W_S
 * 
w
, 
CELL_S_S
 * 
s
);

	@wBits.c

1 
	~"°ru˘s.h
"

2 
	~"îr‹.h
"

3 
	~"ds1misc.h
"

4 
	~"wBôs.h
"

5 
	~"misc.h
"

9 
	$wbôs_maö_sögÀ_tûe
(
ds1_idx
, 
tx
, 
ty
)

11 
CELL_F_S
 * 
f_±r
;

12 
CELL_W_S
 * 
w_±r
;

13 
CELL_S_S
 * 
s_±r
;

14 
CELL_T_S
 * 
t_±r
;

15 
t
, 
n
;

16 
w_x0
, 
w_y0
, 
w_x1
, 
w_y1
;

17 
ok_x0
, 
ok_y0
, 
ˇn˚l_x0
;

18 
c_bœck
 = 
	`makecﬁ
(0, 0, 0),

19 
c_whôe
 = 
	`makecﬁ
(255, 255, 255),

20 
c_yñlow
 = 
	`makecﬁ
(255, 255, 0),

21 
c_d¨kgªí
 = 
	`makecﬁ
(0, 64, 0),

22 
c_lightgªí
 = 
	`makecﬁ
(0, 255, 0),

23 
c_ªd
 = 
	`makecﬁ
(255, 0, 0),

24 
c
, 
c1
, 
c2
, 
c3
, 
mx
, 
my
, 
mb
;

25 
b
, 
i
, 
vÆ
[4], 
x
, 
y
, 
ßve
 = 
FALSE
, 
d⁄e
 = FALSE;

26 
UBYTE
 
¥›s
[6][4], 
dú
[4], 
shad
[4];

27 
UDWORD
 
èg_dw
;

29 
w_width
 = 545, 
w_height
= 270;

32 
	`ãxt_mode
(-1);

34 
w_x0
 = (
glb_c⁄fig
.
s¸ìn
.
width
 - 
w_width
) / 2;

35 
w_y0
 = (
glb_c⁄fig
.
s¸ìn
.
height
 - 
w_height
) / 2;

36 
w_x1
 = 
w_x0
 + 
w_width
;

37 
w_y1
 = 
w_y0
 + 
w_height
;

39 
ok_x0
 = 
w_x0
 + (
w_width
 / 2) - 64;

40 
ok_y0
 = 
w_y0
 + 
w_height
 - 24;

41 
ˇn˚l_x0
 = 
ok_x0
 + 70;

43 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
w_x0
, 
w_y0
, 
w_x1
, 
w_y1
, 
c_bœck
);

44 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
, 
w_x0
, 
w_y0
, 
w_x1
, 
w_y1
, 
c_whôe
);

46 i‡(
glb_ds1
[
ds1_idx
].
Êo‹_num
 >= 1)

47 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "F1", 
w_x0
 + 2, 
w_y0
 + 2, 
c_yñlow
);

48 i‡(
glb_ds1
[
ds1_idx
].
Êo‹_num
 >= 2)

49 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "F2", 
w_x0
 + 2, 
w_y0
 + 12, 
c_yñlow
);

51 i‡(
glb_ds1
[
ds1_idx
].
shadow_num
 >= 1)

52 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "SH", 
w_x0
 + 2, 
w_y0
 + 32, 
c_yñlow
);

54 i‡(
glb_ds1
[
ds1_idx
].
wÆl_num
 >= 1)

55 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "W1", 
w_x0
 + 2, 
w_y0
 + 52, 
c_yñlow
);

56 i‡(
glb_ds1
[
ds1_idx
].
wÆl_num
 >= 2)

57 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "W2", 
w_x0
 + 2, 
w_y0
 + 62, 
c_yñlow
);

58 i‡(
glb_ds1
[
ds1_idx
].
wÆl_num
 >= 3)

59 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "W3", 
w_x0
 + 2, 
w_y0
 + 72, 
c_yñlow
);

60 i‡(
glb_ds1
[
ds1_idx
].
wÆl_num
 >= 4)

61 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "W4", 
w_x0
 + 2, 
w_y0
 + 82, 
c_yñlow
);

63 i‡(
glb_ds1
[
ds1_idx
].
èg_num
 >= 1)

64 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "SUB", 
w_x0
 + 2, 
w_y0
 + 200, 
c_yñlow
);

66 
	`vlöe
(
glb_ds1edô
.
s¸ìn_buff
, 
w_x0
 + 237, 
w_y0
 + 92, w_y0 + 105, 
c_yñlow
);

67 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "UnwÆkabÀ", 
w_x0
 + 200, 
w_y0
 + 110, 
c_yñlow
);

69 
	`vlöe
(
glb_ds1edô
.
s¸ìn_buff
, 
w_x0
 + 27, 
w_y0
 + 92, w_y0 + 105, 
c_yñlow
);

70 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "Hiddí", 
w_x0
 + 10, 
w_y0
 + 110, 
c_yñlow
);

72 
	`vlöe
(
glb_ds1edô
.
s¸ìn_buff
, 
w_x0
 + 87, 
w_y0
 + 92, w_y0 + 105, 
c_yñlow
);

73 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "?", 
w_x0
 + 82, 
w_y0
 + 110, 
c_yñlow
);

75 
	`vlöe
(
glb_ds1edô
.
s¸ìn_buff
, 
w_x0
 + 97, 
w_y0
 + 92, w_y0 + 125, 
c_yñlow
);

76 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "IsShadow", 
w_x0
 + 60, 
w_y0
 + 130, 
c_yñlow
);

78 
	`vlöe
(
glb_ds1edô
.
s¸ìn_buff
, 
w_x0
 + 162, 
w_y0
 + 92, w_y0 + 140, 
c_yñlow
);

79 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "Maö-ödex", 
w_x0
 + 130, 
w_y0
 + 145, 
c_yñlow
);

81 
	`vlöe
(
glb_ds1edô
.
s¸ìn_buff
, 
w_x0
 + 333, 
w_y0
 + 92, w_y0 + 140, 
c_yñlow
);

82 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "Sub-ödex", 
w_x0
 + 300, 
w_y0
 + 145, 
c_yñlow
);

84 
	`vlöe
(
glb_ds1edô
.
s¸ìn_buff
, 
w_x0
 + 413, 
w_y0
 + 92, w_y0 + 100, 
c_yñlow
);

85 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "Layî†¥i‹ôy,", 
w_x0
 + 360, 
w_y0
 + 105, 
c_yñlow
);

86 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "Ty≥ o‡œyîs,", 
w_x0
 + 360, 
w_y0
 + 115, 
c_yñlow
);

87 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "ánd unknown", 
w_x0
 + 360, 
w_y0
 + 125, 
c_yñlow
);

89 
	`vlöe
(
glb_ds1edô
.
s¸ìn_buff
, 
w_x0
 + 503, 
w_y0
 + 92, w_y0 + 140, 
c_yñlow
);

90 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "Orõ¡©i⁄", 
w_x0
 + 455, 
w_y0
 + 145, 
c_yñlow
);

93 
t
 = (
ty
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
tx
 * glb_ds1[ds1_idx].
Êo‹_num
);

94 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
t
;

96 
i
=0; i < 
glb_ds1
[
ds1_idx
].
Êo‹_num
; i++)

98 
¥›s
[
i
][0] = 
f_±r
[i].
¥›1
;

99 
¥›s
[
i
][1] = 
f_±r
[i].
¥›2
;

100 
¥›s
[
i
][2] = 
f_±r
[i].
¥›3
;

101 
¥›s
[
i
][3] = 
f_±r
[i].
¥›4
;

104 
t
 = (
ty
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
tx
 * glb_ds1[ds1_idx].
wÆl_num
);

105 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
t
;

106 
i
=0; i < 
glb_ds1
[
ds1_idx
].
wÆl_num
; i++)

108 
¥›s
[
i
+2][0] = 
w_±r
[i].
¥›1
;

109 
¥›s
[
i
+2][1] = 
w_±r
[i].
¥›2
;

110 
¥›s
[
i
+2][2] = 
w_±r
[i].
¥›3
;

111 
¥›s
[
i
+2][3] = 
w_±r
[i].
¥›4
;

112 
dú
[
i
] = 
w_±r
[i].
‹õ¡©i⁄
;

115 
t
 = (
ty
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
tx
 * glb_ds1[ds1_idx].
shadow_num
);

116 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
t
;

117 
i
=0; i < 
glb_ds1
[
ds1_idx
].
shadow_num
; i++)

119 
shad
[0] = 
s_±r
[
i
].
¥›1
;

120 
shad
[1] = 
s_±r
[
i
].
¥›2
;

121 
shad
[2] = 
s_±r
[
i
].
¥›3
;

122 
shad
[3] = 
s_±r
[
i
].
¥›4
;

125 
t
 = (
ty
 * 
glb_ds1
[
ds1_idx
].
èg_löe
Ë+ (
tx
 * glb_ds1[ds1_idx].
èg_num
);

126 
t_±r
 = 
glb_ds1
[
ds1_idx
].
èg_buff
 + 
t
;

127 
èg_dw
 = 
t_±r
->
num
;

131 
mx
 = 
mou£_x
;

132 
my
 = 
mou£_y
;

133 
mb
 = 
mou£_b
;

136  ! 
d⁄e
)

138 
	`ãxt_mode
(-1);

141 
c1
 = 
c_d¨kgªí
;

142 
c2
 = 
c_lightgªí
;

143 
c3
 = 
c_yñlow
;

144 i‡((
mx
 >
ok_x0
Ë&& (mx <ok_x0 + 64Ë&& (
my
 >
ok_y0
) && (my <= ok_y0 + 20))

146 
c1
 = 
c_lightgªí
;

147 
c2
 = 
c_whôe
;

148 
c3
 = 
c_bœck
;

149 i‡(
mb
 & 1)

152 
ßve
 = 
TRUE
;

153 
d⁄e
 = 
TRUE
;

154 
mou£_b
 & 1)

160 i‡(
key
[
KEY_ENTER
] || key[
KEY_ENTER_PAD
])

162 
ßve
 = 
TRUE
;

163 
d⁄e
 = 
TRUE
;

165 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
ok_x0
, 
ok_y0
-3, ok_x0 + 64, ok_y0 + 20, 
c1
);

166 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
, 
ok_x0
, 
ok_y0
-3, ok_x0 + 64, ok_y0 + 20, 
c2
);

167 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "OK", 
ok_x0
+25, 
ok_y0
+5, 
c3
);

170 
c1
 = 
c_d¨kgªí
;

171 
c2
 = 
c_lightgªí
;

172 
c3
 = 
c_yñlow
;

173 i‡((
mx
 >
ˇn˚l_x0
Ë&& (mx <ˇn˚l_x0 + 64Ë&& (
my
 >
ok_y0
) && (my <= ok_y0 + 20))

175 
c1
 = 
c_lightgªí
;

176 
c2
 = 
c_whôe
;

177 
c3
 = 
c_bœck
;

178 i‡(
mb
 & 1)

181 
ßve
 = 
FALSE
;

182 
d⁄e
 = 
TRUE
;

183 
mou£_b
 & 1)

189 i‡(
key
[
KEY_ESC
])

191 
ßve
 = 
FALSE
;

192 
d⁄e
 = 
TRUE
;

194 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
ˇn˚l_x0
, 
ok_y0
-3, c™˚l_x0 + 64, ok_y0 + 20, 
c1
);

195 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
, 
ˇn˚l_x0
, 
ok_y0
-3, c™˚l_x0 + 64, ok_y0 + 20, 
c2
);

196 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "CANCEL", 
ˇn˚l_x0
+10, 
ok_y0
+5, 
c3
);

198 
	`ãxt_mode
(0);

201 
y
 = 
w_y0
 + 2;

202 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
Êo‹_num
;Ç++)

204 
vÆ
[0] = 
f_±r
[
n
].
¥›1
;

205 
vÆ
[1] = 
f_±r
[
n
].
¥›2
;

206 
vÆ
[2] = 
f_±r
[
n
].
¥›3
;

207 
vÆ
[3] = 
f_±r
[
n
].
¥›4
;

208 
x
 = 
w_x0
 + 24;

209 
b
=3; b >= 0 ; b--)

211 
i
=7; i >= 0; i--)

213 
c
 = 
c_whôe
;

214 i‡–(
mx
 >
x
) && (mx <= x+9) &&

215 (
my
 >
y
) && (my <= y+9) )

217 
c
 = 
c_ªd
;

218 i‡(
mb
 & 1)

220 i‡(
vÆ
[
b
] & (1 << 
i
))

223 
vÆ
[
b
] = vÆ[b] - (1 << 
i
);

228 
vÆ
[
b
] = vÆ[b] + (1 << 
i
);

230 
mb
 & 1)

233 
mb
 = 
mou£_b
;

235 
b
)

237 0 : 
f_±r
[
n
].
¥›1
 = 
vÆ
[
b
]; ;

238 1 : 
f_±r
[
n
].
¥›2
 = 
vÆ
[
b
]; ;

239 2 : 
f_±r
[
n
].
¥›3
 = 
vÆ
[
b
]; ;

240 3 : 
f_±r
[
n
].
¥›4
 = 
vÆ
[
b
]; ;

244 i‡(
vÆ
[
b
] & (1 << 
i
))

245 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "1", 
x
, 
y
, 
c
);

247 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "0", 
x
, 
y
, 
c
);

248 
x
 += 10;

250 i‡((
b
==3Ë&& ((
i
==7) || (i==6) || (i==5) || (i==3) || (i==2)))

251 
x
+=10;

252 i‡((
b
==2Ë&& ((
i
==4) || (i==2) || (i==1) || (i==0)))

253 
x
+=10;

254 i‡((
b
==1Ë&& ((
i
==6) || (i==0)))

255 
x
+=10;

258 
y
 += 10;

262 
y
 +10 * (2 - 
glb_ds1
[
ds1_idx
].
Êo‹_num
);

263 
y
 += 10;

264 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
shadow_num
;Ç++)

266 
shad
[0] = 
s_±r
[
n
].
¥›1
;

267 
shad
[1] = 
s_±r
[
n
].
¥›2
;

268 
shad
[2] = 
s_±r
[
n
].
¥›3
;

269 
shad
[3] = 
s_±r
[
n
].
¥›4
;

270 
x
 = 
w_x0
 + 24;

271 
b
=3; b >= 0 ; b--)

273 
i
=7; i >= 0; i--)

275 
c
 = 
c_whôe
;

276 i‡–(
mx
 >
x
) && (mx <= x+9) &&

277 (
my
 >
y
) && (my <= y+9) )

279 
c
 = 
c_ªd
;

280 i‡(
mb
 & 1)

282 i‡(
shad
[
b
] & (1 << 
i
))

285 
shad
[
b
] = shad[b] - (1 << 
i
);

290 
shad
[
b
] = shad[b] + (1 << 
i
);

292 
mb
 & 1)

295 
mb
 = 
mou£_b
;

297 
b
)

299 0 : 
s_±r
[
n
].
¥›1
 = 
shad
[
b
]; ;

300 1 : 
s_±r
[
n
].
¥›2
 = 
shad
[
b
]; ;

301 2 : 
s_±r
[
n
].
¥›3
 = 
shad
[
b
]; ;

302 3 : 
s_±r
[
n
].
¥›4
 = 
shad
[
b
]; ;

306 i‡(
shad
[
b
] & (1 << 
i
))

307 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "1", 
x
, 
y
, 
c
);

309 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "0", 
x
, 
y
, 
c
);

310 
x
 += 10;

312 i‡((
b
==3Ë&& ((
i
==7) || (i==6) || (i==5) || (i==3) || (i==2)))

313 
x
+=10;

314 i‡((
b
==2Ë&& ((
i
==4) || (i==2) || (i==1) || (i==0)))

315 
x
+=10;

316 i‡((
b
==1Ë&& ((
i
==6) || (i==0)))

317 
x
+=10;

320 
y
 += 10;

324 
y
 += 10;

325 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

327 
vÆ
[0] = 
w_±r
[
n
].
¥›1
;

328 
vÆ
[1] = 
w_±r
[
n
].
¥›2
;

329 
vÆ
[2] = 
w_±r
[
n
].
¥›3
;

330 
vÆ
[3] = 
w_±r
[
n
].
¥›4
;

331 
x
 = 
w_x0
 + 24;

334 
b
=3; b >= 0 ; b--)

336 
i
=7; i >= 0; i--)

338 
c
 = 
c_whôe
;

339 i‡–(
mx
 >
x
) && (mx <= x+9) &&

340 (
my
 >
y
) && (my <= y+9) )

342 
c
 = 
c_ªd
;

343 i‡(
mb
 & 1)

345 i‡(
vÆ
[
b
] & (1 << 
i
))

348 
vÆ
[
b
] = vÆ[b] - (1 << 
i
);

353 
vÆ
[
b
] = vÆ[b] + (1 << 
i
);

355 
mb
 & 1)

358 
mb
 = 
mou£_b
;

360 
b
)

362 0 : 
w_±r
[
n
].
¥›1
 = 
vÆ
[
b
]; ;

363 1 : 
w_±r
[
n
].
¥›2
 = 
vÆ
[
b
]; ;

364 2 : 
w_±r
[
n
].
¥›3
 = 
vÆ
[
b
]; ;

365 3 : 
w_±r
[
n
].
¥›4
 = 
vÆ
[
b
]; ;

369 i‡(
vÆ
[
b
] & (1 << 
i
))

370 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "1", 
x
, 
y
, 
c
);

372 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "0", 
x
, 
y
, 
c
);

373 
x
 += 10;

375 i‡((
b
==3Ë&& ((
i
==7) || (i==6) || (i==5) || (i==3) || (i==2)))

376 
x
+=10;

377 i‡((
b
==2Ë&& ((
i
==4) || (i==2) || (i==1) || (i==0)))

378 
x
+=10;

379 i‡((
b
==1Ë&& ((
i
==6) || (i==0)))

380 
x
+=10;

381 i‡((
b
==0Ë&& (
i
==0))

382 
x
+=10;

387 
i
=7; i >= 0; i--)

389 
c
 = 
c_whôe
;

390 i‡–(
mx
 >
x
) && (mx <= x+9) &&

391 (
my
 >
y
) && (my <= y+9) )

393 
c
 = 
c_ªd
;

394 i‡(
mb
 & 1)

396 i‡(
w_±r
[
n
].
‹õ¡©i⁄
 & (1 << 
i
))

399 
w_±r
[
n
].
‹õ¡©i⁄
 = w_±r[n].‹õ¡©i⁄ - (1 << 
i
);

404 
w_±r
[
n
].
‹õ¡©i⁄
 = w_±r[n].‹õ¡©i⁄ + (1 << 
i
);

406 
mb
 & 1)

409 
mb
 = 
mou£_b
;

413 i‡(
w_±r
[
n
].
‹õ¡©i⁄
 & (1 << 
i
))

414 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "1", 
x
, 
y
, 
c
);

416 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "0", 
x
, 
y
, 
c
);

417 
x
 += 10;

420 
y
 += 10;

424 
y
 +10 * (4 - 
glb_ds1
[
ds1_idx
].
wÆl_num
);

425 
y
 += 108;

426 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
èg_num
;Ç++)

428 
èg_dw
 = 
t_±r
->
num
;

429 
x
 = 
w_x0
 + 34;

430 
i
=31; i >= 0; i--)

432 
c
 = 
c_whôe
;

433 i‡–(
mx
 >
x
) && (mx <= x+9) &&

434 (
my
 >
y
) && (my <= y+9) )

436 
c
 = 
c_ªd
;

437 i‡(
mb
 & 1)

439 i‡(
èg_dw
 & (1 << 
i
))

442 
èg_dw
 =Åag_dw - (1 << 
i
);

447 
èg_dw
 =Åag_dw + (1 << 
i
);

449 
mb
 & 1)

452 
mb
 = 
mou£_b
;

454 
t_±r
->
num
 = 
èg_dw
;

457 i‡(
èg_dw
 & (1 << 
i
))

458 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "1", 
x
, 
y
, 
c
);

460 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "0", 
x
, 
y
, 
c
);

461 
x
 += 10;

463 i‡((
i
==8) || (i==16) || (i==24))

464 
x
+=10;

466 
y
 += 10;

467 
x
 = 
w_x0
 + 48;

468 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x
, 
y
, 
c_lightgªí
, "%8lu", (
èg_dw
 & 0xFF000000LU) >> 24);

469 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x
 + 90, 
y
, 
c_lightgªí
, "%8lu", (
èg_dw
 & 0x00FF0000LU) >> 16);

470 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x
 + 180, 
y
, 
c_lightgªí
, "%8lu", (
èg_dw
 & 0x0000FF00LU) >> 8);

471 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x
 + 270, 
y
, 
c_lightgªí
, "%8lu", 
èg_dw
 & 0x000000FFLU);

474 
	`misc_døw_s¸ìn
(
mx
, 
my
);

477 
mx
 = 
mou£_x
;

478 
my
 = 
mou£_y
;

479 
mb
 = 
mou£_b
;

482 i‡(
ßve
 =
FALSE
)

485 
i
=0; i < 
glb_ds1
[
ds1_idx
].
Êo‹_num
; i++)

487 
f_±r
[
i
].
¥›1
 = 
¥›s
[i][0];

488 
f_±r
[
i
].
¥›2
 = 
¥›s
[i][1];

489 
f_±r
[
i
].
¥›3
 = 
¥›s
[i][2];

490 
f_±r
[
i
].
¥›4
 = 
¥›s
[i][3];

492 
i
=0; i < 
glb_ds1
[
ds1_idx
].
wÆl_num
; i++)

494 
w_±r
[
i
].
¥›1
 = 
¥›s
[i+2][0];

495 
w_±r
[
i
].
¥›2
 = 
¥›s
[i+2][1];

496 
w_±r
[
i
].
¥›3
 = 
¥›s
[i+2][2];

497 
w_±r
[
i
].
¥›4
 = 
¥›s
[i+2][3];

498 
w_±r
[
i
].
‹õ¡©i⁄
 = 
dú
[i];

500 
i
=0; i < 
glb_ds1
[
ds1_idx
].
shadow_num
; i++)

502 
s_±r
[
i
].
¥›1
 = 
shad
[0];

503 
s_±r
[
i
].
¥›2
 = 
shad
[1];

504 
s_±r
[
i
].
¥›3
 = 
shad
[2];

505 
s_±r
[
i
].
¥›4
 = 
shad
[3];

507 
t_±r
->
num
 = 
èg_dw
;

512 
	`ds1_make_¥›_2_block
(
ds1_idx
);

515 i‡(
key
[
KEY_ESC
])

517 
key
[
KEY_ESC
])

522 i‡(
key
[
KEY_ENTER
] || key[
KEY_ENTER_PAD
])

524 
key
[
KEY_ENTER
] || key[
KEY_ENTER_PAD
])

531 
	`ãxt_mode
(-1);

532 
	}
}

536 
	$wbôs_≠∂y_modifiˇti⁄
(
ds1_idx
, 
WBITSDATA_S
 * 
±r_wbôsd©a
)

538 
CELL_F_S
 * 
f_±r
;

539 
CELL_W_S
 * 
w_±r
;

540 
CELL_S_S
 * 
s_±r
;

541 
CELL_T_S
 * 
t_±r
;

542 
x
, 
y
, 
t
, 
i
, 
b
;

543 
UDWORD
 
bt
, 
b1
, 
b2
;

546 
y
=0; y < 
glb_ds1
[
ds1_idx
].
height
; y++)

548 
x
=0; x < 
glb_ds1
[
ds1_idx
].
width
; x++)

551 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

552 
i
=0; i < 
glb_ds1
[
ds1_idx
].
Êo‹_num
; i++)

554 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
t
 + 
i
;

555 i‡(
	`IS_SELECTED
(
f_±r
->
Êags
))

560 
b
=0; b < 8; b++)

562 
bt
 = 
±r_wbôsd©a
->
bô_ty≥_f
[
i
][0][
b
];

563 i‡(
bt
 =
WBITSTYPE_SAME
)

565 
b1
 = 
±r_wbôsd©a
->
mix_f
[
i
].
¥›1
 & (1 << 
b
);

566 
b2
 = 
f_±r
->
¥›1
 & (1 << 
b
);

567 i‡(
b1
 !
b2
)

569 i‡(
b1
)

570 
f_±r
->
¥›1
 |(1 << 
b
);

572 
f_±r
->
¥›1
 &~(1 << 
b
);

578 
b
=0; b < 8; b++)

580 
bt
 = 
±r_wbôsd©a
->
bô_ty≥_f
[
i
][1][
b
];

581 i‡(
bt
 =
WBITSTYPE_SAME
)

583 
b1
 = 
±r_wbôsd©a
->
mix_f
[
i
].
¥›2
 & (1 << 
b
);

584 
b2
 = 
f_±r
->
¥›2
 & (1 << 
b
);

585 i‡(
b1
 !
b2
)

587 i‡(
b1
)

588 
f_±r
->
¥›2
 |(1 << 
b
);

590 
f_±r
->
¥›2
 &~(1 << 
b
);

596 
b
=0; b < 8; b++)

598 
bt
 = 
±r_wbôsd©a
->
bô_ty≥_f
[
i
][2][
b
];

599 i‡(
bt
 =
WBITSTYPE_SAME
)

601 
b1
 = 
±r_wbôsd©a
->
mix_f
[
i
].
¥›3
 & (1 << 
b
);

602 
b2
 = 
f_±r
->
¥›3
 & (1 << 
b
);

603 i‡(
b1
 !
b2
)

605 i‡(
b1
)

606 
f_±r
->
¥›3
 |(1 << 
b
);

608 
f_±r
->
¥›3
 &~(1 << 
b
);

614 
b
=0; b < 8; b++)

616 
bt
 = 
±r_wbôsd©a
->
bô_ty≥_f
[
i
][3][
b
];

617 i‡((
bt
 =
WBITSTYPE_SAME
))

619 
b1
 = 
±r_wbôsd©a
->
mix_f
[
i
].
¥›4
 & (1 << 
b
);

620 
b2
 = 
f_±r
->
¥›4
 & (1 << 
b
);

621 i‡(
b1
 !
b2
)

623 i‡(
b1
)

624 
f_±r
->
¥›4
 |(1 << 
b
);

626 
f_±r
->
¥›4
 &~(1 << 
b
);

634 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

635 
i
=0; i < 
glb_ds1
[
ds1_idx
].
shadow_num
; i++)

637 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
t
 + 
i
;

638 i‡(
	`IS_SELECTED
(
s_±r
->
Êags
))

643 
b
=0; b < 8; b++)

645 
bt
 = 
±r_wbôsd©a
->
bô_ty≥_s
[
i
][0][
b
];

646 i‡(
bt
 =
WBITSTYPE_SAME
)

648 
b1
 = 
±r_wbôsd©a
->
mix_s
[
i
].
¥›1
 & (1 << 
b
);

649 
b2
 = 
s_±r
->
¥›1
 & (1 << 
b
);

650 i‡(
b1
 !
b2
)

652 i‡(
b1
)

653 
s_±r
->
¥›1
 |(1 << 
b
);

655 
s_±r
->
¥›1
 &~(1 << 
b
);

661 
b
=0; b < 8; b++)

663 
bt
 = 
±r_wbôsd©a
->
bô_ty≥_s
[
i
][1][
b
];

664 i‡(
bt
 =
WBITSTYPE_SAME
)

666 
b1
 = 
±r_wbôsd©a
->
mix_s
[
i
].
¥›2
 & (1 << 
b
);

667 
b2
 = 
s_±r
->
¥›2
 & (1 << 
b
);

668 i‡(
b1
 !
b2
)

670 i‡(
b1
)

671 
s_±r
->
¥›2
 |(1 << 
b
);

673 
s_±r
->
¥›2
 &~(1 << 
b
);

679 
b
=0; b < 8; b++)

681 
bt
 = 
±r_wbôsd©a
->
bô_ty≥_s
[
i
][2][
b
];

682 i‡(
bt
 =
WBITSTYPE_SAME
)

684 
b1
 = 
±r_wbôsd©a
->
mix_s
[
i
].
¥›3
 & (1 << 
b
);

685 
b2
 = 
s_±r
->
¥›3
 & (1 << 
b
);

686 i‡(
b1
 !
b2
)

688 i‡(
b1
)

689 
s_±r
->
¥›3
 |(1 << 
b
);

691 
s_±r
->
¥›3
 &~(1 << 
b
);

697 
b
=0; b < 8; b++)

699 
bt
 = 
±r_wbôsd©a
->
bô_ty≥_s
[
i
][3][
b
];

700 i‡(
bt
 =
WBITSTYPE_SAME
)

702 
b1
 = 
±r_wbôsd©a
->
mix_s
[
i
].
¥›4
 & (1 << 
b
);

703 
b2
 = 
s_±r
->
¥›4
 & (1 << 
b
);

704 i‡(
b1
 !
b2
)

706 i‡(
b1
)

707 
s_±r
->
¥›4
 |(1 << 
b
);

709 
s_±r
->
¥›4
 &~(1 << 
b
);

717 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

718 
i
=0; i < 
glb_ds1
[
ds1_idx
].
wÆl_num
; i++)

720 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
t
 + 
i
;

721 i‡(
	`IS_SELECTED
(
w_±r
->
Êags
))

726 
b
=0; b < 8; b++)

728 
bt
 = 
±r_wbôsd©a
->
bô_ty≥_w
[
i
][0][
b
];

729 i‡(
bt
 =
WBITSTYPE_SAME
)

731 
b1
 = 
±r_wbôsd©a
->
mix_w
[
i
].
¥›1
 & (1 << 
b
);

732 
b2
 = 
w_±r
->
¥›1
 & (1 << 
b
);

733 i‡(
b1
 !
b2
)

735 i‡(
b1
)

736 
w_±r
->
¥›1
 |(1 << 
b
);

738 
w_±r
->
¥›1
 &~(1 << 
b
);

744 
b
=0; b < 8; b++)

746 
bt
 = 
±r_wbôsd©a
->
bô_ty≥_w
[
i
][1][
b
];

747 i‡(
bt
 =
WBITSTYPE_SAME
)

749 
b1
 = 
±r_wbôsd©a
->
mix_w
[
i
].
¥›2
 & (1 << 
b
);

750 
b2
 = 
w_±r
->
¥›2
 & (1 << 
b
);

751 i‡(
b1
 !
b2
)

753 i‡(
b1
)

754 
w_±r
->
¥›2
 |(1 << 
b
);

756 
w_±r
->
¥›2
 &~(1 << 
b
);

762 
b
=0; b < 8; b++)

764 
bt
 = 
±r_wbôsd©a
->
bô_ty≥_w
[
i
][2][
b
];

765 i‡(
bt
 =
WBITSTYPE_SAME
)

767 
b1
 = 
±r_wbôsd©a
->
mix_w
[
i
].
¥›3
 & (1 << 
b
);

768 
b2
 = 
w_±r
->
¥›3
 & (1 << 
b
);

769 i‡(
b1
 !
b2
)

771 i‡(
b1
)

772 
w_±r
->
¥›3
 |(1 << 
b
);

774 
w_±r
->
¥›3
 &~(1 << 
b
);

780 
b
=0; b < 8; b++)

782 
bt
 = 
±r_wbôsd©a
->
bô_ty≥_w
[
i
][3][
b
];

783 i‡(
bt
 =
WBITSTYPE_SAME
)

785 
b1
 = 
±r_wbôsd©a
->
mix_w
[
i
].
¥›4
 & (1 << 
b
);

786 
b2
 = 
w_±r
->
¥›4
 & (1 << 
b
);

787 i‡(
b1
 !
b2
)

789 i‡(
b1
)

790 
w_±r
->
¥›4
 |(1 << 
b
);

792 
w_±r
->
¥›4
 &~(1 << 
b
);

798 
b
=0; b < 8; b++)

800 
bt
 = 
±r_wbôsd©a
->
bô_ty≥_w
[
i
][4][
b
];

801 i‡(
bt
 =
WBITSTYPE_SAME
)

803 
b1
 = 
±r_wbôsd©a
->
mix_w
[
i
].
‹õ¡©i⁄
 & (1 << 
b
);

804 
b2
 = 
w_±r
->
‹õ¡©i⁄
 & (1 << 
b
);

805 i‡(
b1
 !
b2
)

807 i‡(
b1
)

808 
w_±r
->
‹õ¡©i⁄
 |(1 << 
b
);

810 
w_±r
->
‹õ¡©i⁄
 &~(1 << 
b
);

818 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
èg_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
èg_num
);

819 
i
=0; i < 
glb_ds1
[
ds1_idx
].
èg_num
; i++)

821 
t_±r
 = 
glb_ds1
[
ds1_idx
].
èg_buff
 + 
t
 + 
i
;

822 i‡(
	`IS_SELECTED
(
t_±r
->
Êags
))

827 
b
=0; b < 32; b++)

829 
bt
 = 
±r_wbôsd©a
->
bô_ty≥_t
[
i
][
b
];

830 i‡(
bt
 =
WBITSTYPE_SAME
)

832 
b1
 = 
±r_wbôsd©a
->
mix_t
[
i
].
num
 & (1 << 
b
);

833 
b2
 = 
t_±r
->
num
 & (1 << 
b
);

834 i‡(
b1
 !
b2
)

836 i‡(
b1
)

837 
t_±r
->
num
 |(1 << 
b
);

839 
t_±r
->
num
 &~(1 << 
b
);

848 
	}
}

852 
	$wbôs_maö_mu…ùÀ_tûes
(
ds1_idx
, 
WBITSDATA_S
 * 
±r_wbôsd©a
)

854 
w_x0
, 
w_y0
, 
w_x1
, 
w_y1
;

855 
ok_x0
, 
ok_y0
, 
ˇn˚l_x0
;

856 
c_bœck
 = 
	`makecﬁ
(0, 0, 0),

857 
c_whôe
 = 
	`makecﬁ
(255, 255, 255),

858 
c_yñlow
 = 
	`makecﬁ
(255, 255, 0),

859 
c_d¨kgªí
 = 
	`makecﬁ
(0, 64, 0),

860 
c_lightgªí
 = 
	`makecﬁ
(0, 255, 0),

861 
c_ªd
 = 
	`makecﬁ
(255, 0, 0),

862 
c_unkn
 = 
	`makecﬁ
(52, 156, 28),

863 
c_blue
 = 
	`makecﬁ
(36, 96, 216),

864 
c1
, 
c2
, 
c3
, 
mx
, 
my
, 
mb
;

865 
UDWORD
 
èg_dw
;

867 
w_width
 = 545, 
w_height
= 270;

868 
ßve
 = 
FALSE
, 
d⁄e
 = FALSE;

869 
x
, 
y
, 
i
, 
b
, 
c
, 
n
, 
vÆ
[4];

870 
UBYTE
 
shad
[4];

873 
	`ãxt_mode
(-1);

875 
w_x0
 = (
glb_c⁄fig
.
s¸ìn
.
width
 - 
w_width
) / 2;

876 
w_y0
 = (
glb_c⁄fig
.
s¸ìn
.
height
 - 
w_height
) / 2;

877 
w_x1
 = 
w_x0
 + 
w_width
;

878 
w_y1
 = 
w_y0
 + 
w_height
;

880 
ok_x0
 = 
w_x0
 + (
w_width
 / 2) - 64;

881 
ok_y0
 = 
w_y0
 + 
w_height
 - 24;

882 
ˇn˚l_x0
 = 
ok_x0
 + 70;

884 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
w_x0
, 
w_y0
, 
w_x1
, 
w_y1
, 
c_bœck
);

885 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
, 
w_x0
, 
w_y0
, 
w_x1
, 
w_y1
, 
c_whôe
);

887 i‡(
glb_ds1
[
ds1_idx
].
Êo‹_num
 >= 1)

888 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "F1", 
w_x0
 + 2, 
w_y0
 + 2, 
c_yñlow
);

889 i‡(
glb_ds1
[
ds1_idx
].
Êo‹_num
 >= 2)

890 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "F2", 
w_x0
 + 2, 
w_y0
 + 12, 
c_yñlow
);

892 i‡(
glb_ds1
[
ds1_idx
].
shadow_num
 >= 1)

893 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "SH", 
w_x0
 + 2, 
w_y0
 + 32, 
c_yñlow
);

895 i‡(
glb_ds1
[
ds1_idx
].
wÆl_num
 >= 1)

896 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "W1", 
w_x0
 + 2, 
w_y0
 + 52, 
c_yñlow
);

897 i‡(
glb_ds1
[
ds1_idx
].
wÆl_num
 >= 2)

898 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "W2", 
w_x0
 + 2, 
w_y0
 + 62, 
c_yñlow
);

899 i‡(
glb_ds1
[
ds1_idx
].
wÆl_num
 >= 3)

900 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "W3", 
w_x0
 + 2, 
w_y0
 + 72, 
c_yñlow
);

901 i‡(
glb_ds1
[
ds1_idx
].
wÆl_num
 >= 4)

902 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "W4", 
w_x0
 + 2, 
w_y0
 + 82, 
c_yñlow
);

904 i‡(
glb_ds1
[
ds1_idx
].
èg_num
 >= 1)

905 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "SUB", 
w_x0
 + 2, 
w_y0
 + 200, 
c_yñlow
);

907 
	`vlöe
(
glb_ds1edô
.
s¸ìn_buff
, 
w_x0
 + 237, 
w_y0
 + 92, w_y0 + 105, 
c_yñlow
);

908 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "UnwÆkabÀ", 
w_x0
 + 200, 
w_y0
 + 110, 
c_yñlow
);

910 
	`vlöe
(
glb_ds1edô
.
s¸ìn_buff
, 
w_x0
 + 27, 
w_y0
 + 92, w_y0 + 105, 
c_yñlow
);

911 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "Hiddí", 
w_x0
 + 10, 
w_y0
 + 110, 
c_yñlow
);

913 
	`vlöe
(
glb_ds1edô
.
s¸ìn_buff
, 
w_x0
 + 87, 
w_y0
 + 92, w_y0 + 105, 
c_yñlow
);

914 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "?", 
w_x0
 + 82, 
w_y0
 + 110, 
c_yñlow
);

916 
	`vlöe
(
glb_ds1edô
.
s¸ìn_buff
, 
w_x0
 + 97, 
w_y0
 + 92, w_y0 + 125, 
c_yñlow
);

917 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "IsShadow", 
w_x0
 + 60, 
w_y0
 + 130, 
c_yñlow
);

919 
	`vlöe
(
glb_ds1edô
.
s¸ìn_buff
, 
w_x0
 + 162, 
w_y0
 + 92, w_y0 + 140, 
c_yñlow
);

920 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "Maö-ödex", 
w_x0
 + 130, 
w_y0
 + 145, 
c_yñlow
);

922 
	`vlöe
(
glb_ds1edô
.
s¸ìn_buff
, 
w_x0
 + 333, 
w_y0
 + 92, w_y0 + 140, 
c_yñlow
);

923 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "Sub-ödex", 
w_x0
 + 300, 
w_y0
 + 145, 
c_yñlow
);

925 
	`vlöe
(
glb_ds1edô
.
s¸ìn_buff
, 
w_x0
 + 413, 
w_y0
 + 92, w_y0 + 100, 
c_yñlow
);

926 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "Layî†¥i‹ôy,", 
w_x0
 + 360, 
w_y0
 + 105, 
c_yñlow
);

927 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "Ty≥ o‡œyîs,", 
w_x0
 + 360, 
w_y0
 + 115, 
c_yñlow
);

928 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "ánd unknown", 
w_x0
 + 360, 
w_y0
 + 125, 
c_yñlow
);

930 
	`vlöe
(
glb_ds1edô
.
s¸ìn_buff
, 
w_x0
 + 503, 
w_y0
 + 92, w_y0 + 140, 
c_yñlow
);

931 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "Orõ¡©i⁄", 
w_x0
 + 455, 
w_y0
 + 145, 
c_yñlow
);

935 
mx
 = 
mou£_x
;

936 
my
 = 
mou£_y
;

937 
mb
 = 
mou£_b
;

940  ! 
d⁄e
)

942 
	`ãxt_mode
(-1);

945 
c1
 = 
c_d¨kgªí
;

946 
c2
 = 
c_lightgªí
;

947 
c3
 = 
c_yñlow
;

948 i‡((
mx
 >
ok_x0
Ë&& (mx <ok_x0 + 64Ë&& (
my
 >
ok_y0
) && (my <= ok_y0 + 20))

950 
c1
 = 
c_lightgªí
;

951 
c2
 = 
c_whôe
;

952 
c3
 = 
c_bœck
;

953 i‡(
mb
 & 1)

956 
ßve
 = 
TRUE
;

957 
d⁄e
 = 
TRUE
;

958 
mou£_b
 & 1)

964 i‡(
key
[
KEY_ENTER
] || key[
KEY_ENTER_PAD
])

966 
ßve
 = 
TRUE
;

967 
d⁄e
 = 
TRUE
;

969 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
ok_x0
, 
ok_y0
-3, ok_x0 + 64, ok_y0 + 20, 
c1
);

970 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
, 
ok_x0
, 
ok_y0
-3, ok_x0 + 64, ok_y0 + 20, 
c2
);

971 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "OK", 
ok_x0
+25, 
ok_y0
+5, 
c3
);

974 
c1
 = 
c_d¨kgªí
;

975 
c2
 = 
c_lightgªí
;

976 
c3
 = 
c_yñlow
;

977 i‡((
mx
 >
ˇn˚l_x0
Ë&& (mx <ˇn˚l_x0 + 64Ë&& (
my
 >
ok_y0
) && (my <= ok_y0 + 20))

979 
c1
 = 
c_lightgªí
;

980 
c2
 = 
c_whôe
;

981 
c3
 = 
c_bœck
;

982 i‡(
mb
 & 1)

985 
ßve
 = 
FALSE
;

986 
d⁄e
 = 
TRUE
;

987 
mou£_b
 & 1)

993 i‡(
key
[
KEY_ESC
])

995 
ßve
 = 
FALSE
;

996 
d⁄e
 = 
TRUE
;

998 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
ˇn˚l_x0
, 
ok_y0
-3, c™˚l_x0 + 64, ok_y0 + 20, 
c1
);

999 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
, 
ˇn˚l_x0
, 
ok_y0
-3, c™˚l_x0 + 64, ok_y0 + 20, 
c2
);

1000 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "CANCEL", 
ˇn˚l_x0
+10, 
ok_y0
+5, 
c3
);

1002 
	`ãxt_mode
(0);

1005 
y
 = 
w_y0
 + 2;

1006 
n
=0;Ç < 
glb_ds1
[
ds1_idx
].
Êo‹_num
;Ç++)

1008 
vÆ
[0] = 
±r_wbôsd©a
->
mix_f
[
n
].
¥›1
;

1009 
vÆ
[1] = 
±r_wbôsd©a
->
mix_f
[
n
].
¥›2
;

1010 
vÆ
[2] = 
±r_wbôsd©a
->
mix_f
[
n
].
¥›3
;

1011 
vÆ
[3] = 
±r_wbôsd©a
->
mix_f
[
n
].
¥›4
;

1012 
x
 = 
w_x0
 + 24;

1013 
b
=3; b >= 0 ; b--)

1015 
i
=7; i >= 0; i--)

1017 i‡(
±r_wbôsd©a
->
bô_ty≥_f
[
n
][
b
][
i
] =
WBITSTYPE_DIFFERENT
)

1018 
c
 = 
c_blue
;

1019 i‡(
±r_wbôsd©a
->
bô_ty≥_f
[
n
][
b
][
i
] =
WBITSTYPE_UNKNOWN
)

1020 
c
 = 
c_unkn
;

1022 
c
 = 
c_whôe
;

1024 i‡((
mx
 >
x
Ë&& (mx <x+9Ë&& (
my
 >
y
) && (my <= y+9) &&

1025 (
±r_wbôsd©a
->
bô_ty≥_f
[
n
][
b
][
i
] !
WBITSTYPE_UNKNOWN
))

1027 
c
 = 
c_ªd
;

1028 i‡(
mb
 & 1)

1030 i‡(
vÆ
[
b
] & (1 << 
i
))

1033 
vÆ
[
b
] = vÆ[b] - (1 << 
i
);

1038 
vÆ
[
b
] = vÆ[b] + (1 << 
i
);

1040 
mb
 & 1)

1043 
mb
 = 
mou£_b
;

1045 
b
)

1047 0 : 
±r_wbôsd©a
->
mix_f
[
n
].
¥›1
 = 
vÆ
[0]; ;

1048 1 : 
±r_wbôsd©a
->
mix_f
[
n
].
¥›2
 = 
vÆ
[1]; ;

1049 2 : 
±r_wbôsd©a
->
mix_f
[
n
].
¥›3
 = 
vÆ
[2]; ;

1050 3 : 
±r_wbôsd©a
->
mix_f
[
n
].
¥›4
 = 
vÆ
[3]; ;

1052 i‡(
±r_wbôsd©a
->
bô_ty≥_f
[
n
][
b
][
i
] =
WBITSTYPE_DIFFERENT
)

1053 
±r_wbôsd©a
->
bô_ty≥_f
[
n
][
b
][
i
] = 
WBITSTYPE_SAME
;

1056 i‡(
±r_wbôsd©a
->
bô_ty≥_f
[
n
][
b
][
i
] =
WBITSTYPE_UNKNOWN
)

1058 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "-", 
x
, 
y
, 
c
);

1062 i‡(
vÆ
[
b
] & (1 << 
i
))

1063 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "1", 
x
, 
y
, 
c
);

1065 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "0", 
x
, 
y
, 
c
);

1068 
x
 += 10;

1069 i‡((
b
==3Ë&& ((
i
==7) || (i==6) || (i==5) || (i==3) || (i==2)))

1070 
x
+=10;

1071 i‡((
b
==2Ë&& ((
i
==4) || (i==2) || (i==1) || (i==0)))

1072 
x
+=10;

1073 i‡((
b
==1Ë&& ((
i
==6) || (i==0)))

1074 
x
+=10;

1077 
y
 += 10;

1081 
y
 +10 * (2 - 
glb_ds1
[
ds1_idx
].
Êo‹_num
);

1082 
y
 += 10;

1083 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
shadow_num
;Ç++)

1085 
shad
[0] = 
±r_wbôsd©a
->
mix_s
[
n
].
¥›1
;

1086 
shad
[1] = 
±r_wbôsd©a
->
mix_s
[
n
].
¥›2
;

1087 
shad
[2] = 
±r_wbôsd©a
->
mix_s
[
n
].
¥›3
;

1088 
shad
[3] = 
±r_wbôsd©a
->
mix_s
[
n
].
¥›4
;

1089 
x
 = 
w_x0
 + 24;

1090 
b
=3; b >= 0 ; b--)

1092 
i
=7; i >= 0; i--)

1094 i‡(
±r_wbôsd©a
->
bô_ty≥_s
[
n
][
b
][
i
] =
WBITSTYPE_DIFFERENT
)

1095 
c
 = 
c_blue
;

1096 i‡(
±r_wbôsd©a
->
bô_ty≥_s
[
n
][
b
][
i
] =
WBITSTYPE_UNKNOWN
)

1097 
c
 = 
c_unkn
;

1099 
c
 = 
c_whôe
;

1101 i‡((
mx
 >
x
Ë&& (mx <x+9Ë&& (
my
 >
y
) && (my <= y+9) &&

1102 (
±r_wbôsd©a
->
bô_ty≥_s
[
n
][
b
][
i
] !
WBITSTYPE_UNKNOWN
))

1104 
c
 = 
c_ªd
;

1105 i‡(
mb
 & 1)

1107 i‡(
shad
[
b
] & (1 << 
i
))

1110 
shad
[
b
] = shad[b] - (1 << 
i
);

1115 
shad
[
b
] = shad[b] + (1 << 
i
);

1117 
mb
 & 1)

1120 
mb
 = 
mou£_b
;

1122 
b
)

1124 0 : 
±r_wbôsd©a
->
mix_s
[
n
].
¥›1
 = 
shad
[0]; ;

1125 1 : 
±r_wbôsd©a
->
mix_s
[
n
].
¥›2
 = 
shad
[1]; ;

1126 2 : 
±r_wbôsd©a
->
mix_s
[
n
].
¥›3
 = 
shad
[2]; ;

1127 3 : 
±r_wbôsd©a
->
mix_s
[
n
].
¥›4
 = 
shad
[3]; ;

1129 i‡(
±r_wbôsd©a
->
bô_ty≥_s
[
n
][
b
][
i
] =
WBITSTYPE_DIFFERENT
)

1130 
±r_wbôsd©a
->
bô_ty≥_s
[
n
][
b
][
i
] = 
WBITSTYPE_SAME
;

1133 i‡(
±r_wbôsd©a
->
bô_ty≥_s
[
n
][
b
][
i
] =
WBITSTYPE_UNKNOWN
)

1135 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "-", 
x
, 
y
, 
c
);

1139 i‡(
shad
[
b
] & (1 << 
i
))

1140 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "1", 
x
, 
y
, 
c
);

1142 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "0", 
x
, 
y
, 
c
);

1145 
x
 += 10;

1146 i‡((
b
==3Ë&& ((
i
==7) || (i==6) || (i==5) || (i==3) || (i==2)))

1147 
x
+=10;

1148 i‡((
b
==2Ë&& ((
i
==4) || (i==2) || (i==1) || (i==0)))

1149 
x
+=10;

1150 i‡((
b
==1Ë&& ((
i
==6) || (i==0)))

1151 
x
+=10;

1154 
y
 += 10;

1158 
y
 += 10;

1159 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

1161 
vÆ
[0] = 
±r_wbôsd©a
->
mix_w
[
n
].
¥›1
;

1162 
vÆ
[1] = 
±r_wbôsd©a
->
mix_w
[
n
].
¥›2
;

1163 
vÆ
[2] = 
±r_wbôsd©a
->
mix_w
[
n
].
¥›3
;

1164 
vÆ
[3] = 
±r_wbôsd©a
->
mix_w
[
n
].
¥›4
;

1165 
x
 = 
w_x0
 + 24;

1168 
b
=3; b >= 0 ; b--)

1170 
i
=7; i >= 0; i--)

1172 i‡(
±r_wbôsd©a
->
bô_ty≥_w
[
n
][
b
][
i
] =
WBITSTYPE_DIFFERENT
)

1173 
c
 = 
c_blue
;

1174 i‡(
±r_wbôsd©a
->
bô_ty≥_w
[
n
][
b
][
i
] =
WBITSTYPE_UNKNOWN
)

1175 
c
 = 
c_unkn
;

1177 
c
 = 
c_whôe
;

1179 i‡((
mx
 >
x
Ë&& (mx <x+9Ë&& (
my
 >
y
) && (my <= y+9) &&

1180 (
±r_wbôsd©a
->
bô_ty≥_w
[
n
][
b
][
i
] !
WBITSTYPE_UNKNOWN
))

1182 
c
 = 
c_ªd
;

1183 i‡(
mb
 & 1)

1185 i‡(
vÆ
[
b
] & (1 << 
i
))

1188 
vÆ
[
b
] = vÆ[b] - (1 << 
i
);

1193 
vÆ
[
b
] = vÆ[b] + (1 << 
i
);

1195 
mb
 & 1)

1198 
mb
 = 
mou£_b
;

1200 
b
)

1202 0 : 
±r_wbôsd©a
->
mix_w
[
n
].
¥›1
 = 
vÆ
[0]; ;

1203 1 : 
±r_wbôsd©a
->
mix_w
[
n
].
¥›2
 = 
vÆ
[1]; ;

1204 2 : 
±r_wbôsd©a
->
mix_w
[
n
].
¥›3
 = 
vÆ
[2]; ;

1205 3 : 
±r_wbôsd©a
->
mix_w
[
n
].
¥›4
 = 
vÆ
[3]; ;

1207 i‡(
±r_wbôsd©a
->
bô_ty≥_w
[
n
][
b
][
i
] =
WBITSTYPE_DIFFERENT
)

1208 
±r_wbôsd©a
->
bô_ty≥_w
[
n
][
b
][
i
] = 
WBITSTYPE_SAME
;

1211 i‡(
±r_wbôsd©a
->
bô_ty≥_w
[
n
][
b
][
i
] =
WBITSTYPE_UNKNOWN
)

1213 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "-", 
x
, 
y
, 
c
);

1217 i‡(
vÆ
[
b
] & (1 << 
i
))

1218 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "1", 
x
, 
y
, 
c
);

1220 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "0", 
x
, 
y
, 
c
);

1223 
x
 += 10;

1224 i‡((
b
==3Ë&& ((
i
==7) || (i==6) || (i==5) || (i==3) || (i==2)))

1225 
x
+=10;

1226 i‡((
b
==2Ë&& ((
i
==4) || (i==2) || (i==1) || (i==0)))

1227 
x
+=10;

1228 i‡((
b
==1Ë&& ((
i
==6) || (i==0)))

1229 
x
+=10;

1230 i‡((
b
==0Ë&& (
i
==0))

1231 
x
+=10;

1236 
i
=7; i >= 0; i--)

1238 i‡(
±r_wbôsd©a
->
bô_ty≥_w
[
n
][4][
i
] =
WBITSTYPE_DIFFERENT
)

1239 
c
 = 
c_blue
;

1240 i‡(
±r_wbôsd©a
->
bô_ty≥_w
[
n
][4][
i
] =
WBITSTYPE_UNKNOWN
)

1241 
c
 = 
c_unkn
;

1243 
c
 = 
c_whôe
;

1245 i‡((
mx
 >
x
Ë&& (mx <x+9Ë&& (
my
 >
y
) && (my <= y+9) &&

1246 (
±r_wbôsd©a
->
bô_ty≥_w
[
n
][4][
i
] !
WBITSTYPE_UNKNOWN
))

1248 
c
 = 
c_ªd
;

1249 i‡(
mb
 & 1)

1251 i‡(
±r_wbôsd©a
->
mix_w
[
n
].
‹õ¡©i⁄
 & (1 << 
i
))

1254 
±r_wbôsd©a
->
mix_w
[
n
].
‹õ¡©i⁄
 =

1255 
±r_wbôsd©a
->
mix_w
[
n
].
‹õ¡©i⁄
 - (1 << 
i
);

1260 
±r_wbôsd©a
->
mix_w
[
n
].
‹õ¡©i⁄
 =

1261 
±r_wbôsd©a
->
mix_w
[
n
].
‹õ¡©i⁄
 + (1 << 
i
);

1263 
mb
 & 1)

1266 
mb
 = 
mou£_b
;

1269 i‡(
±r_wbôsd©a
->
bô_ty≥_w
[
n
][4][
i
] =
WBITSTYPE_DIFFERENT
)

1270 
±r_wbôsd©a
->
bô_ty≥_w
[
n
][4][
i
] = 
WBITSTYPE_SAME
;

1273 i‡(
±r_wbôsd©a
->
bô_ty≥_w
[
n
][4][
i
] =
WBITSTYPE_UNKNOWN
)

1275 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "-", 
x
, 
y
, 
c
);

1279 i‡(
±r_wbôsd©a
->
mix_w
[
n
].
‹õ¡©i⁄
 & (1 << 
i
))

1280 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "1", 
x
, 
y
, 
c
);

1282 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "0", 
x
, 
y
, 
c
);

1284 
x
 += 10;

1287 
y
 += 10;

1291 
y
 +10 * (4 - 
glb_ds1
[
ds1_idx
].
wÆl_num
);

1292 
y
 += 108;

1293 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
èg_num
;Ç++)

1295 
èg_dw
 = 
±r_wbôsd©a
->
mix_t
[
n
].
num
;

1296 
x
 = 
w_x0
 + 34;

1297 
i
=31; i >= 0; i--)

1299 i‡(
±r_wbôsd©a
->
bô_ty≥_t
[
n
][
i
] =
WBITSTYPE_DIFFERENT
)

1300 
c
 = 
c_blue
;

1301 i‡(
±r_wbôsd©a
->
bô_ty≥_t
[
n
][
i
] =
WBITSTYPE_UNKNOWN
)

1302 
c
 = 
c_unkn
;

1304 
c
 = 
c_whôe
;

1306 i‡((
mx
 >
x
Ë&& (mx <x+9Ë&& (
my
 >
y
) && (my <= y+9) &&

1307 (
±r_wbôsd©a
->
bô_ty≥_t
[
n
][
i
] !
WBITSTYPE_UNKNOWN
))

1309 
c
 = 
c_ªd
;

1310 i‡(
mb
 & 1)

1312 i‡(
èg_dw
 & (1 << 
i
))

1315 
èg_dw
 =Åag_dw - (1 << 
i
);

1320 
èg_dw
 =Åag_dw + (1 << 
i
);

1322 
mb
 & 1)

1325 
mb
 = 
mou£_b
;

1328 
±r_wbôsd©a
->
mix_t
[
n
].
num
 = 
èg_dw
;

1330 i‡(
±r_wbôsd©a
->
bô_ty≥_t
[
n
][
i
] =
WBITSTYPE_DIFFERENT
)

1331 
±r_wbôsd©a
->
bô_ty≥_t
[
n
][
i
] = 
WBITSTYPE_SAME
;

1334 i‡(
±r_wbôsd©a
->
bô_ty≥_t
[
n
][
i
] =
WBITSTYPE_UNKNOWN
)

1336 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "-", 
x
, 
y
, 
c
);

1340 i‡(
èg_dw
 & (1 << 
i
))

1341 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "1", 
x
, 
y
, 
c
);

1343 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, "0", 
x
, 
y
, 
c
);

1345 
x
 += 10;

1347 i‡((
i
==8) || (i==16) || (i==24))

1348 
x
+=10;

1350 
y
 += 10;

1351 
x
 = 
w_x0
 + 48;

1352 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x
, 
y
, 
c_lightgªí
, "%8lu", (
èg_dw
 & 0xFF000000LU) >> 24);

1353 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x
 + 90, 
y
, 
c_lightgªí
, "%8lu", (
èg_dw
 & 0x00FF0000LU) >> 16);

1354 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x
 + 180, 
y
, 
c_lightgªí
, "%8lu", (
èg_dw
 & 0x0000FF00LU) >> 8);

1355 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x
 + 270, 
y
, 
c_lightgªí
, "%8lu", 
èg_dw
 & 0x000000FFLU);

1358 
	`misc_døw_s¸ìn
(
mx
, 
my
);

1361 
mx
 = 
mou£_x
;

1362 
my
 = 
mou£_y
;

1363 
mb
 = 
mou£_b
;

1366 i‡(
ßve
 =
FALSE
)

1373 
	`wbôs_≠∂y_modifiˇti⁄
(
ds1_idx
, 
±r_wbôsd©a
);

1376 
	`ds1_make_¥›_2_block
(
ds1_idx
);

1379 i‡(
key
[
KEY_ESC
])

1381 
key
[
KEY_ESC
])

1386 i‡(
key
[
KEY_ENTER
] || key[
KEY_ENTER_PAD
])

1388 
key
[
KEY_ENTER
] || key[
KEY_ENTER_PAD
])

1395 
	`ãxt_mode
(-1);

1396 
	}
}

1400 
	$wbôs_maö
(
ds1_idx
, 
tx
, 
ty
)

1402 
WBITSDATA_S
 * 
±r_wbôsd©a
;

1403 
CELL_F_S
 * 
f_±r
;

1404 
CELL_W_S
 * 
w_±r
;

1405 
CELL_S_S
 * 
s_±r
;

1406 
CELL_T_S
 * 
t_±r
;

1407 
x
, 
y
, 
t
, 
i
, 
size
, 
b
, 
b1
, 
b2
;

1408 
has_£À˘i⁄
;

1409 
tmp
[256];

1413 
size
 = (
WBITSDATA_S
);

1414 
±r_wbôsd©a
 = (
WBITSDATA_S
 *Ë
	`mÆloc
(
size
);

1415 i‡(
±r_wbôsd©a
 =
NULL
)

1417 
	`•rötf
(
tmp
, "wbôs_maö(Ë: c™'àÆoˇã %òbyã†f‹ '±r_wbôsd©a'\n", 
size
);

1418 
	`ds1edô_îr‹
(
tmp
);

1420 
	`mem£t
(
±r_wbôsd©a
, 0, 
size
);

1425 
has_£À˘i⁄
 = 
FALSE
;

1426 
y
=0; y < 
glb_ds1
[
ds1_idx
].
height
; y++)

1428 
x
=0; x < 
glb_ds1
[
ds1_idx
].
width
; x++)

1431 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

1432 
i
=0; i < 
glb_ds1
[
ds1_idx
].
Êo‹_num
; i++)

1434 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
t
 + 
i
;

1435 i‡(
	`IS_SELECTED
(
f_±r
->
Êags
))

1436 
has_£À˘i⁄
 = 
TRUE
;

1440 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

1441 
i
=0; i < 
glb_ds1
[
ds1_idx
].
shadow_num
; i++)

1443 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
t
 + 
i
;

1444 i‡(
	`IS_SELECTED
(
s_±r
->
Êags
))

1445 
has_£À˘i⁄
 = 
TRUE
;

1449 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

1450 
i
=0; i < 
glb_ds1
[
ds1_idx
].
wÆl_num
; i++)

1452 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
t
 + 
i
;

1453 i‡(
	`IS_SELECTED
(
w_±r
->
Êags
))

1454 
has_£À˘i⁄
 = 
TRUE
;

1458 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
èg_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
èg_num
);

1459 
i
=0; i < 
glb_ds1
[
ds1_idx
].
èg_num
; i++)

1461 
t_±r
 = 
glb_ds1
[
ds1_idx
].
èg_buff
 + 
t
 + 
i
;

1462 i‡(
	`IS_SELECTED
(
t_±r
->
Êags
))

1463 
has_£À˘i⁄
 = 
TRUE
;

1468 i‡(
has_£À˘i⁄
 =
FALSE
)

1472 
	`wbôs_maö_sögÀ_tûe
(
ds1_idx
, 
tx
, 
ty
);

1482 
y
=0; y < 
glb_ds1
[
ds1_idx
].
height
; y++)

1484 
x
=0; x < 
glb_ds1
[
ds1_idx
].
width
; x++)

1487 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

1488 
i
=0; i < 
glb_ds1
[
ds1_idx
].
Êo‹_num
; i++)

1490 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
t
 + 
i
;

1491 i‡(
	`IS_SELECTED
(
f_±r
->
Êags
))

1495 i‡(
	`IS_SELECTED
(
±r_wbôsd©a
->
mix_f
[
i
].
Êags
))

1500 
b
=0; b < 8; b++)

1502 
b1
 = 
±r_wbôsd©a
->
mix_f
[
i
].
¥›1
 & (1 << 
b
);

1503 
b2
 = 
f_±r
->
¥›1
 & (1 << 
b
);

1504 i‡(
b1
 !
b2
)

1505 
±r_wbôsd©a
->
bô_ty≥_f
[
i
][0][
b
] = 
WBITSTYPE_DIFFERENT
;

1509 
b
=0; b < 8; b++)

1511 
b1
 = 
±r_wbôsd©a
->
mix_f
[
i
].
¥›2
 & (1 << 
b
);

1512 
b2
 = 
f_±r
->
¥›2
 & (1 << 
b
);

1513 i‡(
b1
 !
b2
)

1514 
±r_wbôsd©a
->
bô_ty≥_f
[
i
][1][
b
] = 
WBITSTYPE_DIFFERENT
;

1518 
b
=0; b < 8; b++)

1520 
b1
 = 
±r_wbôsd©a
->
mix_f
[
i
].
¥›3
 & (1 << 
b
);

1521 
b2
 = 
f_±r
->
¥›3
 & (1 << 
b
);

1522 i‡(
b1
 !
b2
)

1523 
±r_wbôsd©a
->
bô_ty≥_f
[
i
][2][
b
] = 
WBITSTYPE_DIFFERENT
;

1527 
b
=0; b < 8; b++)

1529 
b1
 = 
±r_wbôsd©a
->
mix_f
[
i
].
¥›4
 & (1 << 
b
);

1530 
b2
 = 
f_±r
->
¥›4
 & (1 << 
b
);

1531 i‡(
b1
 !
b2
)

1532 
±r_wbôsd©a
->
bô_ty≥_f
[
i
][3][
b
] = 
WBITSTYPE_DIFFERENT
;

1537 
	`SET_SELECTED
(
±r_wbôsd©a
->
mix_f
[
i
].
Êags
);

1540 
b
=0; b < 8; b++)

1541 
±r_wbôsd©a
->
bô_ty≥_f
[
i
][0][
b
] = 
WBITSTYPE_SAME
;

1542 
b
=0; b < 8; b++)

1543 
±r_wbôsd©a
->
bô_ty≥_f
[
i
][1][
b
] = 
WBITSTYPE_SAME
;

1544 
b
=0; b < 8; b++)

1545 
±r_wbôsd©a
->
bô_ty≥_f
[
i
][2][
b
] = 
WBITSTYPE_SAME
;

1546 
b
=0; b < 8; b++)

1547 
±r_wbôsd©a
->
bô_ty≥_f
[
i
][3][
b
] = 
WBITSTYPE_SAME
;

1551 
±r_wbôsd©a
->
mix_f
[
i
].
¥›1
 |
f_±r
->prop1;

1552 
±r_wbôsd©a
->
mix_f
[
i
].
¥›2
 |
f_±r
->prop2;

1553 
±r_wbôsd©a
->
mix_f
[
i
].
¥›3
 |
f_±r
->prop3;

1554 
±r_wbôsd©a
->
mix_f
[
i
].
¥›4
 |
f_±r
->prop4;

1559 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

1560 
i
=0; i < 
glb_ds1
[
ds1_idx
].
shadow_num
; i++)

1562 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
t
 + 
i
;

1563 i‡(
	`IS_SELECTED
(
s_±r
->
Êags
))

1567 i‡(
	`IS_SELECTED
(
±r_wbôsd©a
->
mix_s
[
i
].
Êags
))

1572 
b
=0; b < 8; b++)

1574 
b1
 = 
±r_wbôsd©a
->
mix_s
[
i
].
¥›1
 & (1 << 
b
);

1575 
b2
 = 
s_±r
->
¥›1
 & (1 << 
b
);

1576 i‡(
b1
 !
b2
)

1577 
±r_wbôsd©a
->
bô_ty≥_s
[
i
][0][
b
] = 
WBITSTYPE_DIFFERENT
;

1581 
b
=0; b < 8; b++)

1583 
b1
 = 
±r_wbôsd©a
->
mix_s
[
i
].
¥›2
 & (1 << 
b
);

1584 
b2
 = 
s_±r
->
¥›2
 & (1 << 
b
);

1585 i‡(
b1
 !
b2
)

1586 
±r_wbôsd©a
->
bô_ty≥_s
[
i
][1][
b
] = 
WBITSTYPE_DIFFERENT
;

1590 
b
=0; b < 8; b++)

1592 
b1
 = 
±r_wbôsd©a
->
mix_s
[
i
].
¥›3
 & (1 << 
b
);

1593 
b2
 = 
s_±r
->
¥›3
 & (1 << 
b
);

1594 i‡(
b1
 !
b2
)

1595 
±r_wbôsd©a
->
bô_ty≥_s
[
i
][2][
b
] = 
WBITSTYPE_DIFFERENT
;

1599 
b
=0; b < 8; b++)

1601 
b1
 = 
±r_wbôsd©a
->
mix_s
[
i
].
¥›4
 & (1 << 
b
);

1602 
b2
 = 
s_±r
->
¥›4
 & (1 << 
b
);

1603 i‡(
b1
 !
b2
)

1604 
±r_wbôsd©a
->
bô_ty≥_s
[
i
][3][
b
] = 
WBITSTYPE_DIFFERENT
;

1609 
	`SET_SELECTED
(
±r_wbôsd©a
->
mix_s
[
i
].
Êags
);

1612 
b
=0; b < 8; b++)

1613 
±r_wbôsd©a
->
bô_ty≥_s
[
i
][0][
b
] = 
WBITSTYPE_SAME
;

1614 
b
=0; b < 8; b++)

1615 
±r_wbôsd©a
->
bô_ty≥_s
[
i
][1][
b
] = 
WBITSTYPE_SAME
;

1616 
b
=0; b < 8; b++)

1617 
±r_wbôsd©a
->
bô_ty≥_s
[
i
][2][
b
] = 
WBITSTYPE_SAME
;

1618 
b
=0; b < 8; b++)

1619 
±r_wbôsd©a
->
bô_ty≥_s
[
i
][3][
b
] = 
WBITSTYPE_SAME
;

1623 
±r_wbôsd©a
->
mix_s
[
i
].
¥›1
 |
s_±r
->prop1;

1624 
±r_wbôsd©a
->
mix_s
[
i
].
¥›2
 |
s_±r
->prop2;

1625 
±r_wbôsd©a
->
mix_s
[
i
].
¥›3
 |
s_±r
->prop3;

1626 
±r_wbôsd©a
->
mix_s
[
i
].
¥›4
 |
s_±r
->prop4;

1631 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

1632 
i
=0; i < 
glb_ds1
[
ds1_idx
].
wÆl_num
; i++)

1634 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
t
 + 
i
;

1635 i‡(
	`IS_SELECTED
(
w_±r
->
Êags
))

1639 i‡(
	`IS_SELECTED
(
±r_wbôsd©a
->
mix_w
[
i
].
Êags
))

1644 
b
=0; b < 8; b++)

1646 
b1
 = 
±r_wbôsd©a
->
mix_w
[
i
].
¥›1
 & (1 << 
b
);

1647 
b2
 = 
w_±r
->
¥›1
 & (1 << 
b
);

1648 i‡(
b1
 !
b2
)

1649 
±r_wbôsd©a
->
bô_ty≥_w
[
i
][0][
b
] = 
WBITSTYPE_DIFFERENT
;

1653 
b
=0; b < 8; b++)

1655 
b1
 = 
±r_wbôsd©a
->
mix_w
[
i
].
¥›2
 & (1 << 
b
);

1656 
b2
 = 
w_±r
->
¥›2
 & (1 << 
b
);

1657 i‡(
b1
 !
b2
)

1658 
±r_wbôsd©a
->
bô_ty≥_w
[
i
][1][
b
] = 
WBITSTYPE_DIFFERENT
;

1662 
b
=0; b < 8; b++)

1664 
b1
 = 
±r_wbôsd©a
->
mix_w
[
i
].
¥›3
 & (1 << 
b
);

1665 
b2
 = 
w_±r
->
¥›3
 & (1 << 
b
);

1666 i‡(
b1
 !
b2
)

1667 
±r_wbôsd©a
->
bô_ty≥_w
[
i
][2][
b
] = 
WBITSTYPE_DIFFERENT
;

1671 
b
=0; b < 8; b++)

1673 
b1
 = 
±r_wbôsd©a
->
mix_w
[
i
].
¥›4
 & (1 << 
b
);

1674 
b2
 = 
w_±r
->
¥›4
 & (1 << 
b
);

1675 i‡(
b1
 !
b2
)

1676 
±r_wbôsd©a
->
bô_ty≥_w
[
i
][3][
b
] = 
WBITSTYPE_DIFFERENT
;

1680 
b
=0; b < 8; b++)

1682 
b1
 = 
±r_wbôsd©a
->
mix_w
[
i
].
‹õ¡©i⁄
 & (1 << 
b
);

1683 
b2
 = 
w_±r
->
‹õ¡©i⁄
 & (1 << 
b
);

1684 i‡(
b1
 !
b2
)

1685 
±r_wbôsd©a
->
bô_ty≥_w
[
i
][4][
b
] = 
WBITSTYPE_DIFFERENT
;

1690 
	`SET_SELECTED
(
±r_wbôsd©a
->
mix_w
[
i
].
Êags
);

1693 
b
=0; b < 8; b++)

1694 
±r_wbôsd©a
->
bô_ty≥_w
[
i
][0][
b
] = 
WBITSTYPE_SAME
;

1695 
b
=0; b < 8; b++)

1696 
±r_wbôsd©a
->
bô_ty≥_w
[
i
][1][
b
] = 
WBITSTYPE_SAME
;

1697 
b
=0; b < 8; b++)

1698 
±r_wbôsd©a
->
bô_ty≥_w
[
i
][2][
b
] = 
WBITSTYPE_SAME
;

1699 
b
=0; b < 8; b++)

1700 
±r_wbôsd©a
->
bô_ty≥_w
[
i
][3][
b
] = 
WBITSTYPE_SAME
;

1701 
b
=0; b < 8; b++)

1702 
±r_wbôsd©a
->
bô_ty≥_w
[
i
][4][
b
] = 
WBITSTYPE_SAME
;

1706 
±r_wbôsd©a
->
mix_w
[
i
].
¥›1
 |
w_±r
->prop1;

1707 
±r_wbôsd©a
->
mix_w
[
i
].
¥›2
 |
w_±r
->prop2;

1708 
±r_wbôsd©a
->
mix_w
[
i
].
¥›3
 |
w_±r
->prop3;

1709 
±r_wbôsd©a
->
mix_w
[
i
].
¥›4
 |
w_±r
->prop4;

1710 
±r_wbôsd©a
->
mix_w
[
i
].
‹õ¡©i⁄
 |
w_±r
->orientation;

1715 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
èg_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
èg_num
);

1716 
i
=0; i < 
glb_ds1
[
ds1_idx
].
èg_num
; i++)

1718 
t_±r
 = 
glb_ds1
[
ds1_idx
].
èg_buff
 + 
t
 + 
i
;

1719 i‡(
	`IS_SELECTED
(
t_±r
->
Êags
))

1723 i‡(
	`IS_SELECTED
(
±r_wbôsd©a
->
mix_t
[
i
].
Êags
))

1728 
b
=0; b < 32; b++)

1730 
b1
 = 
±r_wbôsd©a
->
mix_t
[
i
].
num
 & (1 << 
b
);

1731 
b2
 = 
t_±r
->
num
 & (1 << 
b
);

1732 i‡(
b1
 !
b2
)

1733 
±r_wbôsd©a
->
bô_ty≥_t
[
i
][
b
] = 
WBITSTYPE_DIFFERENT
;

1738 
	`SET_SELECTED
(
±r_wbôsd©a
->
mix_t
[
i
].
Êags
);

1741 
b
=0; b < 32; b++)

1742 
±r_wbôsd©a
->
bô_ty≥_t
[
i
][
b
] = 
WBITSTYPE_SAME
;

1746 
±r_wbôsd©a
->
mix_t
[
i
].
num
 |
t_±r
->num;

1753 
	`wbôs_maö_mu…ùÀ_tûes
(
ds1_idx
, 
±r_wbôsd©a
);

1757 
	`‰ì
(
±r_wbôsd©a
);

1758 
	}
}

	@wBits.h

1 #i‚de‡
_WBITS_H_


3 
	#_WBITS_H_


	)

5 
wbôs_maö_sögÀ_tûe
 (
ds1_idx
, 
tx
, 
ty
);

6 
wbôs_≠∂y_modifiˇti⁄
 (
ds1_idx
, 
WBITSDATA_S
 * 
±r_wbôsd©a
);

7 
wbôs_maö_mu…ùÀ_tûes
 (
ds1_idx
, 
WBITSDATA_S
 * 
±r_wbôsd©a
);

8 
wbôs_maö
 (
ds1_idx
, 
tx
, 
ty
);

	@wEdit.c

1 
	~"°ru˘s.h
"

2 
	~"wPªvõw.h
"

3 
	~"îr‹.h
"

4 
	~"undo.h
"

5 
	~"misc.h
"

6 
	~"wEdô.h
"

11 
	$wedô_døw_s
(
ds1_idx
, 
x
, 
y
)

13 
WIN_ELEMENT_S
 * 
w_ñm
 = & 
glb_ds1edô
.
wö_edô
.
w_¥evõw
;

14 
BITMAP
 * 
sub
;

15 
BLOCK_TABLE_S
 * 
bt_±r
;

16 
BITMAP
 * 
tmp_bmp
;

17 
CELL_S_S
 * 
s_±r
;

18 
n
, 
t
, 
bt_idx
, 
dt1_idx
, 
block_idx
, 
y1
;

19 
ux1
, 
ux2
, 
ux3
, 
ux4
, 
uy1
, 
uy2
, 
uy3
;

22 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

23 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
t
;

24 
sub
 = 
	`¸óã_sub_bôm≠
(
glb_ds1edô
.
s¸ìn_buff
,

25 
w_ñm
->
i_x0
, w_ñm->
i_y0
, w_ñm->
öside
->
w
, w_ñm->öside->
h
);

27 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
shadow_num
;Ç++)

29 
bt_idx
 = 
s_±r
[
n
].bt_idx;

30 i‡(
bt_idx
 == -1)

32 
ux1
 = 0;

33 
ux2
 = 
ux1
 + 79;

34 
ux3
 = 
ux1
 + 80;

35 
ux4
 = 
ux1
 + 159;

37 
uy1
 = 
sub
->
h
 - 160;

38 
uy2
 = 
uy1
 + 39;

39 
uy3
 = 
uy1
 + 78;

41 
	`löe
(
sub
, 
ux1
, 
uy2
, 
ux2
, 
uy1
, 168);

42 
	`löe
(
sub
, 
ux3
, 
uy1
, 
ux4
, 
uy2
, 168);

43 
	`löe
(
sub
, 
ux3
, 
uy3
, 
ux4
, 
uy2
, 168);

44 
	`löe
(
sub
, 
ux1
, 
uy2
, 
ux2
, 
uy3
, 168);

46 
	`ãxçrötf
(
sub
, 
f⁄t
, 
ux1
+8, 
uy2
-2, 0,

48 
s_±r
[
n
].
¥›1
,

49 
s_±r
[
n
].
¥›2
,

50 
s_±r
[
n
].
¥›3
,

51 
s_±r
[
n
].
¥›4


53 
	`ãxçrötf
(
sub
, 
f⁄t
, 
ux1
+7, 
uy2
-3, 255,

55 
s_±r
[
n
].
¥›1
,

56 
s_±r
[
n
].
¥›2
,

57 
s_±r
[
n
].
¥›3
,

58 
s_±r
[
n
].
¥›4


61 i‡(
bt_idx
 <= 0)

64 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
 + 
bt_idx
;

65 i‡(
bt_±r
->
ty≥
 !
BT_SHADOW
)

68 
dt1_idx
 = 
bt_±r
->dt1_idx;

69 
block_idx
 = 
bt_±r
->block_idx;

70 
tmp_bmp
 = * (
glb_dt1
[
dt1_idx
].
block_zoom
[
ZM_11
] + 
block_idx
);

72 i‡(
tmp_bmp
 =
NULL
)

75 
y1
 = 
sub
->
h
 - 160 - 
bt_±r
->
zîo_löe
;

76 
y1
 += 80;

79 
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[0])

82 
	`døw_•rôe
(
sub
, 
tmp_bmp
, 0, 
y1
);

86 i‡(
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 == -1)

87 
cﬁ‹_m≠
 = & 
glb_ds1edô
.
cm≠
[
CM_SELECT
][
glb_ds1
[
ds1_idx
].
a˘
 - 1];

89 
cﬁ‹_m≠
 = & 
glb_ds1edô
.
cm≠
[
CM_SELECT
][glb_ds1edô.
cmd_löe
.
f‹˚_∑l_num
 - 1];

90 
	`døw_lô_•rôe
(
sub
, 
tmp_bmp
, 0, 
y1
, 
COL_SHADOW
);

94 i‡(
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 == -1)

95 
cﬁ‹_m≠
 = & 
glb_ds1edô
.
cm≠
[
CM_TRANS
][
glb_ds1
[
ds1_idx
].
a˘
 - 1];

97 
cﬁ‹_m≠
 = & 
glb_ds1edô
.
cm≠
[
CM_TRANS
][glb_ds1edô.
cmd_löe
.
f‹˚_∑l_num
 - 1];

98 
	`døw_å™s_•rôe
(
sub
, 
tmp_bmp
, 0, 
y1
);

102 
	`de°roy_bôm≠
(
sub
);

103 
	}
}

108 
	$wedô_døw_f
(
ds1_idx
, 
x
, 
y
)

110 
WIN_ELEMENT_S
 * 
w_ñm
 = & 
glb_ds1edô
.
wö_edô
.
w_¥evõw
;

111 
BITMAP
 * 
sub
;

112 
BLOCK_TABLE_S
 * 
bt_±r
;

113 
BITMAP
 * 
tmp_bmp
;

114 
CELL_F_S
 * 
f_±r
;

115 
n
, 
t
, 
bt_idx
, 
dt1_idx
, 
block_idx
, 
y1
;

116 
ORDER_DATA_S
 
‹dî_d©a
[4];

117 
ux1
, 
ux2
, 
ux3
, 
ux4
, 
uy1
, 
uy2
, 
uy3
;

120 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

121 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
t
;

122 
sub
 = 
	`¸óã_sub_bôm≠
(
glb_ds1edô
.
s¸ìn_buff
,

123 
w_ñm
->
i_x0
, w_ñm->
i_y0
, w_ñm->
öside
->
w
, w_ñm->öside->
h
);

125 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
Êo‹_num
;Ç++)

127 
‹dî_d©a
[
n
].
idx
 =Ç;

128 
‹dî_d©a
[
n
].
height
 = 
f_±r
[n].
¥›1
;

130 
	`qs‹t
(
‹dî_d©a
, 
glb_ds1
[
ds1_idx
].
Êo‹_num
, (
ORDER_DATA_S
),

131 
qs‹t_hñ≥r_‹dî_d©a
);

133 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
Êo‹_num
;Ç++)

135 
bt_idx
 = 
f_±r
[
‹dî_d©a
[
n
].
idx
].bt_idx;

136 i‡(
bt_idx
 == -1)

138 
ux1
 = 0;

139 
ux2
 = 
ux1
 + 79;

140 
ux3
 = 
ux1
 + 80;

141 
ux4
 = 
ux1
 + 159;

143 
uy1
 = 
sub
->
h
 - 160;

144 
uy2
 = 
uy1
 + 39;

145 
uy3
 = 
uy1
 + 78;

147 
	`löe
(
sub
, 
ux1
, 
uy2
, 
ux2
, 
uy1
, 168);

148 
	`löe
(
sub
, 
ux3
, 
uy1
, 
ux4
, 
uy2
, 168);

149 
	`löe
(
sub
, 
ux3
, 
uy3
, 
ux4
, 
uy2
, 168);

150 
	`löe
(
sub
, 
ux1
, 
uy2
, 
ux2
, 
uy3
, 168);

152 
	`ãxçrötf
(
sub
, 
f⁄t
, 
ux1
+8, 
uy2
-2, 0,

154 
f_±r
[
‹dî_d©a
[
n
].
idx
].
¥›1
,

155 
f_±r
[
‹dî_d©a
[
n
].
idx
].
¥›2
,

156 
f_±r
[
‹dî_d©a
[
n
].
idx
].
¥›3
,

157 
f_±r
[
‹dî_d©a
[
n
].
idx
].
¥›4


159 
	`ãxçrötf
(
sub
, 
f⁄t
, 
ux1
+7, 
uy2
-3, 255,

161 
f_±r
[
‹dî_d©a
[
n
].
idx
].
¥›1
,

162 
f_±r
[
‹dî_d©a
[
n
].
idx
].
¥›2
,

163 
f_±r
[
‹dî_d©a
[
n
].
idx
].
¥›3
,

164 
f_±r
[
‹dî_d©a
[
n
].
idx
].
¥›4


167 i‡(
bt_idx
 <= 0)

170 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
 + 
bt_idx
;

171 i‡–(
bt_±r
->
ty≥
 !
BT_STATIC
Ë&& (bt_±r->ty≥ !
BT_ANIMATED
) )

174 
dt1_idx
 = 
bt_±r
->dt1_idx;

175 
block_idx
 = 
bt_±r
->block_idx;

176 
tmp_bmp
 = * (
glb_dt1
[
dt1_idx
].
block_zoom
[
ZM_11
] + 
block_idx
);

178 i‡(
tmp_bmp
 =
NULL
)

181 
y1
 = 
sub
->
h
 - 160 - 
bt_±r
->
zîo_löe
;

182 
	`døw_•rôe
(
sub
, 
tmp_bmp
, 0, 
y1
);

184 
	`de°roy_bôm≠
(
sub
);

185 
	}
}

190 
	$wedô_døw_w
(
ds1_idx
, 
x
, 
y
, 
uµî
)

192 
WIN_ELEMENT_S
 * 
w_ñm
 = & 
glb_ds1edô
.
wö_edô
.
w_¥evõw
;

193 
BITMAP
 * 
sub
;

194 
BLOCK_TABLE_S
 * 
bt_±r
;

195 
BITMAP
 * 
tmp_bmp
;

196 
CELL_W_S
 * 
w_±r
;

197 
n
, 
t
, 
bt_idx
, 
dt1_idx
, 
block_idx
, 
m
, 
s
, 
y1
;

198 
d⁄e
, 
found
, 
o
;

199 
ORDER_DATA_S
 
‹dî_d©a
[4];

200 
ux1
, 
ux2
, 
ux3
, 
ux4
, 
uy1
, 
uy2
, 
uy3
;

203 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

204 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
t
;

205 
sub
 = 
	`¸óã_sub_bôm≠
(
glb_ds1edô
.
s¸ìn_buff
,

206 
w_ñm
->
i_x0
, w_ñm->
i_y0
, w_ñm->
öside
->
w
, w_ñm->öside->
h
);

208 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

210 
‹dî_d©a
[
n
].
idx
 =Ç;

211 
‹dî_d©a
[
n
].
height
 = 
w_±r
[n].
¥›1
;

212 i‡(
w_±r
[
n
].
‹õ¡©i⁄
 == 10)

213 
‹dî_d©a
[
n
].
height
 = 255;

215 
	`qs‹t
(
‹dî_d©a
, 
glb_ds1
[
ds1_idx
].
wÆl_num
, (
ORDER_DATA_S
),

216 
qs‹t_hñ≥r_‹dî_d©a
);

218 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

220 
o
 = 
w_±r
[
‹dî_d©a
[
n
].
idx
].
‹õ¡©i⁄
;

221 i‡((
uµî
 =
TRUE
Ë&& (
o
 >= 15))

223 i‡((
uµî
 =
FALSE
Ë&& (
o
 <= 15))

226 i‡(
glb_ds1
[
ds1_idx
].
•ecül_œyî_mask
 && ((
o
 == 10) || (o == 11)))

232 
bt_idx
 = 
w_±r
[
‹dî_d©a
[
n
].
idx
].bt_idx;

234 i‡(
bt_idx
 == 0)

237 i‡(
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›4
 & 0x80)

240 i‡((
o
 != 10) && (o != 11))

241 
bt_idx
 = -1;

244 i‡(
bt_idx
 == -1)

246 
ux1
 = 0;

247 
ux2
 = 
ux1
 + 79;

248 
ux3
 = 
ux1
 + 80;

249 
ux4
 = 
ux1
 + 159;

251 
uy1
 = 
sub
->
h
 - 160;

252 
uy2
 = 
uy1
 + 39;

253 
uy3
 = 
uy1
 + 78;

255 
	`löe
(
sub
, 
ux1
, 
uy2
, 
ux2
, 
uy1
, 168);

256 
	`löe
(
sub
, 
ux3
, 
uy1
, 
ux4
, 
uy2
, 168);

257 
	`löe
(
sub
, 
ux3
, 
uy3
, 
ux4
, 
uy2
, 168);

258 
	`löe
(
sub
, 
ux1
, 
uy2
, 
ux2
, 
uy3
, 168);

260 
	`ãxçrötf
(
sub
, 
f⁄t
, 
ux1
+8, 
uy2
-2, 0,

262 
w_±r
[
‹dî_d©a
[
n
].
idx
].
‹õ¡©i⁄
,

263 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›1
,

264 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›2
,

265 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›3
,

266 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›4


268 
	`ãxçrötf
(
sub
, 
f⁄t
, 
ux1
+7, 
uy2
-3, 255,

270 
w_±r
[
‹dî_d©a
[
n
].
idx
].
‹õ¡©i⁄
,

271 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›1
,

272 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›2
,

273 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›3
,

274 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›4


279 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
 + 
bt_idx
;

280 i‡–(
bt_±r
->
ty≥
 !
BT_WALL_UP
) &&

281 (
bt_±r
->
ty≥
 !
BT_WALL_DOWN
) &&

282 (
bt_±r
->
ty≥
 !
BT_SPECIAL
))

288 
dt1_idx
 = 
bt_±r
->dt1_idx;

289 
block_idx
 = 
bt_±r
->block_idx;

291 
tmp_bmp
 = * (
glb_dt1
[
dt1_idx
].
block_zoom
[
ZM_11
] + 
block_idx
);

293 i‡(
tmp_bmp
 =
NULL
)

296 
y1
 = 
sub
->
h
 - 160 - 
bt_±r
->
zîo_löe
;

297 
y1
 += 80;

298 
	`døw_•rôe
(
sub
, 
tmp_bmp
, 0, 
y1
);

300 i‡(
bt_±r
->
‹õ¡©i⁄
 == 3)

303 
m
 = 
bt_±r
->
maö_ödex
;

304 
s
 = 
bt_±r
->
sub_ödex
;

305 
d⁄e
 = 
FALSE
;

306 
found
 = 
FALSE
;

307  ! 
d⁄e
)

309 i‡(
bt_idx
 >
glb_ds1
[
ds1_idx
].
bt_num
)

310 
d⁄e
 = 
TRUE
;

313 
bt_±r
++;

314 i‡(
bt_±r
->
‹õ¡©i⁄
 < 4)

315 
bt_idx
++;

318 i‡(
bt_±r
->
‹õ¡©i⁄
 == 4)

319 i‡((
bt_±r
->
maö_ödex
 =
m
Ë&& (bt_±r->
sub_ödex
 =
s
))

320 
d⁄e
 = 
found
 = 
TRUE
;

324 i‡(
found
 =
TRUE
)

326 
dt1_idx
 = 
bt_±r
->dt1_idx;

327 
block_idx
 = 
bt_±r
->block_idx;

328 
tmp_bmp
 = * (
glb_dt1
[
dt1_idx
].
block_zoom
[
ZM_11
] + 
block_idx
);

330 i‡(
tmp_bmp
 =
NULL
)

333 
y1
 = 
sub
->
h
 - 160 - 
bt_±r
->
zîo_löe
;

334 
y1
 += 80;

335 
	`døw_•rôe
(
sub
, 
tmp_bmp
, 0, 
y1
);

339 
	`de°roy_bôm≠
(
sub
);

340 
	}
}

344 
	$wedô_døw_r
(
ds1_idx
, 
x
, 
y
)

346 
WIN_ELEMENT_S
 * 
w_ñm
 = & 
glb_ds1edô
.
wö_edô
.
w_¥evõw
;

347 
BITMAP
 * 
sub
;

348 
BLOCK_TABLE_S
 * 
bt_±r
;

349 
BITMAP
 * 
tmp_bmp
;

350 
CELL_W_S
 * 
r_±r
;

351 
n
, 
t
, 
bt_idx
, 
dt1_idx
, 
block_idx
, 
y1
;

352 
ORDER_DATA_S
 
‹dî_d©a
[4];

354 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

355 
r_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
t
;

356 
sub
 = 
	`¸óã_sub_bôm≠
(
glb_ds1edô
.
s¸ìn_buff
,

357 
w_ñm
->
i_x0
, w_ñm->
i_y0
, w_ñm->
öside
->
w
, w_ñm->öside->
h
);

359 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

361 
‹dî_d©a
[
n
].
idx
 =Ç;

362 
‹dî_d©a
[
n
].
height
 = 
r_±r
[n].
¥›1
;

364 
	`qs‹t
(
‹dî_d©a
, 
glb_ds1
[
ds1_idx
].
wÆl_num
, (
ORDER_DATA_S
),

365 
qs‹t_hñ≥r_‹dî_d©a
);

367 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

369 i‡(
r_±r
[
‹dî_d©a
[
n
].
idx
].
¥›4
 & 0x80)

372 
bt_idx
 = 
r_±r
[
‹dî_d©a
[
n
].
idx
].bt_idx;

373 i‡(
bt_idx
 <= 0)

376 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
 + 
bt_idx
;

377 i‡(
bt_±r
->
ty≥
 !
BT_ROOF
)

380 
dt1_idx
 = 
bt_±r
->dt1_idx;

381 
block_idx
 = 
bt_±r
->block_idx;

382 
tmp_bmp
 = * (
glb_dt1
[
dt1_idx
].
block_zoom
[
ZM_11
] + 
block_idx
);

384 i‡(
tmp_bmp
 =
NULL
)

387 
y1
 = 
sub
->
h
 - 160 - 
bt_±r
->
zîo_löe
;

388 
y1
 -
bt_±r
->
roof_y
;

389 
	`døw_•rôe
(
sub
, 
tmp_bmp
, 0, 
y1
);

391 
	`de°roy_bôm≠
(
sub
);

392 
	}
}

397 
	$wedô_døw_•
(
ds1_idx
, 
x
, 
y
)

399 
WIN_ELEMENT_S
 * 
w_ñm
 = & 
glb_ds1edô
.
wö_edô
.
w_¥evõw
;

400 
BITMAP
 * 
sub
;

401 
BLOCK_TABLE_S
 * 
bt_±r
;

402 
BITMAP
 * 
tmp_bmp
;

403 
CELL_W_S
 * 
w_±r
;

404 
n
, 
t
, 
bt_idx
, 
dt1_idx
, 
block_idx
, 
y1
, 
o
;

405 
ORDER_DATA_S
 
‹dî_d©a
[4];

406 
ux1
, 
ux2
, 
ux3
, 
ux4
, 
uy1
, 
uy2
, 
uy3
;

409 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

410 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
t
;

411 
sub
 = 
	`¸óã_sub_bôm≠
(
glb_ds1edô
.
s¸ìn_buff
,

412 
w_ñm
->
i_x0
, w_ñm->
i_y0
, w_ñm->
öside
->
w
, w_ñm->öside->
h
);

414 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

416 
‹dî_d©a
[
n
].
idx
 =Ç;

417 
‹dî_d©a
[
n
].
height
 = 
w_±r
[n].
¥›1
;

418 i‡(
w_±r
[
n
].
‹õ¡©i⁄
 == 10)

419 
‹dî_d©a
[
n
].
height
 = 255;

421 
	`qs‹t
(
‹dî_d©a
, 
glb_ds1
[
ds1_idx
].
wÆl_num
, (
ORDER_DATA_S
),

422 
qs‹t_hñ≥r_‹dî_d©a
);

424 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

426 
bt_idx
 = 
w_±r
[
‹dî_d©a
[
n
].
idx
].bt_idx;

428 i‡(
bt_idx
 == 0)

431 
o
 = 
w_±r
[
‹dî_d©a
[
n
].
idx
].
‹õ¡©i⁄
;

433 i‡((
o
 != 10) && (o != 11))

442 i‡(
bt_idx
 <= 0)

445 
ux1
 = 0;

446 
ux2
 = 
ux1
 + 79;

447 
ux3
 = 
ux1
 + 80;

448 
ux4
 = 
ux1
 + 159;

450 
uy1
 = 
sub
->
h
 - 160;

451 
uy2
 = 
uy1
 + 39;

452 
uy3
 = 
uy1
 + 78;

454 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ux1
, 
uy2
, 
ux2
, 
uy1
, 168);

455 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ux3
, 
uy1
, 
ux4
, 
uy2
, 168);

456 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ux3
, 
uy3
, 
ux4
, 
uy2
, 168);

457 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ux1
, 
uy2
, 
ux2
, 
uy3
, 168);

459 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
ux1
+8, 
uy2
-2, 0,

461 
w_±r
[
‹dî_d©a
[
n
].
idx
].
‹õ¡©i⁄
,

462 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›1
,

463 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›2
,

464 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›3
,

465 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›4


467 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
ux1
+7, 
uy2
-3, 255,

469 
w_±r
[
‹dî_d©a
[
n
].
idx
].
‹õ¡©i⁄
,

470 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›1
,

471 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›2
,

472 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›3
,

473 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›4


480 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
 + 
bt_idx
;

481 i‡(
bt_±r
->
ty≥
 !
BT_SPECIAL
)

484 
dt1_idx
 = 
bt_±r
->dt1_idx;

485 
block_idx
 = 
bt_±r
->block_idx;

487 
tmp_bmp
 = * (
glb_dt1
[
dt1_idx
].
block_zoom
[
ZM_11
] + 
block_idx
);

489 i‡(
tmp_bmp
 =
NULL
)

492 
y1
 = 
sub
->
h
 - 160 - 
bt_±r
->
zîo_löe
;

493 
y1
 += 80;

494 
	`døw_•rôe
(
sub
, 
tmp_bmp
, 0, 
y1
);

496 
	`de°roy_bôm≠
(
sub
);

497 
	}
}

502 
	$wedô_make_2nd_buâ⁄s
()

504 
BUTTON_S
 * 
b
;

505 
BITMAP
 * 
tmp
;

506 
i
;

508 
i
 = 
BU_NULL
+1; i<
BU_MAX
; i++)

510 
b
 = & 
glb_ds1edô
.
wö_edô
.
buâ⁄
[
i
];

511 
tmp
 = 
	`¸óã_bôm≠
(
b
->
w
, b->
h
);

512 i‡(
tmp
 =
NULL
)

513 
	`ds1edô_îr‹
("notÉnough mem for 1 button");

514 
b
->
bmp
[1] = 
tmp
;

515 
	`˛ór_to_cﬁ‹
(
tmp
, 172);

516 
	`blô
(
b
->
bmp
[0], 
tmp
, 0, 0, 2, 2, b->
w
, b->
h
);

518 
	}
}

523 
	$wedô_ªad_pcx
()

525 
WIN_ELEMENT_S
 * 
w_ñm
;

526 
BITMAP
 * 
tmp_bmp
;

527 
BITMAP
 * 
pcx
[9];

528 
BUTTON_S
 * 
b
;

531 
fûe
[30];

532 
BUT_TYP_E
 
b_num
;

533 
BLK_TYP_E
 
t_num
;

534 
x0
;

535 
y0
;

536 } 
d©a
[] = {

537 {"but_ok", 
BU_OK
, 
BT_NULL
, 8, 8},

538 {"but_ˇn˚l", 
BU_CANCEL
, 
BT_NULL
, 83, 8},

539 {"but_Êo‹1", 
BU_FLOOR1
, 
BT_NULL
, 186, 38},

540 {"but_Êo‹2", 
BU_FLOOR2
, 
BT_NULL
, 257, 38},

541 {"but_shadow", 
BU_SHADOW
, 
BT_NULL
, 470, 38},

542 {"but_wÆl1", 
BU_WALL1
, 
BT_NULL
, 186, 8},

543 {"but_wÆl2", 
BU_WALL2
, 
BT_NULL
, 257, 8},

544 {"but_wÆl3", 
BU_WALL3
, 
BT_NULL
, 328, 8},

545 {"but_wÆl4", 
BU_WALL4
, 
BT_NULL
, 399, 8},

546 {"võw_ønd", 
BU_VIEW_RAND
, 
BT_NULL
, 470, 8},

547 {"èb_°©ic", 
BU_NULL
, 
BT_STATIC
, -1, -1},

548 {"èb_™im", 
BU_NULL
, 
BT_ANIMATED
, -1, -1},

549 {"èb_uµî", 
BU_NULL
, 
BT_WALL_UP
, -1, -1},

550 {"èb_lowî", 
BU_NULL
, 
BT_WALL_DOWN
, -1, -1},

551 {"èb_roofs", 
BU_NULL
, 
BT_ROOF
, -1, -1},

552 {"èb_•ecül", 
BU_NULL
, 
BT_SPECIAL
, -1, -1},

553 {"èb_shadow", 
BU_NULL
, 
BT_SHADOW
, -1, -1},

554 {"", 
BU_NULL
, 
BT_NULL
, -1, -1}

556 
fûíame
[80];

557 
pcx_«me
[9][20] = {

562 
i
=0, 
n1
, 
n2
, 
x0
, 
y0
, 
w
, 
h
, 
my_b‹dî
, 
x
, 
y
;

564 
	`Ârötf
(
°dîr
, "loadingÖcx");

565 
	`fÊush
(
°dîr
);

566 
	`°æí
(
d©a
[
i
].
fûe
) != 0)

568 
	`Ârötf
(
°dîr
, ".");

569 
	`fÊush
(
°dîr
);

570 
n1
 = 
d©a
[
i
].
b_num
;

571 
n2
 = 
d©a
[
i
].
t_num
;

572 i‡(
n1
 !
BU_NULL
)

575 
b
 = & 
glb_ds1edô
.
wö_edô
.
buâ⁄
[
n1
];

576 
	`•rötf
(
fûíame
, "pcx/%s.pcx", 
d©a
[
i
].
fûe
);

577 
b
->
bmp
[0] = 
	`lﬂd_pcx
(
fûíame
, 
glb_ds1edô
.
dummy_∑l
);

578 
b
->
w
 = b->
bmp
[0]->w;

579 
b
->
h
 = b->
bmp
[0]->h;

580 
b
->
x0
 = 
d©a
[
i
].x0;

581 
b
->
y0
 = 
d©a
[
i
].y0;

583 i‡(
n2
 !
BT_NULL
)

586 
b
 = & 
glb_ds1edô
.
wö_edô
.
èb
[
n2
];

587 
	`•rötf
(
fûíame
, "pcx/%s_off.pcx", 
d©a
[
i
].
fûe
);

588 
b
->
bmp
[0] = 
	`lﬂd_pcx
(
fûíame
, 
glb_ds1edô
.
dummy_∑l
);

589 
b
->
w
 = b->
bmp
[0]->w;

590 
b
->
h
 = b->
bmp
[0]->h;

593 
	`•rötf
(
fûíame
, "pcx/%s.pcx", 
d©a
[
i
].
fûe
);

594 
b
->
bmp
[1] = 
	`lﬂd_pcx
(
fûíame
, 
glb_ds1edô
.
dummy_∑l
);

596 
i
++;

600 
i
=0; i<9; i++)

602 
	`Ârötf
(
°dîr
, ".");

603 
	`fÊush
(
°dîr
);

604 
	`•rötf
(
fûíame
, "pcx/¥evõw/%s.pcx", 
pcx_«me
[
i
]);

605 
pcx
[
i
] = 
	`lﬂd_pcx
(
fûíame
, 
glb_ds1edô
.
dummy_∑l
);

607 
my_b‹dî
 = 8;

608 
x0
 = 
my_b‹dî
;

609 
y0
 = 38;

610 
w
 = 160 + 
pcx
[0]->w +Öcx[2]->w;

611 
h
 = 
glb_c⁄fig
.
s¸ìn
.
height
 - 
y0
 - 
my_b‹dî
;

613 
tmp_bmp
 = 
	`¸óã_bôm≠
(
w
, 
h
);

615 
	`˛ór
(
tmp_bmp
);

617 
x
=0; x<
w
; x +
pcx
[1]->w)

618 
	`blô
(
pcx
[1], 
tmp_bmp
, 0, 0, 
x
, 0,Öcx[1]->
w
,Öcx[1]->
h
);

620 
x
=0; x<
w
; x +
pcx
[7]->w)

621 
	`blô
(
pcx
[7], 
tmp_bmp
, 0, 0, 
x
, 
h
 -Öcx[7]->h,Öcx[7]->
w
,Öcx[7]->h);

623 
y
=0; y<
h
; y +
pcx
[3]->h)

624 
	`blô
(
pcx
[3], 
tmp_bmp
, 0, 0, 0, 
y
,Öcx[3]->
w
,Öcx[3]->
h
);

626 
y
=0; y<
h
; y +
pcx
[5]->h)

627 
	`blô
(
pcx
[5], 
tmp_bmp
, 0, 0, 
w
-pcx[5]->w, 
y
,Öcx[5]->w,Öcx[5]->
h
);

629 
	`blô
(
pcx
[0], 
tmp_bmp
, 0, 0, 0, 0,Öcx[0]->
w
,Öcx[0]->
h
);

630 
	`blô
(
pcx
[2], 
tmp_bmp
, 0, 0, 
w
-pcx[2]->w, 0,Öcx[2]->w,Öcx[2]->
h
);

631 
	`blô
(
pcx
[6], 
tmp_bmp
, 0, 0, 0, 
h
-pcx[6]->h,Öcx[6]->
w
,Öcx[6]->h);

632 
	`blô
(
pcx
[8], 
tmp_bmp
, 0, 0, 
w
-pcx[8]->w, 
h
-pcx[8]->h,Öcx[8]->w,Öcx[8]->h);

634 
w_ñm
 = & 
glb_ds1edô
.
wö_edô
.
w_¥evõw
;

635 
w_ñm
->
b‹dî
 = 
	`gë_æe_•rôe
(
tmp_bmp
);

636 
w_ñm
->
b_x0
 = 
x0
;

637 
w_ñm
->
b_y0
 = 
y0
;

639 
y
=0; y<
h
; y +
pcx
[4]->h)

640 
x
=0; x<
w
; x +
pcx
[4]->w)

641 
	`blô
(
pcx
[4], 
tmp_bmp
, 0, 0, 
x
, 
y
,Öcx[4]->
w
,Öcx[4]->
h
);

643 
w_ñm
->
öside
 = 
	`¸óã_bôm≠
(
w
 - 
pcx
[3]->w * 2, 
h
 -Öcx[1]->h * 2);

644 
	`blô
(
tmp_bmp
, 
w_ñm
->
öside
, 
pcx
[3]->
w
,Öcx[1]->
h
, 0, 0, w -Öcx[3]->w * 2, h -Öcx[1]->h * 2);

645 
w_ñm
->
i_x0
 = w_ñm->
b_x0
 + 
pcx
[3]->
w
;

646 
w_ñm
->
i_y0
 = w_ñm->
b_y0
 + 
pcx
[1]->
h
;

648 
i
=0; i<9; i++)

649 
	`de°roy_bôm≠
(
pcx
[
i
]);

650 
	`de°roy_bôm≠
(
tmp_bmp
);

654 
i
=0; i<9; i++)

656 
	`Ârötf
(
°dîr
, ".");

657 
	`fÊush
(
°dîr
);

658 
	`•rötf
(
fûíame
, "pcx/tûes/%s.pcx", 
pcx_«me
[
i
]);

659 
pcx
[
i
] = 
	`lﬂd_pcx
(
fûíame
, 
glb_ds1edô
.
dummy_∑l
);

661 
x0
 = 
w_ñm
->
b_x0
 + w_ñm->
b‹dî
->
w
 + 
my_b‹dî
;

662 
y0
 = 119;

663 
w
 = 
glb_c⁄fig
.
s¸ìn
.
width
 - 
x0
 - 
my_b‹dî
;

664 
h
 = 
glb_c⁄fig
.
s¸ìn
.
height
 - 
y0
 - 
my_b‹dî
;

665 
tmp_bmp
 = 
	`¸óã_bôm≠
(
w
, 
h
);

666 
	`˛ór
(
tmp_bmp
);

668 
x
=0; x<
w
; x +
pcx
[1]->w)

669 
	`blô
(
pcx
[1], 
tmp_bmp
, 0, 0, 
x
, 0,Öcx[1]->
w
,Öcx[1]->
h
);

671 
x
=0; x<
w
; x +
pcx
[7]->w)

672 
	`blô
(
pcx
[7], 
tmp_bmp
, 0, 0, 
x
, 
h
 -Öcx[7]->h,Öcx[7]->
w
,Öcx[7]->h);

674 
y
=0; y<
h
; y +
pcx
[3]->h)

675 
	`blô
(
pcx
[3], 
tmp_bmp
, 0, 0, 0, 
y
,Öcx[3]->
w
,Öcx[3]->
h
);

677 
y
=0; y<
h
; y +
pcx
[5]->h)

678 
	`blô
(
pcx
[5], 
tmp_bmp
, 0, 0, 
w
-pcx[5]->w, 
y
,Öcx[5]->w,Öcx[5]->
h
);

680 
	`blô
(
pcx
[0], 
tmp_bmp
, 0, 0, 0, 0,Öcx[0]->
w
,Öcx[0]->
h
);

681 
	`blô
(
pcx
[2], 
tmp_bmp
, 0, 0, 
w
-pcx[2]->w, 0,Öcx[2]->w,Öcx[2]->
h
);

682 
	`blô
(
pcx
[6], 
tmp_bmp
, 0, 0, 0, 
h
-pcx[6]->h,Öcx[6]->
w
,Öcx[6]->h);

683 
	`blô
(
pcx
[8], 
tmp_bmp
, 0, 0, 
w
-pcx[8]->w, 
h
-pcx[8]->h,Öcx[8]->w,Öcx[8]->h);

685 
w_ñm
 = & 
glb_ds1edô
.
wö_edô
.
w_tûes
;

686 
w_ñm
->
b‹dî
 = 
	`gë_æe_•rôe
(
tmp_bmp
);

687 
w_ñm
->
b_x0
 = 
x0
;

688 
w_ñm
->
b_y0
 = 
y0
;

690 
y
=0; y<
h
; y +
pcx
[4]->h)

691 
x
=0; x<
w
; x +
pcx
[4]->w)

692 
	`blô
(
pcx
[4], 
tmp_bmp
, 0, 0, 
x
, 
y
,Öcx[4]->
w
,Öcx[4]->
h
);

694 
w_ñm
->
öside
 = 
	`¸óã_bôm≠
(
w
 - 
pcx
[3]->w * 2, 
h
 -Öcx[1]->h * 2);

695 
	`blô
(
tmp_bmp
, 
w_ñm
->
öside
, 
pcx
[3]->
w
,Öcx[1]->
h
, 0, 0, w -Öcx[3]->w * 2, h -Öcx[1]->h * 2);

696 
w_ñm
->
i_x0
 = w_ñm->
b_x0
 + 
pcx
[3]->
w
;

697 
w_ñm
->
i_y0
 = w_ñm->
b_y0
 + 
pcx
[1]->
h
;

699 
i
=0; i<9; i++)

700 
	`de°roy_bôm≠
(
pcx
[
i
]);

701 
	`de°roy_bôm≠
(
tmp_bmp
);

703 
	`Ârötf
(
°dîr
, "\n");

704 
	`fÊush
(
°dîr
);

705 
	}
}

710 
	$wedô_‰ì
()

712 
WIN_ELEMENT_S
 * 
w_ñm
;

713 
BUTTON_S
 * 
b
, * 
t
;

714 
i
, 
n
;

717 
i
 = 
BU_NULL
+1; i<
BU_MAX
; i++)

719 
b
 = & 
glb_ds1edô
.
wö_edô
.
buâ⁄
[
i
];

720 
n
=0;Ç<2;Ç++)

722 i‡(
b
->
bmp
[
n
] !
NULL
)

724 
	`de°roy_bôm≠
(
b
->
bmp
[
n
]);

725 
b
->
bmp
[
n
] = 
NULL
;

731 
i
 = 
BT_NULL
+1; i<
BT_MAX
; i++)

733 
t
 = & 
glb_ds1edô
.
wö_edô
.
èb
[
i
];

734 
n
=0;Ç<2;Ç++)

736 i‡(
t
->
bmp
[
n
] !
NULL
)

738 
	`de°roy_bôm≠
(
t
->
bmp
[
n
]);

739 
t
->
bmp
[
n
] = 
NULL
;

745 
i
=0; i<2; i++)

748 i‡(
i
 == 0)

749 
w_ñm
 = & 
glb_ds1edô
.
wö_edô
.
w_¥evõw
;

750 i‡(
i
 == 1)

751 
w_ñm
 = & 
glb_ds1edô
.
wö_edô
.
w_tûes
;

753 
w_ñm
 = 
NULL
;

756 i‡(
w_ñm
->
b‹dî
 !
NULL
)

758 
	`de°roy_æe_•rôe
(
w_ñm
->
b‹dî
);

759 
w_ñm
->
b‹dî
 = 
NULL
;

761 i‡(
w_ñm
->
öside
 !
NULL
)

763 
	`de°roy_bôm≠
(
w_ñm
->
öside
);

764 
w_ñm
->
öside
 = 
NULL
;

767 
	}
}

772 
	$wedô_døw_buâ⁄
(
BUT_TYP_E
 
b_num
)

774 
BUTTON_S
 * 
b
 = & 
glb_ds1edô
.
wö_edô
.
buâ⁄
[
b_num
];

775 
x1
, 
y1
, 
x2
, 
y2
;

777 i‡–! 
b
->
a˘ive
)

779 
x1
 = 
b
->
x0
;

780 
x2
 = 
x1
 + 
b
->
w
 - 1;

781 
y1
 = 
b
->
y0
;

782 
y2
 = 
y1
 + 
b
->
h
 - 1;

783 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 0);

784 
	`døw_•rôe
(
glb_ds1edô
.
s¸ìn_buff
, 
b
->
bmp
[b->
°©e
], b->
x0
, b->
y0
);

785 
	}
}

790 
	$wedô_døw_èb
(
BLK_TYP_E
 
t_num
)

792 
BUTTON_S
 * 
t
 = & 
glb_ds1edô
.
wö_edô
.
èb
[
t_num
];

793 
x1
, 
y1
, 
x2
, 
y2
;

795 i‡–! 
t
->
a˘ive
)

797 
x1
 = 
t
->
x0
;

798 
x2
 = 
x1
 + 
t
->
w
 - 1;

799 
y1
 = 
t
->
y0
;

800 
y2
 = 
y1
 + 
t
->
h
 - 1;

801 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 0);

802 
	`døw_•rôe
(
glb_ds1edô
.
s¸ìn_buff
, 
t
->
bmp
[t->
°©e
],Å->
x0
,Å->
y0
);

803 
	}
}

808 
	$wedô_èb_have
(
ds1_idx
, 
BLK_TYP_E
 
t
)

810 
BLOCK_TABLE_S
 * 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
;

811 
i
;

813 
i
=0; i<
glb_ds1
[
ds1_idx
].
bt_num
; i++)

815 i‡(
bt_±r
->
ty≥
 =
t
)

816  
TRUE
;

817 
bt_±r
++;

820  
FALSE
;

821 
	}
}

826 
	$wedô_tûes_‰ì
()

828 
WIN_EDIT_S
 * 
w
 = & 
glb_ds1edô
.
wö_edô
;

829 
MAIN_LINE_S
 * 
m_±r
;

830 
t
, 
m
;

832 
t
=
BT_NULL
+1;Å<
BT_MAX
;Å++)

834 i‡(
w
->
maö_löe_èb
[
t
] !
NULL
)

836 
m
=0; m < 
w
->
maö_löe_num
[
t
]; m++)

838 
m_±r
 = 
w
->
maö_löe_èb
[
t
] + 
m
;

839 i‡(
m_±r
->
sub_ñm
 !
NULL
)

841 
	`‰ì
(
m_±r
->
sub_ñm
);

842 
m_±r
->
sub_ñm
 = 
NULL
;

845 
	`‰ì
(
w
->
maö_löe_èb
[
t
]);

846 
w
->
maö_löe_èb
[
t
] = 
NULL
;

849 
	}
}

854 
	$wedô_tûes_make
(
ds1_idx
)

856 
BITMAP
 * 
tmp_bmp
;

857 
BLOCK_TABLE_S
 * 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
;

858 
WIN_EDIT_S
 * 
w
 = & 
glb_ds1edô
.
wö_edô
;

859 
MAIN_LINE_S
 * 
m_±r
;

860 
SUB_ELM_S
 * 
s_±r
;

861 
numb
, 
size
, 
i
, 
b
, 
löe
, 
t
, 
n
, 
d⁄e
, 
cﬁ
, 
y
, 
max_height
, 
x
;

862 
ﬁd_o
, 
ﬁd_m
, 
ﬁd_s
, 
o
, 
m
, 
s
, 
dx
, 
bx
, 
y0
;

863 
ube
;

864 * 
is_kìp
, 
tmp
[150];

866 
numb
 = 
glb_ds1
[
ds1_idx
].
bt_num
;

867 
size
 = 
numb
 * ();

868 
is_kìp
 = (*Ë
	`mÆloc
(
size
);

869 i‡(
is_kìp
 =
NULL
)

871 
	`•rötf
(
tmp
, "(is_kìpË:ÇŸÉnough mem (%òbyãs)", 
size
);

872 
	`ds1edô_îr‹
(
tmp
);

876 
t
 = 
BT_NULL
 + 1;Å < 
BT_MAX
;Å++)

878 
i
=0; i<
numb
; i++)

879 * (
is_kìp
 + 
i
Ë
FALSE
;

881 
löe
 = 0;

882 
ﬁd_o
 = 
ﬁd_m
 = -1;

883 
b
=1; b < 
numb
; b++)

885 i‡(
bt_±r
[
b
].
ty≥
 =
t
)

887 
o
 = 
bt_±r
[
b
].
‹õ¡©i⁄
;

888 
m
 = 
bt_±r
[
b
].
maö_ödex
;

889 
dx
 = 
bt_±r
[
b
].
dt1_idx
;

890 
bx
 = 
bt_±r
[
b
].
block_idx
;

891 
ube
 = 
bt_±r
[
b
].
u£d_by_edô‹
;

892 
tmp_bmp
 = * (
glb_dt1
[
dx
].
block_zoom
[
ZM_11
] + 
bx
);

893 i‡((
tmp_bmp
 !
NULL
Ë&& 
ube
)

895 i‡–(
ﬁd_o
 !
o
Ë|| (
ﬁd_m
 !
m
) )

897 * (
is_kìp
 + 
b
Ë
TRUE
;

898 
löe
++;

899 
ﬁd_o
 = 
o
;

900 
ﬁd_m
 = 
m
;

906 
w
->
maö_löe_èb
[
t
] = 
NULL
;

907 i‡(
löe
 == 0)

911 
size
 = 
löe
 * (
MAIN_LINE_S
);

912 
w
->
maö_löe_èb
[
t
] = (
MAIN_LINE_S
 *Ë
	`mÆloc
(
size
);

913 i‡(
w
->
maö_löe_èb
[
t
] =
NULL
)

915 
	`•rötf
(
tmp
, "(main_line_tab) :ÇotÉnough mem (%i bytes), "

916 "ty≥ %i,Üöê%i", 
size
, 
t
, 
löe
);

917 
	`ds1edô_îr‹
(
tmp
);

919 
i
=0; i<
löe
; i++)

921 
w
->
maö_löe_èb
[
t
][
i
].
sub_ñm
 = 
NULL
;

922 
w
->
maö_löe_èb
[
t
][
i
].
bt_idx_num
 = 0;

923 
w
->
maö_löe_èb
[
t
][
i
].
max_height
 = 0;

925 
w
->
maö_löe_num
[
t
] = 
löe
;

927 
b
=1;

928 
y0
=0;

931 
n
=0;Ç<
löe
;Ç++)

933  * (
is_kìp
 + 
b
Ë!
TRUE
)

934 
b
++;

935 
ﬁd_o
 = 
bt_±r
[
b
].
‹õ¡©i⁄
;

936 
ﬁd_m
 = 
bt_±r
[
b
].
maö_ödex
;

937 
ﬁd_s
 = 
bt_±r
[
b
].
sub_ödex
;

938 
cﬁ
 = 1;

939 
y
 = 
b
;

940 
d⁄e
 = 
FALSE
;

945 
y
++;

946 
o
 = 
bt_±r
[
y
].
‹õ¡©i⁄
;

947 
m
 = 
bt_±r
[
y
].
maö_ödex
;

948 
s
 = 
bt_±r
[
y
].
sub_ödex
;

949 i‡((
ﬁd_o
 =
o
Ë&& (
ﬁd_m
 =
m
))

952 
dx
 = 
bt_±r
[
y
].
dt1_idx
;

953 
bx
 = 
bt_±r
[
y
].
block_idx
;

954 
ube
 = 
bt_±r
[
y
].
u£d_by_edô‹
;

955 
tmp_bmp
 = * (
glb_dt1
[
dx
].
block_zoom
[
ZM_11
] + 
bx
);

956 i‡((
tmp_bmp
 !
NULL
Ë&& 
ube
)

958 i‡(
ﬁd_s
 !
s
)

960 
cﬁ
++;

961 
ﬁd_s
 = 
s
;

970 
d⁄e
 = 
TRUE
;

971 }  ! 
d⁄e
);

976 
m_±r
 = 
w
->
maö_löe_èb
[
t
] + 
n
;

977 
size
 = 
cﬁ
 * (
SUB_ELM_S
);

978 
m_±r
->
sub_ñm
 = (
SUB_ELM_S
 *Ë
	`mÆloc
(
size
);

979 i‡(
m_±r
->
sub_ñm
 =
NULL
)

981 
	`•rötf
(
tmp
, "(sub_line) :ÇotÉnough mem (%i bytes), "

982 "ty≥ %i,Üöê%i, cﬁ %i", 
size
, 
t
, 
n
, 
cﬁ
);

983 
	`ds1edô_îr‹
(
tmp
);

985 
i
=0; i<
cﬁ
; i++)

987 
m_±r
->
sub_ñm
[
i
].
bt_idx_èb
 = 0;

988 
m_±r
->
sub_ñm
[
i
].
x1
 = 0;

989 
m_±r
->
sub_ñm
[
i
].
y1
 = 0;

990 
m_±r
->
sub_ñm
[
i
].
x2
 = 0;

991 
m_±r
->
sub_ñm
[
i
].
y2
 = 0;

992 
m_±r
->
sub_ñm
[
i
].
is_døw
 = 
FALSE
;

994 
m_±r
->
bt_idx_num
 = 
cﬁ
;

996 
max_height
 = 0;

999 
ﬁd_o
 = 
bt_±r
[
b
].
‹õ¡©i⁄
;

1000 
ﬁd_m
 = 
bt_±r
[
b
].
maö_ödex
;

1001 
ﬁd_s
 = -1;

1002 
y
 = 
b
 - 1;

1003 
x
 = 0;

1004 
d⁄e
 = 
FALSE
;

1009 
y
++;

1010 
o
 = 
bt_±r
[
y
].
‹õ¡©i⁄
;

1011 
m
 = 
bt_±r
[
y
].
maö_ödex
;

1012 
s
 = 
bt_±r
[
y
].
sub_ödex
;

1013 i‡((
ﬁd_o
 =
o
Ë&& (
ﬁd_m
 =
m
))

1016 
dx
 = 
bt_±r
[
y
].
dt1_idx
;

1017 
bx
 = 
bt_±r
[
y
].
block_idx
;

1018 
ube
 = 
bt_±r
[
y
].
u£d_by_edô‹
;

1019 
tmp_bmp
 = * (
glb_dt1
[
dx
].
block_zoom
[
ZM_11
] + 
bx
);

1020 i‡((
tmp_bmp
 !
NULL
Ë&& 
ube
)

1022 i‡(
ﬁd_s
 !
s
)

1025 
s_±r
 = 
m_±r
->
sub_ñm
 + 
x
;

1026 
s_±r
->
bt_idx_èb
 = 
y
;

1027 
x
++;

1028 
ﬁd_s
 = 
s
;

1031 i‡(
tmp_bmp
->
h
 > 
max_height
)

1032 
max_height
 = 
tmp_bmp
->
h
;

1041 
d⁄e
 = 
TRUE
;

1042 }  ! 
d⁄e
);

1045 
ﬁd_o
 = 
bt_±r
[
b
].
‹õ¡©i⁄
;

1046 
ﬁd_m
 = 
bt_±r
[
b
].
maö_ödex
;

1047 
ﬁd_s
 = -1;

1048 
y
 = 
b
 - 1;

1049 
x
 = 0;

1050 
d⁄e
 = 
FALSE
;

1055 
y
++;

1056 
o
 = 
bt_±r
[
y
].
‹õ¡©i⁄
;

1057 
m
 = 
bt_±r
[
y
].
maö_ödex
;

1058 
s
 = 
bt_±r
[
y
].
sub_ödex
;

1059 i‡((
ﬁd_o
 =
o
Ë&& (
ﬁd_m
 =
m
))

1062 
dx
 = 
bt_±r
[
y
].
dt1_idx
;

1063 
bx
 = 
bt_±r
[
y
].
block_idx
;

1064 
ube
 = 
bt_±r
[
y
].
u£d_by_edô‹
;

1065 
tmp_bmp
 = * (
glb_dt1
[
dx
].
block_zoom
[
ZM_11
] + 
bx
);

1066 i‡((
tmp_bmp
 !
NULL
Ë&& 
ube
)

1068 i‡(
ﬁd_s
 !
s
)

1071 
s_±r
 = 
m_±r
->
sub_ñm
 + 
x
;

1072 
s_±r
->
x1
 = 161 * 
x
;

1073 
s_±r
->
x2
 = s_±r->
x1
 + 159;

1074 
s_±r
->
y1
 = 
y0
;

1075 
s_±r
->
y2
 = s_±r->
y1
 + 
max_height
 + 12;

1076 
x
++;

1077 
ﬁd_s
 = 
s
;

1086 
d⁄e
 = 
TRUE
;

1087 }  ! 
d⁄e
);

1090 
m_±r
->
max_height
 = max_height;

1091 
y0
 +
max_height
 + 12;

1094 
b
++;

1097 
	`‰ì
(
is_kìp
);

1098 
	}
}

1103 
	$wedô_£¨ch_tûe
(
ds1_idx
, 
x
, 
y
, 
BUT_TYP_E
 
but
)

1105 
CELL_F_S
 * 
f_±r
;

1106 
CELL_S_S
 * 
s_±r
;

1107 
CELL_W_S
 * 
w_±r
;

1108 
t
, 
n
;

1110 i‡((
but
 =
BU_FLOOR1
Ë|| (buà=
BU_FLOOR2
))

1112 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

1113 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
t
;

1115 i‡((
but
 =
BU_FLOOR1
Ë&& (
glb_ds1
[
ds1_idx
].
Êo‹_num
 >= 1))

1116 
n
 = 0;

1117 i‡((
but
 =
BU_FLOOR2
Ë&& (
glb_ds1
[
ds1_idx
].
Êo‹_num
 >= 2))

1118 
n
 = 1;

1122  
f_±r
[
n
].
bt_idx
;

1124 i‡(
but
 =
BU_SHADOW
)

1126 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

1127 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
t
;

1129 i‡((
but
 =
BU_SHADOW
Ë&& (
glb_ds1
[
ds1_idx
].
shadow_num
 >= 1))

1130 
n
 = 0;

1134  
s_±r
[
n
].
bt_idx
;

1136 i‡((
but
 =
BU_WALL1
Ë|| (buà=
BU_WALL2
) ||

1137 (
but
 =
BU_WALL3
Ë|| (buà=
BU_WALL4
))

1139 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

1140 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
t
;

1141 i‡((
but
 =
BU_WALL1
Ë&& (
glb_ds1
[
ds1_idx
].
wÆl_num
 >= 1))

1142 
n
 = 0;

1143 i‡((
but
 =
BU_WALL2
Ë&& (
glb_ds1
[
ds1_idx
].
wÆl_num
 >= 2))

1144 
n
 = 1;

1145 i‡((
but
 =
BU_WALL3
Ë&& (
glb_ds1
[
ds1_idx
].
wÆl_num
 >= 3))

1146 
n
 = 2;

1147 i‡((
but
 =
BU_WALL4
Ë&& (
glb_ds1
[
ds1_idx
].
wÆl_num
 >= 4))

1148 
n
 = 3;

1152  
w_±r
[
n
].
bt_idx
;

1155 
	}
}

1212 
	$wedô_èb_tûes
(
ds1_idx
, 
BLK_TYP_E
 
t
, 
x0
, 
y0
, 
bt_£l
,

1213 
m_idx
, 
s_idx
)

1215 
WIN_EDIT_S
 * 
w
 = & 
glb_ds1edô
.
wö_edô
;

1216 
WIN_ELEMENT_S
 * 
wt
 = & 
w
->
w_tûes
;

1217 
MAIN_LINE_S
 * 
m_±r
;

1218 
SUB_ELM_S
 * 
s_±r
;

1219 
BLOCK_TABLE_S
 * 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
;

1220 
BITMAP
 * 
tmp_bmp
;

1221 
m
, 
i
, 
bt
, 
dx
, 
bx
, 
x1
, 
y1
, 
x2
, 
y2
, 
c
, 
Àn
, 
dt1_idx
;

1222 * 
dt1«me
;

1228 
	`blô
(
wt
->
öside
, 
w
->
tmp_edô
, 0, 0, 0, 0, wt->öside->w, wt->öside->
h
);

1231 
	`ãxt_mode
(-1);

1232 
m
=0; m < 
w
->
maö_löe_num
[
t
]; m++)

1234 
m_±r
 = 
w
->
maö_löe_èb
[
t
] + 
m
;

1237 
s_±r
 = 
m_±r
->
sub_ñm
;

1238 
x1
 = 
s_±r
->x1 - 
x0
;

1239 
y1
 = 
s_±r
->y1 - 
y0
 + (
m_±r
->
max_height
 / 2);

1240 i‡((
y1
 >-8Ë&& (y1 < 
w
->
tmp_edô
->
h
Ë&& (
x1
 > 0))

1242 
dt1_idx
 = 
bt_±r
[
s_±r
->
bt_idx_èb
].dt1_idx;

1243 i‡(
dt1_idx
 != -1)

1245 
dt1«me
 = 
glb_dt1
[
dt1_idx
].
«me
;

1246 
Àn
 = 
	`°æí
(
dt1«me
) + 2;

1247 
x1
 -8 * 
Àn
;

1248 
	`ãxçrötf
(
w
->
tmp_edô
, 
f⁄t
, 
x1
+1, 
y1
+1, 0, "%s", 
dt1«me
);

1249 
	`ãxçrötf
(
w
->
tmp_edô
, 
f⁄t
, 
x1
, 
y1
, 255, "%s", 
dt1«me
);

1254 
i
=0; i < 
m_±r
->
bt_idx_num
; i++)

1256 
s_±r
 = 
m_±r
->
sub_ñm
 + 
i
;

1257 
x1
 = 
s_±r
->x1 - 
x0
;

1258 
x2
 = 
s_±r
->x2 - 
x0
;

1259 i‡((
x1
 > -160Ë&& (x1 < 
w
->
tmp_edô
->w))

1261 
bt
 = 
s_±r
->
bt_idx_èb
;

1262 
dx
 = 
bt_±r
[
bt
].
dt1_idx
;

1263 
bx
 = 
bt_±r
[
bt
].
block_idx
;

1264 
tmp_bmp
 = * (
glb_dt1
[
dx
].
block_zoom
[
ZM_11
] + 
bx
);

1265 i‡(
tmp_bmp
 !
NULL
)

1267 
y1
 = 
s_±r
->y1 - 
y0
;

1268 
y2
 = 
y1
 + 
tmp_bmp
->
h
 - 1;

1269 i‡(((
y1
 + 
m_±r
->
max_height
 - 1Ë< 0Ë|| (y1 >
w
->
tmp_edô
->
h
))

1272 
s_±r
->
is_døw
 = 
FALSE
;

1276 
s_±r
->
is_døw
 = 
TRUE
;

1277 
	`ª˘
(
w
->
tmp_edô
, 
x1
-1, 
y1
-1, 
x2
+1, y1+
m_±r
->
max_height
+1+10, 255);

1278 
c
 = 22;

1279 i‡(
bt_£l
 =
bt
)

1280 
c
 = 119;

1281 i‡((
m
 =
m_idx
Ë&& (
i
 =
s_idx
))

1282 
c
 = 255;

1283 i‡(
t
 =
BT_WALL_DOWN
)

1285 
	`ª˘fûl
(
w
->
tmp_edô
, 
x1
, 
y1
, 
x2
, 
y2
+9, 
c
);

1286 
	`døw_•rôe
(
w
->
tmp_edô
, 
tmp_bmp
, 
x1
, 
y1
);

1290 
	`ª˘fûl
(
w
->
tmp_edô
,

1291 
x1
, 
y1
 + 
m_±r
->
max_height
 - 
tmp_bmp
->
h
,

1292 
x2
, 
y1
 + 
m_±r
->
max_height
 + 10, 
c
);

1293 
	`døw_•rôe
(
w
->
tmp_edô
, 
tmp_bmp
, 
x1
,

1294 
y1
 + 
m_±r
->
max_height
 - 
tmp_bmp
->
h
);

1296 i‡(
t
 =
BT_WALL_DOWN
)

1298 
	`ãxçrötf
(
w
->
tmp_edô
, 
f⁄t
, 
x1
 + 2, 
y1
 + 2, 96, "%2i", 
bt_±r
[
bt
].
maö_ödex
);

1299 
	`ãxçrötf
(
w
->
tmp_edô
, 
f⁄t
, 
x1
 + 26, 
y1
 + 2, 96, "%2i", 
bt_±r
[
bt
].
‹õ¡©i⁄
);

1300 
	`ãxçrötf
(
w
->
tmp_edô
, 
f⁄t
, 
x1
 + 82, 
y1
 + 2, 158, "%2i", 
bt_±r
[
bt
].
sub_ödex
);

1301 
	`ãxçrötf
(
w
->
tmp_edô
, 
f⁄t
, 
x1
 + 138, 
y1
 + 2, 134, "%2i", 
bt_±r
[
bt
].
ørôy
);

1305 
	`ãxçrötf
(
w
->
tmp_edô
, 
f⁄t
, 
x1
 + 2, 
y1
 + 
m_±r
->
max_height
 + 2, 96, "%2i", 
bt_±r
[
bt
].
maö_ödex
);

1306 
	`ãxçrötf
(
w
->
tmp_edô
, 
f⁄t
, 
x1
 + 26, 
y1
 + 
m_±r
->
max_height
 + 2, 96, "%2i", 
bt_±r
[
bt
].
‹õ¡©i⁄
);

1307 
	`ãxçrötf
(
w
->
tmp_edô
, 
f⁄t
, 
x1
 + 82, 
y1
 + 
m_±r
->
max_height
 + 2, 158, "%2i", 
bt_±r
[
bt
].
sub_ödex
);

1308 
	`ãxçrötf
(
w
->
tmp_edô
, 
f⁄t
, 
x1
 + 138, 
y1
 + 
m_±r
->
max_height
 + 2, 134, "%2i", 
bt_±r
[
bt
].
ørôy
);

1315 
s_±r
->
is_døw
 = 
FALSE
;

1320 
	}
}

1325 
	$wedô_jump
(
ds1_idx
, 
bt_idx
, * 
xn
, * 
yn
)

1327 
WIN_EDIT_S
 * 
w
 = & 
glb_ds1edô
.
wö_edô
;

1328 
WIN_ELEMENT_S
 * 
wt
 = & 
w
->
w_tûes
;

1329 
MAIN_LINE_S
 * 
m_±r
;

1330 
SUB_ELM_S
 * 
s_±r
;

1331 
BLOCK_TABLE_S
 * 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
;

1332 
m
, 
s
;

1333 
BLK_TYP_E
 
t
;

1335 * 
xn
 = 0;

1336 * 
yn
 = 0;

1337 i‡(
bt_idx
 <= 0)

1340 
t
 = 
bt_±r
[
bt_idx
].
ty≥
;

1341 
m
=0; m < 
w
->
maö_löe_num
[
t
]; m++)

1343 
m_±r
 = 
w
->
maö_löe_èb
[
t
] + 
m
;

1344 
s
=0; s<
m_±r
->
bt_idx_num
; s++)

1346 
s_±r
 = 
m_±r
->
sub_ñm
 + 
s
;

1347 i‡(
s_±r
->
bt_idx_èb
 =
bt_idx
)

1349 * 
xn
 = 
s_±r
->
x1
 - 
glb_c⁄fig
.
s¸ﬁl
.
edô
.
x
;

1350 i‡(
t
 =
BT_WALL_DOWN
)

1351 * 
yn
 = 
s_±r
->
y1
 - 
glb_c⁄fig
.
s¸ﬁl
.
edô
.
y
;

1353 * 
yn
 = 
s_±r
->
y2
 + 
glb_c⁄fig
.
s¸ﬁl
.
edô
.
y
 - 
wt
->
öside
->
h
;

1359 
	}
}

1364 
	$wedô_mou£_tûe
(
mx
, 
my
, 
x0
, 
y0
, 
t
, * 
m_idx
, * 
s_idx
)

1366 
WIN_EDIT_S
 * 
w
 = & 
glb_ds1edô
.
wö_edô
;

1367 
WIN_ELEMENT_S
 * 
wt
 = & 
w
->
w_tûes
;

1368 
MAIN_LINE_S
 * 
m_±r
;

1369 
SUB_ELM_S
 * 
s_±r
;

1370 
m
, 
i
, 
x
, 
y
;

1373 
x
 = 
mx
 - 
wt
->
i_x0
;

1374 
y
 = 
my
 - 
wt
->
i_y0
;

1375 i‡((
x
 >0Ë&& (x < 
wt
->
öside
->
w
Ë&& (
y
 >0Ë&& (y < wt->öside->
h
))

1378 
x
 +
x0
;

1379 
y
 +
y0
;

1380 
m
=0; m < 
w
->
maö_löe_num
[
t
]; m++)

1382 
m_±r
 = 
w
->
maö_löe_èb
[
t
] + 
m
;

1383 
i
=0; i < 
m_±r
->
bt_idx_num
; i++)

1385 
s_±r
 = 
m_±r
->
sub_ñm
 + 
i
;

1386 i‡(
s_±r
->
is_døw
)

1388 i‡((
x
 >
s_±r
->
x1
Ë&& (x <s_±r->
x2
) &&

1389 (
y
 >
s_±r
->
y1
Ë&& (y <s_±r->
y2
))

1391 * 
m_idx
 = 
m
;

1392 * 
s_idx
 = 
i
;

1400 * 
m_idx
 = * 
s_idx
 = -1;

1401 
	}
}

1406 
	$wedô_upd©e_tûe
(
ds1_idx
, 
x
, 
y
, 
BUT_TYP_E
 
buâ⁄
,

1407 
BLK_TYP_E
 
ty≥
, 
m_idx
, 
s_idx
)

1409 
BLOCK_TABLE_S
 * 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
;

1410 
WIN_EDIT_S
 * 
e_±r
 = & 
glb_ds1edô
.
wö_edô
;

1411 
MAIN_LINE_S
 * 
m_±r
;

1412 
SUB_ELM_S
 * 
s_±r
;

1413 
CELL_W_S
 * 
w_±r
;

1414 
CELL_F_S
 * 
f_±r
;

1415 
CELL_S_S
 * 
sh_±r
;

1416 
f
 = -1, 
s
 = -1, 
w
 = -1, 
t
, 
bt
;

1418 
buâ⁄
)

1420 
BU_FLOOR1
 : i‡(
glb_ds1
[
ds1_idx
].
Êo‹_num
 >1Ë
f
 = 0; ;

1421 
BU_FLOOR2
 : i‡(
glb_ds1
[
ds1_idx
].
Êo‹_num
 >2Ë
f
 = 1; ;

1422 
BU_SHADOW
 : i‡(
glb_ds1
[
ds1_idx
].
shadow_num
 >1Ë
s
 = 0; ;

1423 
BU_WALL1
 : i‡(
glb_ds1
[
ds1_idx
].
wÆl_num
 >1Ë
w
 = 0; ;

1424 
BU_WALL2
 : i‡(
glb_ds1
[
ds1_idx
].
wÆl_num
 >2Ë
w
 = 1; ;

1425 
BU_WALL3
 : i‡(
glb_ds1
[
ds1_idx
].
wÆl_num
 >3Ë
w
 = 2; ;

1426 
BU_WALL4
 : i‡(
glb_ds1
[
ds1_idx
].
wÆl_num
 >4Ë
w
 = 3; ;

1428 i‡((
f
 =-1Ë&& (
w
 =-1Ë&& (
s
 == -1))

1430 
m_±r
 = 
e_±r
->
maö_löe_èb
[
ty≥
] + 
m_idx
;

1431 
s_±r
 = 
m_±r
->
sub_ñm
 + 
s_idx
;

1432 
bt
 = 
s_±r
->
bt_idx_èb
;

1433 i‡(
f
 != -1)

1435 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

1436 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
t
 + 
f
;

1437 i‡(
f_±r
->
¥›1
 == 0)

1438 
f_±r
->
¥›1
 = 194;

1439 
f_±r
->
¥›2
 = 
bt_±r
[
bt
].
sub_ödex
;

1440 
f_±r
->
¥›3
 = (
bt_±r
[
bt
].
maö_ödex
 & 0x0F) << 4;

1441 
f_±r
->
¥›4
 = (
bt_±r
[
bt
].
maö_ödex
 & 0x30) >> 4;

1442 
f_±r
->
bt_idx
 = 
bt
;

1444 i‡(
s
 != -1)

1446 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

1447 
sh_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
t
 + 
s
;

1448 i‡(
sh_±r
->
¥›1
 == 0)

1449 
sh_±r
->
¥›1
 = 128;

1450 
sh_±r
->
¥›2
 = 
bt_±r
[
bt
].
sub_ödex
;

1451 
sh_±r
->
¥›3
 = (
bt_±r
[
bt
].
maö_ödex
 & 0x0F) << 4;

1452 
sh_±r
->
¥›4
 = ((
bt_±r
[
bt
].
maö_ödex
 & 0x30) >> 4) | 0x08;

1453 
sh_±r
->
bt_idx
 = 
bt
;

1455 i‡(
w
 != -1)

1457 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

1458 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
t
 + 
w
;

1459 
w_±r
->
‹õ¡©i⁄
 = 
bt_±r
[
bt
].orientation;

1460 i‡(
w_±r
->
¥›1
 == 0)

1461 
w_±r
->
¥›1
 = 129;

1462 
w_±r
->
¥›2
 = 
bt_±r
[
bt
].
sub_ödex
;

1463 
w_±r
->
¥›3
 = (
bt_±r
[
bt
].
maö_ödex
 & 0x0F) << 4;

1464 
w_±r
->
¥›4
 = (
bt_±r
[
bt
].
maö_ödex
 & 0x30) >> 4;

1465 
w_±r
->
bt_idx
 = 
bt
;

1467 
	}
}

1472 
	$wedô_ßve_tûe
(
ds1_idx
, 
x
, 
y
,

1473 
CELL_F_S
 * 
d°_f_±r
, 
CELL_W_S
 * 
d°_w_±r
,

1474 
CELL_S_S
 * 
d°_s_±r
)

1476 
CELL_W_S
 * 
w_±r
;

1477 
CELL_F_S
 * 
f_±r
;

1478 
CELL_S_S
 * 
s_±r
;

1479 
i
, 
t
;

1483 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

1484 
i
=0; i<
glb_ds1
[
ds1_idx
].
Êo‹_num
; i++)

1486 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
t
 + 
i
;

1487 
d°_f_±r
[
i
].
¥›1
 = 
f_±r
->prop1;

1488 
d°_f_±r
[
i
].
¥›2
 = 
f_±r
->prop2;

1489 
d°_f_±r
[
i
].
¥›3
 = 
f_±r
->prop3;

1490 
d°_f_±r
[
i
].
¥›4
 = 
f_±r
->prop4;

1491 
d°_f_±r
[
i
].
bt_idx
 = 
f_±r
->bt_idx;

1492 
d°_f_±r
[
i
].
Êags
 = 
f_±r
->flags;

1496 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

1497 
i
=0; i<
glb_ds1
[
ds1_idx
].
shadow_num
; i++)

1499 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
t
 + 
i
;

1500 
d°_s_±r
[
i
].
¥›1
 = 
s_±r
->prop1;

1501 
d°_s_±r
[
i
].
¥›2
 = 
s_±r
->prop2;

1502 
d°_s_±r
[
i
].
¥›3
 = 
s_±r
->prop3;

1503 
d°_s_±r
[
i
].
¥›4
 = 
s_±r
->prop4;

1504 
d°_s_±r
[
i
].
bt_idx
 = 
s_±r
->bt_idx;

1505 
d°_s_±r
[
i
].
Êags
 = 
s_±r
->flags;

1509 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

1510 
i
=0; i<
glb_ds1
[
ds1_idx
].
wÆl_num
; i++)

1512 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
t
 + 
i
;

1513 
d°_w_±r
[
i
].
¥›1
 = 
w_±r
->prop1;

1514 
d°_w_±r
[
i
].
¥›2
 = 
w_±r
->prop2;

1515 
d°_w_±r
[
i
].
¥›3
 = 
w_±r
->prop3;

1516 
d°_w_±r
[
i
].
¥›4
 = 
w_±r
->prop4;

1517 
d°_w_±r
[
i
].
‹õ¡©i⁄
 = 
w_±r
->orientation;

1518 
d°_w_±r
[
i
].
bt_idx
 = 
w_±r
->bt_idx;

1519 
d°_w_±r
[
i
].
Êags
 = 
w_±r
->flags;

1521 
	}
}

1526 
	$wedô_ˇn˚l_tûe
(
ds1_idx
, 
x
, 
y
,

1527 
CELL_F_S
 * 
§c_f_±r
, 
CELL_W_S
 * 
§c_w_±r
,

1528 
CELL_S_S
 * 
§c_s_±r
)

1530 
CELL_W_S
 * 
w_±r
;

1531 
CELL_F_S
 * 
f_±r
;

1532 
CELL_S_S
 * 
s_±r
;

1533 
i
, 
t
;

1537 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

1538 
i
=0; i<
glb_ds1
[
ds1_idx
].
Êo‹_num
; i++)

1540 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
t
;

1541 
f_±r
[
i
].
¥›1
 = 
§c_f_±r
[i].prop1;

1542 
f_±r
[
i
].
¥›2
 = 
§c_f_±r
[i].prop2;

1543 
f_±r
[
i
].
¥›3
 = 
§c_f_±r
[i].prop3;

1544 
f_±r
[
i
].
¥›4
 = 
§c_f_±r
[i].prop4;

1545 
f_±r
[
i
].
bt_idx
 = 
§c_f_±r
[i].bt_idx;

1546 
f_±r
[
i
].
Êags
 = 
§c_f_±r
[i].flags;

1550 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

1551 
i
=0; i<
glb_ds1
[
ds1_idx
].
shadow_num
; i++)

1553 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
t
;

1554 
s_±r
[
i
].
¥›1
 = 
§c_s_±r
[i].prop1;

1555 
s_±r
[
i
].
¥›2
 = 
§c_s_±r
[i].prop2;

1556 
s_±r
[
i
].
¥›3
 = 
§c_s_±r
[i].prop3;

1557 
s_±r
[
i
].
¥›4
 = 
§c_s_±r
[i].prop4;

1558 
s_±r
[
i
].
bt_idx
 = 
§c_s_±r
[i].bt_idx;

1559 
s_±r
[
i
].
Êags
 = 
§c_s_±r
[i].flags;

1563 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

1564 
i
=0; i<
glb_ds1
[
ds1_idx
].
wÆl_num
; i++)

1566 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
t
;

1567 
w_±r
[
i
].
¥›1
 = 
§c_w_±r
[i].prop1;

1568 
w_±r
[
i
].
¥›2
 = 
§c_w_±r
[i].prop2;

1569 
w_±r
[
i
].
¥›3
 = 
§c_w_±r
[i].prop3;

1570 
w_±r
[
i
].
¥›4
 = 
§c_w_±r
[i].prop4;

1571 
w_±r
[
i
].
‹õ¡©i⁄
 = 
§c_w_±r
[i].orientation;

1572 
w_±r
[
i
].
bt_idx
 = 
§c_w_±r
[i].bt_idx;

1573 
w_±r
[
i
].
Êags
 = 
§c_w_±r
[i].flags;

1575 
	}
}

1580 
	$wedô_kìp_tûe
(
ds1_idx
, 
x
, 
y
,

1581 
CELL_F_S
 * 
§c_f_±r
, 
CELL_W_S
 * 
§c_w_±r
,

1582 
CELL_S_S
 * 
§c_s_±r
)

1584 
UNDO_S
 * 
u
 = & 
glb_ds1
[
ds1_idx
].
undo
;

1585 
n
;

1587 
	`undo_√w_tûe_buf„r
(
ds1_idx
);

1589 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
Êo‹_num
;Ç++)

1590 
u
->
d©_Êg
.
f
[
n
] = 
DF_P1
 | 
DF_P2
 | 
DF_P3
 | 
DF_P4
;

1592 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
shadow_num
;Ç++)

1593 
u
->
d©_Êg
.
s
[
n
] = 
DF_P1
 | 
DF_P2
 | 
DF_P3
 | 
DF_P4
;

1595 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

1596 
u
->
d©_Êg
.
w
[
n
] = 
DF_P1
 | 
DF_P2
 | 
DF_P3
 | 
DF_P4
 | 
DF_OR
;

1598 
	`undo_add_this_tûe_to_buf„r
(
ds1_idx
, 
x
, 
y
, 
§c_f_±r
, 
§c_w_±r
, 
§c_s_±r
);

1599 
	`undo_˛o£_tûe_buf„r
(
ds1_idx
);

1600 
	}
}

1606 
	$wedô_ã°
(
ds1_idx
, 
tx
, 
ty
)

1608 
WIN_ELEMENT_S
 * 
w_ñm
;

1609 
WIN_EDIT_S
 * 
w
 = & 
glb_ds1edô
.
wö_edô
;

1610 
DS1_S
 * 
d
 = & 
glb_ds1
[
ds1_idx
];

1611 
BUTTON_S
 * 
b
;

1612 
BLOCK_TABLE_S
 * 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
;

1613 
i
, 
n
, 
d⁄e
=
FALSE
, 
mx
, 
my
, 
mb
;

1614 
focus
=0, 
focus_ˇn_ch™ge
=
TRUE
, 
bt_£l
;

1615 
my_b‹dî
 = 1, 
xn
=0, 
yn
=0, 
ﬁd_xn
=0, 
ﬁd_yn
=0;

1616 
BUT_TYP_E
 
cuºít_buâ⁄
 = 
BU_NULL
;

1617 
BLK_TYP_E
 
cuºít_ty≥
 = 
BT_NULL
;

1618 
m_idx
, 
s_idx
;

1619 
CELL_W_S
 
ßve_wÆl
 [
WALL_MAX_LAYER
];

1620 
CELL_F_S
 
ßve_Êo‹
 [
FLOOR_MAX_LAYER
];

1621 
CELL_S_S
 
ßve_shadow
 [
SHADOW_MAX_LAYER
];

1622 
tmp
[80];

1625 
	`wedô_ßve_tûe
(
ds1_idx
, 
tx
, 
ty
, 
ßve_Êo‹
, 
ßve_wÆl
, 
ßve_shadow
);

1626 
	`wedô_tûes_make
(
ds1_idx
);

1627 
	`posôi⁄_mou£
(200, 70);

1629 
w
->
buâ⁄
[
BU_WALL1
].
a˘ive
 = 0 < 
d
->
wÆl_num
 ? 
TRUE
 : 
FALSE
;

1630 
w
->
buâ⁄
[
BU_WALL2
].
a˘ive
 = 1 < 
d
->
wÆl_num
 ? 
TRUE
 : 
FALSE
;

1631 
w
->
buâ⁄
[
BU_WALL3
].
a˘ive
 = 2 < 
d
->
wÆl_num
 ? 
TRUE
 : 
FALSE
;

1632 
w
->
buâ⁄
[
BU_WALL4
].
a˘ive
 = 3 < 
d
->
wÆl_num
 ? 
TRUE
 : 
FALSE
;

1634 
w
->
buâ⁄
[
BU_FLOOR1
].
a˘ive
 = 0 < 
d
->
Êo‹_num
 ? 
TRUE
 : 
FALSE
;

1635 
w
->
buâ⁄
[
BU_FLOOR2
].
a˘ive
 = 1 < 
d
->
Êo‹_num
 ? 
TRUE
 : 
FALSE
;

1637 
w
->
buâ⁄
[
BU_OK
].
a˘ive
 = 
TRUE
;

1638 
w
->
buâ⁄
[
BU_CANCEL
].
a˘ive
 = 
TRUE
;

1640 
w
->
buâ⁄
[
BU_VIEW_RAND
].
a˘ive
 = 
FALSE
;

1643 
i
=
BU_NULL
 + 1; i<
BU_MAX
; i++)

1645 i‡(
w
->
buâ⁄
[
i
].
a˘ive
)

1647 
w
->
buâ⁄
[
i
].
mou£_ovî
 = 
FALSE
;

1648 
w
->
buâ⁄
[
i
].
°©e
 = 
BS_OFF
;

1652 i‡(
w
->
buâ⁄
[
BU_WALL1
].
a˘ive
 =
TRUE
)

1653 
cuºít_buâ⁄
 = 
BU_WALL1
;

1654 i‡(
w
->
buâ⁄
[
BU_FLOOR1
].
a˘ive
 =
TRUE
)

1655 
cuºít_buâ⁄
 = 
BU_FLOOR1
;

1658 
bt_£l
 = 
	`wedô_£¨ch_tûe
(
ds1_idx
, 
tx
, 
ty
, 
cuºít_buâ⁄
);

1659 
	`wedô_jump
(
ds1_idx
, 
bt_£l
, & 
xn
, & 
yn
);

1661 
w_ñm
 = & 
glb_ds1edô
.
wö_edô
.
w_tûes
;

1663 
b
 = & 
w
->
èb
[
BT_STATIC
];

1664 
b
->
x0
 = 
w_ñm
->
i_x0
;

1665 
b
->
y0
 = 88;

1666 
b
->
a˘ive
 = 
FALSE
;

1667 
b
->
°©e
 = 
BS_OFF
;

1668 
b
->
èb_have_tûes
 = 
	`wedô_èb_have
(
ds1_idx
, 
BT_STATIC
);

1670 
b
 = & 
w
->
èb
[
BT_ANIMATED
];

1671 
b
->
x0
 = 
w
->
èb
[
BT_STATIC
].x0 + w->èb[BT_STATIC].w + 
my_b‹dî
;

1672 
b
->
y0
 = 88;

1673 
b
->
a˘ive
 = 
FALSE
;

1674 
b
->
°©e
 = 
BS_OFF
;

1675 
b
->
èb_have_tûes
 = 
	`wedô_èb_have
(
ds1_idx
, 
BT_ANIMATED
);

1677 
b
 = & 
w
->
èb
[
BT_SHADOW
];

1678 
b
->
x0
 = 
w_ñm
->
i_x0
;

1679 
b
->
y0
 = 88;

1680 
b
->
a˘ive
 = 
FALSE
;

1681 
b
->
°©e
 = 
BS_OFF
;

1682 
b
->
èb_have_tûes
 = 
	`wedô_èb_have
(
ds1_idx
, 
BT_SHADOW
);

1683 i‡(
b
->
èb_have_tûes
)

1684 
w
->
buâ⁄
[
BU_SHADOW
].
a˘ive
 = 
TRUE
;

1686 
w
->
buâ⁄
[
BU_SHADOW
].
a˘ive
 = 
FALSE
;

1688 
b
 = & 
w
->
èb
[
BT_WALL_UP
];

1689 
b
->
x0
 = 
w_ñm
->
i_x0
;

1690 
b
->
y0
 = 88;

1691 
b
->
°©e
 = 
BS_OFF
;

1692 
b
->
èb_have_tûes
 = b->
a˘ive
 = 
	`wedô_èb_have
(
ds1_idx
, 
BT_WALL_UP
);

1694 
b
 = & 
w
->
èb
[
BT_WALL_DOWN
];

1695 
b
->
x0
 = 
w
->
èb
[
BT_WALL_UP
].x0 + w->èb[BT_WALL_UP].w + 
my_b‹dî
;

1696 
b
->
y0
 = 88;

1697 
b
->
°©e
 = 
BS_OFF
;

1698 
b
->
èb_have_tûes
 = b->
a˘ive
 = 
	`wedô_èb_have
(
ds1_idx
, 
BT_WALL_DOWN
);

1700 
b
 = & 
w
->
èb
[
BT_ROOF
];

1701 
b
->
x0
 = 
w
->
èb
[
BT_WALL_DOWN
].x0 + w->èb[BT_WALL_DOWN].w + 
my_b‹dî
;

1702 
b
->
y0
 = 88;

1703 
b
->
°©e
 = 
BS_OFF
;

1704 
b
->
èb_have_tûes
 = b->
a˘ive
 = 
	`wedô_èb_have
(
ds1_idx
, 
BT_ROOF
);

1706 
b
 = & 
w
->
èb
[
BT_SPECIAL
];

1707 
b
->
x0
 = 
w
->
èb
[
BT_ROOF
].x0 + w->èb[BT_ROOF].w + 
my_b‹dî
;

1708 
b
->
y0
 = 88;

1709 
b
->
°©e
 = 
BS_OFF
;

1710 
b
->
èb_have_tûes
 = b->
a˘ive
 = 
	`wedô_èb_have
(
ds1_idx
, 
BT_SPECIAL
);

1712 
	`£t_cﬁ‹_dïth
(8);

1714 
w
->
tmp_edô
 = 
	`¸óã_bôm≠
(w->
w_tûes
.
öside
->w, w->w_tûes.öside->
h
);

1716 
	`£t_cﬁ‹_dïth
(
glb_c⁄fig
.
s¸ìn
.
dïth
);

1718 i‡(
bt_£l
 >= 1)

1720 
cuºít_ty≥
 = 
bt_±r
[
bt_£l
].
ty≥
;

1721 
w
->
èb
[
cuºít_ty≥
].
°©e
 = 
BS_ON
;

1725 i‡(
w
->
èb
[
BT_WALL_UP
].
a˘ive
)

1727 
w
->
èb
[
BT_WALL_UP
].
°©e
 = 
BS_ON
;

1728 
cuºít_ty≥
 = 
BT_WALL_UP
;

1730 i‡(
w
->
èb
[
BT_WALL_DOWN
].
a˘ive
)

1732 
w
->
èb
[
BT_WALL_DOWN
].
°©e
 = 
BS_ON
;

1733 
cuºít_ty≥
 = 
BT_WALL_DOWN
;

1735 i‡(
w
->
èb
[
BT_ROOF
].
a˘ive
)

1737 
w
->
èb
[
BT_ROOF
].
°©e
 = 
BS_ON
;

1738 
cuºít_ty≥
 = 
BT_ROOF
;

1740 i‡(
w
->
èb
[
BT_SPECIAL
].
a˘ive
)

1742 
w
->
èb
[
BT_SPECIAL
].
°©e
 = 
BS_ON
;

1743 
cuºít_ty≥
 = 
BT_SPECIAL
;

1747 
	`wedô_èb_tûes
(
ds1_idx
, 
cuºít_ty≥
, 
xn
, 
yn
, 
bt_£l
, -1, -1);

1750  ! 
d⁄e
)

1752 
mx
 = 
mou£_x
;

1753 
my
 = 
mou£_y
;

1754 
mb
 = 
mou£_b
;

1758 
	`˛ór_to_cﬁ‹
(
glb_ds1edô
.
s¸ìn_buff
, 27);

1759 
i
 = 
BU_NULL
+1; i<
BU_MAX
; i++)

1760 
	`wedô_døw_buâ⁄
(
i
);

1762 i‡(
cuºít_buâ⁄
 !
BU_NULL
)

1764 
b
 = & 
glb_ds1edô
.
wö_edô
.
buâ⁄
[
cuºít_buâ⁄
];

1765 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
,

1766 
b
->
x0
-2, b->
y0
-2, b->x0+b->
w
+1, b->y0+b->
h
+1, 133);

1769 
w_ñm
 = & 
glb_ds1edô
.
wö_edô
.
w_¥evõw
;

1770 
	`døw_æe_•rôe
(
glb_ds1edô
.
s¸ìn_buff
, 
w_ñm
->
b‹dî
, w_ñm->
b_x0
, w_ñm->
b_y0
);

1771 
	`blô
(
w_ñm
->
öside
, 
glb_ds1edô
.
s¸ìn_buff
, 0, 0, w_ñm->
i_x0
, w_ñm->
i_y0
, w_ñm->öside->
w
, w_ñm->öside->
h
);

1773 
w_ñm
 = & 
glb_ds1edô
.
wö_edô
.
w_tûes
;

1774 
	`døw_æe_•rôe
(
glb_ds1edô
.
s¸ìn_buff
, 
w_ñm
->
b‹dî
, w_ñm->
b_x0
, w_ñm->
b_y0
);

1776 
	`wedô_døw_w
 (
ds1_idx
, 
tx
, 
ty
, 
FALSE
);

1777 
	`wedô_døw_f
 (
ds1_idx
, 
tx
, 
ty
);

1778 
	`wedô_døw_s
 (
ds1_idx
, 
tx
, 
ty
);

1779 
	`wedô_døw_w
 (
ds1_idx
, 
tx
, 
ty
, 
TRUE
);

1780 
	`wedô_døw_r
 (
ds1_idx
, 
tx
, 
ty
);

1781 
	`wedô_døw_•
(
ds1_idx
, 
tx
, 
ty
);

1783 
i
=
BT_NULL
 + 1; i<
BT_MAX
; i++)

1785 
b
 = & 
w
->
èb
[
i
];

1786 i‡(
b
->
a˘ive
)

1787 
	`wedô_døw_èb
(
i
);

1790 
	`blô
(
w
->
tmp_edô
, 
glb_ds1edô
.
s¸ìn_buff
, 0, 0,

1791 
w_ñm
->
i_x0
, w_ñm->
i_y0
, 
w
->
tmp_edô
->w, w->tmp_edô->
h
);

1793 
	`misc_døw_s¸ìn
(
mx
, 
my
);

1796 
	`wedô_mou£_tûe
(
mx
, 
my
, 
xn
, 
yn
, 
cuºít_ty≥
, & 
m_idx
, & 
s_idx
);

1799 i‡(
key
[
KEY_UP
] || 
my
 =0Ë
yn
 -
glb_c⁄fig
.
s¸ﬁl
.
edô
.
y
;

1800 i‡(
key
[
KEY_DOWN
] || 
my
 =
glb_c⁄fig
.
s¸ìn
.
height
 - 1Ë
yn
 +glb_c⁄fig.
s¸ﬁl
.
edô
.
y
;

1801 i‡(
key
[
KEY_LEFT
] || 
mx
 =0Ë
xn
 -
glb_c⁄fig
.
s¸ﬁl
.
edô
.
x
;

1802 i‡(
key
[
KEY_RIGHT
] || 
mx
 =
glb_c⁄fig
.
s¸ìn
.
width
 - 1Ë
xn
 +glb_c⁄fig.
s¸ﬁl
.
edô
.
x
;

1803 i‡(
key
[
KEY_HOME
]Ë
xn
 = 0;

1804 i‡(
key
[
KEY_PGUP
])

1806 i‡(
key
[
KEY_LCONTROL
] || key[
KEY_RCONTROL
])

1807 
xn
 -
w
->
tmp_edô
->w;

1809 
yn
 -
w
->
tmp_edô
->
h
;

1810 
	`ª°
(80);

1812 i‡(
key
[
KEY_PGDN
])

1814 i‡(
key
[
KEY_LCONTROL
] || key[
KEY_RCONTROL
])

1815 
xn
 +
w
->
tmp_edô
->w;

1817 
yn
 +
w
->
tmp_edô
->
h
;

1818 
	`ª°
(80);

1822 i‡(
key
[
KEY_F9
])

1824 
key
[
KEY_F9
])

1826 
glb_ds1
[
ds1_idx
].
•ecül_œyî_mask
 = 1 - glb_ds1[ds1_idx].special_layer_mask;

1830 i‡(
key
[
KEY_F11
])

1832 
key
[
KEY_F11
])

1834 i‡(
key
[
KEY_LSHIFT
] || key[
KEY_RSHIFT
])

1836 
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[0]--;

1837 i‡(
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[0] < 0)

1838 
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[0] = 3;

1842 
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[0]++;

1843 i‡(
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[0] >= 4)

1844 
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[0] = 0;

1849 i‡(
key
[
KEY_F12
])

1851 i‡(
key
[
KEY_LSHIFT
] || key[
KEY_RSHIFT
])

1853 i‡(
glb_ds1edô
.
cur_gamma
 > 
GC_060
)

1855 
	`ª°
(80);

1856 
glb_ds1edô
.
cur_gamma
--;

1857 
	`misc_upd©e_∑l_wôh_gamma
();

1858 
	`£t_∑Àâe
(
glb_ds1edô
.
vga_∑l
[
glb_ds1
[
ds1_idx
].
a˘
 - 1]);

1863 i‡(
glb_ds1edô
.
cur_gamma
 < 
GC_300
)

1865 
	`ª°
(80);

1866 
glb_ds1edô
.
cur_gamma
++;

1867 
	`misc_upd©e_∑l_wôh_gamma
();

1868 
	`£t_∑Àâe
(
glb_ds1edô
.
vga_∑l
[
glb_ds1
[
ds1_idx
].
a˘
 - 1]);

1874 i‡(
key
[
KEY_P
])

1876 
	`•rötf
(
tmp
, "s¸ìnshŸ-%05i.pcx", 
glb_ds1edô
.
s¸ìnshŸ_num
);

1877 
	`fûe_exi°s
(
tmp
, -1, 
NULL
))

1879 
glb_ds1edô
.
s¸ìnshŸ_num
++;

1880 
	`•rötf
(
tmp
, "s¸ìnshŸ-%05i.pcx", 
glb_ds1edô
.
s¸ìnshŸ_num
);

1884 
	`døw_•rôe
(

1885 
glb_ds1edô
.
s¸ìn_buff
,

1886 
glb_ds1edô
.
mou£_curs‹
[glb_ds1edô.
mode
],

1887 
mou£_x
 - 1,

1888 
mou£_y
 - 1

1892 
	`ßve_pcx
(
tmp
, 
glb_ds1edô
.
s¸ìn_buff
, glb_ds1edô.
vga_∑l
[
glb_ds1
[
ds1_idx
].
a˘
-1]);

1893 
	`misc_pcx_put_d2_∑Àâe
(
tmp
, 
glb_ds1
[
ds1_idx
].
a˘
-1);

1894 
glb_ds1edô
.
s¸ìnshŸ_num
++;

1895 
key
[
KEY_P
])

1900 i‡(
focus_ˇn_ch™ge
)

1901 
focus
 = 0;

1903 
i
=
BU_NULL
 + 1; i<
BU_MAX
; i++)

1905 
b
 = & 
w
->
buâ⁄
[
i
];

1906 i‡(
b
->
a˘ive
)

1908 i‡((
mx
 >
b
->
x0
) &&

1909 (
my
 >
b
->
y0
) &&

1910 (
mx
 < 
b
->
x0
 + b->
w
) &&

1911 (
my
 < 
b
->
y0
 + b->
h
))

1914 
b
->
mou£_ovî
 = 
TRUE
;

1915 i‡(
mb
)

1918 i‡((
focus_ˇn_ch™ge
Ë|| (
focus
 =
i
))

1921 i‡(
b
->
°©e
 =
BS_OFF
)

1923 
b
->
°©e
 = 
BS_ON
;

1925 i‡(
focus_ˇn_ch™ge
)

1927 
focus
 = 
i
;

1928 
focus_ˇn_ch™ge
 = 
FALSE
;

1935 i‡(
b
->
°©e
 =
BS_ON
)

1937 
b
->
°©e
 = 
BS_OFF
;

1943 
b
->
mou£_ovî
 = 
FALSE
;

1944 i‡(
mb
)

1947 i‡(
b
->
°©e
 =
BS_ON
)

1949 
b
->
°©e
 = 
BS_OFF
;

1957 
i
=
BT_NULL
 + 1; i<
BT_MAX
; i++)

1959 
b
 = & 
w
->
èb
[
i
];

1960 i‡(
b
->
a˘ive
)

1962 i‡((
mx
 >
b
->
x0
) &&

1963 (
my
 >
b
->
y0
) &&

1964 (
mx
 < 
b
->
x0
 + b->
w
) &&

1965 (
my
 < 
b
->
y0
 + b->
h
))

1968 
b
->
mou£_ovî
 = 
TRUE
;

1969 i‡(
mb
)

1972 i‡(
focus_ˇn_ch™ge
)

1975 
n
=
BT_NULL
 + 1;Ç<
BT_MAX
;Ç++)

1977 i‡(
w
->
èb
[
n
].
a˘ive
)

1978 
w
->
èb
[
n
].
°©e
 = 
BS_OFF
;

1981 
b
->
°©e
 = 
BS_ON
;

1982 
cuºít_ty≥
 = 
i
;

1983 
xn
 = 
yn
 = 0;

1988 
b
->
mou£_ovî
 = 
FALSE
;

1993 i‡((
focus
 =0Ë&& (
mb
))

1994 
focus_ˇn_ch™ge
 = 
FALSE
;

1997 i‡(
mb
 == 0)

1999 i‡(
key
[
KEY_ENTER
] || key[
KEY_ENTER_PAD
])

2002 
d⁄e
 = 
TRUE
;

2003 
	`wedô_kìp_tûe
(
ds1_idx
, 
tx
, 
ty
, 
ßve_Êo‹
, 
ßve_wÆl
, 
ßve_shadow
);

2004 
key
[
KEY_ENTER
] || key[
KEY_ENTER_PAD
])

2006 
focus_ˇn_ch™ge
 = 
TRUE
;

2010 i‡(
focus_ˇn_ch™ge
 =
FALSE
)

2012 i‡(
w
->
buâ⁄
[
focus
].
mou£_ovî
 =
TRUE
)

2015 
focus
)

2017 
BU_OK
 :

2019 
d⁄e
 = 
TRUE
;

2020 
	`wedô_kìp_tûe
(
ds1_idx
, 
tx
, 
ty
, 
ßve_Êo‹
, 
ßve_wÆl
, 
ßve_shadow
);

2023 
BU_CANCEL
 :

2025 
	`wedô_ˇn˚l_tûe
(
ds1_idx
, 
tx
, 
ty
, 
ßve_Êo‹
, 
ßve_wÆl
, 
ßve_shadow
);

2026 
d⁄e
 = 
TRUE
;

2029 
BU_FLOOR1
 :

2030 
BU_FLOOR2
 :

2031 
n
=
BT_NULL
 + 1;Ç<
BT_MAX
;Ç++)

2033 
w
->
èb
[
n
].
a˘ive
 = 
FALSE
;

2034 
w
->
èb
[
n
].
°©e
 = 
BS_OFF
;

2036 
w
->
èb
[
BT_STATIC
].
a˘ive
 = w->èb[BT_STATIC].
èb_have_tûes
;

2037 
w
->
èb
[
BT_ANIMATED
].
a˘ive
 = w->èb[BT_ANIMATED].
èb_have_tûes
;

2038 
cuºít_buâ⁄
 = 
focus
;

2039 
bt_£l
 = 
	`wedô_£¨ch_tûe
(
ds1_idx
, 
tx
, 
ty
, 
cuºít_buâ⁄
);

2040 
	`wedô_jump
(
ds1_idx
, 
bt_£l
, & 
xn
, & 
yn
);

2041 i‡(
bt_£l
 >= 1)

2043 
cuºít_ty≥
 = 
bt_±r
[
bt_£l
].
ty≥
;

2044 
w
->
èb
[
cuºít_ty≥
].
°©e
 = 
BS_ON
;

2048 i‡(
w
->
èb
[
BT_STATIC
].
a˘ive
)

2050 
w
->
èb
[
BT_STATIC
].
°©e
 = 
BS_ON
;

2051 
cuºít_ty≥
 = 
BT_STATIC
;

2053 i‡(
w
->
èb
[
BT_ANIMATED
].
a˘ive
)

2055 
w
->
èb
[
BT_ANIMATED
].
°©e
 = 
BS_ON
;

2056 
cuºít_ty≥
 = 
BT_ANIMATED
;

2061 
BU_SHADOW
 :

2062 
n
=
BT_NULL
 + 1;Ç<
BT_MAX
;Ç++)

2064 
w
->
èb
[
n
].
a˘ive
 = 
FALSE
;

2065 
w
->
èb
[
n
].
°©e
 = 
BS_OFF
;

2067 
w
->
èb
[
BT_SHADOW
].
a˘ive
 = w->èb[BT_SHADOW].
èb_have_tûes
;

2068 
cuºít_buâ⁄
 = 
focus
;

2069 
bt_£l
 = 
	`wedô_£¨ch_tûe
(
ds1_idx
, 
tx
, 
ty
, 
cuºít_buâ⁄
);

2070 
	`wedô_jump
(
ds1_idx
, 
bt_£l
, & 
xn
, & 
yn
);

2071 i‡(
bt_£l
 >= 1)

2073 
cuºít_ty≥
 = 
bt_±r
[
bt_£l
].
ty≥
;

2074 
w
->
èb
[
cuºít_ty≥
].
°©e
 = 
BS_ON
;

2078 i‡(
w
->
èb
[
BT_SHADOW
].
a˘ive
)

2080 
w
->
èb
[
BT_SHADOW
].
°©e
 = 
BS_ON
;

2081 
cuºít_ty≥
 = 
BT_SHADOW
;

2086 
BU_WALL1
 :

2087 
BU_WALL2
 :

2088 
BU_WALL3
 :

2089 
BU_WALL4
 :

2090 
n
=
BT_NULL
 + 1;Ç<
BT_MAX
;Ç++)

2092 
w
->
èb
[
n
].
a˘ive
 = 
FALSE
;

2093 
w
->
èb
[
n
].
°©e
 = 
BS_OFF
;

2095 
w
->
èb
[
BT_WALL_UP
].
a˘ive
 = w->èb[BT_WALL_UP].
èb_have_tûes
;

2096 
w
->
èb
[
BT_WALL_DOWN
].
a˘ive
 = w->èb[BT_WALL_DOWN].
èb_have_tûes
;

2097 
w
->
èb
[
BT_ROOF
].
a˘ive
 = w->èb[BT_ROOF].
èb_have_tûes
;

2098 
w
->
èb
[
BT_SPECIAL
].
a˘ive
 = w->èb[BT_SPECIAL].
èb_have_tûes
;

2099 
cuºít_buâ⁄
 = 
focus
;

2100 
bt_£l
 = 
	`wedô_£¨ch_tûe
(
ds1_idx
, 
tx
, 
ty
, 
cuºít_buâ⁄
);

2101 
	`wedô_jump
(
ds1_idx
, 
bt_£l
, & 
xn
, & 
yn
);

2102 i‡(
bt_£l
 >= 1)

2104 
cuºít_ty≥
 = 
bt_±r
[
bt_£l
].
ty≥
;

2105 
w
->
èb
[
cuºít_ty≥
].
°©e
 = 
BS_ON
;

2109 i‡(
w
->
èb
[
BT_WALL_UP
].
a˘ive
)

2111 
w
->
èb
[
BT_WALL_UP
].
°©e
 = 
BS_ON
;

2112 
cuºít_ty≥
 = 
BT_WALL_UP
;

2114 i‡(
w
->
èb
[
BT_WALL_DOWN
].
a˘ive
)

2116 
w
->
èb
[
BT_WALL_DOWN
].
°©e
 = 
BS_ON
;

2117 
cuºít_ty≥
 = 
BT_WALL_DOWN
;

2119 i‡(
w
->
èb
[
BT_ROOF
].
a˘ive
)

2121 
w
->
èb
[
BT_ROOF
].
°©e
 = 
BS_ON
;

2122 
cuºít_ty≥
 = 
BT_ROOF
;

2124 i‡(
w
->
èb
[
BT_SPECIAL
].
a˘ive
)

2126 
w
->
èb
[
BT_SPECIAL
].
°©e
 = 
BS_ON
;

2127 
cuºít_ty≥
 = 
BT_SPECIAL
;

2133 
focus_ˇn_ch™ge
 = 
TRUE
;

2136 i‡((
m_idx
 !-1Ë&& (
s_idx
 != -1))

2139 
	`wedô_upd©e_tûe
(
ds1_idx
, 
tx
, 
ty
, 
cuºít_buâ⁄
,

2140 
cuºít_ty≥
, 
m_idx
, 
s_idx
);

2141 
bt_£l
 = 
	`wedô_£¨ch_tûe
(
ds1_idx
, 
tx
, 
ty
, 
cuºít_buâ⁄
);

2147 
	`wedô_èb_tûes
(
ds1_idx
, 
cuºít_ty≥
, 
xn
, 
yn
, 
bt_£l
, 
m_idx
, 
s_idx
);

2148 
ﬁd_xn
 = 
xn
;

2149 
ﬁd_yn
 = 
yn
;

2152 
	`de°roy_bôm≠
(
w
->
tmp_edô
);

2153 
w
->
tmp_edô
 = 
NULL
;

2154 
	`wedô_tûes_‰ì
();

2155 
	}
}

	@wEdit.h

1 #i‚de‡
_WEDIT_H_


3 
	#_WEDIT_H_


	)

5 
wedô_døw_s
 (
ds1_idx
, 
x
, 
y
);

6 
wedô_døw_f
 (
ds1_idx
, 
x
, 
y
);

7 
wedô_døw_w
 (
ds1_idx
, 
x
, 
y
, 
uµî
);

8 
wedô_døw_r
 (
ds1_idx
, 
x
, 
y
);

9 
wedô_døw_•
 (
ds1_idx
, 
x
, 
y
);

10 
wedô_make_2nd_buâ⁄s
 ();

11 
wedô_ªad_pcx
 ();

12 
wedô_‰ì
 ();

13 
wedô_døw_buâ⁄
 (
BUT_TYP_E
 
b_num
);

14 
wedô_døw_èb
 (
BLK_TYP_E
 
t_num
);

15 
wedô_èb_have
 (
ds1_idx
, 
BLK_TYP_E
 
t
);

16 
wedô_tûes_‰ì
 ();

17 
wedô_tûes_make
 (
ds1_idx
);

18 
wedô_£¨ch_tûe
 (
ds1_idx
, 
x
, 
y
, 
BUT_TYP_E
 
but
);

19 
wedô_èb_tûes
 (
ds1_idx
, 
BLK_TYP_E
 
t
, 
x0
, 
y0
, 
bt_£l
, 
m_idx
, 
s_idx
);

20 
wedô_jump
 (
ds1_idx
, 
bt_idx
, * 
xn
, * 
yn
);

21 
wedô_mou£_tûe
 (
mx
, 
my
, 
x0
, 
y0
, 
t
, * 
m_idx
, * 
s_idx
);

22 
wedô_upd©e_tûe
 (
ds1_idx
, 
x
, 
y
, 
BUT_TYP_E
 
buâ⁄
, 
BLK_TYP_E
 
ty≥
, 
m_idx
, 
s_idx
);

23 
wedô_ßve_tûe
 (
ds1_idx
, 
x
, 
y
, 
CELL_F_S
 * 
d°_f_±r
, 
CELL_W_S
 * 
d°_w_±r
, 
CELL_S_S
 * 
d°_s_±r
);

24 
wedô_ˇn˚l_tûe
 (
ds1_idx
, 
x
, 
y
, 
CELL_F_S
 * 
§c_f_±r
, 
CELL_W_S
 * 
§c_w_±r
, 
CELL_S_S
 * 
§c_s_±r
);

25 
wedô_kìp_tûe
 (
ds1_idx
, 
x
, 
y
, 
CELL_F_S
 * 
§c_f_±r
, 
CELL_W_S
 * 
§c_w_±r
, 
CELL_S_S
 * 
§c_s_±r
);

26 
wedô_ã°
 (
ds1_idx
, 
tx
, 
ty
);

	@wMsg.c

1 
	~<°rög.h
>

2 
	~"°ru˘s.h
"

3 
	~"îr‹.h
"

4 
	~"wMsg.h
"

5 
	~"misc.h
"

9 
	$wmsg_maö
(
WMSG_S
 * 
wmsg
)

11 
mx
, 
my
, 
mb
, 
d⁄e
 = 
FALSE
;

12 
wx0
, 
wy0
, 
wx1
, 
wy1
;

13 
i
, 
n
, 
cuº_Àngth
 = 0, 
max_Àngth
 = 0;

14 
cuº_width
, 
max_width
, 
cuº_height
;

15 
ãxt_löes
 = 0, 
löe_height
, 
x
, 
y
, 
x2
, 
y2
;

16 
ªt
 = -1, 
bx0
, 
by0
, 
but_maxwidth
 = 0, 
bg
, 
fg
, 
b‹dî
;

17 
s
, 
k
, 
Æl_keys
;

18 
tmp
[512];

21 i‡(
wmsg
 =
NULL
)

23 i‡(
wmsg
->
ãxt
 =
NULL
)

25 i‡(
wmsg
->
buâ⁄
 =
NULL
)

29 
n
 = 
	`°æí
(
wmsg
->
ãxt
) + 1;

30 
i
=0; i < 
n
; i++)

32 i‡–(
wmsg
->
ãxt
[
i
] != 0x0A) &&

33 (
wmsg
->
ãxt
[
i
] != 0x0D) &&

34 (
wmsg
->
ãxt
[
i
] != 0x00)

36 
cuº_Àngth
++;

39 i‡(
cuº_Àngth
 > 
max_Àngth
)

40 
max_Àngth
 = 
cuº_Àngth
;

41 
cuº_Àngth
 = 0;

42 
ãxt_löes
++;

45 
max_width
 = (
max_Àngth
 + 2Ë* 
wmsg
->
f⁄t_width
;

46 
löe_height
 = 
wmsg
->
f⁄t_height
 + 2;

47 
cuº_height
 = 
ãxt_löes
 * 
löe_height
;

48 
cuº_height
 +
löe_height
;

51 i‡(
wmsg
->
tôÀ
 !
NULL
)

53 
cuº_height
 +
löe_height
 * 2;

54 
cuº_width
 = 
wmsg
->
f⁄t_width
 * 
	`°æí
(wmsg->
tôÀ
);

55 i‡(
cuº_width
 > 
max_width
)

56 
max_width
 = 
cuº_width
;

60 
but_maxwidth
 = 0;

61 
i
 = 0;

62 
wmsg
->
buâ⁄
[
i
].
ãxt
 !
NULL
)

64 
n
 = 
	`°æí
(
wmsg
->
buâ⁄
[
i
].
ãxt
);

65 
but_maxwidth
 +(2 + 
n
 + 
wmsg
->
buâ⁄
[
i
].
right_•a˚s
) *

66 
wmsg
->
f⁄t_width
;

69 
i
++;

71 
but_maxwidth
 +2 * 
wmsg
->
f⁄t_width
;

72 i‡(
but_maxwidth
 > 
max_width
)

73 
max_width
 = 
but_maxwidth
;

74 
cuº_height
 +
löe_height
 * 5;

78 
wx0
 = (
glb_c⁄fig
.
s¸ìn
.
width
 - 
max_width
) / 2;

79 
bx0
 = 
wx0
 + 
wmsg
->
f⁄t_width
 + ((
max_width
 - 
but_maxwidth
) / 2);

80 
wy0
 = (
glb_c⁄fig
.
s¸ìn
.
height
 - 
cuº_height
) / 2;

81 
wx1
 = 
wx0
 + 
max_width
;

82 
wy1
 = 
wy0
 + 
cuº_height
;

83 
by0
 = 
wy1
 - 
löe_height
 * 4;

84 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
wx0
, 
wy0
, 
wx1
, 
wy1
, 
wmsg
->
cﬁ_wö
.
bg
);

85 
x
 = 
wx0
 + 
wmsg
->
f⁄t_width
;

86 
y
 = 
wy0
 + 
wmsg
->
f⁄t_height
;

89 i‡(
wmsg
->
tôÀ
 !
NULL
)

91 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
wx0
, 
wy0
, 
wx1
, wy0 + 
löe_height
*2, 
wmsg
->
cﬁ_tôÀ
.
bg
);

92 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
, 
wx0
, 
wy0
, 
wx1
, wy0 + 
löe_height
*2, 
wmsg
->
cﬁ_tôÀ
.
fg
);

93 
	`hlöe
(
glb_ds1edô
.
s¸ìn_buff
, 
wx0
, 
wy0
 + 
löe_height
*2, 
wx1
, 
wmsg
->
cﬁ_wö
.
fg
);

95 
	`ãxt_mode
(
wmsg
->
cﬁ_tôÀ
.
bg
);

96 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
wmsg
->
tôÀ
, 
x
, 
y
, wmsg->
cﬁ_tôÀ
.
fg
);

97 
y
 +
löe_height
 * 2;

101 
tmp
[1] = 0x00;

102 
n
 = 
	`°æí
(
wmsg
->
ãxt
) + 1;

103 
	`ãxt_mode
(
wmsg
->
cﬁ_ãxt
.
bg
);

104 
i
=0; i < 
n
; i++)

106 i‡–(
wmsg
->
ãxt
[
i
] != 0x0A) &&

107 (
wmsg
->
ãxt
[
i
] != 0x0D) &&

108 (
wmsg
->
ãxt
[
i
] != 0x00)

112 
tmp
[0] = 
wmsg
->
ãxt
[
i
];

113 
	`ãxtout
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
tmp
, 
x
, 
y
, 
wmsg
->
cﬁ_ãxt
.
fg
);

114 
x
 +
wmsg
->
f⁄t_width
;

118 
x
 = 
wx0
 + 
wmsg
->
f⁄t_width
;

119 
y
 +
löe_height
;

124 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
, 
wx0
, 
wy0
, 
wx1
, 
wy1
, 
wmsg
->
cﬁ_wö
.
fg
);

129 
mx
 = 
mou£_x
;

130 
my
 = 
mou£_y
;

131 
mb
 = 
mou£_b
;

134 
	`ãxt_mode
(-1);

135  ! 
d⁄e
)

138 
i
 = 0;

139 (
wmsg
->
buâ⁄
[
i
].
ãxt
 !
NULL
Ë&& ( ! 
d⁄e
) )

141 
s
=0; s < 
MW_SHORTCUT_NUM
; s++)

145 
Æl_keys
 = 
TRUE
;

146 i‡(
wmsg
->
buâ⁄
[
i
].
sh‹tcut
[
s
].
key
[0] != 0)

148 
k
=0; k < 
MW_COMBINATION_KEY_NUM
; k++)

150 i‡(
wmsg
->
buâ⁄
[
i
].
sh‹tcut
[
s
].
key
[
k
])

152 i‡–! 
key
[ 
wmsg
->
buâ⁄
[
i
].
sh‹tcut
[
s
].key[
k
] ])

153 
Æl_keys
 = 
FALSE
;

158 
Æl_keys
 = 
FALSE
;

159 i‡(
Æl_keys
 =
TRUE
)

161 
d⁄e
 = 
TRUE
;

162 
ªt
 = 
i
;

165 
Æl_keys
 =
TRUE
)

167 
Æl_keys
 = 
FALSE
;

168 
k
=0; k < 
MW_COMBINATION_KEY_NUM
; k++)

170 i‡(
wmsg
->
buâ⁄
[
i
].
sh‹tcut
[
s
].
key
[
k
])

172 i‡(
key
[ 
wmsg
->
buâ⁄
[
i
].
sh‹tcut
[
s
].key[
k
] ])

173 
Æl_keys
 = 
TRUE
;

181 
i
++;

185 
i
 = 0;

186 
x
 = 
bx0
;

187 
y
 = 
by0
;

188 
y2
 = 
y
 + (3 * 
löe_height
);

189 
wmsg
->
buâ⁄
[
i
].
ãxt
 !
NULL
)

191 
n
 = 
	`°æí
(
wmsg
->
buâ⁄
[
i
].
ãxt
);

192 
x2
 = 
x
 + ((
n
 + 2Ë* 
wmsg
->
f⁄t_width
);

195 i‡((
mx
 >
x
Ë&& (mx <
x2
Ë&& (
my
 >
y
Ë&& (my <
y2
))

198 
bg
 = 
wmsg
->
buâ⁄
[
i
].
⁄
.bg;

199 
fg
 = 
wmsg
->
buâ⁄
[
i
].
⁄
.fg;

200 
b‹dî
 = 
wmsg
->
buâ⁄
[
i
].
⁄
.border;

203 i‡(
mb
)

205 
mb
)

206 
mb
 = 
mou£_b
;

207 
d⁄e
 = 
TRUE
;

208 
ªt
 = 
i
;

214 
bg
 = 
wmsg
->
buâ⁄
[
i
].
off
.bg;

215 
fg
 = 
wmsg
->
buâ⁄
[
i
].
off
.fg;

216 
b‹dî
 = 
wmsg
->
buâ⁄
[
i
].
off
.border;

220 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
x
, 
y
, 
x2
, 
y2
, 
bg
);

221 
	`ãxçrötf
(

222 
glb_ds1edô
.
s¸ìn_buff
,

223 
f⁄t
,

224 
x
 + 
wmsg
->
f⁄t_width
,

225 
y
 + 
löe_height
 + 2,

226 
fg
,

227 "%s", 
wmsg
->
buâ⁄
[
i
].
ãxt


229 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
, 
x
, 
y
, 
x2
, 
y2
, 
b‹dî
);

232 
x
 = 
x2
 + (
wmsg
->
f⁄t_width
 * wmsg->
buâ⁄
[
i
].
right_•a˚s
);

233 
i
++;

236 
	`misc_døw_s¸ìn
(
mx
, 
my
);

239 
mx
 = 
mou£_x
;

240 
my
 = 
mou£_y
;

241 
mb
 = 
mou£_b
;

244 
	`ãxt_mode
(-1);

246  
ªt
;

247 
	}
}

	@wMsg.h

1 #i‚de‡
_WMSG_H_


3 
	#_WMSG_H_


	)

5 
wmsg_maö
(
WMSG_S
 * 
wmsg
);

	@wPreview.c

1 
	~<m©h.h
>

2 
	~<°rög.h
>

3 
	~"°ru˘s.h
"

4 
	~"gfx_cu°om.h
"

5 
	~"misc.h
"

6 
	~"edôobj.h
"

7 
	~"edô∑th.h
"

8 
	~"wPªvõw.h
"

10 #ifde‡
WIN32


11 #¥agm®
w¨nög
 (
push
)

12 #¥agm®
w¨nög
 (
dißbÀ
 : 4244 4267 )

17 
	$w¥evõw_sh≠e
(
BITMAP
 * 
tmp_bmp
, 
x0
, 
y0
, 
ds1_idx
,

18 
COL_E
 
cﬁ_idx
)

20 i‡(
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 == -1)

21 
cﬁ‹_m≠
 = & 
glb_ds1edô
.
cm≠
[
CM_SELECT
][
glb_ds1
[
ds1_idx
].
a˘
 - 1];

23 
cﬁ‹_m≠
 = & 
glb_ds1edô
.
cm≠
[
CM_SELECT
][glb_ds1edô.
cmd_löe
.
f‹˚_∑l_num
 - 1];

24 
	`døw_lô_•rôe
(
glb_ds1edô
.
s¸ìn_buff
, 
tmp_bmp
, 
x0
, 
y0
, 
cﬁ_idx
);

25 
	}
}

30 
	$w¥evõw_gouøud_f
(
BITMAP
 * 
tmp_bmp
, 
x0
, 
y0
, 
ds1_idx
,

31 
c1
, 
c2
, 
c3
, 
c4
)

33 i‡((
c1
 =
c2
Ë&& (c2 =
c3
Ë&& (c3 =
c4
))

35 i‡(
c1
 <= 7)

37 i‡(
c1
 >= 248)

38 
	`døw_•rôe
(
glb_ds1edô
.
s¸ìn_buff
, 
tmp_bmp
, 
x0
, 
y0
);

41 i‡(
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 == -1)

42 
cﬁ‹_m≠
 = & 
glb_ds1edô
.
cm≠
[
CM_SHADOW
][
glb_ds1
[
ds1_idx
].
a˘
 - 1];

44 
cﬁ‹_m≠
 = & 
glb_ds1edô
.
cm≠
[
CM_SHADOW
][glb_ds1edô.
cmd_löe
.
f‹˚_∑l_num
 - 1];

45 
	`døw_lô_•rôe
(
glb_ds1edô
.
s¸ìn_buff
, 
tmp_bmp
, 
x0
, 
y0
, 
c1
);

50 i‡(
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 == -1)

51 
cﬁ‹_m≠
 = & 
glb_ds1edô
.
cm≠
[
CM_SHADOW
][
glb_ds1
[
ds1_idx
].
a˘
 - 1];

53 
cﬁ‹_m≠
 = & 
glb_ds1edô
.
cm≠
[
CM_SHADOW
][glb_ds1edô.
cmd_löe
.
f‹˚_∑l_num
 - 1];

54 i‡(
glb_ds1edô
.
night_mode
 == 1)

56 
	`døw_gouøud_•rôe
(
glb_ds1edô
.
s¸ìn_buff
, 
tmp_bmp
, 
x0
, 
y0
,

57 
c1
, 
c2
, 
c3
, 
c4
);

61 
	`døw_lô_•rôe
(
glb_ds1edô
.
s¸ìn_buff
, 
tmp_bmp
, 
x0
, 
y0
,

62 (
c1
 + 
c2
 + 
c3
 + 
c4
) / 4);

65 
	}
}

70 
	$w¥evõw_gouøud_w
(
BITMAP
 * 
tmp_bmp
, 
x0
, 
y0
, 
ds1_idx
,

71 
c1
, 
c2
, 
c3
, 
c4
)

73 i‡(
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 == -1)

74 
cﬁ‹_m≠
 = & 
glb_ds1edô
.
cm≠
[
CM_SHADOW
][
glb_ds1
[
ds1_idx
].
a˘
 - 1];

76 
cﬁ‹_m≠
 = & 
glb_ds1edô
.
cm≠
[
CM_SHADOW
][glb_ds1edô.
cmd_löe
.
f‹˚_∑l_num
 - 1];

78 i‡((
c1
 =
c2
Ë&& (c2 =
c3
Ë&& (c3 =
c4
))

80 i‡(
c1
 >= 248)

81 
	`døw_•rôe
(
glb_ds1edô
.
s¸ìn_buff
, 
tmp_bmp
, 
x0
, 
y0
);

84 i‡(
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 == -1)

85 
cﬁ‹_m≠
 = & 
glb_ds1edô
.
cm≠
[
CM_SHADOW
][
glb_ds1
[
ds1_idx
].
a˘
 - 1];

87 
cﬁ‹_m≠
 = & 
glb_ds1edô
.
cm≠
[
CM_SHADOW
][glb_ds1edô.
cmd_löe
.
f‹˚_∑l_num
 - 1];

88 
	`døw_lô_•rôe
(
glb_ds1edô
.
s¸ìn_buff
, 
tmp_bmp
, 
x0
, 
y0
, 
c1
);

93 i‡(
glb_ds1edô
.
night_mode
 == 1)

95 
	`døw_gouøud_•rôe
(
glb_ds1edô
.
s¸ìn_buff
, 
tmp_bmp
, 
x0
, 
y0
,

96 
c1
, 
c2
, 
c3
, 
c4
);

100 
	`døw_lô_•rôe
(
glb_ds1edô
.
s¸ìn_buff
, 
tmp_bmp
, 
x0
, 
y0
,

101 (
c1
 + 
c2
 + 
c3
 + 
c4
) / 4);

104 
	}
}

109 
	$w¥evõw_light_di°
(
x0
, 
y0
, 
mx
, 
my
)

111 
dx
, 
dy
;

113 
dx
 = 
mx
 - 
x0
;

114 
dx
 *= dx;

116 
dy
 = (
my
 - 
y0
) * 2;

117 
dy
 *= dy;

119  
	`˚û
(
	`sqπ
(
dx
 + 
dy
));

120 
	}
}

125 
	$qs‹t_hñ≥r_‹dî_d©a
(c⁄° *
e1
, c⁄° *
e2
)

127 
ORDER_DATA_S
 * 
o1
, * 
o2
;

129 
o1
 = (
ORDER_DATA_S
 *Ë
e1
;

130 
o2
 = (
ORDER_DATA_S
 *Ë
e2
;

133 i‡(
o1
->
height
 =
o2
->height)

134  
o1
->
idx
 - 
o2
->idx;

136  
o1
->
height
 - 
o2
->height;

137 
	}
}

142 
	$w¥evõw_døw_s
(
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
,

143 
£À˘ed
)

145 
BLOCK_TABLE_S
 * 
bt_±r
;

146 
BITMAP
 * 
tmp_bmp
;

147 
CELL_S_S
 * 
s_±r
;

148 
n
, 
t
, 
bt_idx
, 
dt1_idx
, 
block_idx
, 
y1
, 
cﬁ‹
;

149 
ux1
, 
ux2
, 
ux3
, 
ux4
, 
uy1
, 
uy2
, 
uy3
;

152 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

153 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
t
;

155 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
shadow_num
;Ç++)

157 
cﬁ‹
 = -1;

158 i‡(
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[
n
] == 0)

161 i‡(
	`IS_HIDE
(
s_±r
[
n
].
Êags
))

164 
bt_idx
 = 
s_±r
[
n
].bt_idx;

166 i‡(
s_±r
[
n
].
¥›4
 & 0x80)

167 
bt_idx
 = -1;

169 i‡(
bt_idx
 == -1)

171 
ux1
 = 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
;

172 
ux2
 = 
ux1
 + 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2 - 1;

173 
ux3
 = 
ux1
 + 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

174 
ux4
 = 
ux1
 + 
glb_ds1
[
ds1_idx
].
tûe_w
 - 1;

176 
uy1
 = 
my
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
;

177 
uy2
 = 
uy1
 + 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2 - 1;

178 
uy3
 = 
uy1
 + 
glb_ds1
[
ds1_idx
].
tûe_h
 - 2;

180 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ux1
, 
uy2
, 
ux2
, 
uy1
, 168);

181 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ux3
, 
uy1
, 
ux4
, 
uy2
, 168);

182 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ux3
, 
uy3
, 
ux4
, 
uy2
, 168);

183 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ux1
, 
uy2
, 
ux2
, 
uy3
, 168);

185 i‡(
glb_ds1
[
ds1_idx
].
cur_zoom
 =
ZM_11
)

187 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
ux1
+8, 
uy2
-2, 0,

189 
s_±r
[
n
].
¥›1
,

190 
s_±r
[
n
].
¥›2
,

191 
s_±r
[
n
].
¥›3
,

192 
s_±r
[
n
].
¥›4


194 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
ux1
+7, 
uy2
-3, 255,

196 
s_±r
[
n
].
¥›1
,

197 
s_±r
[
n
].
¥›2
,

198 
s_±r
[
n
].
¥›3
,

199 
s_±r
[
n
].
¥›4


203 i‡(
bt_idx
 <= 0)

206 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
 + 
bt_idx
;

208 i‡(
bt_±r
->
ty≥
 !
BT_SHADOW
)

211 
dt1_idx
 = 
bt_±r
->dt1_idx;

212 
block_idx
 = 
bt_±r
->block_idx;

214 
tmp_bmp
 = * (
glb_dt1
[
dt1_idx
].
block_zoom
[
z
] + 
block_idx
);

216 i‡(
tmp_bmp
 =
NULL
)

219 
y1
 = 
my
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 -

220 
bt_±r
->
zîo_löe
 * 
glb_ds1
[
ds1_idx
].
height_mul
 / glb_ds1[ds1_idx].
height_div
;

221 
y1
 +
glb_ds1
[
ds1_idx
].
tûe_h
;

224 i‡–(
y1
 + 
tmp_bmp
->
h
) < 0)

226 i‡(
y1
 >
glb_ds1edô
.
wö_¥evõw
.
h
)

229 i‡(
£À˘ed
)

231 i‡(
	`IS_COPY_INFO
(
s_±r
[
n
].
Êags
))

233 
cﬁ‹
 = 
COL_PASTE_OK
;

234 i‡(
	`IS_COPY_STATE
(
s_±r
[
n
].
Êags
))

235 
cﬁ‹
 = 
COL_PASTE_KO
;

237 i‡(
	`IS_TMP_SELECT
(
s_±r
[
n
].
Êags
))

238 
cﬁ‹
 = 
COL_TMPSEL_M
;

239 i‡(
	`IS_SELECTED
(
s_±r
[
n
].
Êags
))

240 
cﬁ‹
 = 
COL_FLOOR_M
;

242 
cﬁ‹
 = 
COL_MOUSE
;

246 i‡(
	`IS_COPY_INFO
(
s_±r
[
n
].
Êags
))

248 
cﬁ‹
 = 
COL_PASTE_OK
;

249 i‡(
	`IS_COPY_STATE
(
s_±r
[
n
].
Êags
))

250 
cﬁ‹
 = 
COL_PASTE_KO
;

252 i‡(
	`IS_TMP_SELECT
(
s_±r
[
n
].
Êags
))

253 
cﬁ‹
 = 
COL_TMPSEL
;

254 i‡(
	`IS_SELECTED
(
s_±r
[
n
].
Êags
))

255 
cﬁ‹
 = 
COL_FLOOR
;

257 i‡((
cﬁ‹
 !-1Ë&& (
glb_ds1edô
.
mode
 !
MOD_L
))

259 
	`w¥evõw_sh≠e
(
tmp_bmp
,

260 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
, 
y1
,

261 
ds1_idx
, 
cﬁ‹
);

265 
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[0])

271 
	`døw_•rôe
(
glb_ds1edô
.
s¸ìn_buff
, 
tmp_bmp
,

272 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
, 
y1
);

276 
	`w¥evõw_sh≠e
(
tmp_bmp
,

277 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
, 
y1
,

278 
ds1_idx
, 
COL_SHADOW
);

282 i‡(
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 == -1)

283 
cﬁ‹_m≠
 = & 
glb_ds1edô
.
cm≠
[
CM_TRANS
][
glb_ds1
[
ds1_idx
].
a˘
 - 1];

285 
cﬁ‹_m≠
 = & 
glb_ds1edô
.
cm≠
[
CM_TRANS
][glb_ds1edô.
cmd_löe
.
f‹˚_∑l_num
 - 1];

286 
	`døw_å™s_•rôe
(

287 
glb_ds1edô
.
s¸ìn_buff
,

288 
tmp_bmp
,

289 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
,

290 
y1


296 
	}
}

301 
	$w¥evõw_ªiöô_™im©ed_Êo‹
(
ds1_idx
)

303 
BLOCK_TABLE_S
 * 
bt_±r
;

304 
i
;

307 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
;

308 
i
=0; i < 
glb_ds1
[
ds1_idx
].
bt_num
; i++)

310 i‡(
bt_±r
->
ty≥
 =
BT_ANIMATED
)

311 
bt_±r
->
upd©ed
 = 
FALSE
;

312 
bt_±r
++;

314 
	}
}

319 
	$w¥evõw_døw_f
(
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
, 
£À˘ed
)

321 
BLOCK_TABLE_S
 * 
bt_±r
;

322 
BITMAP
 * 
tmp_bmp
;

323 
CELL_F_S
 * 
f_±r
;

324 
n
, 
t
, 
bt_idx
, 
dt1_idx
, 
block_idx
, 
y1
, 
cﬁ‹
;

325 
ORDER_DATA_S
 
‹dî_d©a
[4];

326 
di°
, 
c1
, 
c2
, 
c3
, 
c4
;

327 
ux1
, 
ux2
, 
ux3
, 
ux4
, 
uy1
, 
uy2
, 
uy3
;

330 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

331 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
t
;

334 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
Êo‹_num
;Ç++)

336 
‹dî_d©a
[
n
].
idx
 =Ç;

337 
‹dî_d©a
[
n
].
height
 = 
f_±r
[n].
¥›1
;

339 
	`qs‹t
(
‹dî_d©a
, 
glb_ds1
[
ds1_idx
].
Êo‹_num
, (
ORDER_DATA_S
),

340 
qs‹t_hñ≥r_‹dî_d©a
);

342 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
Êo‹_num
;Ç++)

344 
cﬁ‹
 = -1;

345 i‡(
glb_ds1
[
ds1_idx
].
Êo‹_œyî_mask
[
‹dî_d©a
[
n
].
idx
] == 0)

348 i‡(
	`IS_HIDE
(
f_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

351 
bt_idx
 = 
f_±r
[
‹dî_d©a
[
n
].
idx
].bt_idx;

353 i‡(
bt_idx
 == 0)

356 i‡(
f_±r
[
‹dî_d©a
[
n
].
idx
].
¥›4
 & 0x80)

357 
bt_idx
 = -1;

359 i‡(
bt_idx
 == -1)

361 
ux1
 = 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
;

362 
ux2
 = 
ux1
 + 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2 - 1;

363 
ux3
 = 
ux1
 + 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

364 
ux4
 = 
ux1
 + 
glb_ds1
[
ds1_idx
].
tûe_w
 - 1;

366 
uy1
 = 
my
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
;

367 
uy2
 = 
uy1
 + 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2 - 1;

368 
uy3
 = 
uy1
 + 
glb_ds1
[
ds1_idx
].
tûe_h
 - 2;

370 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ux1
, 
uy2
, 
ux2
, 
uy1
, 168);

371 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ux3
, 
uy1
, 
ux4
, 
uy2
, 168);

372 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ux3
, 
uy3
, 
ux4
, 
uy2
, 168);

373 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ux1
, 
uy2
, 
ux2
, 
uy3
, 168);

375 i‡(
glb_ds1
[
ds1_idx
].
cur_zoom
 =
ZM_11
)

377 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
ux1
+8, 
uy2
-2, 0,

379 
f_±r
[
‹dî_d©a
[
n
].
idx
].
¥›1
,

380 
f_±r
[
‹dî_d©a
[
n
].
idx
].
¥›2
,

381 
f_±r
[
‹dî_d©a
[
n
].
idx
].
¥›3
,

382 
f_±r
[
‹dî_d©a
[
n
].
idx
].
¥›4


384 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
ux1
+7, 
uy2
-3, 255,

386 
f_±r
[
‹dî_d©a
[
n
].
idx
].
¥›1
,

387 
f_±r
[
‹dî_d©a
[
n
].
idx
].
¥›2
,

388 
f_±r
[
‹dî_d©a
[
n
].
idx
].
¥›3
,

389 
f_±r
[
‹dî_d©a
[
n
].
idx
].
¥›4


393 i‡(
bt_idx
 <= 0)

396 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
 + 
bt_idx
;

398 i‡–(
bt_±r
->
ty≥
 !
BT_STATIC
Ë&& (bt_±r->ty≥ !
BT_ANIMATED
) )

401 i‡(
bt_±r
->
ty≥
 =
BT_ANIMATED
)

404 i‡(
bt_±r
->
upd©ed
 =
FALSE
)

406 
bt_±r
->
cuº_‰ame
 =

407 (
glb_ds1
[
ds1_idx
].
cur_™im_Êo‹_‰ame
 / 5Ë% (
bt_±r
->
ørôy
 + 1);

408 
bt_±r
->
upd©ed
 = 
TRUE
;

410 
bt_±r
 +bt_±r->
cuº_‰ame
 - bt_±r->
ørôy
;

413 
dt1_idx
 = 
bt_±r
->dt1_idx;

414 
block_idx
 = 
bt_±r
->block_idx;

416 
tmp_bmp
 = * (
glb_dt1
[
dt1_idx
].
block_zoom
[
z
] + 
block_idx
);

418 i‡(
tmp_bmp
 =
NULL
)

421 
y1
 = 
my
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 -

422 
bt_±r
->
zîo_löe
 * 
glb_ds1
[
ds1_idx
].
height_mul
 / glb_ds1[ds1_idx].
height_div
;

423 i‡–(
y1
 + 
tmp_bmp
->
h
) < 0)

425 i‡(
y1
 >
glb_ds1edô
.
wö_¥evõw
.
h
)

428 i‡(
glb_ds1edô
.
mode
 =
MOD_L
)

431 
di°
 = 
	`w¥evõw_light_di°
(

432 
mx
,

433 
my
,

434 
glb_ds1edô
.
wö_¥evõw
.
x0
 + 
mou£_x
,

435 
glb_ds1edô
.
wö_¥evõw
.
y0
 + 
mou£_y


437 i‡(
di°
 < 200)

438 
c1
 = 255;

439 i‡(
di°
 > 500)

440 
c1
 = 0;

442 
c1
 = 255 - ((
di°
 - 200) * 255 / (500 - 200));

445 
di°
 = 
	`w¥evõw_light_di°
(

446 
mx
 + 
tmp_bmp
->
w
,

447 
my
,

448 
glb_ds1edô
.
wö_¥evõw
.
x0
 + 
mou£_x
,

449 
glb_ds1edô
.
wö_¥evõw
.
y0
 + 
mou£_y


451 i‡(
di°
 < 200)

452 
c2
 = 255;

453 i‡(
di°
 > 500)

454 
c2
 = 0;

456 
c2
 = 255 - ((
di°
 - 200) * 255 / (500 - 200));

459 
di°
 = 
	`w¥evõw_light_di°
(

460 
mx
 + 
tmp_bmp
->
w
,

461 
my
 + 
glb_ds1
[
ds1_idx
].
tûe_h
,

462 
glb_ds1edô
.
wö_¥evõw
.
x0
 + 
mou£_x
,

463 
glb_ds1edô
.
wö_¥evõw
.
y0
 + 
mou£_y


465 i‡(
di°
 < 200)

466 
c3
 = 255;

467 i‡(
di°
 > 500)

468 
c3
 = 0;

470 
c3
 = 255 - ((
di°
 - 200) * 255 / (500 - 200));

473 
di°
 = 
	`w¥evõw_light_di°
(

474 
mx
,

475 
my
 + 
glb_ds1
[
ds1_idx
].
tûe_h
,

476 
glb_ds1edô
.
wö_¥evõw
.
x0
 + 
mou£_x
,

477 
glb_ds1edô
.
wö_¥evõw
.
y0
 + 
mou£_y


479 i‡(
di°
 < 200)

480 
c4
 = 255;

481 i‡(
di°
 > 500)

482 
c4
 = 0;

484 
c4
 = 255 - ((
di°
 - 200) * 255 / (500 - 200));

487 
	`w¥evõw_gouøud_f
(
tmp_bmp
,

488 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
, 
y1
,

489 
ds1_idx
,

490 
c1
, 
c2
, 
c3
, 
c4
);

494 i‡(
£À˘ed
)

496 i‡(
	`IS_COPY_INFO
(
f_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

498 
cﬁ‹
 = 
COL_PASTE_OK
;

499 i‡(
	`IS_COPY_STATE
(
f_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

500 
cﬁ‹
 = 
COL_PASTE_KO
;

502 i‡(
	`IS_TMP_SELECT
(
f_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

503 
cﬁ‹
 = 
COL_TMPSEL_M
;

504 i‡(
	`IS_SELECTED
(
f_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

505 
cﬁ‹
 = 
COL_FLOOR_M
;

507 
cﬁ‹
 = 
COL_MOUSE
;

511 i‡(
	`IS_COPY_INFO
(
f_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

513 
cﬁ‹
 = 
COL_PASTE_OK
;

514 i‡(
	`IS_COPY_STATE
(
f_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

515 
cﬁ‹
 = 
COL_PASTE_KO
;

517 i‡(
	`IS_TMP_SELECT
(
f_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

518 
cﬁ‹
 = 
COL_TMPSEL
;

519 i‡(
	`IS_SELECTED
(
f_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

520 
cﬁ‹
 = 
COL_FLOOR
;

523 i‡(
cﬁ‹
 != -1)

525 
	`w¥evõw_sh≠e
(
tmp_bmp
,

526 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
, 
y1
,

527 
ds1_idx
, 
cﬁ‹
);

531 
	`døw_•rôe
(
glb_ds1edô
.
s¸ìn_buff
, 
tmp_bmp
,

532 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
, 
y1
);

536 
	}
}

541 
	$w¥evõw_døw_w
(
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
,

542 
£À˘ed
, 
uµî
)

544 
BLOCK_TABLE_S
 * 
bt_±r
;

545 
BITMAP
 * 
tmp_bmp
;

546 
CELL_W_S
 * 
w_±r
;

547 
n
, 
t
, 
bt_idx
, 
dt1_idx
, 
block_idx
, 
m
, 
s
, 
y1
;

548 
d⁄e
, 
found
, 
o
, 
cﬁ‹
;

549 
ORDER_DATA_S
 
‹dî_d©a
[4];

550 
di°
, 
c1
=0, 
c2
=0;

551 
ux1
, 
ux2
, 
ux3
, 
ux4
, 
uy1
, 
uy2
, 
uy3
;

554 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

555 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
t
;

557 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

559 
‹dî_d©a
[
n
].
idx
 =Ç;

560 
‹dî_d©a
[
n
].
height
 = 
w_±r
[n].
¥›1
;

561 i‡(
w_±r
[
n
].
‹õ¡©i⁄
 == 10)

562 
‹dî_d©a
[
n
].
height
 = 255;

564 
	`qs‹t
(
‹dî_d©a
, 
glb_ds1
[
ds1_idx
].
wÆl_num
, (
ORDER_DATA_S
),

565 
qs‹t_hñ≥r_‹dî_d©a
);

567 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

569 
cﬁ‹
 = -1;

570 i‡(
glb_ds1
[
ds1_idx
].
wÆl_œyî_mask
[
‹dî_d©a
[
n
].
idx
] == 0)

573 i‡(
	`IS_HIDE
(
w_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

577 
o
 = 
w_±r
[
‹dî_d©a
[
n
].
idx
].
‹õ¡©i⁄
;

578 i‡((
uµî
 =
TRUE
Ë&& (
o
 >= 15))

580 i‡((
uµî
 =
FALSE
Ë&& (
o
 <= 15))

583 
bt_idx
 = 
w_±r
[
‹dî_d©a
[
n
].
idx
].bt_idx;

585 i‡(
bt_idx
 == 0)

588 i‡(
glb_ds1
[
ds1_idx
].
•ecül_œyî_mask
 && ((
o
 == 10) || (o == 11)))

594 i‡(
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›4
 & 0x80)

597 i‡((
o
 != 10) && (o != 11))

598 
bt_idx
 = -1;

601 i‡(
bt_idx
 == -1)

603 
ux1
 = 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
;

604 
ux2
 = 
ux1
 + 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2 - 1;

605 
ux3
 = 
ux1
 + 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

606 
ux4
 = 
ux1
 + 
glb_ds1
[
ds1_idx
].
tûe_w
 - 1;

608 
uy1
 = 
my
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
;

609 
uy2
 = 
uy1
 + 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2 - 1;

610 
uy3
 = 
uy1
 + 
glb_ds1
[
ds1_idx
].
tûe_h
 - 2;

612 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ux1
, 
uy2
, 
ux2
, 
uy1
, 168);

613 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ux3
, 
uy1
, 
ux4
, 
uy2
, 168);

614 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ux3
, 
uy3
, 
ux4
, 
uy2
, 168);

615 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ux1
, 
uy2
, 
ux2
, 
uy3
, 168);

617 i‡(
glb_ds1
[
ds1_idx
].
cur_zoom
 =
ZM_11
)

619 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
ux1
+8, 
uy2
-2, 0,

621 
w_±r
[
‹dî_d©a
[
n
].
idx
].
‹õ¡©i⁄
,

622 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›1
,

623 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›2
,

624 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›3
,

625 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›4


627 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
ux1
+7, 
uy2
-3, 255,

629 
w_±r
[
‹dî_d©a
[
n
].
idx
].
‹õ¡©i⁄
,

630 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›1
,

631 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›2
,

632 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›3
,

633 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›4


639 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
 + 
bt_idx
;

640 i‡–(
bt_±r
->
ty≥
 !
BT_WALL_UP
) &&

641 (
bt_±r
->
ty≥
 !
BT_WALL_DOWN
) &&

642 (
bt_±r
->
ty≥
 !
BT_SPECIAL
))

648 
dt1_idx
 = 
bt_±r
->dt1_idx;

649 
block_idx
 = 
bt_±r
->block_idx;

651 
tmp_bmp
 = * (
glb_dt1
[
dt1_idx
].
block_zoom
[
z
] + 
block_idx
);

653 i‡(
tmp_bmp
 =
NULL
)

656 
y1
 = 
my
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 -

657 
bt_±r
->
zîo_löe
 * 
glb_ds1
[
ds1_idx
].
height_mul
 / glb_ds1[ds1_idx].
height_div
;

658 
y1
 +
glb_ds1
[
ds1_idx
].
tûe_h
;

659 i‡–(
y1
 + 
tmp_bmp
->
h
) < 0)

661 i‡(
y1
 >
glb_ds1edô
.
wö_¥evõw
.
h
)

664 i‡(
glb_ds1edô
.
mode
 =
MOD_L
)

667 
di°
 = 
	`w¥evõw_light_di°
(

668 
mx
,

669 
my
 + (
glb_ds1
[
ds1_idx
].
tûe_h
 / 2),

670 
glb_ds1edô
.
wö_¥evõw
.
x0
 + 
mou£_x
,

671 
glb_ds1edô
.
wö_¥evõw
.
y0
 + 
mou£_y


673 i‡(
di°
 < 200)

674 
c1
 = 255;

675 i‡(
di°
 > 500)

676 
c1
 = 0;

678 
c1
 = 255 - ((
di°
 - 200) * 255 / (500 - 200));

681 
di°
 = 
	`w¥evõw_light_di°
(

682 
mx
 + 
tmp_bmp
->
w
,

683 
my
 + (
glb_ds1
[
ds1_idx
].
tûe_h
 / 2),

684 
glb_ds1edô
.
wö_¥evõw
.
x0
 + 
mou£_x
,

685 
glb_ds1edô
.
wö_¥evõw
.
y0
 + 
mou£_y


687 i‡(
di°
 < 200)

688 
c2
 = 255;

689 i‡(
di°
 > 500)

690 
c2
 = 0;

692 
c2
 = 255 - ((
di°
 - 200) * 255 / (500 - 200));

695 
	`w¥evõw_gouøud_w
(
tmp_bmp
,

696 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
, 
y1
,

697 
ds1_idx
,

698 
c1
, 
c2
, c2, c1);

702 i‡(
£À˘ed
)

704 i‡(
	`IS_COPY_INFO
(
w_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

706 
cﬁ‹
 = 
COL_PASTE_OK
;

707 i‡(
	`IS_COPY_STATE
(
w_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

708 
cﬁ‹
 = 
COL_PASTE_KO
;

710 i‡(
	`IS_TMP_SELECT
(
w_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

711 
cﬁ‹
 = 
COL_TMPSEL_M
;

712 i‡(
	`IS_SELECTED
(
w_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

713 
cﬁ‹
 = 
COL_WALL_M
;

715 
cﬁ‹
 = 
COL_MOUSE
;

719 i‡(
	`IS_COPY_INFO
(
w_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

721 
cﬁ‹
 = 
COL_PASTE_OK
;

722 i‡(
	`IS_COPY_STATE
(
w_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

723 
cﬁ‹
 = 
COL_PASTE_KO
;

725 i‡(
	`IS_TMP_SELECT
(
w_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

726 
cﬁ‹
 = 
COL_TMPSEL
;

727 i‡(
	`IS_SELECTED
(
w_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

728 
cﬁ‹
 = 
COL_WALL
;

730 i‡(
cﬁ‹
 != -1)

731 
	`w¥evõw_sh≠e
(
tmp_bmp
,

732 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
, 
y1
,

733 
ds1_idx
, 
cﬁ‹
);

735 
	`døw_•rôe
(
glb_ds1edô
.
s¸ìn_buff
, 
tmp_bmp
,

736 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
, 
y1
);

740 i‡(
bt_±r
->
‹õ¡©i⁄
 == 3)

743 
m
 = 
bt_±r
->
maö_ödex
;

744 
s
 = 
bt_±r
->
sub_ödex
;

745 
d⁄e
 = 
FALSE
;

746 
found
 = 
FALSE
;

747  ! 
d⁄e
)

749 i‡(
bt_idx
 >
glb_ds1
[
ds1_idx
].
bt_num
)

750 
d⁄e
 = 
TRUE
;

753 
bt_±r
++;

754 i‡(
bt_±r
->
‹õ¡©i⁄
 < 4)

755 
bt_idx
++;

758 i‡(
bt_±r
->
‹õ¡©i⁄
 == 4)

759 i‡((
bt_±r
->
maö_ödex
 =
m
Ë&& (bt_±r->
sub_ödex
 =
s
))

760 
d⁄e
 = 
found
 = 
TRUE
;

764 i‡(
found
 =
TRUE
)

766 
dt1_idx
 = 
bt_±r
->dt1_idx;

767 
block_idx
 = 
bt_±r
->block_idx;

768 
tmp_bmp
 = * (
glb_dt1
[
dt1_idx
].
block_zoom
[
z
] + 
block_idx
);

770 i‡(
tmp_bmp
 =
NULL
)

773 
y1
 = 
my
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 -

774 
bt_±r
->
zîo_löe
 * 
glb_ds1
[
ds1_idx
].
height_mul
 / glb_ds1[ds1_idx].
height_div
;

775 
y1
 +
glb_ds1
[
ds1_idx
].
tûe_h
;

776 i‡–(
y1
 + 
tmp_bmp
->
h
) < 0)

778 i‡(
y1
 >
glb_ds1edô
.
wö_¥evõw
.
h
)

781 i‡(
glb_ds1edô
.
mode
 =
MOD_L
)

783 
	`w¥evõw_gouøud_w
(
tmp_bmp
,

784 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
, 
y1
,

785 
ds1_idx
,

786 
c1
, 
c2
, c2, c1);

790 i‡(
cﬁ‹
 != -1)

791 
	`w¥evõw_sh≠e
(
tmp_bmp
,

792 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
, 
y1
,

793 
ds1_idx
, 
cﬁ‹
);

795 
	`døw_•rôe
(
glb_ds1edô
.
s¸ìn_buff
, 
tmp_bmp
,

796 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
, 
y1
);

801 
	}
}

806 
	$w¥evõw_døw_r
(
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
,

807 
£À˘ed
)

809 
BLOCK_TABLE_S
 * 
bt_±r
;

810 
BITMAP
 * 
tmp_bmp
;

811 
CELL_W_S
 * 
r_±r
;

812 
n
, 
t
, 
bt_idx
, 
dt1_idx
, 
block_idx
, 
y1
, 
cﬁ‹
;

813 
ORDER_DATA_S
 
‹dî_d©a
[4];

816 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

817 
r_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
t
;

819 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

821 
‹dî_d©a
[
n
].
idx
 =Ç;

822 
‹dî_d©a
[
n
].
height
 = 
r_±r
[n].
¥›1
;

824 
	`qs‹t
(
‹dî_d©a
, 
glb_ds1
[
ds1_idx
].
wÆl_num
, (
ORDER_DATA_S
),

825 
qs‹t_hñ≥r_‹dî_d©a
);

827 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

829 
cﬁ‹
 = -1;

830 i‡(
glb_ds1
[
ds1_idx
].
wÆl_œyî_mask
[
‹dî_d©a
[
n
].
idx
] == 0)

833 i‡(
	`IS_HIDE
(
r_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

836 
bt_idx
 = 
r_±r
[
‹dî_d©a
[
n
].
idx
].bt_idx;

838 i‡(
bt_idx
 <= 0)

841 i‡(
r_±r
[
‹dî_d©a
[
n
].
idx
].
¥›4
 & 0x80)

842 
bt_idx
 = -1;

844 i‡(
bt_idx
 <= 0)

847 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
 + 
bt_idx
;

849 i‡(
bt_±r
->
ty≥
 !
BT_ROOF
)

852 
dt1_idx
 = 
bt_±r
->dt1_idx;

853 
block_idx
 = 
bt_±r
->block_idx;

855 
tmp_bmp
 = * (
glb_dt1
[
dt1_idx
].
block_zoom
[
z
] + 
block_idx
);

857 i‡(
tmp_bmp
 =
NULL
)

860 
y1
 = 
my
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 -

861 
bt_±r
->
zîo_löe
 * 
glb_ds1
[
ds1_idx
].
height_mul
 / glb_ds1[ds1_idx].
height_div
;

864 
y1
 -
bt_±r
->
roof_y
 * 
glb_ds1
[
ds1_idx
].
height_mul
 / glb_ds1[ds1_idx].
height_div
;

866 i‡–(
y1
 + 
tmp_bmp
->
h
) < 0)

868 i‡(
y1
 >
glb_ds1edô
.
wö_¥evõw
.
h
)

871 i‡(
glb_ds1edô
.
mode
 =
MOD_L
)

874 i‡(
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 == -1)

875 
cﬁ‹_m≠
 = & 
glb_ds1edô
.
cm≠
[
CM_SHADOW
][
glb_ds1
[
ds1_idx
].
a˘
 - 1];

877 
cﬁ‹_m≠
 = & 
glb_ds1edô
.
cm≠
[
CM_SHADOW
][glb_ds1edô.
cmd_löe
.
f‹˚_∑l_num
 - 1];

878 
	`døw_lô_•rôe
(
glb_ds1edô
.
s¸ìn_buff
,

879 
tmp_bmp
,

880 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
,

881 
y1
,

887 i‡(
£À˘ed
)

889 i‡(
	`IS_COPY_INFO
(
r_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

891 
cﬁ‹
 = 
COL_PASTE_OK
;

892 i‡(
	`IS_COPY_STATE
(
r_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

893 
cﬁ‹
 = 
COL_PASTE_KO
;

895 i‡(
	`IS_TMP_SELECT
(
r_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

896 
cﬁ‹
 = 
COL_TMPSEL_M
;

897 i‡(
	`IS_SELECTED
(
r_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

898 
cﬁ‹
 = 
COL_WALL_M
;

900 
cﬁ‹
 = 
COL_MOUSE
;

904 i‡(
	`IS_COPY_INFO
(
r_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

906 
cﬁ‹
 = 
COL_PASTE_OK
;

907 i‡(
	`IS_COPY_STATE
(
r_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

908 
cﬁ‹
 = 
COL_PASTE_KO
;

910 i‡(
	`IS_TMP_SELECT
(
r_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

911 
cﬁ‹
 = 
COL_TMPSEL
;

912 i‡(
	`IS_SELECTED
(
r_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

913 
cﬁ‹
 = 
COL_WALL
;

915 i‡(
cﬁ‹
 != -1)

916 
	`w¥evõw_sh≠e
(
tmp_bmp
,

917 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
, 
y1
,

918 
ds1_idx
, 
cﬁ‹
);

920 
	`døw_•rôe
(
glb_ds1edô
.
s¸ìn_buff
, 
tmp_bmp
,

921 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
, 
y1
);

924 
	}
}

929 
	$w¥evõw_døw_•
(
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
,

930 
£À˘ed
)

932 
BLOCK_TABLE_S
 * 
bt_±r
;

933 
BITMAP
 * 
tmp_bmp
;

934 
CELL_W_S
 * 
w_±r
;

935 
n
, 
t
, 
bt_idx
, 
dt1_idx
, 
block_idx
, 
y1
, 
o
;

936 
cﬁ‹
;

937 
ORDER_DATA_S
 
‹dî_d©a
[4];

938 
di°
, 
c1
, 
c2
;

939 
ux1
, 
ux2
, 
ux3
, 
ux4
, 
uy1
, 
uy2
, 
uy3
;

942 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

943 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
t
;

945 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

947 
‹dî_d©a
[
n
].
idx
 =Ç;

948 
‹dî_d©a
[
n
].
height
 = 
w_±r
[n].
¥›1
;

949 i‡(
w_±r
[
n
].
‹õ¡©i⁄
 == 10)

950 
‹dî_d©a
[
n
].
height
 = 255;

952 
	`qs‹t
(
‹dî_d©a
, 
glb_ds1
[
ds1_idx
].
wÆl_num
, (
ORDER_DATA_S
),

953 
qs‹t_hñ≥r_‹dî_d©a
);

955 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

957 
cﬁ‹
 = -1;

958 i‡(
glb_ds1
[
ds1_idx
].
wÆl_œyî_mask
[
‹dî_d©a
[
n
].
idx
] == 0)

961 i‡(
	`IS_HIDE
(
w_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

964 
bt_idx
 = 
w_±r
[
‹dî_d©a
[
n
].
idx
].bt_idx;

966 i‡(
bt_idx
 == 0)

969 
o
 = 
w_±r
[
‹dî_d©a
[
n
].
idx
].
‹õ¡©i⁄
;

971 i‡((
o
 != 10) && (o != 11))

980 i‡(
bt_idx
 <= 0)

983 
ux1
 = 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
;

984 
ux2
 = 
ux1
 + 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2 - 1;

985 
ux3
 = 
ux1
 + 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

986 
ux4
 = 
ux1
 + 
glb_ds1
[
ds1_idx
].
tûe_w
 - 1;

988 
uy1
 = 
my
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
;

989 
uy2
 = 
uy1
 + 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2 - 1;

990 
uy3
 = 
uy1
 + 
glb_ds1
[
ds1_idx
].
tûe_h
 - 2;

992 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ux1
, 
uy2
, 
ux2
, 
uy1
, 168);

993 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ux3
, 
uy1
, 
ux4
, 
uy2
, 168);

994 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ux3
, 
uy3
, 
ux4
, 
uy2
, 168);

995 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
ux1
, 
uy2
, 
ux2
, 
uy3
, 168);

997 i‡(
glb_ds1
[
ds1_idx
].
cur_zoom
 =
ZM_11
)

999 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
ux1
+8, 
uy2
-2, 0,

1001 
w_±r
[
‹dî_d©a
[
n
].
idx
].
‹õ¡©i⁄
,

1002 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›1
,

1003 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›2
,

1004 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›3
,

1005 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›4


1007 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
ux1
+7, 
uy2
-3, 255,

1009 
w_±r
[
‹dî_d©a
[
n
].
idx
].
‹õ¡©i⁄
,

1010 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›1
,

1011 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›2
,

1012 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›3
,

1013 
w_±r
[
‹dî_d©a
[
n
].
idx
].
¥›4


1020 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
 + 
bt_idx
;

1021 
dt1_idx
 = 
bt_±r
->dt1_idx;

1022 
block_idx
 = 
bt_±r
->block_idx;

1024 
tmp_bmp
 = * (
glb_dt1
[
dt1_idx
].
block_zoom
[
z
] + 
block_idx
);

1026 i‡(
tmp_bmp
 =
NULL
)

1029 
y1
 = 
my
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 -

1030 
bt_±r
->
zîo_löe
 * 
glb_ds1
[
ds1_idx
].
height_mul
 / glb_ds1[ds1_idx].
height_div
;

1031 
y1
 +
glb_ds1
[
ds1_idx
].
tûe_h
;

1032 i‡–(
y1
 + 
tmp_bmp
->
h
) < 0)

1034 i‡(
y1
 >
glb_ds1edô
.
wö_¥evõw
.
h
)

1037 i‡(
glb_ds1edô
.
mode
 =
MOD_L
)

1040 
di°
 = 
	`w¥evõw_light_di°
(

1041 
mx
,

1042 
my
 + (
glb_ds1
[
ds1_idx
].
tûe_h
 / 2),

1043 
glb_ds1edô
.
wö_¥evõw
.
x0
 + 
mou£_x
,

1044 
glb_ds1edô
.
wö_¥evõw
.
y0
 + 
mou£_y


1046 i‡(
di°
 < 200)

1047 
c1
 = 255;

1048 i‡(
di°
 > 500)

1049 
c1
 = 0;

1051 
c1
 = 255 - ((
di°
 - 200) * 255 / (500 - 200));

1054 
di°
 = 
	`w¥evõw_light_di°
(

1055 
mx
 + 
tmp_bmp
->
w
,

1056 
my
 + (
glb_ds1
[
ds1_idx
].
tûe_h
 / 2),

1057 
glb_ds1edô
.
wö_¥evõw
.
x0
 + 
mou£_x
,

1058 
glb_ds1edô
.
wö_¥evõw
.
y0
 + 
mou£_y


1060 i‡(
di°
 < 200)

1061 
c2
 = 255;

1062 i‡(
di°
 > 500)

1063 
c2
 = 0;

1065 
c2
 = 255 - ((
di°
 - 200) * 255 / (500 - 200));

1068 
	`w¥evõw_gouøud_w
(
tmp_bmp
,

1069 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
, 
y1
,

1070 
ds1_idx
,

1071 
c1
, 
c2
, c2, c1);

1075 i‡(
£À˘ed
)

1077 i‡(
	`IS_COPY_INFO
(
w_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

1079 
cﬁ‹
 = 
COL_PASTE_OK
;

1080 i‡(
	`IS_COPY_STATE
(
w_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

1081 
cﬁ‹
 = 
COL_PASTE_KO
;

1083 i‡(
	`IS_TMP_SELECT
(
w_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

1084 
cﬁ‹
 = 
COL_TMPSEL_M
;

1085 i‡(
	`IS_SELECTED
(
w_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

1086 
cﬁ‹
 = 
COL_WALL_M
;

1088 
cﬁ‹
 = 
COL_MOUSE
;

1092 i‡(
	`IS_COPY_INFO
(
w_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

1094 
cﬁ‹
 = 
COL_PASTE_OK
;

1095 i‡(
	`IS_COPY_STATE
(
w_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

1096 
cﬁ‹
 = 
COL_PASTE_KO
;

1098 i‡(
	`IS_TMP_SELECT
(
w_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

1099 
cﬁ‹
 = 
COL_TMPSEL
;

1100 i‡(
	`IS_SELECTED
(
w_±r
[
‹dî_d©a
[
n
].
idx
].
Êags
))

1101 
cﬁ‹
 = 
COL_WALL
;

1103 i‡(
cﬁ‹
 != -1)

1104 
	`w¥evõw_sh≠e
(
tmp_bmp
,

1105 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
, 
y1
,

1106 
ds1_idx
, 
cﬁ‹
);

1108 
	`døw_•rôe
(
glb_ds1edô
.
s¸ìn_buff
, 
tmp_bmp
,

1109 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
, 
y1
);

1112 
	}
}

1117 
	$co‹d_to_tûe
(
ds1_idx
, 
ax
, 
ay
, * 
œyî_x
, * 
œyî_y
)

1119 
bx
, 
by
, 
cx
, 
cy
, 
rx
, 
ry
;

1122 i‡–(
glb_ds1edô
.
mode
 =
MOD_O
) ||

1123 (
glb_ds1edô
.
mode
 =
MOD_P
) ||

1124 (
glb_ds1edô
.
mode
 =
MOD_L
) )

1126 
ax
 *= 5;

1127 
ay
 *= 5;

1131 i‡(
ax
 < 0)

1132 
ax
 -
glb_ds1
[
ds1_idx
].
tûe_w
;

1133 i‡(
ay
 < 0)

1134 
ay
 -
glb_ds1
[
ds1_idx
].
tûe_h
;

1137 
bx
 = 
ax
 / 
glb_ds1
[
ds1_idx
].
tûe_w
;

1138 
by
 = 
ay
 / 
glb_ds1
[
ds1_idx
].
tûe_h
;

1139 
cx
 = 
bx
 + 
by
;

1140 
cy
 = -
bx
 + 
by
;

1143 
rx
 = 
ax
 % 
glb_ds1
[
ds1_idx
].
tûe_w
;

1144 
ry
 = 
ay
 % 
glb_ds1
[
ds1_idx
].
tûe_h
;

1145 i‡(
ax
 < 0Ë
rx
 = 
glb_ds1
[
ds1_idx
].
tûe_w
 +Ñx;

1146 i‡(
ay
 < 0Ë
ry
 = 
glb_ds1
[
ds1_idx
].
tûe_h
 +Ñy;

1148 i‡(
ry
 >-
rx
 / 2 + 
glb_ds1
[
ds1_idx
].
tûe_w
/2 + glb_ds1[ds1_idx].
tûe_h
/2Ë
cx
++;

1149 i‡(
ry
 < -
rx
 / 2 + 
glb_ds1
[
ds1_idx
].
tûe_h
/2Ë
cx
--;

1150 i‡(
glb_ds1
[
ds1_idx
].
tûe_w
/2 - 
ry
 >=

1151 -
rx
 / 2 + 
glb_ds1
[
ds1_idx
].
tûe_w
/2 + glb_ds1[ds1_idx].
tûe_h
/2Ë
cy
--;

1152 i‡(
glb_ds1
[
ds1_idx
].
tûe_w
/2 - 
ry
 < -
rx
 / 2 + glb_ds1[ds1_idx].
tûe_h
/2Ë
cy
++;

1155 * 
œyî_x
 = 
cx
;

1156 * 
œyî_y
 = 
cy
;

1157 
	}
}

1162 
	$mou£_to_tûe
(
ds1_idx
, * 
œyî_x
, * 
œyî_y
)

1164 
ax
, 
ay
;

1167 
ax
 = 
glb_ds1edô
.
wö_¥evõw
.
x0
 + 
mou£_x
;

1168 
ay
 = 
glb_ds1edô
.
wö_¥evõw
.
y0
 + 
mou£_y
;

1170 
	`co‹d_to_tûe
(
ds1_idx
, 
ax
, 
ay
, 
œyî_x
, 
œyî_y
);

1171 
	}
}

1176 
	$ch™ge_zoom
(
ds1_idx
, 
ZOOM_E
 
z
)

1178 
mul
, 
div
, 
dx
, 
dy
, 
cx
, 
cy
;

1180 i‡(
z
 < 
ZM_11
)

1181 
z
 = 
ZM_11
;

1182 i‡(
z
 > 
ZM_116
)

1183 
z
 = 
ZM_116
;

1185 
dx
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
x0
 + glb_ds1[ds1_idx].own_w¥evõw.
w
 / 2;

1186 
dy
 = 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
y0
 + glb_ds1[ds1_idx].own_w¥evõw.
h
 / 2;

1187 
	`co‹d_to_tûe
(
ds1_idx
, 
dx
, 
dy
, &
cx
, &
cy
);

1188 
cx
++;

1190 
z
)

1192 
ZM_11
 : 
mul
 = 1, 
div
 = 1; ;

1193 
ZM_12
 : 
mul
 = 1, 
div
 = 2; ;

1194 
ZM_14
 : 
mul
 = 1, 
div
 = 4; ;

1195 
ZM_18
 : 
mul
 = 1, 
div
 = 8; ;

1196 
ZM_116
 : 
mul
 = 1, 
div
 = 16; ;

1197  : 
mul
 = 1, 
div
 = 1; ;

1200 
glb_ds1
[
ds1_idx
].
cur_zoom
 = 
z
;

1201 
glb_ds1
[
ds1_idx
].
height_mul
 = 
mul
;

1202 
glb_ds1
[
ds1_idx
].
height_div
 = 
div
;

1203 
glb_ds1
[
ds1_idx
].
tûe_w
 = 160 * 
mul
 / 
div
;

1204 
glb_ds1
[
ds1_idx
].
tûe_h
 = 80 * 
mul
 / 
div
;

1205 i‡(
glb_c⁄fig
.
lowî_•ìd_zoom_out
)

1207 
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
keyb
.
x
 = 
glb_c⁄fig
.
s¸ﬁl
.keyb.x * 
mul
 / 
div
;

1208 
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
keyb
.
y
 = 
glb_c⁄fig
.
s¸ﬁl
.keyb.y * 
mul
 / 
div
;

1209 
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
mou£
.
x
 = 
glb_c⁄fig
.
s¸ﬁl
.mou£.x * 
mul
 / 
div
;

1210 
glb_ds1
[
ds1_idx
].
cur_s¸ﬁl
.
mou£
.
y
 = 
glb_c⁄fig
.
s¸ﬁl
.mou£.y * 
mul
 / 
div
;

1213 i‡(
glb_ds1edô
.
mode
 =
MOD_T
)

1215 
dx
 = (
cy
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2Ë+ (
cx
 * glb_ds1[ds1_idx].tile_w / 2);

1216 
dy
 = (
cy
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2Ë+ (
cx
 * glb_ds1[ds1_idx].tile_h / 2);

1220 
dx
 = (
cy
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 10Ë+ (
cx
 * glb_ds1[ds1_idx].tile_w / 10);

1221 
dy
 = (
cy
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 10Ë+ (
cx
 * glb_ds1[ds1_idx].tile_h / 10);

1224 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
x0
 = 
dx
 - glb_ds1[ds1_idx].own_w¥evõw.
w
 / 2;

1225 
glb_ds1
[
ds1_idx
].
own_w¥evõw
.
y0
 = 
dy
 - glb_ds1[ds1_idx].own_w¥evõw.
h
 / 2;

1226 
	}
}

1231 
	$w¥evõw_døw_∑ths
(
ds1_idx
)

1233 
x
, 
y
, 
dx
, 
dy
, 
o
, 
p
, 
x1
, 
y1
, 
x2
, 
y2
, 
cﬁ‹1
, 
cﬁ‹2
;

1235 
o
=0; o < 
glb_ds1
[
ds1_idx
].
obj_num
; o++)

1237 i‡(
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th_num
 == 0)

1241 i‡(
	`IS_SELECTED
(
glb_ds1
[
ds1_idx
].
obj
[
o
].
Êags
Ë|| IS_SELECTED(glb_ds1[ds1_idx].obj[o].
œbñ
.flags))

1243 
cﬁ‹1
 = 255;

1244 
cﬁ‹2
 = 10;

1248 
cﬁ‹1
 = 219;

1249 
cﬁ‹2
 = 155;

1254 i‡(
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th_num
)

1257 
x
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].x;

1258 
y
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].y;

1260 
dx
 = ((
y
-2Ë* -
glb_ds1
[
ds1_idx
].
tûe_w
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_w / 10);

1261 
dy
 = ((
y
-2Ë* 
glb_ds1
[
ds1_idx
].
tûe_h
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_h / 10);

1263 
x1
 = 
dx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
;

1264 
y1
 = 
dy
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 - 1;

1267 
x
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[0].x;

1268 
y
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[0].y;

1270 
dx
 = ((
y
-2Ë* -
glb_ds1
[
ds1_idx
].
tûe_w
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_w / 10);

1271 
dy
 = ((
y
-2Ë* 
glb_ds1
[
ds1_idx
].
tûe_h
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_h / 10);

1273 
x2
 = 
dx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
;

1274 
y2
 = 
dy
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 - 1;

1277 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
+1, 
y1
+1, 
x2
+1, 
y2
+1, 0);

1278 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 
cﬁ‹1
);

1282 
p
=0;Ö < 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th_num
;Ö++)

1285 
x
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[
p
].x;

1286 
y
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[
p
].y;

1288 
dx
 = ((
y
-2Ë* -
glb_ds1
[
ds1_idx
].
tûe_w
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_w / 10);

1289 
dy
 = ((
y
-2Ë* 
glb_ds1
[
ds1_idx
].
tûe_h
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_h / 10);

1291 
x1
 = 
dx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
;

1292 
y1
 = 
dy
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 - 1;

1295 i‡(
p
 =
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th_num
 - 1)

1297 
x
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[0].x;

1298 
y
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[0].y;

1302 
x
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[
p
 + 1].x;

1303 
y
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[
p
 + 1].y;

1306 
dx
 = ((
y
-2Ë* -
glb_ds1
[
ds1_idx
].
tûe_w
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_w / 10);

1307 
dy
 = ((
y
-2Ë* 
glb_ds1
[
ds1_idx
].
tûe_h
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_h / 10);

1309 
x2
 = 
dx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
;

1310 
y2
 = 
dy
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 - 1;

1313 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
+1, 
y1
+1, 
x2
+1, 
y2
+1, 0);

1314 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 
cﬁ‹2
);

1317 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, x1+2, y1+2, 0);

1318 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
-1, 
y1
-1, x1+1, y1+1, 157);

1321 
	}
}

1326 
	$w¥evõw_døw_∑ths_1obj
(
ds1_idx
, 
o
)

1328 
x
, 
y
, 
dx
, 
dy
, 
p
, 
x1
, 
y1
, 
x2
, 
y2
, 
cﬁ‹
;

1331 i‡((
o
 < 0Ë|| (ÿ>
glb_ds1
[
ds1_idx
].
cuºít_obj_max
))

1334 i‡(
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th_num
 == 0)

1338 i‡(
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th_num
)

1341 
x
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].x;

1342 
y
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].y;

1344 
dx
 = ((
y
-2Ë* -
glb_ds1
[
ds1_idx
].
tûe_w
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_w / 10);

1345 
dy
 = ((
y
-2Ë* 
glb_ds1
[
ds1_idx
].
tûe_h
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_h / 10);

1347 
x1
 = 
dx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
;

1348 
y1
 = 
dy
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 - 1;

1351 
x
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[0].x;

1352 
y
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[0].y;

1354 
dx
 = ((
y
-2Ë* -
glb_ds1
[
ds1_idx
].
tûe_w
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_w / 10);

1355 
dy
 = ((
y
-2Ë* 
glb_ds1
[
ds1_idx
].
tûe_h
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_h / 10);

1357 
x2
 = 
dx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
;

1358 
y2
 = 
dy
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 - 1;

1361 
cﬁ‹
 = 219;

1362 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
+1, 
y1
+1, 
x2
+1, 
y2
+1, 0);

1363 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 
cﬁ‹
);

1367 
p
=0;Ö < 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th_num
;Ö++)

1370 
x
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[
p
].x;

1371 
y
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[
p
].y;

1373 
dx
 = ((
y
-2Ë* -
glb_ds1
[
ds1_idx
].
tûe_w
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_w / 10);

1374 
dy
 = ((
y
-2Ë* 
glb_ds1
[
ds1_idx
].
tûe_h
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_h / 10);

1376 
x1
 = 
dx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
;

1377 
y1
 = 
dy
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 - 1;

1380 i‡(
p
 =
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th_num
 - 1)

1382 
x
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[0].x;

1383 
y
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[0].y;

1387 
x
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[
p
 + 1].x;

1388 
y
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
∑th
[
p
 + 1].y;

1391 
dx
 = ((
y
-2Ë* -
glb_ds1
[
ds1_idx
].
tûe_w
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_w / 10);

1392 
dy
 = ((
y
-2Ë* 
glb_ds1
[
ds1_idx
].
tûe_h
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_h / 10);

1394 
x2
 = 
dx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
;

1395 
y2
 = 
dy
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 - 1;

1398 
cﬁ‹
 = 155;

1399 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
+1, 
y1
+1, 
x2
+1, 
y2
+1, 0);

1400 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 
cﬁ‹
);

1403 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, x1+2, y1+2, 0);

1404 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
-1, 
y1
-1, x1+1, y1+1, 157);

1406 
	}
}

1410 
	$w¥evõw_obj_™im©e
()

1412 
TXT_S
 * 
txt
 = 
glb_ds1edô
.
obj_buff
;

1413 
COF_S
 * 
cof
;

1414 
o
;

1415 
n
, 
nb_ticks
 = 
glb_ds1edô
.
ticks_ñ≠£d
;

1418 
glb_ds1edô
.
ticks_ñ≠£d
 = 0;

1420 i‡(
txt
 =
NULL
)

1424 
o
=0; o < 
txt
->
löe_num
; o++)

1426 i‡(
glb_ds1edô
.
obj_desc
[
o
].
ußge_cou¡
)

1428 
cof
 = 
glb_ds1edô
.
obj_desc
[
o
].cof;

1429 i‡(
cof
 =
NULL
)

1431 i‡(
cof
->
Âd
 == 0)

1433 i‡(
cof
->
•d_div
 == 0)

1435 
n
 = 
nb_ticks
 * 
cof
->
•d_mul
 + cof->
•d_mod
;

1436 
cof
->
cur_‰ame
 +
n
 / cof->
•d_div
;

1437 
cof
->
•d_mod
 = 
n
 % cof->
•d_div
;

1438 
cof
->
cur_‰ame
 >cof->
Âd
)

1439 
cof
->
cur_‰ame
 -cof->
Âd
;

1442 
	}
}

1447 
	$w¥evõw_døw_obje˘s
(
ds1_idx
)

1449 
dx
, 
dy
, 
o
, 
x1
, 
y1
, 
d
;

1450 
ty≥
, 
id
, 
x
, 
y
;

1453 
o
=0; o < 
glb_ds1
[
ds1_idx
].
obj_num
; o++)

1455 
ty≥
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].type;

1456 
id
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].id;

1457 
x
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].x;

1458 
y
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].y;

1459 
d
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
desc_idx
;

1461 
dx
 = ((
y
-2Ë* -
glb_ds1
[
ds1_idx
].
tûe_w
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_w / 10);

1462 
dy
 = ((
y
-2Ë* 
glb_ds1
[
ds1_idx
].
tûe_h
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_h / 10);

1464 i‡(
glb_ds1
[
ds1_idx
].
obje˘s_œyî_mask
 =
OL_DESC
)

1467 i‡(
d
 != -1)

1469 i‡(
glb_ds1edô
.
obj_desc
[
d
].
desc
[0] == '?')

1470 
d
 = -1;

1474 
x1
 = 
dx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
 -

1475 (8 * 
	`°æí
(
glb_ds1edô
.
obj_desc
[
d
].
desc
) / 2);

1476 
y1
 = 
dy
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 - 4;

1478 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x1
+1, 
y1
+1, 0, "%s",

1479 
glb_ds1edô
.
obj_desc
[
d
].
desc
);

1481 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x1
, 
y1
, 255, "%s",

1482 
glb_ds1edô
.
obj_desc
[
d
].
desc
);

1487 i‡((
glb_ds1
[
ds1_idx
].
obje˘s_œyî_mask
 =
OL_TYPEID
Ë|| (
d
 == -1))

1490 
x1
 = 
dx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
 - 20;

1491 
y1
 = 
dy
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 - 4;

1493 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x1
+1, 
y1
+1, 0, "%i,%3i",

1494 
glb_ds1
[
ds1_idx
].
obj
[
o
].
ty≥
, glb_ds1[ds1_idx].obj[o].
id
);

1496 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x1
, 
y1
, 11, "%i",

1497 
glb_ds1
[
ds1_idx
].
obj
[
o
].
ty≥
);

1499 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
x1
+8, 
y1
, 255, ",%3i",

1500 
glb_ds1
[
ds1_idx
].
obj
[
o
].
id
);

1503 
	}
}

1508 
	$w¥evõw_døw_sim∂e_wi
(
mx
, 
my
, 
z
, 
UBYTE
 * 
wÆköfo
)

1510 
i
;

1512 
i
=0; i<25; i++)

1514 i‡(
wÆköfo
[
i
] & 0x04)

1516 
	`døw_æe_•rôe
(
glb_ds1edô
.
s¸ìn_buff
,

1517 
glb_ds1edô
.
subtûe_nojump
[
z
][
i
],

1518 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
,

1519 
my
 - 
glb_ds1edô
.
wö_¥evõw
.
y0


1522 i‡(
wÆköfo
[
i
] & 0x09)

1524 
	`døw_æe_•rôe
(
glb_ds1edô
.
s¸ìn_buff
,

1525 
glb_ds1edô
.
subtûe_nowÆk
[
z
][
i
],

1526 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
,

1527 
my
 - 
glb_ds1edô
.
wö_¥evõw
.
y0


1531 
	}
}

1536 
	$w¥evõw_døw_wi
(
mx
, 
my
, 
z
, 
UBYTE
 * 
wÆköfo
)

1538 
i
;

1540 
i
=0; i<25; i++)

1542 i‡(
wÆköfo
[
i
])

1544 
	`døw_æe_•rôe
(

1545 
glb_ds1edô
.
s¸ìn_buff
,

1546 
glb_ds1edô
.
subtûe_Êag_combö©i⁄
[
wÆköfo
[
i
]][
z
][i],

1547 
mx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
,

1548 
my
 - 
glb_ds1edô
.
wö_¥evõw
.
y0


1552 
	}
}

1556 
	$w¥evõw_døw_™_obje˘
(
ds1_idx
, 
o
)

1558 
COF_S
 * 
cof
;

1559 
LAY_INF_S
 * 
œy
;

1560 
BITMAP
 ** 
bmp_±r
, * 
bmp
;

1561 
c
, 
f
, 
x
, 
y
, 
d
, 
dx0
, 
dy0
, 
dx
, 
dy
, 
p
, 
cﬁ_bœck
, 
cﬁ_whôe
;

1562 
UBYTE
 * 
b±r
;

1563 
UBYTE
 
√w_‰ame
;

1566 
d
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
desc_idx
;

1568 i‡(
d
 == -1)

1571 i‡(
glb_ds1edô
.
obj_desc
[
d
].
ußge_cou¡
 == 0)

1574 
cof
 = 
glb_ds1edô
.
obj_desc
[
d
].cof;

1575 i‡(
cof
 =
NULL
)

1577 i‡(
cof
->
Âd
 == 0)

1580 
√w_‰ame
 = 
cof
->
cur_‰ame
 + 
glb_ds1
[
ds1_idx
].
obj
[
o
].
‰ame_dñè
;

1581 
√w_‰ame
 >
cof
->
Âd
)

1582 
√w_‰ame
 -
cof
->
Âd
;

1584 
x
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].x;

1585 
y
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].y;

1586 
dx0
 = ((
y
-2Ë* -
glb_ds1
[
ds1_idx
].
tûe_w
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_w / 10);

1587 
dy0
 = 4 + ((
y
-2Ë* 
glb_ds1
[
ds1_idx
].
tûe_h
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_h / 10);

1589 
cﬁ_bœck
 = 
	`makecﬁ
( 0, 0, 0);

1590 
cﬁ_whôe
 = 
	`makecﬁ
(255, 255, 255);

1593 
c
=0; c < 
cof
->
œy
; c++)

1595 
p
 = (
cof
->
cur_dú
 * cof->
œy
 * cof->
Âd
);

1596 
p
 +
c
 + (
√w_‰ame
 * 
cof
->
œy
);

1597 
p
 = 
cof
->
¥i‹ôy
[p];

1598 i‡(
p
 >
COMPOSIT_NB
)

1601 
œy
 = & 
cof
->
œy_öf
[
p
];

1602 i‡(
œy
 =
NULL
)

1604 
bmp_±r
 = 
œy
->
bmp
;

1605 i‡(
bmp_±r
 =
NULL
)

1607 i‡(
√w_‰ame
 >
œy
->
bmp_num
)

1608 
f
 = 
œy
->
œ°_good_‰ame
;

1610 
f
 = 
√w_‰ame
;

1611 
bmp
 = 
bmp_±r
[
f
];

1612 i‡(
bmp
 =
NULL
)

1614 
dx
 = 
dx0
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
 + 
cof
->
xoff£t
 + 
œy
->
off_x
;

1615 
dy
 = 
dy0
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 + 
cof
->
yoff£t
 + 
œy
->
off_y
;

1616 i‡(((
dx
 + 
bmp
->
w
Ë< 0Ë|| ((
dy
 + bmp->
h
) < 0))

1618 i‡–(
dx
 >
glb_ds1edô
.
wö_¥evõw
.
w
) ||

1619 (
dy
 >
glb_ds1edô
.
wö_¥evõw
.
h
))

1622 i‡((
glb_ds1
[
ds1_idx
].
cur_zoom
 =
ZM_11
Ë|| (
glb_c⁄fig
.
°ªtch_•rôes
 !
TRUE
))

1625 i‡((
œy
->
å™s_a
Ë&& (œy->
å™s_b
 <= 6) && (lay->trans_b != 5))

1628 i‡(
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 == -1)

1629 
b±r
 = 
glb_ds1edô
.
d2_∑l
[
glb_ds1
[
ds1_idx
].
a˘
 - 1];

1631 
b±r
 = 
glb_ds1edô
.
d2_∑l
[glb_ds1edô.
cmd_löe
.
f‹˚_∑l_num
 - 1];

1632 
œy
->
å™s_b
)

1634 0 : 
b±r
 +(256 * 
COF_75TRANS
); ;

1635 1 : 
b±r
 +(256 * 
COF_50TRANS
); ;

1636 2 : 
b±r
 +(256 * 
COF_25TRANS
); ;

1637 3 : 
b±r
 +(256 * 
COF_ALPHA
); ;

1638 4 : 
b±r
 +(256 * 
COF_LUMINANCE
); ;

1639 6 : 
b±r
 +(256 * 
COF_ALPHABRIGHT
); ;

1641 
cﬁ‹_m≠
 = (
COLOR_MAP
 *Ë
b±r
;

1642 
	`døw_å™s_•rôe
(
glb_ds1edô
.
s¸ìn_buff
, 
bmp
, 
dx
, 
dy
);

1647 
	`døw_•rôe
(
glb_ds1edô
.
s¸ìn_buff
, 
bmp
, 
dx
, 
dy
);

1653 
dx
 = 
dx0
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
 +

1654 (
cof
->
xoff£t
 * 
glb_ds1
[
ds1_idx
].
height_mul
 / glb_ds1[ds1_idx].
height_div
) +

1655 (
œy
->
off_x
 * 
glb_ds1
[
ds1_idx
].
height_mul
 / glb_ds1[ds1_idx].
height_div
);

1657 
dy
 = 
dy0
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 +

1658 (
cof
->
yoff£t
 * 
glb_ds1
[
ds1_idx
].
height_mul
 / glb_ds1[ds1_idx].
height_div
) +

1659 (
œy
->
off_y
 * 
glb_ds1
[
ds1_idx
].
height_mul
 / glb_ds1[ds1_idx].
height_div
);

1661 i‡((
œy
->
å™s_a
Ë&& (œy->
å™s_b
 <= 6) && (lay->trans_b != 5))

1664 i‡(
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 == -1)

1665 
b±r
 = 
glb_ds1edô
.
d2_∑l
[
glb_ds1
[
ds1_idx
].
a˘
 - 1];

1667 
b±r
 = 
glb_ds1edô
.
d2_∑l
[glb_ds1edô.
cmd_löe
.
f‹˚_∑l_num
 - 1];

1668 
œy
->
å™s_b
)

1670 0 : 
b±r
 +(256 * 
COF_75TRANS
); ;

1671 1 : 
b±r
 +(256 * 
COF_50TRANS
); ;

1672 2 : 
b±r
 +(256 * 
COF_25TRANS
); ;

1673 3 : 
b±r
 +(256 * 
COF_ALPHA
); ;

1674 4 : 
b±r
 +(256 * 
COF_LUMINANCE
); ;

1675 6 : 
b±r
 +(256 * 
COF_ALPHABRIGHT
); ;

1677 
cﬁ‹_m≠
 = (
COLOR_MAP
 *Ë
b±r
;

1682 
cﬁ‹_m≠
 = 
NULL
;

1685 
	`°ªtch_å™s_•rôe_8bµ
(

1686 
glb_ds1edô
.
s¸ìn_buff
,

1687 
bmp
,

1688 
dx
,

1689 
dy
,

1690 
glb_ds1
[
ds1_idx
].
height_div


1695 i‡(
√w_‰ame
 < 
œy
->
bmp_num
)

1696 
œy
->
œ°_good_‰ame
 = 
f
;

1700 i‡(
glb_ds1edô
.
mode
 =
MOD_O
)

1704 i‡(
glb_ds1
[
ds1_idx
].
obje˘s_œyî_mask
 =
OL_SPEED
)

1706 
dx
 = 
dx0
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
 - 44;

1707 
dy
 = 
dy0
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 - 8;

1709 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
dx
+1, 
dy
+1, 
cﬁ_bœck
,

1710 "•ìd = %3li", 
cof
->
•d_mul
);

1712 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
dx
, 
dy
, 
cﬁ_whôe
,

1713 "•ìd = %3li", 
cof
->
•d_mul
);

1715 
	}
}

1719 
	$w¥evõw_døw_™_obje˘_shad
(
ds1_idx
, 
o
)

1721 
COF_S
 * 
cof
;

1722 
LAY_INF_S
 * 
œy
;

1723 
BITMAP
 ** 
bmp_±r
, * 
bmp
;

1724 
c
, 
f
, 
x
, 
y
, 
d
, 
dx0
, 
dy0
, 
dx
, 
dy
, 
p
, 
offx
, 
offy
;

1725 
UBYTE
 * 
b±r
;

1726 
UBYTE
 
√w_‰ame
;

1728 
d
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
desc_idx
;

1730 i‡(
d
 == -1)

1733 i‡(
glb_ds1edô
.
obj_desc
[
d
].
ußge_cou¡
 == 0)

1736 
cof
 = 
glb_ds1edô
.
obj_desc
[
d
].cof;

1737 i‡(
cof
 =
NULL
)

1739 i‡(
cof
->
Âd
 == 0)

1742 
√w_‰ame
 = 
cof
->
cur_‰ame
 + 
glb_ds1
[
ds1_idx
].
obj
[
o
].
‰ame_dñè
;

1743 
√w_‰ame
 >
cof
->
Âd
)

1744 
√w_‰ame
 -
cof
->
Âd
;

1746 
x
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].x;

1747 
y
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].y;

1749 
dx0
 = ((
y
-2Ë* -
glb_ds1
[
ds1_idx
].
tûe_w
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_w / 10);

1750 
dy0
 = 4 + ((
y
-2Ë* 
glb_ds1
[
ds1_idx
].
tûe_h
 / 10Ë+ ((
x
+3) * glb_ds1[ds1_idx].tile_h / 10);

1753 
c
=0; c < 
cof
->
œy
; c++)

1755 
p
 = (
cof
->
cur_dú
 * cof->
œy
 * cof->
Âd
);

1756 
p
 +
c
 + (
√w_‰ame
 * 
cof
->
œy
);

1757 
p
 = 
cof
->
¥i‹ôy
[p];

1758 i‡(
p
 >
COMPOSIT_NB
)

1761 
œy
 = & 
cof
->
œy_öf
[
p
];

1762 i‡(
œy
 =
NULL
)

1766 i‡(
œy
->
shad_a
 == 0)

1769 
bmp_±r
 = 
œy
->
bmp
;

1770 i‡(
bmp_±r
 =
NULL
)

1772 i‡(
√w_‰ame
 >
œy
->
bmp_num
)

1773 
f
 = 
œy
->
œ°_good_‰ame
;

1775 
f
 = 
√w_‰ame
;

1776 
bmp
 = 
bmp_±r
[
f
];

1777 i‡(
bmp
 =
NULL
)

1779 
dx
 = 
dx0
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
 + 
cof
->
xoff£t
 + 
œy
->
off_x
;

1780 
dy
 = 
dy0
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 + 
cof
->
yoff£t
 + 
œy
->
off_y
;

1781 i‡(((
dx
 + 
bmp
->
w
Ë< 0Ë|| ((
dy
 + bmp->
h
) < 0))

1783 i‡–(
dx
 >
glb_ds1edô
.
wö_¥evõw
.
w
) ||

1784 (
dy
 >
glb_ds1edô
.
wö_¥evõw
.
h
))

1789 i‡(
œy
->
å™s_a
)

1792 i‡(
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 == -1)

1793 
b±r
 = 
glb_ds1edô
.
d2_∑l
[
glb_ds1
[
ds1_idx
].
a˘
 - 1];

1795 
b±r
 = 
glb_ds1edô
.
d2_∑l
[glb_ds1edô.
cmd_löe
.
f‹˚_∑l_num
 - 1];

1796 
b±r
 += (256 * 32);

1801 i‡(
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 == -1)

1802 
b±r
 = 
glb_ds1edô
.
d2_∑l
[
glb_ds1
[
ds1_idx
].
a˘
 - 1];

1804 
b±r
 = 
glb_ds1edô
.
d2_∑l
[glb_ds1edô.
cmd_löe
.
f‹˚_∑l_num
 - 1];

1805 
b±r
 += (256 * 14);

1808 i‡((
glb_ds1
[
ds1_idx
].
cur_zoom
 =
ZM_11
Ë|| (
glb_c⁄fig
.
°ªtch_•rôes
 !
TRUE
))

1810 
offx
 = 
cof
->
xoff£t
 + 
œy
->
off_x
;

1811 
offy
 = 
cof
->
yoff£t
 + 
œy
->
off_y
;

1813 
dx
 = 
dx0
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
 + 
offx
;

1814 
dy
 = 
dy0
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 + 
offy
;

1816 
	`°ªtch_å™s_shadow_8bµ
(

1817 
glb_ds1edô
.
s¸ìn_buff
,

1818 
bmp
,

1819 
dx
,

1820 
dy
,

1822 
b±r
,

1823 
dy0
 - 
glb_ds1edô
.
wö_¥evõw
.
y0


1828 
offx
 = (
cof
->
xoff£t
 * 
glb_ds1
[
ds1_idx
].
height_mul
 / glb_ds1[ds1_idx].
height_div
) +

1829 (
œy
->
off_x
 * 
glb_ds1
[
ds1_idx
].
height_mul
 / glb_ds1[ds1_idx].
height_div
);

1831 
offy
 = (
cof
->
yoff£t
 * 
glb_ds1
[
ds1_idx
].
height_mul
 / glb_ds1[ds1_idx].
height_div
) +

1832 (
œy
->
off_y
 * 
glb_ds1
[
ds1_idx
].
height_mul
 / glb_ds1[ds1_idx].
height_div
);

1834 
dx
 = 
dx0
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
 + 
offx
;

1835 
dy
 = 
dy0
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
 + 
offy
;

1837 
	`°ªtch_å™s_shadow_8bµ
(

1838 
glb_ds1edô
.
s¸ìn_buff
,

1839 
bmp
,

1840 
dx
,

1841 
dy
,

1842 
glb_ds1
[
ds1_idx
].
height_div
,

1843 
b±r
,

1844 
dy0
 - 
glb_ds1edô
.
wö_¥evõw
.
y0


1848 
	}
}

1852 
	$w¥evõw_døw_obj_tûe_shad
(
ds1_idx
, 
x
, 
y
, * 
cur_idx
)

1854 
OBJ_S
 * 
obj
;

1855 
o
;

1859 i‡((* 
cur_idx
Ë>
glb_ds1
[
ds1_idx
].
obj_num
)

1863 
o
 = 
glb_ds1
[
ds1_idx
].
døwög_‹dî
[* 
cur_idx
];

1864 
obj
 = & 
glb_ds1
[
ds1_idx
].obj[
o
];

1865 
obj
->
ty
 < 
y
)

1867 (* 
cur_idx
) ++;

1868 i‡–(* 
cur_idx
Ë>
glb_ds1
[
ds1_idx
].
obj_num
 )

1870 
o
 = 
glb_ds1
[
ds1_idx
].
døwög_‹dî
[* 
cur_idx
];

1871 
obj
 = & 
glb_ds1
[
ds1_idx
].obj[
o
];

1873 i‡(
obj
->
ty
 =
y
)

1875 
obj
->
tx
 < 
x
)

1877 (* 
cur_idx
) ++;

1878 i‡–(* 
cur_idx
Ë>
glb_ds1
[
ds1_idx
].
obj_num
 )

1880 
o
 = 
glb_ds1
[
ds1_idx
].
døwög_‹dî
[* 
cur_idx
];

1881 
obj
 = & 
glb_ds1
[
ds1_idx
].obj[
o
];

1890 i‡((
obj
->
tx
 =
x
Ë&& (obj->
ty
 =
y
))

1893 
	`w¥evõw_døw_™_obje˘_shad
(
ds1_idx
, 
o
);

1896 (* 
cur_idx
) ++;

1897 i‡–(* 
cur_idx
Ë>
glb_ds1
[
ds1_idx
].
obj_num
)

1899 
o
 = 
glb_ds1
[
ds1_idx
].
døwög_‹dî
[* 
cur_idx
];

1900 
obj
 = & 
glb_ds1
[
ds1_idx
].obj[
o
];

1905 
	}
}

1909 
	$w¥evõw_døw_obj_tûe_0_2
(
ds1_idx
, 
x
, 
y
, * 
cur_idx
)

1911 
OBJ_S
 * 
obj
;

1912 
o
, 
d
;

1913 
COF_S
 * 
cof
;

1917 i‡((* 
cur_idx
Ë>
glb_ds1
[
ds1_idx
].
obj_num
)

1921 
o
 = 
glb_ds1
[
ds1_idx
].
døwög_‹dî
[* 
cur_idx
];

1922 
obj
 = & 
glb_ds1
[
ds1_idx
].obj[
o
];

1923 
obj
->
ty
 < 
y
)

1925 (* 
cur_idx
) ++;

1926 i‡–(* 
cur_idx
Ë>
glb_ds1
[
ds1_idx
].
obj_num
 )

1928 
o
 = 
glb_ds1
[
ds1_idx
].
døwög_‹dî
[* 
cur_idx
];

1929 
obj
 = & 
glb_ds1
[
ds1_idx
].obj[
o
];

1931 i‡(
obj
->
ty
 =
y
)

1933 
obj
->
tx
 < 
x
)

1935 (* 
cur_idx
) ++;

1936 i‡–(* 
cur_idx
Ë>
glb_ds1
[
ds1_idx
].
obj_num
 )

1938 
o
 = 
glb_ds1
[
ds1_idx
].
døwög_‹dî
[* 
cur_idx
];

1939 
obj
 = & 
glb_ds1
[
ds1_idx
].obj[
o
];

1948 i‡((
obj
->
tx
 =
x
Ë&& (obj->
ty
 =
y
))

1951 
d
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
desc_idx
;

1952 i‡(
d
 != -1)

1954 i‡(
glb_ds1edô
.
obj_desc
[
d
].
ußge_cou¡
)

1956 
cof
 = 
glb_ds1edô
.
obj_desc
[
d
].cof;

1957 i‡(
cof
 !
NULL
)

1959 i‡((
cof
->
‹dîÊag
 == 0) || (cof->orderflag == 2))

1960 
	`w¥evõw_døw_™_obje˘
(
ds1_idx
, 
o
);

1966 (* 
cur_idx
) ++;

1967 i‡–(* 
cur_idx
Ë>
glb_ds1
[
ds1_idx
].
obj_num
)

1969 
o
 = 
glb_ds1
[
ds1_idx
].
døwög_‹dî
[* 
cur_idx
];

1970 
obj
 = & 
glb_ds1
[
ds1_idx
].obj[
o
];

1975 
	}
}

1979 
	$w¥evõw_døw_obj_tûe_1
(
ds1_idx
, 
x
, 
y
, * 
cur_idx
)

1981 
OBJ_S
 * 
obj
;

1982 
o
, 
d
;

1983 
COF_S
 * 
cof
;

1987 i‡((* 
cur_idx
Ë>
glb_ds1
[
ds1_idx
].
obj_num
)

1991 
o
 = 
glb_ds1
[
ds1_idx
].
døwög_‹dî
[* 
cur_idx
];

1992 
obj
 = & 
glb_ds1
[
ds1_idx
].obj[
o
];

1993 
obj
->
ty
 < 
y
)

1995 (* 
cur_idx
) ++;

1996 i‡–(* 
cur_idx
Ë>
glb_ds1
[
ds1_idx
].
obj_num
 )

1998 
o
 = 
glb_ds1
[
ds1_idx
].
døwög_‹dî
[* 
cur_idx
];

1999 
obj
 = & 
glb_ds1
[
ds1_idx
].obj[
o
];

2001 i‡(
obj
->
ty
 =
y
)

2003 
obj
->
tx
 < 
x
)

2005 (* 
cur_idx
) ++;

2006 i‡–(* 
cur_idx
Ë>
glb_ds1
[
ds1_idx
].
obj_num
 )

2008 
o
 = 
glb_ds1
[
ds1_idx
].
døwög_‹dî
[* 
cur_idx
];

2009 
obj
 = & 
glb_ds1
[
ds1_idx
].obj[
o
];

2018 i‡((
obj
->
tx
 =
x
Ë&& (obj->
ty
 =
y
))

2021 
d
 = 
glb_ds1
[
ds1_idx
].
obj
[
o
].
desc_idx
;

2022 i‡(
d
 != -1)

2024 i‡(
glb_ds1edô
.
obj_desc
[
d
].
ußge_cou¡
)

2026 
cof
 = 
glb_ds1edô
.
obj_desc
[
d
].cof;

2027 i‡(
cof
 !
NULL
)

2029 i‡(
cof
->
‹dîÊag
 == 1)

2030 
	`w¥evõw_døw_™_obje˘
(
ds1_idx
, 
o
);

2036 (* 
cur_idx
) ++;

2037 i‡–(* 
cur_idx
Ë>
glb_ds1
[
ds1_idx
].
obj_num
)

2039 
o
 = 
glb_ds1
[
ds1_idx
].
døwög_‹dî
[* 
cur_idx
];

2040 
obj
 = & 
glb_ds1
[
ds1_idx
].obj[
o
];

2045 
	}
}

2050 
	$w¥evõw_døw_tûe_grid
(
ds1_idx
)

2052 
tw
, 
th
, 
dw
, 
dh
, 
px
, 
py
, 
ba£_x
, 
ba£_y
, 
mx
, 
my
, 
c
, 
i
, 
x1
, 
y1
, 
x2
, 
y2
;

2053 
mö_x
, 
mö_y
, 
max_x
, 
max_y
, 
dummy
;

2056 
tw
 = 
glb_ds1
[
ds1_idx
].
tûe_w
;

2057 
th
 = 
glb_ds1
[
ds1_idx
].
tûe_h
;

2058 
dw
 = 
glb_ds1
[
ds1_idx
].
width
;

2059 
dh
 = 
glb_ds1
[
ds1_idx
].
height
;

2060 
px
 = 
glb_ds1edô
.
wö_¥evõw
.
x0
;

2061 
py
 = 
glb_ds1edô
.
wö_¥evõw
.
y0
;

2062 
c
 = 
	`makecﬁ
(255, 255, 255);

2064 
ba£_x
 = 
tw
/2 - 
px
 - 1;

2065 
ba£_y
 = - 
py
 - 1;

2066 
mx
 = 
ba£_x
 - (
tw
 * 
dh
 / 2);

2067 
my
 = 
ba£_y
 + (
th
 * 
dh
 / 2);

2069 
x1
 = 
px
;

2070 
y1
 = 
py
;

2071 
	`co‹d_to_tûe
(
ds1_idx
, 
x1
, 
y1
, & 
mö_x
, & 
dummy
);

2073 
x1
 = 
px
 + 
glb_c⁄fig
.
s¸ìn
.
width
;

2074 
	`co‹d_to_tûe
(
ds1_idx
, 
x1
, 
y1
, & 
dummy
, & 
mö_y
);

2076 
x1
 = 
px
;

2077 
y1
 = 
py
 + 
glb_c⁄fig
.
s¸ìn
.
height
;

2078 
	`co‹d_to_tûe
(
ds1_idx
, 
x1
, 
y1
, & 
dummy
, & 
max_y
);

2080 
x1
 = 
px
 + 
glb_c⁄fig
.
s¸ìn
.
width
;

2081 
	`co‹d_to_tûe
(
ds1_idx
, 
x1
, 
y1
, & 
max_x
, & 
dummy
);

2083 i‡–(
glb_ds1edô
.
mode
 =
MOD_O
) ||

2084 (
glb_ds1edô
.
mode
 =
MOD_P
) ||

2085 (
glb_ds1edô
.
mode
 =
MOD_L
) )

2087 
mö_x
 /= 5;

2088 
mö_y
 /= 5;

2089 
max_x
 /= 5;

2090 
max_y
 /= 5;

2092 i‡(
mö_x
 < 0) min_x = 0;

2093 i‡(
mö_y
 < 0) min_y = 0;

2094 i‡(
max_x
 > 
glb_ds1
[
ds1_idx
].
width
) max_x = glb_ds1[ds1_idx].width;

2095 i‡(
max_y
 > 
glb_ds1
[
ds1_idx
].
height
) max_y = glb_ds1[ds1_idx].height;

2098 
i
=
mö_x
; i <
max_x
 ; i++)

2100 
x1
 = 
ba£_x
 + 
i
 * 
tw
 / 2;

2101 
y1
 = 
ba£_y
 + 
i
 * 
th
 / 2;

2102 
x2
 = 
mx
 + 
i
 * 
tw
 / 2;

2103 
y2
 = 
my
 + 
i
 * 
th
 / 2;

2104 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 
c
);

2107 
ba£_x
 = 
tw
/2 - 
px
 - 1;

2108 
ba£_y
 = - 
py
 - 1;

2109 
mx
 = 
ba£_x
 + (
tw
 * 
dw
 / 2);

2110 
my
 = 
ba£_y
 + (
th
 * 
dw
 / 2);

2111 
i
=
mö_y
; i <
max_y
 ; i++)

2113 
x1
 = 
ba£_x
 - 
i
 * 
tw
 / 2;

2114 
y1
 = 
ba£_y
 + 
i
 * 
th
 / 2;

2115 
x2
 = 
mx
 - 
i
 * 
tw
 / 2;

2116 
y2
 = 
my
 + 
i
 * 
th
 / 2;

2117 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y1
, 
x2
, 
y2
, 
c
);

2119 
	}
}

2124 
	$w¥evõw_døw_tûes
(
ds1_idx
)

2126 
x
, 
y
, 
ba£_x
 = 0, 
ba£_y
 = 0, 
mx
, 
my
;

2127 
cx
, 
cy
, 
dx
, 
dy
, 
z
, 
x1
, 
x2
, 
x3
, 
x4
, 
y1
, 
y2
, 
y3
, 
i
, 
£À˘
;

2128 
ﬁd_∑l
 = -1;

2129 * 
mode
;

2130 
UBYTE
 
wÆköfo
[25];

2131 
objdøw_cur_idx
 = 0;

2132 (* 
Âå_wi
Ë(, , , 
UBYTE
 *);

2133 
PATH_EDIT_WIN_S
 * 
pwö
 = & 
glb_ds1
[
ds1_idx
].
∑th_edô_wö
;

2136 
z
 = 
glb_ds1
[
ds1_idx
].
cur_zoom
;

2137 
	`˛ór
(
glb_ds1edô
.
s¸ìn_buff
);

2140 i‡(
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 == -1)

2143 i‡(
ﬁd_∑l
 !
glb_ds1
[
ds1_idx
].
a˘
 - 1)

2145 
ﬁd_∑l
 = 
glb_ds1
[
ds1_idx
].
a˘
 - 1;

2146 
	`£t_∑Àâe
(
glb_ds1edô
.
vga_∑l
[
ﬁd_∑l
]);

2152 i‡(
ﬁd_∑l
 !
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 - 1)

2154 
ﬁd_∑l
 = 
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 - 1;

2155 
	`£t_∑Àâe
(
glb_ds1edô
.
vga_∑l
[
ﬁd_∑l
]);

2160 
	`mou£_to_tûe
(
ds1_idx
, &
cx
, &
cy
);

2161 i‡(
glb_ds1edô
.
mode
 =
MOD_T
)

2163 i‡(
cx
 < 0)

2164 
cx
 = 0;

2165 i‡(
cx
 >
glb_ds1
[
ds1_idx
].
width
)

2166 
cx
 = 
glb_ds1
[
ds1_idx
].
width
 - 1;

2167 i‡(
cy
 < 0)

2168 
cy
 = 0;

2169 i‡(
cy
 >
glb_ds1
[
ds1_idx
].
height
)

2170 
cy
 = 
glb_ds1
[
ds1_idx
].
height
 - 1;

2177 
cx
 -= 2;

2178 
cy
 += 2;

2183 i‡(
glb_ds1edô
.
mode
 !
MOD_P
)

2185 i‡(
cx
 < 0)

2186 
cx
 = 0;

2187 i‡(
cx
 >
glb_ds1
[
ds1_idx
].
width
 * 5 - 1)

2188 
cx
 = 
glb_ds1
[
ds1_idx
].
width
 * 5 - 1;

2189 i‡(
cy
 < 0)

2190 
cy
 = 0;

2191 i‡(
cy
 >
glb_ds1
[
ds1_idx
].
height
 * 5 - 1)

2192 
cy
 = 
glb_ds1
[
ds1_idx
].
height
 * 5 - 1;

2197 i‡(
glb_ds1
[
ds1_idx
].
™im©i⁄s_œyî_mask
 == 1)

2199 
	`w¥evõw_obj_™im©e
();

2203 
y
=0; y<
glb_ds1
[
ds1_idx
].
height
; y++)

2205 
ba£_x
 = 
y
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2206 
ba£_y
 = 
y
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

2207 
x
=0; x<
glb_ds1
[
ds1_idx
].
width
; x++)

2209 
£À˘
 = 
FALSE
;

2210 i‡((
glb_ds1edô
.
mode
 =
MOD_T
Ë&& (
x
==
cx
Ë&& (
y
==
cy
))

2211 
£À˘
 = 
TRUE
;

2212 
mx
 = 
ba£_x
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2213 i‡((
mx
 >
glb_ds1edô
.
wö_¥evõw
.
x0
-
glb_ds1
[
ds1_idx
].
tûe_w
) &&

2214 (
mx
 < 
glb_ds1edô
.
wö_¥evõw
.
x0
 + glb_ds1edô.wö_¥evõw.
w
))

2216 
my
 = 
ba£_y
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

2217 
	`w¥evõw_døw_w
(
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
, 
£À˘
, 
FALSE
);

2218 
	`w¥evõw_døw_f
(
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
, 
£À˘
);

2219 
	`w¥evõw_døw_s
(
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
, 
£À˘
);

2225 
objdøw_cur_idx
 = 0;

2226 
y
=0; y<
glb_ds1
[
ds1_idx
].
height
; y++)

2228 
ba£_x
 = 
y
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2229 
ba£_y
 = 
y
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

2230 
x
=0; x<
glb_ds1
[
ds1_idx
].
width
; x++)

2232 
£À˘
 = 
FALSE
;

2233 i‡((
glb_ds1edô
.
mode
 =
MOD_T
Ë&& (
x
==
cx
Ë&& (
y
==
cy
))

2234 
£À˘
 = 
TRUE
;

2235 
mx
 = 
ba£_x
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2236 i‡((
mx
 >
glb_ds1edô
.
wö_¥evõw
.
x0
-
glb_ds1
[
ds1_idx
].
tûe_w
) &&

2237 (
mx
 < 
glb_ds1edô
.
wö_¥evõw
.
x0
 + glb_ds1edô.wö_¥evõw.
w
))

2240 i‡(
glb_ds1
[
ds1_idx
].
™im©i⁄s_œyî_mask
)

2241 
	`w¥evõw_døw_obj_tûe_shad
(
ds1_idx
, 
x
, 
y
, & 
objdøw_cur_idx
);

2247 
objdøw_cur_idx
 = 0;

2248 i‡(
glb_ds1
[
ds1_idx
].
™im©i⁄s_œyî_mask
)

2250 
y
=0; y<
glb_ds1
[
ds1_idx
].
height
; y++)

2252 
ba£_x
 = 
y
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2253 
ba£_y
 = 
y
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

2254 
x
=0; x<
glb_ds1
[
ds1_idx
].
width
; x++)

2256 
£À˘
 = 
FALSE
;

2257 i‡((
glb_ds1edô
.
mode
 =
MOD_T
Ë&& (
x
==
cx
Ë&& (
y
==
cy
))

2258 
£À˘
 = 
TRUE
;

2259 
mx
 = 
ba£_x
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2260 i‡((
mx
 >
glb_ds1edô
.
wö_¥evõw
.
x0
-
glb_ds1
[
ds1_idx
].
tûe_w
) &&

2261 (
mx
 < 
glb_ds1edô
.
wö_¥evõw
.
x0
 + glb_ds1edô.wö_¥evõw.
w
))

2264 
	`w¥evõw_døw_obj_tûe_1
(
ds1_idx
, 
x
, 
y
, & 
objdøw_cur_idx
);

2271 i‡(
glb_ds1edô
.
di•œy_tûe_grid
 =
TG_OVERFLOOR
)

2272 
	`w¥evõw_døw_tûe_grid
(
ds1_idx
);

2275 
objdøw_cur_idx
 = 0;

2276 
y
=0; y<
glb_ds1
[
ds1_idx
].
height
; y++)

2278 
ba£_x
 = 
y
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2279 
ba£_y
 = 
y
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

2280 
x
=0; x<
glb_ds1
[
ds1_idx
].
width
; x++)

2282 
£À˘
 = 
FALSE
;

2283 i‡((
glb_ds1edô
.
mode
 =
MOD_T
Ë&& (
x
==
cx
Ë&& (
y
==
cy
))

2284 
£À˘
 = 
TRUE
;

2285 
mx
 = 
ba£_x
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2286 i‡((
mx
 >
glb_ds1edô
.
wö_¥evõw
.
x0
-
glb_ds1
[
ds1_idx
].
tûe_w
) &&

2287 (
mx
 < 
glb_ds1edô
.
wö_¥evõw
.
x0
 + glb_ds1edô.wö_¥evõw.
w
))

2289 
my
 = 
ba£_y
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

2290 
	`w¥evõw_døw_w
(
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
, 
£À˘
, 
TRUE
);

2293 i‡(
glb_ds1
[
ds1_idx
].
™im©i⁄s_œyî_mask
)

2294 
	`w¥evõw_døw_obj_tûe_0_2
(
ds1_idx
, 
x
, 
y
, & 
objdøw_cur_idx
);

2300 
y
=0; y<
glb_ds1
[
ds1_idx
].
height
; y++)

2302 
ba£_x
 = 
y
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2303 
ba£_y
 = 
y
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

2304 
x
=0; x<
glb_ds1
[
ds1_idx
].
width
; x++)

2306 
£À˘
 = 
FALSE
;

2307 i‡((
glb_ds1edô
.
mode
 =
MOD_T
Ë&& (
x
==
cx
Ë&& (
y
==
cy
))

2308 
£À˘
 = 
TRUE
;

2309 
mx
 = 
ba£_x
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2310 i‡((
mx
 >
glb_ds1edô
.
wö_¥evõw
.
x0
-
glb_ds1
[
ds1_idx
].
tûe_w
) &&

2311 (
mx
 < 
glb_ds1edô
.
wö_¥evõw
.
x0
 + glb_ds1edô.wö_¥evõw.
w
))

2313 
my
 = 
ba£_y
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

2314 
	`w¥evõw_døw_r
 (
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
, 
£À˘
);

2320 i‡(
glb_ds1
[
ds1_idx
].
•ecül_œyî_mask
)

2322 
y
=0; y<
glb_ds1
[
ds1_idx
].
height
; y++)

2324 
ba£_x
 = 
y
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2325 
ba£_y
 = 
y
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

2326 
x
=0; x<
glb_ds1
[
ds1_idx
].
width
; x++)

2328 
£À˘
 = 
FALSE
;

2329 i‡((
glb_ds1edô
.
mode
 =
MOD_T
Ë&& (
x
==
cx
Ë&& (
y
==
cy
))

2330 
£À˘
 = 
TRUE
;

2331 
mx
 = 
ba£_x
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2332 i‡((
mx
 >
glb_ds1edô
.
wö_¥evõw
.
x0
-
glb_ds1
[
ds1_idx
].
tûe_w
) &&

2333 (
mx
 < 
glb_ds1edô
.
wö_¥evõw
.
x0
 + glb_ds1edô.wö_¥evõw.
w
))

2335 
my
 = 
ba£_y
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

2336 
	`w¥evõw_døw_•
(
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
, 
£À˘
);

2343 
glb_ds1
[
ds1_idx
].
wÆkabÀ_œyî_mask
)

2345 1 : 
Âå_wi
 = 
w¥evõw_døw_sim∂e_wi
; ;

2346 2 : 
Âå_wi
 = 
w¥evõw_døw_wi
; ;

2347  : 
Âå_wi
 = 
NULL
;

2349 i‡(
Âå_wi
 !
NULL
)

2351 
y
=0; y<
glb_ds1
[
ds1_idx
].
height
; y++)

2353 
ba£_x
 = 
y
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2354 
ba£_y
 = 
y
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

2355 
x
=0; x<
glb_ds1
[
ds1_idx
].
width
; x++)

2357 
mx
 = 
ba£_x
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2358 i‡((
mx
 >
glb_ds1edô
.
wö_¥evõw
.
x0
-
glb_ds1
[
ds1_idx
].
tûe_w
) &&

2359 (
mx
 < 
glb_ds1edô
.
wö_¥evõw
.
x0
 + glb_ds1edô.wö_¥evõw.
w
))

2361 
my
 = 
ba£_y
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

2362 i‡((
my
 >
glb_ds1edô
.
wö_¥evõw
.
y0
-
glb_ds1
[
ds1_idx
].
tûe_h
) &&

2363 (
my
 < 
glb_ds1edô
.
wö_¥evõw
.
y0
 + glb_ds1edô.wö_¥evõw.
h
))

2365 
	`misc_£¨ch_wÆk_öfos
(
ds1_idx
, 
x
, 
y
, 
wÆköfo
);

2366 
	`Âå_wi
(
mx
, 
my
, 
z
, 
wÆköfo
);

2374 i‡(
glb_ds1edô
.
di•œy_tûe_grid
 =
TG_OVERWALL
)

2375 
	`w¥evõw_døw_tûe_grid
(
ds1_idx
);

2378 i‡(
glb_ds1edô
.
mode
 =
MOD_T
)

2381 
dx
 = (
cy
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2Ë+ (
cx
 * glb_ds1[ds1_idx].tile_w / 2);

2382 
dy
 = (
cy
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2Ë+ (
cx
 * glb_ds1[ds1_idx].tile_h / 2);

2384 
x1
 = 
dx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
;

2385 
x2
 = 
x1
 + 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2 - 1;

2386 
x3
 = 
x1
 + 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2387 
x4
 = 
x1
 + 
glb_ds1
[
ds1_idx
].
tûe_w
 - 1;

2389 
y1
 = 
dy
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
;

2390 
y2
 = 
y1
 + 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2 - 1;

2391 
y3
 = 
y1
 + 
glb_ds1
[
ds1_idx
].
tûe_h
 - 2;

2393 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y2
, 
x2
, 
y1
, 129);

2394 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x3
, 
y1
, 
x4
, 
y2
, 129);

2395 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x3
, 
y3
, 
x4
, 
y2
, 129);

2396 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y2
, 
x2
, 
y3
, 129);

2403 
cx
 += 2;

2404 
cy
 -= 2;

2407 
dx
 = (
cy
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 10Ë+ (
cx
 * glb_ds1[ds1_idx].tile_w / 10);

2408 
dy
 = (
cy
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 10Ë+ (
cx
 * glb_ds1[ds1_idx].tile_h / 10);

2411 
cx
 -= 2;

2412 
cy
 += 2;

2414 
x1
 = 
dx
 - 
glb_ds1edô
.
wö_¥evõw
.
x0
;

2415 
x2
 = 
x1
 + 
glb_ds1
[
ds1_idx
].
tûe_w
 / 10 - 1;

2416 
x3
 = 
x1
 + 
glb_ds1
[
ds1_idx
].
tûe_w
 / 10;

2417 
x4
 = 
x1
 + 
glb_ds1
[
ds1_idx
].
tûe_w
 / 5 - 1;

2419 
y1
 = 
dy
 - 
glb_ds1edô
.
wö_¥evõw
.
y0
;

2420 
y2
 = 
y1
 + 
glb_ds1
[
ds1_idx
].
tûe_h
 / 10 - 1;

2421 
y3
 = 
y1
 + 
glb_ds1
[
ds1_idx
].
tûe_h
 / 5 - 2;

2423 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y2
, 
x2
, 
y1
, 129);

2424 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x3
, 
y1
, 
x4
, 
y2
, 129);

2425 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x3
, 
y3
, 
x4
, 
y2
, 129);

2426 
	`löe
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
, 
y2
, 
x2
, 
y3
, 129);

2430 i‡(
glb_ds1edô
.
mode
 =
MOD_P
)

2431 
	`w¥evõw_døw_∑ths_1obj
(
ds1_idx
, 
pwö
->
obj_idx
);

2432 i‡(
glb_ds1
[
ds1_idx
].
∑ths_œyî_mask
)

2433 
	`w¥evõw_døw_∑ths
(
ds1_idx
);

2436 i‡(
glb_ds1edô
.
mode
 =
MOD_O
)

2438 
	`edôobj_døw_obj_œb
(
ds1_idx
, 
TRUE
);

2439 
	`edôobj_døw_obj_œb
(
ds1_idx
, 
FALSE
);

2440 i‡(
glb_ds1
[
ds1_idx
].
døw_edô_obj
)

2441 
	`edôobj_døw_edô_obj
(
ds1_idx
);

2443 i‡(
glb_ds1
[
ds1_idx
].
obje˘s_œyî_mask
 !
OL_NONE
)

2444 
	`w¥evõw_døw_obje˘s
(
ds1_idx
);

2447 i‡(
glb_ds1edô
.
mode
 =
MOD_P
)

2449 
	`edô∑th_døw
(
ds1_idx
, 
mou£_x
, 
mou£_y
, 
mou£_b
, 
cx
, 
cy
);

2453 i‡((
glb_ds1
[
ds1_idx
].
wÆkabÀ_œyî_mask
 == 2) &&

2454 (
glb_ds1
[
ds1_idx
].
subtûe_hñp_di•œy
))

2456 
x1
 = 
glb_ds1edô
.
s¸ìn_buff
->
w
 - glb_ds1edô.
subtûe_hñp
->w - 10;

2457 
x2
 = 
x1
 + 
glb_ds1edô
.
subtûe_hñp
->
w
;

2458 
y1
 = 
glb_ds1edô
.
s¸ìn_buff
->
h
 - glb_ds1edô.
subtûe_hñp
->h - 20;

2459 
y2
 = 
y1
 + 
glb_ds1edô
.
subtûe_hñp
->
h
;

2460 
	`blô
(
glb_ds1edô
.
subtûe_hñp
, glb_ds1edô.
s¸ìn_buff
,

2461 0, 0, 
x1
, 
y1
, 
x2
, 
y2
);

2462 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
-1, 
y1
-1, 
x2
+1, 
y2
+1, 255);

2466 i‡(
glb_ds1edô
.
show_2nd_row
 =
TRUE
)

2468 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 0, 0, 
glb_c⁄fig
.
s¸ìn
.
width
, 19, 0);

2469 
	`hlöe
(
glb_ds1edô
.
s¸ìn_buff
, 0, 9, 
glb_c⁄fig
.
s¸ìn
.
width
, 29);

2470 
	`hlöe
(
glb_ds1edô
.
s¸ìn_buff
, 0, 20, 
glb_c⁄fig
.
s¸ìn
.
width
, 255);

2473 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 0, 11, 255, "Set:");

2474 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 32, 11, 109, "%i", glb_ds1edô.
ds1_group_idx
 + 1);

2476 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 65, 11, 255, "Ds1Index:");

2477 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 137, 11, 109, "%i", 
ds1_idx
 + 1);

2479 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 175, 11, 255, "File:");

2480 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 215, 11, 109, "%s", 
glb_ds1
[
ds1_idx
].
«me
);

2484 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 0, 0, 
glb_c⁄fig
.
s¸ìn
.
width
, 8, 0);

2485 
	`hlöe
(
glb_ds1edô
.
s¸ìn_buff
, 0, 9, 
glb_c⁄fig
.
s¸ìn
.
width
, 255);

2489 
	`ª˘fûl
(
glb_ds1edô
.
s¸ìn_buff
, 0, 
glb_c⁄fig
.
s¸ìn
.
height
-9, glb_c⁄fig.s¸ìn.
width
, glb_config.screen.height, 0);

2490 
	`hlöe
(
glb_ds1edô
.
s¸ìn_buff
, 0, 
glb_c⁄fig
.
s¸ìn
.
height
-10, glb_c⁄fig.s¸ìn.
width
, 255);

2493 
	`ãxt_mode
(-1);

2496 
i
=0; i < 
glb_ds1
[
ds1_idx
].
Êo‹_num
; i++)

2498 i‡(
glb_ds1
[
ds1_idx
].
Êo‹_œyî_mask
[
i
] == 0)

2499 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 20*
i
, 0, 98, "f%i", i+1);

2501 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 20*
i
, 0, 132, "f%i", i+1);

2505 
glb_ds1
[
ds1_idx
].
™im©i⁄s_œyî_mask
)

2508 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 50, 0, 98, "anims");

2512 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 50, 0, 132, "anims");

2516 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 50, 0, 108, "anims");

2521 
glb_ds1
[
ds1_idx
].
obje˘s_œyî_mask
)

2523 
OL_NONE
 :

2524 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 100, 0, 98, "obj");

2527 
OL_TYPEID
 :

2528 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 100, 0, 210, "obj");

2531 
OL_SPEED
 :

2532 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 100, 0, 108, "obj");

2535 
OL_DESC
 :

2536 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 100, 0, 132, "obj");

2544 
glb_ds1
[
ds1_idx
].
•ecül_œyî_mask
)

2547 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 240, 0, 98, "spl");

2551 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 240, 0, 132, "spl");

2556 
i
=0; i < 
glb_ds1
[
ds1_idx
].
wÆl_num
; i++)

2558 i‡(
glb_ds1
[
ds1_idx
].
wÆl_œyî_mask
[
i
] == 0)

2559 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 140+20*
i
, 0, 98, "w%i", i+1);

2561 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 140+20*
i
, 0, 132, "w%i", i+1);

2565 i‡(
glb_ds1
[
ds1_idx
].
∑ths_œyî_mask
 == 0)

2566 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 280, 0, 98, "path");

2568 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 280, 0, 132, "path");

2571 
glb_ds1
[
ds1_idx
].
shadow_œyî_mask
[0])

2574 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 340, 0, 210, "shad");

2578 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 340, 0, 255, "shad");

2582 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 340, 0, 132, "shad");

2586 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 340, 0, 98, "shad");

2594 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 390, 0, 255, "zoom=%i:%i",

2595 
glb_ds1
[
ds1_idx
].
height_mul
, glb_ds1[ds1_idx].
height_div
);

2598 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 490, 0, 255, "gamma=%s",

2599 
glb_gamma_°r
[
glb_ds1edô
.
cur_gamma
].
°r
);

2602 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 606, 0, 109, "%s",

2603 
glb_ds1
[
ds1_idx
].
fûíame
);

2606 i‡(
glb_ds1edô
.
mode
 =
MOD_T
)

2609 
	`ãxçrötf
(

2610 
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 0, 
glb_c⁄fig
.
s¸ìn
.
height
-8, 255,

2612 
cx
, 
cy


2618 
	`ãxçrötf
(

2619 
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 0, 
glb_c⁄fig
.
s¸ìn
.
height
-8, 255,

2621 
cx
, 
cy


2626 
	`ãxçrötf
(

2627 
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
, 
glb_c⁄fig
.
s¸ìn
.
width
-80, 0, 255,

2629 
glb_ds1edô
.
ﬁd_Âs


2633 
	`ãxçrötf
(

2634 
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
,

2635 
glb_c⁄fig
.
s¸ìn
.
width
-168, glb_c⁄fig.s¸ìn.
height
-8,

2638 
glb_ds1edô
.
cuºít_ª‰esh_øã


2642 
	`ãxçrötf
(

2643 
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
,

2644 200, 
glb_c⁄fig
.
s¸ìn
.
height
-8,

2647 
glb_ds1
[
ds1_idx
].
obj_num
,

2648 
glb_ds1
[
ds1_idx
].
cuºít_obj_max


2652 
glb_ds1edô
.
mode
)

2654 
MOD_T
 : 
mode
 = "Tiles "; ;

2655 
MOD_O
 : 
mode
 = "Objects"; ;

2656 
MOD_P
 : 
mode
 = "Paths "; ;

2658 
MOD_L
 : i‡(
glb_ds1edô
.
night_mode
 == 0)

2659 
mode
 = "Night 1";

2661 
mode
 = "Night 2";

2664  : 
mode
 = "? "; ;

2666 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
,

2667 
glb_c⁄fig
.
s¸ìn
.
width
-112, glb_c⁄fig.s¸ìn.
height
-8, 255, "Mode :");

2668 
	`ãxçrötf
(
glb_ds1edô
.
s¸ìn_buff
, 
f⁄t
,

2669 
glb_c⁄fig
.
s¸ìn
.
width
-56, glb_c⁄fig.s¸ìn.
height
-8, 108, "%s", 
mode
);

2681 
	`misc_døw_s¸ìn
(
mou£_x
, 
mou£_y
);

2683 
	`w¥evõw_ªiöô_™im©ed_Êo‹
(
ds1_idx
);

2684 
	}
}

2689 
	$w¥evõw_døw_tûes_big_s¸ìnshŸ
(
ds1_idx
)

2691 
x
, 
y
, 
ba£_x
 = 0, 
ba£_y
 = 0, 
mx
, 
my
;

2692 
cx
, 
cy
, 
z
, 
x1
, 
x2
, 
y1
, 
y2
, 
£À˘
;

2693 
ﬁd_∑l
 = -1;

2694 
UBYTE
 
wÆköfo
[25];

2695 
objdøw_cur_idx
 = 0;

2696 (* 
Âå_wi
Ë(, , , 
UBYTE
 *);

2697 
PATH_EDIT_WIN_S
 * 
pwö
 = & 
glb_ds1
[
ds1_idx
].
∑th_edô_wö
;

2699 
möx
, 
möy
, 
maxx
, 
maxy
, 
tmpw
, 
tmph
;

2700 
BLOCK_TABLE_S
 * 
bt_±r
;

2701 
BITMAP
 * 
tmp_bmp
;

2702 
CELL_S_S
 * 
s_±r
;

2703 
CELL_F_S
 * 
f_±r
;

2704 
CELL_W_S
 * 
w_±r
;

2705 
n
, 
t
, 
bt_idx
, 
dt1_idx
, 
block_idx
;

2706 
ﬁd_s¸ìn_width
, 
ﬁd_s¸ìn_height
,

2707 
ﬁd_s¸ìn_x0
, 
ﬁd_s¸ìn_y0
;

2710 
z
 = 
glb_ds1
[
ds1_idx
].
cur_zoom
;

2713 
möx
 = 
möy
 = 0x7FFFFFFFLU;

2714 
maxx
 = 
maxy
 = 0x80000000LU;

2717 
y
=0; y<
glb_ds1
[
ds1_idx
].
height
; y++)

2719 
ba£_x
 = 
y
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2720 
ba£_y
 = 
y
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

2721 
x
=0; x<
glb_ds1
[
ds1_idx
].
width
; x++)

2723 
mx
 = 
ba£_x
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2724 
my
 = 
ba£_y
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

2727 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
shadow_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
shadow_num
);

2728 
s_±r
 = 
glb_ds1
[
ds1_idx
].
shadow_buff
 + 
t
;

2729 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
shadow_num
;Ç++)

2731 
bt_idx
 = 
s_±r
[
n
].bt_idx;

2733 i‡(
s_±r
[
n
].
¥›4
 & 0x80)

2734 
bt_idx
 = -1;

2736 i‡(
bt_idx
 != -1)

2738 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
 + 
bt_idx
;

2740 i‡(
bt_±r
->
ty≥
 !
BT_SHADOW
)

2743 
dt1_idx
 = 
bt_±r
->dt1_idx;

2744 
block_idx
 = 
bt_±r
->block_idx;

2746 
tmp_bmp
 = * (
glb_dt1
[
dt1_idx
].
block_zoom
[
z
] + 
block_idx
);

2748 i‡(
tmp_bmp
 =
NULL
)

2751 
y1
 = 
my
 -

2752 
bt_±r
->
zîo_löe
 * 
glb_ds1
[
ds1_idx
].
height_mul
 / glb_ds1[ds1_idx].
height_div
;

2753 
y1
 +
glb_ds1
[
ds1_idx
].
tûe_h
;

2755 
y2
 = 
y1
 + 
tmp_bmp
->
h
;

2756 
x1
 = 
mx
;

2757 
x2
 = 
x1
 + 
tmp_bmp
->
w
;

2758 i‡(
x1
 < 
möx
)

2759 
möx
 = 
x1
;

2760 i‡(
x2
 > 
maxx
)

2761 
maxx
 = 
x2
;

2762 i‡(
y1
 < 
möy
)

2763 
möy
 = 
y1
;

2764 i‡(
y2
 > 
maxy
)

2765 
maxy
 = 
y2
;

2770 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
Êo‹_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
Êo‹_num
);

2771 
f_±r
 = 
glb_ds1
[
ds1_idx
].
Êo‹_buff
 + 
t
;

2772 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
Êo‹_num
;Ç++)

2774 
bt_idx
 = 
f_±r
[
n
].bt_idx;

2776 i‡(
bt_idx
 != -1)

2778 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
 + 
bt_idx
;

2780 i‡((
bt_±r
->
ty≥
 !
BT_STATIC
Ë&& (bt_±r->ty≥ !
BT_ANIMATED
))

2783 
dt1_idx
 = 
bt_±r
->dt1_idx;

2784 
block_idx
 = 
bt_±r
->block_idx;

2786 
tmp_bmp
 = * (
glb_dt1
[
dt1_idx
].
block_zoom
[
z
] + 
block_idx
);

2788 i‡(
tmp_bmp
 =
NULL
)

2791 
y1
 = 
my
 -

2792 
bt_±r
->
zîo_löe
 * 
glb_ds1
[
ds1_idx
].
height_mul
 / glb_ds1[ds1_idx].
height_div
;

2793 
y2
 = 
y1
 + 
tmp_bmp
->
h
;

2794 
x1
 = 
mx
;

2795 
x2
 = 
x1
 + 
tmp_bmp
->
w
;

2796 i‡(
x1
 < 
möx
)

2797 
möx
 = 
x1
;

2798 i‡(
x2
 > 
maxx
)

2799 
maxx
 = 
x2
;

2800 i‡(
y1
 < 
möy
)

2801 
möy
 = 
y1
;

2802 i‡(
y2
 > 
maxy
)

2803 
maxy
 = 
y2
;

2808 
t
 = (
y
 * 
glb_ds1
[
ds1_idx
].
wÆl_löe
Ë+ (
x
 * glb_ds1[ds1_idx].
wÆl_num
);

2809 
w_±r
 = 
glb_ds1
[
ds1_idx
].
wÆl_buff
 + 
t
;

2810 
n
=0;Ç<
glb_ds1
[
ds1_idx
].
wÆl_num
;Ç++)

2812 
bt_idx
 = 
w_±r
[
n
].bt_idx;

2814 i‡(
bt_idx
 != -1)

2816 
bt_±r
 = 
glb_ds1
[
ds1_idx
].
block_èbÀ
 + 
bt_idx
;

2818 i‡–(
bt_±r
->
ty≥
 !
BT_WALL_UP
) &&

2819 (
bt_±r
->
ty≥
 !
BT_WALL_DOWN
) &&

2820 (
bt_±r
->
ty≥
 !
BT_ROOF
) &&

2821 (
bt_±r
->
ty≥
 !
BT_SPECIAL
) &&

2822 (
bt_±r
->
ty≥
 !
BT_WALL_ANIMATED
)

2828 
dt1_idx
 = 
bt_±r
->dt1_idx;

2829 
block_idx
 = 
bt_±r
->block_idx;

2831 
tmp_bmp
 = * (
glb_dt1
[
dt1_idx
].
block_zoom
[
z
] + 
block_idx
);

2833 i‡(
tmp_bmp
 =
NULL
)

2836 
y1
 = 
my
 -

2837 
bt_±r
->
zîo_löe
 * 
glb_ds1
[
ds1_idx
].
height_mul
 / glb_ds1[ds1_idx].
height_div
;

2838 
y1
 +
glb_ds1
[
ds1_idx
].
tûe_h
;

2840 
y2
 = 
y1
 + 
tmp_bmp
->
h
;

2841 
x1
 = 
mx
;

2842 
x2
 = 
x1
 + 
tmp_bmp
->
w
;

2843 i‡(
x1
 < 
möx
)

2844 
möx
 = 
x1
;

2845 i‡(
x2
 > 
maxx
)

2846 
maxx
 = 
x2
;

2847 i‡(
y1
 < 
möy
)

2848 
möy
 = 
y1
;

2849 i‡(
y2
 > 
maxy
)

2850 
maxy
 = 
y2
;

2857 
tmpw
 = 
maxx
 - 
möx
;

2858 
tmph
 = 
maxy
 - 
möy
;

2866 i‡((
tmpw
 <0Ë|| (
tmph
 <= 0))

2868 
tmp_bmp
 = 
	`¸óã_bôm≠_ex
(8, 
tmpw
, 
tmph
);

2869 i‡(
tmp_bmp
 =
NULL
)

2873 
glb_ds1edô
.
s¸ìn_buff
 = 
tmp_bmp
;

2875 
ﬁd_s¸ìn_width
 = 
glb_ds1edô
.
wö_¥evõw
.
w
;

2876 
ﬁd_s¸ìn_height
 = 
glb_ds1edô
.
wö_¥evõw
.
h
;

2877 
ﬁd_s¸ìn_x0
 = 
glb_ds1edô
.
wö_¥evõw
.
x0
;

2878 
ﬁd_s¸ìn_y0
 = 
glb_ds1edô
.
wö_¥evõw
.
y0
;

2880 
glb_ds1edô
.
wö_¥evõw
.
w
 = 
tmpw
;

2881 
glb_ds1edô
.
wö_¥evõw
.
h
 = 
tmph
;

2882 
glb_ds1edô
.
wö_¥evõw
.
x0
 = 
möx
;

2883 
glb_ds1edô
.
wö_¥evõw
.
y0
 = 
möy
;

2884 
glb_c⁄fig
.
s¸ìn
.
width
 = 
tmpw
;

2885 
glb_c⁄fig
.
s¸ìn
.
height
 = 
tmph
;

2888 
	`˛ór
(
glb_ds1edô
.
s¸ìn_buff
);

2891 i‡(
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 == -1)

2894 i‡(
ﬁd_∑l
 !
glb_ds1
[
ds1_idx
].
a˘
 - 1)

2896 
ﬁd_∑l
 = 
glb_ds1
[
ds1_idx
].
a˘
 - 1;

2897 
	`£t_∑Àâe
(
glb_ds1edô
.
vga_∑l
[
ﬁd_∑l
]);

2903 i‡(
ﬁd_∑l
 !
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 - 1)

2905 
ﬁd_∑l
 = 
glb_ds1edô
.
cmd_löe
.
f‹˚_∑l_num
 - 1;

2906 
	`£t_∑Àâe
(
glb_ds1edô
.
vga_∑l
[
ﬁd_∑l
]);

2911 
cx
 = 
cy
 = -1;

2914 
y
=0; y<
glb_ds1
[
ds1_idx
].
height
; y++)

2916 
ba£_x
 = 
y
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2917 
ba£_y
 = 
y
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

2918 
x
=0; x<
glb_ds1
[
ds1_idx
].
width
; x++)

2920 
£À˘
 = 
FALSE
;

2921 i‡((
glb_ds1edô
.
mode
 =
MOD_T
Ë&& (
x
==
cx
Ë&& (
y
==
cy
))

2922 
£À˘
 = 
TRUE
;

2923 
mx
 = 
ba£_x
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2924 i‡((
mx
 >
glb_ds1edô
.
wö_¥evõw
.
x0
-
glb_ds1
[
ds1_idx
].
tûe_w
) &&

2925 (
mx
 < 
glb_ds1edô
.
wö_¥evõw
.
x0
 + glb_ds1edô.wö_¥evõw.
w
))

2927 
my
 = 
ba£_y
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

2928 
	`w¥evõw_døw_w
(
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
, 
£À˘
, 
FALSE
);

2929 
	`w¥evõw_døw_f
(
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
, 
£À˘
);

2930 
	`w¥evõw_døw_s
(
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
, 
£À˘
);

2936 
objdøw_cur_idx
 = 0;

2937 
y
=0; y<
glb_ds1
[
ds1_idx
].
height
; y++)

2939 
ba£_x
 = 
y
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2940 
ba£_y
 = 
y
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

2941 
x
=0; x<
glb_ds1
[
ds1_idx
].
width
; x++)

2943 
£À˘
 = 
FALSE
;

2944 i‡((
glb_ds1edô
.
mode
 =
MOD_T
Ë&& (
x
==
cx
Ë&& (
y
==
cy
))

2945 
£À˘
 = 
TRUE
;

2946 
mx
 = 
ba£_x
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2947 i‡((
mx
 >
glb_ds1edô
.
wö_¥evõw
.
x0
-
glb_ds1
[
ds1_idx
].
tûe_w
) &&

2948 (
mx
 < 
glb_ds1edô
.
wö_¥evõw
.
x0
 + glb_ds1edô.wö_¥evõw.
w
))

2951 i‡(
glb_ds1
[
ds1_idx
].
™im©i⁄s_œyî_mask
)

2952 
	`w¥evõw_døw_obj_tûe_shad
(
ds1_idx
, 
x
, 
y
, & 
objdøw_cur_idx
);

2958 
objdøw_cur_idx
 = 0;

2959 i‡(
glb_ds1
[
ds1_idx
].
™im©i⁄s_œyî_mask
)

2961 
y
=0; y<
glb_ds1
[
ds1_idx
].
height
; y++)

2963 
ba£_x
 = 
y
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2964 
ba£_y
 = 
y
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

2965 
x
=0; x<
glb_ds1
[
ds1_idx
].
width
; x++)

2967 
£À˘
 = 
FALSE
;

2968 i‡((
glb_ds1edô
.
mode
 =
MOD_T
Ë&& (
x
==
cx
Ë&& (
y
==
cy
))

2969 
£À˘
 = 
TRUE
;

2970 
mx
 = 
ba£_x
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2971 i‡((
mx
 >
glb_ds1edô
.
wö_¥evõw
.
x0
-
glb_ds1
[
ds1_idx
].
tûe_w
) &&

2972 (
mx
 < 
glb_ds1edô
.
wö_¥evõw
.
x0
 + glb_ds1edô.wö_¥evõw.
w
))

2975 
	`w¥evõw_døw_obj_tûe_1
(
ds1_idx
, 
x
, 
y
, & 
objdøw_cur_idx
);

2982 
objdøw_cur_idx
 = 0;

2983 
y
=0; y<
glb_ds1
[
ds1_idx
].
height
; y++)

2985 
ba£_x
 = 
y
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2986 
ba£_y
 = 
y
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

2987 
x
=0; x<
glb_ds1
[
ds1_idx
].
width
; x++)

2989 
£À˘
 = 
FALSE
;

2990 i‡((
glb_ds1edô
.
mode
 =
MOD_T
Ë&& (
x
==
cx
Ë&& (
y
==
cy
))

2991 
£À˘
 = 
TRUE
;

2992 
mx
 = 
ba£_x
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

2993 i‡((
mx
 >
glb_ds1edô
.
wö_¥evõw
.
x0
-
glb_ds1
[
ds1_idx
].
tûe_w
) &&

2994 (
mx
 < 
glb_ds1edô
.
wö_¥evõw
.
x0
 + glb_ds1edô.wö_¥evõw.
w
))

2996 
my
 = 
ba£_y
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

2997 
	`w¥evõw_døw_w
(
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
, 
£À˘
, 
TRUE
);

3000 i‡(
glb_ds1
[
ds1_idx
].
™im©i⁄s_œyî_mask
)

3001 
	`w¥evõw_døw_obj_tûe_0_2
(
ds1_idx
, 
x
, 
y
, & 
objdøw_cur_idx
);

3007 
y
=0; y<
glb_ds1
[
ds1_idx
].
height
; y++)

3009 
ba£_x
 = 
y
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

3010 
ba£_y
 = 
y
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

3011 
x
=0; x<
glb_ds1
[
ds1_idx
].
width
; x++)

3013 
£À˘
 = 
FALSE
;

3014 i‡((
glb_ds1edô
.
mode
 =
MOD_T
Ë&& (
x
==
cx
Ë&& (
y
==
cy
))

3015 
£À˘
 = 
TRUE
;

3016 
mx
 = 
ba£_x
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

3017 i‡((
mx
 >
glb_ds1edô
.
wö_¥evõw
.
x0
-
glb_ds1
[
ds1_idx
].
tûe_w
) &&

3018 (
mx
 < 
glb_ds1edô
.
wö_¥evõw
.
x0
 + glb_ds1edô.wö_¥evõw.
w
))

3020 
my
 = 
ba£_y
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

3021 
	`w¥evõw_døw_r
 (
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
, 
£À˘
);

3027 i‡(
glb_ds1
[
ds1_idx
].
•ecül_œyî_mask
)

3029 
y
=0; y<
glb_ds1
[
ds1_idx
].
height
; y++)

3031 
ba£_x
 = 
y
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

3032 
ba£_y
 = 
y
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

3033 
x
=0; x<
glb_ds1
[
ds1_idx
].
width
; x++)

3035 
£À˘
 = 
FALSE
;

3036 i‡((
glb_ds1edô
.
mode
 =
MOD_T
Ë&& (
x
==
cx
Ë&& (
y
==
cy
))

3037 
£À˘
 = 
TRUE
;

3038 
mx
 = 
ba£_x
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

3039 i‡((
mx
 >
glb_ds1edô
.
wö_¥evõw
.
x0
-
glb_ds1
[
ds1_idx
].
tûe_w
) &&

3040 (
mx
 < 
glb_ds1edô
.
wö_¥evõw
.
x0
 + glb_ds1edô.wö_¥evõw.
w
))

3042 
my
 = 
ba£_y
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

3043 
	`w¥evõw_døw_•
(
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
, 
£À˘
);

3050 
glb_ds1
[
ds1_idx
].
wÆkabÀ_œyî_mask
)

3052 1 : 
Âå_wi
 = 
w¥evõw_døw_sim∂e_wi
; ;

3053 2 : 
Âå_wi
 = 
w¥evõw_døw_wi
; ;

3054  : 
Âå_wi
 = 
NULL
;

3056 i‡(
Âå_wi
 !
NULL
)

3058 
y
=0; y<
glb_ds1
[
ds1_idx
].
height
; y++)

3060 
ba£_x
 = 
y
 * -
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

3061 
ba£_y
 = 
y
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

3062 
x
=0; x<
glb_ds1
[
ds1_idx
].
width
; x++)

3064 
mx
 = 
ba£_x
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_w
 / 2;

3065 i‡((
mx
 >
glb_ds1edô
.
wö_¥evõw
.
x0
-
glb_ds1
[
ds1_idx
].
tûe_w
) &&

3066 (
mx
 < 
glb_ds1edô
.
wö_¥evõw
.
x0
 + glb_ds1edô.wö_¥evõw.
w
))

3068 
my
 = 
ba£_y
 + 
x
 * 
glb_ds1
[
ds1_idx
].
tûe_h
 / 2;

3069 i‡((
my
 >
glb_ds1edô
.
wö_¥evõw
.
y0
-
glb_ds1
[
ds1_idx
].
tûe_h
) &&

3070 (
my
 < 
glb_ds1edô
.
wö_¥evõw
.
y0
 + glb_ds1edô.wö_¥evõw.
h
))

3072 
	`misc_£¨ch_wÆk_öfos
(
ds1_idx
, 
x
, 
y
, 
wÆköfo
);

3073 
	`Âå_wi
(
mx
, 
my
, 
z
, 
wÆköfo
);

3081 i‡(
glb_ds1edô
.
di•œy_tûe_grid
 =
TRUE
)

3082 
	`w¥evõw_døw_tûe_grid
(
ds1_idx
);

3085 i‡(
glb_ds1edô
.
mode
 =
MOD_P
)

3086 
	`w¥evõw_døw_∑ths_1obj
(
ds1_idx
, 
pwö
->
obj_idx
);

3087 i‡(
glb_ds1
[
ds1_idx
].
∑ths_œyî_mask
)

3088 
	`w¥evõw_døw_∑ths
(
ds1_idx
);

3091 i‡(
glb_ds1edô
.
mode
 =
MOD_O
)

3093 
	`edôobj_døw_obj_œb
(
ds1_idx
, 
TRUE
);

3094 
	`edôobj_døw_obj_œb
(
ds1_idx
, 
FALSE
);

3095 i‡(
glb_ds1
[
ds1_idx
].
døw_edô_obj
)

3096 
	`edôobj_døw_edô_obj
(
ds1_idx
);

3098 i‡(
glb_ds1
[
ds1_idx
].
obje˘s_œyî_mask
 !
OL_NONE
)

3099 
	`w¥evõw_døw_obje˘s
(
ds1_idx
);

3102 i‡(
glb_ds1edô
.
mode
 =
MOD_P
)

3104 
	`edô∑th_døw
(
ds1_idx
, 
mou£_x
, 
mou£_y
, 
mou£_b
, 
cx
, 
cy
);

3108 i‡((
glb_ds1
[
ds1_idx
].
wÆkabÀ_œyî_mask
 == 2) &&

3109 (
glb_ds1
[
ds1_idx
].
subtûe_hñp_di•œy
))

3111 
x1
 = 
glb_ds1edô
.
s¸ìn_buff
->
w
 - glb_ds1edô.
subtûe_hñp
->w - 10;

3112 
x2
 = 
x1
 + 
glb_ds1edô
.
subtûe_hñp
->
w
;

3113 
y1
 = 
glb_ds1edô
.
s¸ìn_buff
->
h
 - glb_ds1edô.
subtûe_hñp
->h - 20;

3114 
y2
 = 
y1
 + 
glb_ds1edô
.
subtûe_hñp
->
h
;

3115 
	`blô
(
glb_ds1edô
.
subtûe_hñp
, glb_ds1edô.
s¸ìn_buff
,

3116 0, 0, 
x1
, 
y1
, 
x2
, 
y2
);

3117 
	`ª˘
(
glb_ds1edô
.
s¸ìn_buff
, 
x1
-1, 
y1
-1, 
x2
+1, 
y2
+1, 255);

3120 
glb_ds1edô
.
wö_¥evõw
.
w
 = 
ﬁd_s¸ìn_width
;

3121 
glb_ds1edô
.
wö_¥evõw
.
h
 = 
ﬁd_s¸ìn_height
;

3122 
glb_ds1edô
.
wö_¥evõw
.
x0
 = 
ﬁd_s¸ìn_x0
;

3123 
glb_ds1edô
.
wö_¥evõw
.
y0
 = 
ﬁd_s¸ìn_y0
;

3124 
glb_c⁄fig
.
s¸ìn
.
width
 = 
ﬁd_s¸ìn_width
;

3125 
glb_c⁄fig
.
s¸ìn
.
height
 = 
ﬁd_s¸ìn_height
;

3128 
	}
}

3130 #ifde‡
WIN32


3131 #¥agm®
w¨nög
 (
p›
)

	@wPreview.h

1 #i‚de‡
_WPREVIEW_H_


3 
	#_WPREVIEW_H_


	)

5 
w¥evõw_sh≠e
 (
BITMAP
 * 
tmp_bmp
, 
x0
, 
y0
, 
ds1_idx
, 
COL_E
 
cﬁ_idx
);

6 
w¥evõw_gouøud_f
 (
BITMAP
 * 
tmp_bmp
, 
x0
, 
y0
, 
ds1_idx
, 
c1
, 
c2
, 
c3
, 
c4
);

7 
w¥evõw_gouøud_w
 (
BITMAP
 * 
tmp_bmp
, 
x0
, 
y0
, 
ds1_idx
, 
c1
, 
c2
, 
c3
, 
c4
);

8 
w¥evõw_light_di°
 (
x0
, 
y0
, 
mx
, 
my
);

9 
qs‹t_hñ≥r_‹dî_d©a
 (c⁄° *
e1
, c⁄° *
e2
);

10 
w¥evõw_døw_s
 (
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
, 
£À˘ed
);

11 
w¥evõw_døw_f
 (
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
, 
£À˘ed
);

12 
w¥evõw_døw_w
 (
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
, 
£À˘ed
, 
uµî
);

13 
w¥evõw_døw_r
 (
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
, 
£À˘ed
);

14 
w¥evõw_døw_•
 (
ds1_idx
, 
x
, 
y
, 
mx
, 
my
, 
z
, 
£À˘ed
);

15 
co‹d_to_tûe
 (
ds1_idx
, 
ax
, 
ay
, * 
œyî_x
, * 
œyî_y
);

16 
mou£_to_tûe
 (
ds1_idx
, * 
œyî_x
, * 
œyî_y
);

17 
ch™ge_zoom
 (
ds1_idx
, 
ZOOM_E
 
z
);

18 
w¥evõw_døw_∑ths
 (
ds1_idx
);

19 
w¥evõw_døw_∑ths_1obj
 (
ds1_idx
, 
o
);

20 
w¥evõw_obj_™im©e
 ();

21 
w¥evõw_døw_obje˘s
 (
ds1_idx
);

22 
w¥evõw_døw_sim∂e_wi
 (
mx
, 
my
, 
z
, 
UBYTE
 * 
wÆköfo
);

23 
w¥evõw_døw_wi
 (
mx
, 
my
, 
z
, 
UBYTE
 * 
wÆköfo
);

24 
w¥evõw_døw_™_obje˘
 (
ds1_idx
, 
o
);

25 
w¥evõw_døw_™_obje˘_shad
 (
ds1_idx
, 
o
);

26 
w¥evõw_døw_obj_tûe_shad
 (
ds1_idx
, 
x
, 
y
, * 
cur_idx
);

27 
w¥evõw_døw_obj_tûe_0_2
 (
ds1_idx
, 
x
, 
y
, * 
cur_idx
);

28 
w¥evõw_døw_obj_tûe_1
 (
ds1_idx
, 
x
, 
y
, * 
cur_idx
);

29 
w¥evõw_døw_tûes
 (
ds1_idx
);

30 
w¥evõw_ªiöô_™im©ed_Êo‹
 (
ds1_idx
);

31 
w¥evõw_døw_tûes_big_s¸ìnshŸ
 (
ds1_idx
);

	@/usr/include/ctype.h

24 #i‚def 
_CTYPE_H


25 
	#_CTYPE_H
 1

	)

27 
	~<„©uªs.h
>

28 
	~<bôs/ty≥s.h
>

30 
	g__BEGIN_DECLS


32 #i‚de‡
_ISbô


41 
	~<ídün.h
>

42 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


43 
	#_ISbô
(
bô
Ë(1 << (bô))

	)

45 
	#_ISbô
(
bô
Ë((bôË< 8 ? ((1 << (bô)Ë<< 8Ë: ((1 << (bô)Ë>> 8))

	)

50 
	m_ISuµî
 = 
_ISbô
 (0),

51 
	m_ISlowî
 = 
_ISbô
 (1),

52 
	m_ISÆpha
 = 
_ISbô
 (2),

53 
	m_ISdigô
 = 
_ISbô
 (3),

54 
	m_ISxdigô
 = 
_ISbô
 (4),

55 
	m_IS•a˚
 = 
_ISbô
 (5),

56 
	m_IS¥öt
 = 
_ISbô
 (6),

57 
	m_ISgøph
 = 
_ISbô
 (7),

58 
	m_ISbœnk
 = 
_ISbô
 (8),

59 
	m_IS˙ål
 = 
_ISbô
 (9),

60 
	m_ISpun˘
 = 
_ISbô
 (10),

61 
	m_ISÆnum
 = 
_ISbô
 (11)

81 
__c⁄°
 **
	$__˘y≥_b_loc
 ()

82 
__THROW
 
	`__©åibuã__
 ((
__c⁄°
));

83 
__c⁄°
 
__öt32_t
 **
	$__˘y≥_tﬁowî_loc
 ()

84 
__THROW
 
	`__©åibuã__
 ((
__c⁄°
));

85 
__c⁄°
 
__öt32_t
 **
	$__˘y≥_touµî_loc
 ()

86 
__THROW
 
	`__©åibuã__
 ((
__c⁄°
));

88 
	#__is˘y≥
(
c
, 
ty≥
) \

89 ((*
	`__˘y≥_b_loc
 ())[(Ë(
c
)] & (Ë
ty≥
)

	)

91 
	#__ißscii
(
c
Ë(((cË& ~0x7fË=0Ë

	)

92 
	#__tﬂscii
(
c
Ë((cË& 0x7fË

	)

94 
	#__ex˘y≥
(
«me
Ë
	`«me
 (Ë
__THROW


	)

96 
__BEGIN_NAMESPACE_STD


102 
	`__ex˘y≥
 (
iß um
);

103 
	`__ex˘y≥
 (
ißÕha
);

104 
	`__ex˘y≥
 (
is˙ål
);

105 
	`__ex˘y≥
 (
isdigô
);

106 
	`__ex˘y≥
 (
i¶owî
);

107 
	`__ex˘y≥
 (
isgøph
);

108 
	`__ex˘y≥
 (
i•röt
);

109 
	`__ex˘y≥
 (
i•un˘
);

110 
	`__ex˘y≥
 (
is•a˚
);

111 
	`__ex˘y≥
 (
isuµî
);

112 
	`__ex˘y≥
 (
isxdigô
);

116 
	$tﬁowî
 (
__c
Ë
__THROW
;

119 
	$touµî
 (
__c
Ë
__THROW
;

121 
__END_NAMESPACE_STD


125 #ifdef 
__USE_ISOC99


126 
__BEGIN_NAMESPACE_C99


128 
	`__ex˘y≥
 (
isbœnk
);

130 
__END_NAMESPACE_C99


133 #ifde‡
__USE_GNU


135 
	$is˘y≥
 (
__c
, 
__mask
Ë
__THROW
;

138 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


142 
	$ißscii
 (
__c
Ë
__THROW
;

146 
	$tﬂscii
 (
__c
Ë
__THROW
;

150 
	`__ex˘y≥
 (
_touµî
);

151 
	`__ex˘y≥
 (
_tﬁowî
);

155 
	#__tobody
(
c
, 
f
, 
a
, 
¨gs
) \

156 (
__exãnsi⁄__
 \

157 ({ 
__ªs
; \

158 i‡( (
c
) > 1) \

160 i‡(
	`__buûtö_c⁄°™t_p
 (
c
)) \

162 
__c
 = (
c
); \

163 
__ªs
 = 
__c
 < -128 || __¯> 255 ? __¯: (
a
)[__c]; \

166 
__ªs
 = 
f
 
¨gs
; \

169 
__ªs
 = (
a
)[(Ë(
c
)]; \

170 
__ªs
; 
	}
}))

	)

172 #i‡!
deföed
 
__NO_CTYPE
 && !deföed 
__˝lu•lus


173 
	#iß um
(
c
Ë
	`__is˘y≥
((c), 
_ISÆnum
)

	)

174 
	#ißÕha
(
c
Ë
	`__is˘y≥
((c), 
_ISÆpha
)

	)

175 
	#is˙ål
(
c
Ë
	`__is˘y≥
((c), 
_IS˙ål
)

	)

176 
	#isdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISdigô
)

	)

177 
	#i¶owî
(
c
Ë
	`__is˘y≥
((c), 
_ISlowî
)

	)

178 
	#isgøph
(
c
Ë
	`__is˘y≥
((c), 
_ISgøph
)

	)

179 
	#i•röt
(
c
Ë
	`__is˘y≥
((c), 
_IS¥öt
)

	)

180 
	#i•un˘
(
c
Ë
	`__is˘y≥
((c), 
_ISpun˘
)

	)

181 
	#is•a˚
(
c
Ë
	`__is˘y≥
((c), 
_IS•a˚
)

	)

182 
	#isuµî
(
c
Ë
	`__is˘y≥
((c), 
_ISuµî
)

	)

183 
	#isxdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISxdigô
)

	)

185 #ifde‡
__USE_ISOC99


186 
	#isbœnk
(
c
Ë
	`__is˘y≥
((c), 
_ISbœnk
)

	)

189 #ifde‡
__USE_EXTERN_INLINES


190 
__exã∫_ölöe
 

191 
__NTH
 (
	$tﬁowî
 (
__c
))

193  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_tﬁowî_loc
 ())[__c] : __c;

194 
	}
}

196 
__exã∫_ölöe
 

197 
__NTH
 (
	$touµî
 (
__c
))

199  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_touµî_loc
 ())[__c] : __c;

200 
	}
}

203 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


204 
	#tﬁowî
(
c
Ë
	`__tobody
 (c, 
tﬁowî
, *
	`__˘y≥_tﬁowî_loc
 (), (c))

	)

205 
	#touµî
(
c
Ë
	`__tobody
 (c, 
touµî
, *
	`__˘y≥_touµî_loc
 (), (c))

	)

208 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


209 
	#ißscii
(
c
Ë
	`__ißscii
 (c)

	)

210 
	#tﬂscii
(
c
Ë
	`__tﬂscii
 (c)

	)

212 
	#_tﬁowî
(
c
Ë((Ë(*
	`__˘y≥_tﬁowî_loc
 ())[(Ë(c)])

	)

213 
	#_touµî
(
c
Ë((Ë(*
	`__˘y≥_touµî_loc
 ())[(Ë(c)])

	)

219 #ifde‡
__USE_XOPEN2K8


233 
	~<xloˇÀ.h
>

237 
	#__is˘y≥_l
(
c
, 
ty≥
, 
loˇÀ
) \

238 ((
loˇÀ
)->
__˘y≥_b
[(Ë(
c
)] & (Ë
ty≥
)

	)

240 
	#__ex˘y≥_l
(
«me
) \

241 
	`«me
 (, 
__loˇÀ_t
Ë
__THROW


	)

247 
__ex˘y≥_l
 (
iß um_l
);

248 
__ex˘y≥_l
 (
ißÕha_l
);

249 
__ex˘y≥_l
 (
is˙ål_l
);

250 
__ex˘y≥_l
 (
isdigô_l
);

251 
__ex˘y≥_l
 (
i¶owî_l
);

252 
__ex˘y≥_l
 (
isgøph_l
);

253 
__ex˘y≥_l
 (
i•röt_l
);

254 
__ex˘y≥_l
 (
i•un˘_l
);

255 
__ex˘y≥_l
 (
is•a˚_l
);

256 
__ex˘y≥_l
 (
isuµî_l
);

257 
__ex˘y≥_l
 (
isxdigô_l
);

259 
__ex˘y≥_l
 (
isbœnk_l
);

263 
	$__tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

264 
	$tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

267 
	$__touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

268 
	$touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

270 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


271 
	#__tﬁowî_l
(
c
, 
loˇÀ
) \

272 
	`__tobody
 (
c
, 
__tﬁowî_l
, (
loˇÀ
)->
__˘y≥_tﬁowî
, (c,ÜoˇÀ))

	)

273 
	#__touµî_l
(
c
, 
loˇÀ
) \

274 
	`__tobody
 (
c
, 
__touµî_l
, (
loˇÀ
)->
__˘y≥_touµî
, (c,ÜoˇÀ))

	)

275 
	#tﬁowî_l
(
c
, 
loˇÀ
Ë
	`__tﬁowî_l
 ((c), (loˇÀ))

	)

276 
	#touµî_l
(
c
, 
loˇÀ
Ë
	`__touµî_l
 ((c), (loˇÀ))

	)

280 #i‚de‡
__NO_CTYPE


281 
	#__iß um_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆnum
, (l))

	)

282 
	#__ißÕha_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆpha
, (l))

	)

283 
	#__is˙ål_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS˙ål
, (l))

	)

284 
	#__isdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISdigô
, (l))

	)

285 
	#__i¶owî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISlowî
, (l))

	)

286 
	#__isgøph_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISgøph
, (l))

	)

287 
	#__i•röt_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS¥öt
, (l))

	)

288 
	#__i•un˘_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISpun˘
, (l))

	)

289 
	#__is•a˚_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS•a˚
, (l))

	)

290 
	#__isuµî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISuµî
, (l))

	)

291 
	#__isxdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISxdigô
, (l))

	)

293 
	#__isbœnk_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISbœnk
, (l))

	)

295 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


296 
	#__ißscii_l
(
c
,
l
Ë(÷), 
	`__ißscii
 (c))

	)

297 
	#__tﬂscii_l
(
c
,
l
Ë(÷), 
	`__tﬂscii
 (c))

	)

300 
	#iß um_l
(
c
,
l
Ë
	`__iß um_l
 ((c), (l))

	)

301 
	#ißÕha_l
(
c
,
l
Ë
	`__ißÕha_l
 ((c), (l))

	)

302 
	#is˙ål_l
(
c
,
l
Ë
	`__is˙ål_l
 ((c), (l))

	)

303 
	#isdigô_l
(
c
,
l
Ë
	`__isdigô_l
 ((c), (l))

	)

304 
	#i¶owî_l
(
c
,
l
Ë
	`__i¶owî_l
 ((c), (l))

	)

305 
	#isgøph_l
(
c
,
l
Ë
	`__isgøph_l
 ((c), (l))

	)

306 
	#i•röt_l
(
c
,
l
Ë
	`__i•röt_l
 ((c), (l))

	)

307 
	#i•un˘_l
(
c
,
l
Ë
	`__i•un˘_l
 ((c), (l))

	)

308 
	#is•a˚_l
(
c
,
l
Ë
	`__is•a˚_l
 ((c), (l))

	)

309 
	#isuµî_l
(
c
,
l
Ë
	`__isuµî_l
 ((c), (l))

	)

310 
	#isxdigô_l
(
c
,
l
Ë
	`__isxdigô_l
 ((c), (l))

	)

312 
	#isbœnk_l
(
c
,
l
Ë
	`__isbœnk_l
 ((c), (l))

	)

314 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


315 
	#ißscii_l
(
c
,
l
Ë
	`__ißscii_l
 ((c), (l))

	)

316 
	#tﬂscii_l
(
c
,
l
Ë
	`__tﬂscii_l
 ((c), (l))

	)

323 
__END_DECLS


	@/usr/include/math.h

25 #i‚def 
_MATH_H


26 
	#_MATH_H
 1

	)

28 
	~<„©uªs.h
>

30 
	g__BEGIN_DECLS


34 
	~<bôs/huge_vÆ.h
>

35 #ifde‡
__USE_ISOC99


36 
	~<bôs/huge_vÆf.h
>

37 
	~<bôs/huge_vÆl.h
>

40 
	~<bôs/öf.h
>

43 
	~<bôs/«n.h
>

47 
	~<bôs/m©hdef.h
>

54 
	#__MATHCALL
(
fun˘i⁄
,
suffix
, 
¨gs
) \

55 
	`__MATHDECL
 (
_MdoubÀ_
,
fun˘i⁄
,
suffix
, 
¨gs
)

	)

56 
	#__MATHDECL
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

57 
	`__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
); \

58 
	`__MATHDECL_1
(
ty≥
, 
	`__CONCAT
(
__
,
fun˘i⁄
),
suffix
, 
¨gs
)

	)

59 
	#__MATHCALLX
(
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
) \

60 
	`__MATHDECLX
 (
_MdoubÀ_
,
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
)

	)

61 
	#__MATHDECLX
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
) \

62 
	`__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
Ë
	`__©åibuã__
 (
©åib
); \

63 
	`__MATHDECL_1
(
ty≥
, 
	`__CONCAT
(
__
,
fun˘i⁄
),
suffix
, 
¨gs
Ë
	`__©åibuã__
 (
©åib
)

	)

64 
	#__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

65 
ty≥
 
	`__MATH_PRECNAME
(
fun˘i⁄
,
suffix
Ë
¨gs
 
__THROW


	)

67 
	#_MdoubÀ_
 

	)

68 
	#__MATH_PRECNAME
(
«me
,
r
Ë
	`__CONCAT
“ame,r)

	)

69 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_STD


	)

70 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_STD


	)

71 
	~<bôs/m©hˇŒs.h
>

72 #unde‡
_MdoubÀ_


73 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


74 #unde‡
_MdoubÀ_END_NAMESPACE


75 #unde‡
__MATH_PRECNAME


77 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


83 #i‚de‡
_MÊﬂt_


84 
	#_MÊﬂt_
 

	)

86 
	#_MdoubÀ_
 
_MÊﬂt_


	)

87 #ifde‡
__STDC__


88 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
f
##
	)
r

90 
	#__MATH_PRECNAME
(
«me
,
r
Ë«mê
f
 
	)
r

92 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

93 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

94 
	~<bôs/m©hˇŒs.h
>

95 #unde‡
_MdoubÀ_


96 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


97 #unde‡
_MdoubÀ_END_NAMESPACE


98 #unde‡
__MATH_PRECNAME


100 #i‡(
__STDC__
 - 0 || 
__GNUC__
 - 0) \

101 && (!
deföed
 
__NO_LONG_DOUBLE_MATH
 \

102 || 
deföed
 
__LDBL_COMPAT
 \

103 || !
deföed
 
_LIBC
)

104 #ifde‡
__LDBL_COMPAT


106 #ifde‡
__USE_ISOC99


107 
	$__∆dbl_√xâow¨df
 (
__x
, 
__y
)

108 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

109 #ifde‡
__REDIRECT_NTH


110 
	`__REDIRECT_NTH
 (
√xâow¨df
, (
__x
, 
__y
),

111 
__∆dbl_√xâow¨df
)

112 
	`__©åibuã__
 ((
__c⁄°__
));

113 
	`__REDIRECT_NTH
 (
√xâow¨d
, (
__x
, 
__y
),

114 
√xè·î
Ë
	`__©åibuã__
 ((
__c⁄°__
));

115 
	`__REDIRECT_NTH
 (
√xâow¨dl
,

116 (
__x
, 
__y
),

117 
√xè·î
Ë
	`__©åibuã__
 ((
__c⁄°__
));

122 #i‡
deföed
 
__LDBL_COMPAT
 || deföed 
__NO_LONG_DOUBLE_MATH


124 #unde‡
__MATHDECL_1


125 
	#__MATHDECL_2
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
Æüs
) \

126 
ty≥
 
	`__REDIRECT_NTH
(
	`__MATH_PRECNAME
(
fun˘i⁄
,
suffix
), \

127 
¨gs
, 
Æüs
)

	)

128 
	#__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

129 
	`__MATHDECL_2
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
	`__CONCAT
(fun˘i⁄,suffix))

	)

134 #i‚de‡
_Ml⁄g_doubÀ_


135 
	#_Ml⁄g_doubÀ_
 

	)

137 
	#_MdoubÀ_
 
_Ml⁄g_doubÀ_


	)

138 #ifde‡
__STDC__


139 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
l
##
	)
r

141 
	#__MATH_PRECNAME
(
«me
,
r
Ë«mê
l
 
	)
r

143 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

144 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

145 
	~<bôs/m©hˇŒs.h
>

146 #unde‡
_MdoubÀ_


147 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


148 #unde‡
_MdoubÀ_END_NAMESPACE


149 #unde‡
__MATH_PRECNAME


154 #unde‡
__MATHDECL_1


155 #unde‡
__MATHDECL


156 #unde‡
__MATHCALL


159 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


161 
signgam
;

166 #ifde‡
__USE_ISOC99


204 
FP_NAN
,

205 
	#FP_NAN
 
FP_NAN


	)

206 
FP_INFINITE
,

207 
	#FP_INFINITE
 
FP_INFINITE


	)

208 
FP_ZERO
,

209 
	#FP_ZERO
 
FP_ZERO


	)

210 
FP_SUBNORMAL
,

211 
	#FP_SUBNORMAL
 
FP_SUBNORMAL


	)

212 
FP_NORMAL


213 
	#FP_NORMAL
 
FP_NORMAL


	)

217 #ifde‡
__NO_LONG_DOUBLE_MATH


218 
	#Â˛assify
(
x
) \

219 ( (
x
Ë= (Ë? 
	`__Â˛assifyf
 (xË: 
	`__Â˛assify
 (x))

	)

221 
	#Â˛assify
(
x
) \

222 ( (
x
) ==  () \

223 ? 
	`__Â˛assifyf
 (
x
) \

224 :  (
x
) ==  () \

225 ? 
	`__Â˛assify
 (
x
Ë: 
	`__Â˛assifyl
 (x))

	)

229 #ifde‡
__NO_LONG_DOUBLE_MATH


230 
	#signbô
(
x
) \

231 ( (
x
Ë= (Ë? 
	`__signbôf
 (xË: 
	`__signbô
 (x))

	)

233 
	#signbô
(
x
) \

234 ( (
x
) ==  () \

235 ? 
	`__signbôf
 (
x
) \

236 :  (
x
) ==  () \

237 ? 
	`__signbô
 (
x
Ë: 
	`__signbôl
 (x))

	)

241 #ifde‡
__NO_LONG_DOUBLE_MATH


242 
	#isföôe
(
x
) \

243 ( (
x
Ë= (Ë? 
	`__föôef
 (xË: 
	`__föôe
 (x))

	)

245 
	#isföôe
(
x
) \

246 ( (
x
) ==  () \

247 ? 
	`__föôef
 (
x
) \

248 :  (
x
) ==  () \

249 ? 
	`__föôe
 (
x
Ë: 
	`__föôñ
 (x))

	)

253 
	#i¢‹mÆ
(
x
Ë(
	`Â˛assify
 (xË=
FP_NORMAL
)

	)

257 #ifde‡
__NO_LONG_DOUBLE_MATH


258 
	#i¢™
(
x
) \

259 ( (
x
Ë= (Ë? 
	`__i¢™f
 (xË: 
	`__i¢™
 (x))

	)

261 
	#i¢™
(
x
) \

262 ( (
x
) ==  () \

263 ? 
	`__i¢™f
 (
x
) \

264 :  (
x
) ==  () \

265 ? 
	`__i¢™
 (
x
Ë: 
	`__i¢™l
 (x))

	)

269 #ifde‡
__NO_LONG_DOUBLE_MATH


270 
	#isöf
(
x
) \

271 ( (
x
Ë= (Ë? 
	`__isöff
 (xË: 
	`__isöf
 (x))

	)

273 
	#isöf
(
x
) \

274 ( (
x
) ==  () \

275 ? 
	`__isöff
 (
x
) \

276 :  (
x
) ==  () \

277 ? 
	`__isöf
 (
x
Ë: 
	`__isöÊ
 (x))

	)

281 
	#MATH_ERRNO
 1

	)

282 
	#MATH_ERREXCEPT
 2

	)

287 #i‚de‡
__FAST_MATH__


288 
	#m©h_îrh™dlög
 (
MATH_ERRNO
 | 
MATH_ERREXCEPT
)

	)

293 #ifdef 
__USE_MISC


297 
_IEEE_
 = -1,

298 
_SVID_
,

299 
_XOPEN_
,

300 
_POSIX_
,

301 
_ISOC_


302 } 
	t_LIB_VERSION_TYPE
;

307 
_LIB_VERSION_TYPE
 
_LIB_VERSION
;

311 #ifde‡
__USE_SVID


317 #ifde‡
__˝lu•lus


318 
__ex˚±i⁄


320 
ex˚±i⁄


323 
ty≥
;

324 *
«me
;

325 
¨g1
;

326 
¨g2
;

327 
ªtvÆ
;

328 
	}
};

330 #ifde‡
__˝lu•lus


331 
	$m©hîr
 (
__ex˚±i⁄
 *
__exc
Ë
	`throw
 ();

333 
	`m©hîr
 (
ex˚±i⁄
 *
__exc
);

336 
	#X_TLOSS
 1.41484755040568800000e+16

	)

339 
	#DOMAIN
 1

	)

340 
	#SING
 2

	)

341 
	#OVERFLOW
 3

	)

342 
	#UNDERFLOW
 4

	)

343 
	#TLOSS
 5

	)

344 
	#PLOSS
 6

	)

347 
	#HUGE
 3.40282347e+38F

	)

351 #ifde‡
__USE_XOPEN


353 
	#MAXFLOAT
 3.40282347e+38F

	)

360 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN


361 
	#M_E
 2.7182818284590452354

	)

362 
	#M_LOG2E
 1.4426950408889634074

	)

363 
	#M_LOG10E
 0.43429448190325182765

	)

364 
	#M_LN2
 0.69314718055994530942

	)

365 
	#M_LN10
 2.30258509299404568402

	)

366 
	#M_PI
 3.14159265358979323846

	)

367 
	#M_PI_2
 1.57079632679489661923

	)

368 
	#M_PI_4
 0.78539816339744830962

	)

369 
	#M_1_PI
 0.31830988618379067154

	)

370 
	#M_2_PI
 0.63661977236758134308

	)

371 
	#M_2_SQRTPI
 1.12837916709551257390

	)

372 
	#M_SQRT2
 1.41421356237309504880

	)

373 
	#M_SQRT1_2
 0.70710678118654752440

	)

379 #ifde‡
__USE_GNU


380 
	#M_El
 2.7182818284590452353602874713526625L

	)

381 
	#M_LOG2El
 1.4426950408889634073599246810018921L

	)

382 
	#M_LOG10El
 0.4342944819032518276511289189166051L

	)

383 
	#M_LN2l
 0.6931471805599453094172321214581766L

	)

384 
	#M_LN10l
 2.3025850929940456840179914546843642L

	)

385 
	#M_PIl
 3.1415926535897932384626433832795029L

	)

386 
	#M_PI_2l
 1.5707963267948966192313216916397514L

	)

387 
	#M_PI_4l
 0.7853981633974483096156608458198757L

	)

388 
	#M_1_PIl
 0.3183098861837906715377675267450287L

	)

389 
	#M_2_PIl
 0.6366197723675813430755350534900574L

	)

390 
	#M_2_SQRTPIl
 1.1283791670955125738961589031215452L

	)

391 
	#M_SQRT2l
 1.4142135623730950488016887242096981L

	)

392 
	#M_SQRT1_2l
 0.7071067811865475244008443621048490L

	)

399 #i‡
deföed
 
__STRICT_ANSI__
 && !deföed 
__NO_MATH_INLINES


400 
	#__NO_MATH_INLINES
 1

	)

403 #i‡
deföed
 
__USE_ISOC99
 && 
	`__GNUC_PREREQ
(2,97)

410 
	#isgª©î
(
x
, 
y
Ë
	`__buûtö_isgª©î
(x, y)

	)

411 
	#isgª©îequÆ
(
x
, 
y
Ë
	`__buûtö_isgª©îequÆ
(x, y)

	)

412 
	#i¶ess
(
x
, 
y
Ë
	`__buûtö_i¶ess
(x, y)

	)

413 
	#i¶es£quÆ
(
x
, 
y
Ë
	`__buûtö_i¶es£quÆ
(x, y)

	)

414 
	#i¶essgª©î
(
x
, 
y
Ë
	`__buûtö_i¶essgª©î
(x, y)

	)

415 
	#isun‹dîed
(
u
, 
v
Ë
	`__buûtö_isun‹dîed
(u, v)

	)

419 #ifde‡
__USE_EXTERN_INLINES


420 
	~<bôs/m©hölöe.h
>

423 #ifde‡
__USE_ISOC99


427 #i‚de‡
isgª©î


428 
	#isgª©î
(
x
, 
y
) \

429 (
__exãnsi⁄__
 \

430 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

431 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x > __y; 
	}
}))

	)

435 #i‚de‡
isgª©îequÆ


436 
	#isgª©îequÆ
(
x
, 
y
) \

437 (
__exãnsi⁄__
 \

438 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

439 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x >__y; }))

	)

443 #i‚de‡
i¶ess


444 
	#i¶ess
(
x
, 
y
) \

445 (
__exãnsi⁄__
 \

446 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

447 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x < __y; }))

	)

451 #i‚de‡
i¶es£quÆ


452 
	#i¶es£quÆ
(
x
, 
y
) \

453 (
__exãnsi⁄__
 \

454 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

455 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x <__y; }))

	)

459 #i‚de‡
i¶essgª©î


460 
	#i¶essgª©î
(
x
, 
y
) \

461 (
__exãnsi⁄__
 \

462 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

463 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& (__x < __y || __y < __x); }))

	)

467 #i‚de‡
isun‹dîed


468 
	#isun‹dîed
(
u
, 
v
) \

469 (
__exãnsi⁄__
 \

470 ({ 
	`__ty≥of__
(
u
Ë
__u
 = (u); __ty≥of__(
v
Ë
__v
 = (v); \

471 
	`Â˛assify
 (
__u
Ë=
FP_NAN
 || fp˛assify (
__v
Ë=FP_NAN; }))

	)

476 
	g__END_DECLS


	@/usr/include/stdio.h

24 #i‚de‡
_STDIO_H


26 #i‡!
deföed
 
__√ed_FILE
 && !deföed 
__√ed___FILE


27 
	#_STDIO_H
 1

	)

28 
	~<„©uªs.h
>

30 
	g__BEGIN_DECLS


32 
	#__√ed_size_t


	)

33 
	#__√ed_NULL


	)

34 
	~<°ddef.h
>

36 
	~<bôs/ty≥s.h
>

37 
	#__√ed_FILE


	)

38 
	#__√ed___FILE


	)

42 #i‡!
deföed
 
__FILE_deföed
 && deföed 
__√ed_FILE


45 
	g_IO_FILE
;

47 
__BEGIN_NAMESPACE_STD


49 
_IO_FILE
 
	tFILE
;

50 
	g__END_NAMESPACE_STD


51 #i‡
deföed
 
__USE_LARGEFILE64
 || deföed 
__USE_SVID
 || deföed 
__USE_POSIX
 \

52 || 
deföed
 
	g__USE_BSD
 || deföed 
	g__USE_ISOC99
 || deföed 
	g__USE_XOPEN
 \

53 || 
deföed
 
__USE_POSIX2


54 
	$__USING_NAMESPACE_STD
(
FILE
)

57 
	#__FILE_deföed
 1

	)

59 #unde‡
__√ed_FILE


62 #i‡!
deföed
 
____FILE_deföed
 && deföed 
__√ed___FILE


65 
_IO_FILE
 
	t__FILE
;

67 
	#____FILE_deföed
 1

	)

69 #unde‡
__√ed___FILE


72 #ifdef 
_STDIO_H


73 
	#_STDIO_USES_IOSTREAM


	)

75 
	~<libio.h
>

77 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


78 #ifde‡
__GNUC__


79 #i‚de‡
_VA_LIST_DEFINED


80 
_G_va_li°
 
	tva_li°
;

81 
	#_VA_LIST_DEFINED


	)

84 
	~<°d¨g.h
>

88 #ifde‡
__USE_XOPEN2K8


89 #i‚de‡
__off_t_deföed


90 #i‚de‡
__USE_FILE_OFFSET64


91 
__off_t
 
	toff_t
;

93 
__off64_t
 
	toff_t
;

95 
	#__off_t_deföed


	)

97 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


98 
__off64_t
 
	toff64_t
;

99 
	#__off64_t_deföed


	)

102 #i‚de‡
__ssize_t_deföed


103 
__ssize_t
 
	tssize_t
;

104 
	#__ssize_t_deföed


	)

109 
__BEGIN_NAMESPACE_STD


110 #i‚de‡
__USE_FILE_OFFSET64


111 
_G_Âos_t
 
	tÂos_t
;

113 
_G_Âos64_t
 
	tÂos_t
;

115 
__END_NAMESPACE_STD


116 #ifde‡
__USE_LARGEFILE64


117 
_G_Âos64_t
 
	tÂos64_t
;

121 
	#_IOFBF
 0

	)

122 
	#_IOLBF
 1

	)

123 
	#_IONBF
 2

	)

127 #i‚de‡
BUFSIZ


128 
	#BUFSIZ
 
_IO_BUFSIZ


	)

134 #i‚de‡
EOF


135 
	#EOF
 (-1)

	)

141 
	#SEEK_SET
 0

	)

142 
	#SEEK_CUR
 1

	)

143 
	#SEEK_END
 2

	)

146 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


148 
	#P_tmpdú
 "/tmp"

	)

161 
	~<bôs/°dio_lim.h
>

165 
_IO_FILE
 *
°dö
;

166 
_IO_FILE
 *
°dout
;

167 
_IO_FILE
 *
°dîr
;

169 
	#°dö
 
°dö


	)

170 
	#°dout
 
°dout


	)

171 
	#°dîr
 
°dîr


	)

173 
__BEGIN_NAMESPACE_STD


175 
	$ªmove
 (
__c⁄°
 *
__fûíame
Ë
__THROW
;

177 
	$ª«me
 (
__c⁄°
 *
__ﬁd
, __c⁄° *
__√w
Ë
__THROW
;

178 
__END_NAMESPACE_STD


180 #ifde‡
__USE_ATFILE


182 
	$ª«mót
 (
__ﬁdfd
, 
__c⁄°
 *
__ﬁd
, 
__√wfd
,

183 
__c⁄°
 *
__√w
Ë
__THROW
;

186 
__BEGIN_NAMESPACE_STD


191 #i‚de‡
__USE_FILE_OFFSET64


192 
FILE
 *
	$tmpfûe
 (Ë
__wur
;

194 #ifde‡
__REDIRECT


195 
FILE
 *
	`__REDIRECT
 (
tmpfûe
, (), 
tmpfûe64
Ë
__wur
;

197 
	#tmpfûe
 
tmpfûe64


	)

201 #ifde‡
__USE_LARGEFILE64


202 
FILE
 *
	$tmpfûe64
 (Ë
__wur
;

206 *
	$tm≤am
 (*
__s
Ë
__THROW
 
__wur
;

207 
__END_NAMESPACE_STD


209 #ifde‡
__USE_MISC


212 *
	$tm≤am_r
 (*
__s
Ë
__THROW
 
__wur
;

216 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


224 *
	$ãm≤am
 (
__c⁄°
 *
__dú
, __c⁄° *
__pfx
)

225 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

229 
__BEGIN_NAMESPACE_STD


234 
	`f˛o£
 (
FILE
 *
__°ªam
);

239 
	`fÊush
 (
FILE
 *
__°ªam
);

240 
__END_NAMESPACE_STD


242 #ifde‡
__USE_MISC


249 
	`fÊush_u∆ocked
 (
FILE
 *
__°ªam
);

252 #ifde‡
__USE_GNU


259 
	`f˛o£Æl
 ();

263 
__BEGIN_NAMESPACE_STD


264 #i‚de‡
__USE_FILE_OFFSET64


269 
FILE
 *
	$f›í
 (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

270 
__c⁄°
 *
__ª°ri˘
 
__modes
Ë
__wur
;

275 
FILE
 *
	$‰e›í
 (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

276 
__c⁄°
 *
__ª°ri˘
 
__modes
,

277 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

279 #ifde‡
__REDIRECT


280 
FILE
 *
	`__REDIRECT
 (
f›í
, (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

281 
__c⁄°
 *
__ª°ri˘
 
__modes
), 
f›í64
)

282 
__wur
;

283 
FILE
 *
	`__REDIRECT
 (
‰e›í
, (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

284 
__c⁄°
 *
__ª°ri˘
 
__modes
,

285 
FILE
 *
__ª°ri˘
 
__°ªam
), 
‰e›í64
)

286 
__wur
;

288 
	#f›í
 
f›í64


	)

289 
	#‰e›í
 
‰e›í64


	)

292 
__END_NAMESPACE_STD


293 #ifde‡
__USE_LARGEFILE64


294 
FILE
 *
	$f›í64
 (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

295 
__c⁄°
 *
__ª°ri˘
 
__modes
Ë
__wur
;

296 
FILE
 *
	$‰e›í64
 (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

297 
__c⁄°
 *
__ª°ri˘
 
__modes
,

298 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

301 #ifdef 
__USE_POSIX


303 
FILE
 *
	$fd›í
 (
__fd
, 
__c⁄°
 *
__modes
Ë
__THROW
 
__wur
;

306 #ifdef 
__USE_GNU


309 
FILE
 *
	$f›ícookõ
 (*
__ª°ri˘
 
__magic_cookõ
,

310 
__c⁄°
 *
__ª°ri˘
 
__modes
,

311 
_IO_cookõ_io_fun˘i⁄s_t
 
__io_funcs
Ë
__THROW
 
__wur
;

314 #ifde‡
__USE_XOPEN2K8


316 
FILE
 *
	$fmem›í
 (*
__s
, 
size_t
 
__Àn
, 
__c⁄°
 *
__modes
)

317 
__THROW
 
__wur
;

322 
FILE
 *
	$›í_mem°ªam
 (**
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
 
__wur
;

326 
__BEGIN_NAMESPACE_STD


329 
	$£tbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
Ë
__THROW
;

333 
	$£tvbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

334 
__modes
, 
size_t
 
__n
Ë
__THROW
;

335 
__END_NAMESPACE_STD


337 #ifdef 
__USE_BSD


340 
	$£tbuf„r
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

341 
size_t
 
__size
Ë
__THROW
;

344 
	$£éöebuf
 (
FILE
 *
__°ªam
Ë
__THROW
;

348 
__BEGIN_NAMESPACE_STD


353 
	`Ârötf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

354 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...);

359 
	`¥ötf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...);

361 
	$•rötf
 (*
__ª°ri˘
 
__s
,

362 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

368 
	`vÂrötf
 (
FILE
 *
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__f‹m©
,

369 
_G_va_li°
 
__¨g
);

374 
	`v¥ötf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
);

376 
	$v•rötf
 (*
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__f‹m©
,

377 
_G_va_li°
 
__¨g
Ë
__THROW
;

378 
__END_NAMESPACE_STD


380 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_ISOC99
 || deföed 
__USE_UNIX98


381 
__BEGIN_NAMESPACE_C99


383 
	$¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

384 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...)

385 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 4)));

387 
	$v¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

388 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

389 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 0)));

390 
__END_NAMESPACE_C99


393 #ifde‡
__USE_GNU


396 
	$va•rötf
 (**
__ª°ri˘
 
__±r
, 
__c⁄°
 *__ª°ri˘ 
__f
,

397 
_G_va_li°
 
__¨g
)

398 
__THROW
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 0))Ë
__wur
;

399 
	$__a•rötf
 (**
__ª°ri˘
 
__±r
,

400 
__c⁄°
 *
__ª°ri˘
 
__fmt
, ...)

401 
__THROW
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

402 
	$a•rötf
 (**
__ª°ri˘
 
__±r
,

403 
__c⁄°
 *
__ª°ri˘
 
__fmt
, ...)

404 
__THROW
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

407 #ifde‡
__USE_XOPEN2K8


414 
	$vd¥ötf
 (
__fd
, 
__c⁄°
 *
__ª°ri˘
 
__fmt
,

415 
_G_va_li°
 
__¨g
)

416 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

417 
	$d¥ötf
 (
__fd
, 
__c⁄°
 *
__ª°ri˘
 
__fmt
, ...)

418 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

422 
__BEGIN_NAMESPACE_STD


427 
	$fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

428 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

433 
	$sˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

435 
	$ssˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

436 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

438 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

439 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

440 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

441 #ifde‡
__REDIRECT


445 
	`__REDIRECT
 (
fsˇnf
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

446 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...),

447 
__isoc99_fsˇnf
Ë
__wur
;

448 
	`__REDIRECT
 (
sˇnf
, (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...),

449 
__isoc99_sˇnf
Ë
__wur
;

450 
	`__REDIRECT_NTH
 (
ssˇnf
, (
__c⁄°
 *
__ª°ri˘
 
__s
,

451 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...),

452 
__isoc99_ssˇnf
);

454 
	$__isoc99_fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

455 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

456 
	$__isoc99_sˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

457 
	$__isoc99_ssˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

458 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

459 
	#fsˇnf
 
__isoc99_fsˇnf


	)

460 
	#sˇnf
 
__isoc99_sˇnf


	)

461 
	#ssˇnf
 
__isoc99_ssˇnf


	)

465 
__END_NAMESPACE_STD


467 #ifdef 
__USE_ISOC99


468 
__BEGIN_NAMESPACE_C99


473 
	$vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__f‹m©
,

474 
_G_va_li°
 
__¨g
)

475 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

481 
	$vsˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

482 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

485 
	$vssˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

486 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

487 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

489 #i‡!
deföed
 
__USE_GNU
 \

490 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

491 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

492 #ifde‡
__REDIRECT


496 
	`__REDIRECT
 (
vfsˇnf
,

497 (
FILE
 *
__ª°ri˘
 
__s
,

498 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
),

499 
__isoc99_vfsˇnf
)

500 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

501 
	`__REDIRECT
 (
vsˇnf
, (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

502 
_G_va_li°
 
__¨g
), 
__isoc99_vsˇnf
)

503 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

504 
	`__REDIRECT_NTH
 (
vssˇnf
,

505 (
__c⁄°
 *
__ª°ri˘
 
__s
,

506 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

507 
_G_va_li°
 
__¨g
), 
__isoc99_vssˇnf
)

508 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

510 
	$__isoc99_vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
,

511 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

512 
_G_va_li°
 
__¨g
Ë
__wur
;

513 
	$__isoc99_vsˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

514 
_G_va_li°
 
__¨g
Ë
__wur
;

515 
	$__isoc99_vssˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

516 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

517 
_G_va_li°
 
__¨g
Ë
__THROW
;

518 
	#vfsˇnf
 
__isoc99_vfsˇnf


	)

519 
	#vsˇnf
 
__isoc99_vsˇnf


	)

520 
	#vssˇnf
 
__isoc99_vssˇnf


	)

524 
__END_NAMESPACE_C99


528 
__BEGIN_NAMESPACE_STD


533 
	`fgëc
 (
FILE
 *
__°ªam
);

534 
	`gëc
 (
FILE
 *
__°ªam
);

540 
	`gëch¨
 ();

541 
__END_NAMESPACE_STD


545 
	#gëc
(
_Â
Ë
	`_IO_gëc
 (_Â)

	)

547 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


552 
	`gëc_u∆ocked
 (
FILE
 *
__°ªam
);

553 
	`gëch¨_u∆ocked
 ();

556 #ifde‡
__USE_MISC


563 
	`fgëc_u∆ocked
 (
FILE
 *
__°ªam
);

567 
__BEGIN_NAMESPACE_STD


575 
	`Âutc
 (
__c
, 
FILE
 *
__°ªam
);

576 
	`putc
 (
__c
, 
FILE
 *
__°ªam
);

582 
	`putch¨
 (
__c
);

583 
__END_NAMESPACE_STD


587 
	#putc
(
_ch
, 
_Â
Ë
	`_IO_putc
 (_ch, _Â)

	)

589 #ifde‡
__USE_MISC


596 
	`Âutc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

599 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


604 
	`putc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

605 
	`putch¨_u∆ocked
 (
__c
);

609 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 \

610 || (
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

612 
	`gëw
 (
FILE
 *
__°ªam
);

615 
	`putw
 (
__w
, 
FILE
 *
__°ªam
);

619 
__BEGIN_NAMESPACE_STD


624 *
	$fgës
 (*
__ª°ri˘
 
__s
, 
__n
, 
FILE
 *__ª°ri˘ 
__°ªam
)

625 
__wur
;

632 *
	$gës
 (*
__s
Ë
__wur
;

633 
__END_NAMESPACE_STD


635 #ifde‡
__USE_GNU


642 *
	$fgës_u∆ocked
 (*
__ª°ri˘
 
__s
, 
__n
,

643 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

647 #ifdef 
__USE_XOPEN2K8


658 
_IO_ssize_t
 
	$__gëdñim
 (**
__ª°ri˘
 
__löïå
,

659 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

660 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

661 
_IO_ssize_t
 
	$gëdñim
 (**
__ª°ri˘
 
__löïå
,

662 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

663 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

671 
_IO_ssize_t
 
	$gëlöe
 (**
__ª°ri˘
 
__löïå
,

672 
size_t
 *
__ª°ri˘
 
__n
,

673 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

677 
__BEGIN_NAMESPACE_STD


682 
	`Âuts
 (
__c⁄°
 *
__ª°ri˘
 
__s
, 
FILE
 *__ª°ri˘ 
__°ªam
);

688 
	`puts
 (
__c⁄°
 *
__s
);

695 
	`ungëc
 (
__c
, 
FILE
 *
__°ªam
);

702 
size_t
 
	$‰ód
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

703 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

708 
size_t
 
	`fwrôe
 (
__c⁄°
 *
__ª°ri˘
 
__±r
, size_à
__size
,

709 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__s
);

710 
__END_NAMESPACE_STD


712 #ifde‡
__USE_GNU


719 
	`Âuts_u∆ocked
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

720 
FILE
 *
__ª°ri˘
 
__°ªam
);

723 #ifde‡
__USE_MISC


730 
size_t
 
	$‰ód_u∆ocked
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

731 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

732 
size_t
 
	`fwrôe_u∆ocked
 (
__c⁄°
 *
__ª°ri˘
 
__±r
, size_à
__size
,

733 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
);

737 
__BEGIN_NAMESPACE_STD


742 
	`f£ek
 (
FILE
 *
__°ªam
, 
__off
, 
__whí˚
);

747 
	$·ñl
 (
FILE
 *
__°ªam
Ë
__wur
;

752 
	`ªwöd
 (
FILE
 *
__°ªam
);

753 
__END_NAMESPACE_STD


760 #i‡
deföed
 
__USE_LARGEFILE
 || deföed 
__USE_XOPEN2K


761 #i‚de‡
__USE_FILE_OFFSET64


766 
	`f£eko
 (
FILE
 *
__°ªam
, 
__off_t
 
__off
, 
__whí˚
);

771 
__off_t
 
	$·ñlo
 (
FILE
 *
__°ªam
Ë
__wur
;

773 #ifde‡
__REDIRECT


774 
	`__REDIRECT
 (
f£eko
,

775 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
),

776 
f£eko64
);

777 
__off64_t
 
	`__REDIRECT
 (
·ñlo
, (
FILE
 *
__°ªam
), 
·ñlo64
);

779 
	#f£eko
 
f£eko64


	)

780 
	#·ñlo
 
·ñlo64


	)

785 
__BEGIN_NAMESPACE_STD


786 #i‚de‡
__USE_FILE_OFFSET64


791 
	`fgëpos
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos_t
 *__ª°ri˘ 
__pos
);

796 
	`f£ços
 (
FILE
 *
__°ªam
, 
__c⁄°
 
Âos_t
 *
__pos
);

798 #ifde‡
__REDIRECT


799 
	`__REDIRECT
 (
fgëpos
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

800 
Âos_t
 *
__ª°ri˘
 
__pos
), 
fgëpos64
);

801 
	`__REDIRECT
 (
f£ços
,

802 (
FILE
 *
__°ªam
, 
__c⁄°
 
Âos_t
 *
__pos
), 
f£ços64
);

804 
	#fgëpos
 
fgëpos64


	)

805 
	#f£ços
 
f£ços64


	)

808 
__END_NAMESPACE_STD


810 #ifde‡
__USE_LARGEFILE64


811 
	`f£eko64
 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
);

812 
__off64_t
 
	$·ñlo64
 (
FILE
 *
__°ªam
Ë
__wur
;

813 
	`fgëpos64
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos64_t
 *__ª°ri˘ 
__pos
);

814 
	`f£ços64
 (
FILE
 *
__°ªam
, 
__c⁄°
 
Âos64_t
 *
__pos
);

817 
__BEGIN_NAMESPACE_STD


819 
	$˛óªº
 (
FILE
 *
__°ªam
Ë
__THROW
;

821 
	$„of
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

823 
	$„º‹
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

824 
__END_NAMESPACE_STD


826 #ifde‡
__USE_MISC


828 
	$˛óªº_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
;

829 
	$„of_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

830 
	$„º‹_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

834 
__BEGIN_NAMESPACE_STD


839 
	`≥º‹
 (
__c⁄°
 *
__s
);

840 
__END_NAMESPACE_STD


846 
	~<bôs/sys_îæi°.h
>

849 #ifdef 
__USE_POSIX


851 
	$fûío
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

854 #ifde‡
__USE_MISC


856 
	$fûío_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

860 #i‡(
deföed
 
__USE_POSIX2
 || deföed 
__USE_SVID
 || deföed 
__USE_BSD
 || \

861 
deföed
 
__USE_MISC
)

866 
FILE
 *
	$p›í
 (
__c⁄°
 *
__comm™d
, __c⁄° *
__modes
Ë
__wur
;

872 
	`p˛o£
 (
FILE
 *
__°ªam
);

876 #ifdef 
__USE_POSIX


878 *
	$˘îmid
 (*
__s
Ë
__THROW
;

882 #ifde‡
__USE_XOPEN


884 *
	`cu£rid
 (*
__s
);

888 #ifdef 
__USE_GNU


889 
ob°ack
;

892 
	$ob°ack_¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

893 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...)

894 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

895 
	$ob°ack_v¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

896 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

897 
_G_va_li°
 
__¨gs
)

898 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

902 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


906 
	$Êockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

910 
	$·rylockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

913 
	$fu∆ockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

916 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


920 
	#__√ed_gë›t


	)

921 
	~<gë›t.h
>

926 #ifde‡
__USE_EXTERN_INLINES


927 
	~<bôs/°dio.h
>

929 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


930 
	~<bôs/°dio2.h
>

932 #ifde‡
__LDBL_COMPAT


933 
	~<bôs/°dio-ldbl.h
>

936 
__END_DECLS


	@/usr/include/stdlib.h

23 #i‚def 
_STDLIB_H


25 
	~<„©uªs.h
>

28 
	#__√ed_size_t


	)

29 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


30 
	#__√ed_wch¨_t


	)

31 
	#__√ed_NULL


	)

33 
	~<°ddef.h
>

35 
	g__BEGIN_DECLS


37 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


38 
	#_STDLIB_H
 1

	)

40 #i‡(
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8
Ë&& !deföed 
_SYS_WAIT_H


42 
	~<bôs/waôÊags.h
>

43 
	~<bôs/waô°©us.h
>

45 #ifde‡
__USE_BSD


50 #i‡
deföed
 
__GNUC__
 && !deföed 
__˝lu•lus


51 
	#__WAIT_INT
(
°©us
) \

52 (
	`__exãnsi⁄__
 (((uni⁄ { 
	`__ty≥of
(
°©us
Ë
__ö
; 
__i
; }) \

53 { .
__ö
 = (
°©us
Ë}).
__i
))

	)

55 
	#__WAIT_INT
(
°©us
Ë(*(*Ë&(°©us))

	)

63 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2 || deföed 
__˝lu•lus


64 
	#__WAIT_STATUS
 *

	)

65 
	#__WAIT_STATUS_DEFN
 *

	)

70 
waô
 *
	m__u±r
;

71 *
	m__ùå
;

72 } 
	t__WAIT_STATUS
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

73 
	#__WAIT_STATUS_DEFN
 *

	)

78 
	#__WAIT_INT
(
°©us
Ë(°©us)

	)

79 
	#__WAIT_STATUS
 *

	)

80 
	#__WAIT_STATUS_DEFN
 *

	)

85 
	#WEXITSTATUS
(
°©us
Ë
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (°©us))

	)

86 
	#WTERMSIG
(
°©us
Ë
	`__WTERMSIG
 (
	`__WAIT_INT
 (°©us))

	)

87 
	#WSTOPSIG
(
°©us
Ë
	`__WSTOPSIG
 (
	`__WAIT_INT
 (°©us))

	)

88 
	#WIFEXITED
(
°©us
Ë
	`__WIFEXITED
 (
	`__WAIT_INT
 (°©us))

	)

89 
	#WIFSIGNALED
(
°©us
Ë
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (°©us))

	)

90 
	#WIFSTOPPED
(
°©us
Ë
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (°©us))

	)

91 #ifde‡
__WIFCONTINUED


92 
	#WIFCONTINUED
(
°©us
Ë
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (°©us))

	)

96 
__BEGIN_NAMESPACE_STD


100 
	mquŸ
;

101 
	mªm
;

102 } 
	tdiv_t
;

105 #i‚de‡
__ldiv_t_deföed


108 
	mquŸ
;

109 
	mªm
;

110 } 
	tldiv_t
;

111 
	#__ldiv_t_deföed
 1

	)

113 
	g__END_NAMESPACE_STD


115 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__Œdiv_t_deföed


116 
__BEGIN_NAMESPACE_C99


118 
__exãnsi⁄__
 struct

120 
	mquŸ
;

121 
	mªm
;

122 } 
	tŒdiv_t
;

123 
	#__Œdiv_t_deföed
 1

	)

124 
	g__END_NAMESPACE_C99


129 
	#RAND_MAX
 2147483647

	)

134 
	#EXIT_FAILURE
 1

	)

135 
	#EXIT_SUCCESS
 0

	)

139 
	#MB_CUR_MAX
 (
	`__˘y≥_gë_mb_cur_max
 ())

	)

140 
size_t
 
	$__˘y≥_gë_mb_cur_max
 (Ë
__THROW
 
__wur
;

143 
__BEGIN_NAMESPACE_STD


145 
	$©of
 (
__c⁄°
 *
__≈å
)

146 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

148 
	$©oi
 (
__c⁄°
 *
__≈å
)

149 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

151 
	$©ﬁ
 (
__c⁄°
 *
__≈å
)

152 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

153 
__END_NAMESPACE_STD


155 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_MISC
)

156 
__BEGIN_NAMESPACE_C99


158 
__exãnsi⁄__
 
	$©ﬁl
 (
__c⁄°
 *
__≈å
)

159 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

160 
__END_NAMESPACE_C99


163 
__BEGIN_NAMESPACE_STD


165 
	$°πod
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

166 **
__ª°ri˘
 
__íd±r
)

167 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

168 
__END_NAMESPACE_STD


170 #ifdef 
__USE_ISOC99


171 
__BEGIN_NAMESPACE_C99


173 
	$°πof
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

174 **
__ª°ri˘
 
__íd±r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

176 
	$°πﬁd
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

177 **
__ª°ri˘
 
__íd±r
)

178 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

179 
__END_NAMESPACE_C99


182 
__BEGIN_NAMESPACE_STD


184 
	$°πﬁ
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

185 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

186 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

188 
	$°πoul
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

189 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

190 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

191 
__END_NAMESPACE_STD


193 #i‡
deföed
 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_BSD


195 
__exãnsi⁄__


196 
	$°πoq
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

197 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

198 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

200 
__exãnsi⁄__


201 
	$°πouq
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

202 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

203 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

206 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_MISC
)

207 
__BEGIN_NAMESPACE_C99


209 
__exãnsi⁄__


210 
	$°πﬁl
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

211 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

212 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

214 
__exãnsi⁄__


215 
	$°πouŒ
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

216 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

217 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

218 
__END_NAMESPACE_C99


222 #ifde‡
__USE_GNU


236 
	~<xloˇÀ.h
>

240 
	$°πﬁ_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

241 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

242 
__loˇÀ_t
 
__loc
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 4)Ë
__wur
;

244 
	$°πoul_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

245 **
__ª°ri˘
 
__íd±r
,

246 
__ba£
, 
__loˇÀ_t
 
__loc
)

247 
__THROW
 
	`__n⁄nuŒ
 ((1, 4)Ë
__wur
;

249 
__exãnsi⁄__


250 
	$°πﬁl_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

251 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

252 
__loˇÀ_t
 
__loc
)

253 
__THROW
 
	`__n⁄nuŒ
 ((1, 4)Ë
__wur
;

255 
__exãnsi⁄__


256 
	$°πouŒ_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

257 **
__ª°ri˘
 
__íd±r
,

258 
__ba£
, 
__loˇÀ_t
 
__loc
)

259 
__THROW
 
	`__n⁄nuŒ
 ((1, 4)Ë
__wur
;

261 
	$°πod_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

262 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

263 
__THROW
 
	`__n⁄nuŒ
 ((1, 3)Ë
__wur
;

265 
	$°πof_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

266 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

267 
__THROW
 
	`__n⁄nuŒ
 ((1, 3)Ë
__wur
;

269 
	$°πﬁd_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

270 **
__ª°ri˘
 
__íd±r
,

271 
__loˇÀ_t
 
__loc
)

272 
__THROW
 
	`__n⁄nuŒ
 ((1, 3)Ë
__wur
;

276 #ifde‡
__USE_EXTERN_INLINES


277 
__BEGIN_NAMESPACE_STD


278 
__exã∫_ölöe
 

279 
	`__NTH
 (
	$©of
 (
__c⁄°
 *
__≈å
))

281  
	`°πod
 (
__≈å
, (**Ë
NULL
);

282 
	}
}

283 
__exã∫_ölöe
 

284 
__NTH
 (
	$©oi
 (
__c⁄°
 *
__≈å
))

286  (Ë
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

287 
	}
}

288 
__exã∫_ölöe
 

289 
__NTH
 (
	$©ﬁ
 (
__c⁄°
 *
__≈å
))

291  
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

292 
	}
}

293 
	g__END_NAMESPACE_STD


295 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


296 
__BEGIN_NAMESPACE_C99


297 
__exãnsi⁄__
 
__exã∫_ölöe
 

298 
__NTH
 (
	$©ﬁl
 (
__c⁄°
 *
__≈å
))

300  
	`°πﬁl
 (
__≈å
, (**Ë
NULL
, 10);

301 
	}
}

302 
	g__END_NAMESPACE_C99


307 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED


311 *
	$l64a
 (
__n
Ë
__THROW
 
__wur
;

314 
	$a64l
 (
__c⁄°
 *
__s
)

315 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

319 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_BSD


320 
	~<sys/ty≥s.h
>

327 
	$øndom
 (Ë
__THROW
;

330 
	$§™dom
 (
__£ed
Ë
__THROW
;

336 *
	$öô°©e
 (
__£ed
, *
__°©ebuf
,

337 
size_t
 
__°©ñí
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

341 *
	$£t°©e
 (*
__°©ebuf
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

344 #ifde‡
__USE_MISC


349 
	søndom_d©a


351 
öt32_t
 *
Âå
;

352 
öt32_t
 *
Ωå
;

353 
öt32_t
 *
°©e
;

354 
ønd_ty≥
;

355 
ønd_deg
;

356 
ønd_£p
;

357 
öt32_t
 *
íd_±r
;

360 
	$øndom_r
 (
øndom_d©a
 *
__ª°ri˘
 
__buf
,

361 
öt32_t
 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

363 
	$§™dom_r
 (
__£ed
, 
øndom_d©a
 *
__buf
)

364 
__THROW
 
	`__n⁄nuŒ
 ((2));

366 
	$öô°©e_r
 (
__£ed
, *
__ª°ri˘
 
__°©ebuf
,

367 
size_t
 
__°©ñí
,

368 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

369 
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

371 
	$£t°©e_r
 (*
__ª°ri˘
 
__°©ebuf
,

372 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

373 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

378 
__BEGIN_NAMESPACE_STD


380 
	$ønd
 (Ë
__THROW
;

382 
	$§™d
 (
__£ed
Ë
__THROW
;

383 
__END_NAMESPACE_STD


385 #ifde‡
__USE_POSIX


387 
	$ønd_r
 (*
__£ed
Ë
__THROW
;

391 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


395 
	$dønd48
 (Ë
__THROW
;

396 
	$î™d48
 (
__xsubi
[3]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

399 
	$Ã™d48
 (Ë
__THROW
;

400 
	$ƒ™d48
 (
__xsubi
[3])

401 
__THROW
 
	`__n⁄nuŒ
 ((1));

404 
	$mønd48
 (Ë
__THROW
;

405 
	$jønd48
 (
__xsubi
[3])

406 
__THROW
 
	`__n⁄nuŒ
 ((1));

409 
	$§™d48
 (
__£edvÆ
Ë
__THROW
;

410 *
	$£ed48
 (
__£ed16v
[3])

411 
__THROW
 
	`__n⁄nuŒ
 ((1));

412 
	$lc⁄g48
 (
__∑øm
[7]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

414 #ifde‡
__USE_MISC


418 
	sdønd48_d©a


420 
__x
[3];

421 
__ﬁd_x
[3];

422 
__c
;

423 
__öô
;

424 
__a
;

428 
	$dønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

429 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

430 
	$î™d48_r
 (
__xsubi
[3],

431 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

432 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

435 
	$Ã™d48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

436 *
__ª°ri˘
 
__ªsu…
)

437 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

438 
	$ƒ™d48_r
 (
__xsubi
[3],

439 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

440 *
__ª°ri˘
 
__ªsu…
)

441 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

444 
	$mønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

445 *
__ª°ri˘
 
__ªsu…
)

446 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

447 
	$jønd48_r
 (
__xsubi
[3],

448 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

449 *
__ª°ri˘
 
__ªsu…
)

450 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

453 
	$§™d48_r
 (
__£edvÆ
, 
dønd48_d©a
 *
__buf„r
)

454 
__THROW
 
	`__n⁄nuŒ
 ((2));

456 
	$£ed48_r
 (
__£ed16v
[3],

457 
dønd48_d©a
 *
__buf„r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

459 
	$lc⁄g48_r
 (
__∑øm
[7],

460 
dønd48_d©a
 *
__buf„r
)

461 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

467 #i‚de‡
__mÆloc_™d_ˇŒoc_deföed


468 
	#__mÆloc_™d_ˇŒoc_deföed


	)

469 
__BEGIN_NAMESPACE_STD


471 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

473 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

474 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

475 
__END_NAMESPACE_STD


478 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


479 
__BEGIN_NAMESPACE_STD


485 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

486 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

488 
	$‰ì
 (*
__±r
Ë
__THROW
;

489 
__END_NAMESPACE_STD


491 #ifdef 
__USE_MISC


493 
	$c‰ì
 (*
__±r
Ë
__THROW
;

496 #i‡
deföed
 
__USE_GNU
 || deföed 
__USE_BSD
 || deföed 
__USE_MISC


497 
	~<Æloˇ.h
>

500 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

501 || 
deföed
 
__USE_BSD


503 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

506 #ifde‡
__USE_XOPEN2K


508 
	$posix_memÆign
 (**
__mem±r
, 
size_t
 
__Æignmít
, size_à
__size
)

509 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

512 
__BEGIN_NAMESPACE_STD


514 
	$ab‹t
 (Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

518 
	`©exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

520 #ifde‡
__USE_GNU


524 #ifde‡
__˝lu•lus


525 "C++" 
	`©_quick_exô
 ((*
__func
) ())

526 
__THROW
 
	`__asm
 ("©_quick_exô"Ë
	`__n⁄nuŒ
 ((1));

528 
	`©_quick_exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

531 
__END_NAMESPACE_STD


533 #ifdef 
__USE_MISC


536 
	`⁄_exô
 ((*
__func
Ë(
__°©us
, *
__¨g
), *__arg)

537 
__THROW
 
	`__n⁄nuŒ
 ((1));

540 
__BEGIN_NAMESPACE_STD


544 
	$exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

546 #ifde‡
__USE_GNU


552 
	$quick_exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

554 
__END_NAMESPACE_STD


556 #ifde‡
__USE_ISOC99


557 
__BEGIN_NAMESPACE_C99


560 
	$_Exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

561 
__END_NAMESPACE_C99


565 
__BEGIN_NAMESPACE_STD


567 *
	$gëív
 (
__c⁄°
 *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

568 
__END_NAMESPACE_STD


572 *
	$__£cuª_gëív
 (
__c⁄°
 *
__«me
)

573 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

575 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


579 
	$puãnv
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

582 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


585 
	$£ãnv
 (
__c⁄°
 *
__«me
, __c⁄° *
__vÆue
, 
__ª∂a˚
)

586 
__THROW
 
	`__n⁄nuŒ
 ((2));

589 
	$un£ãnv
 (
__c⁄°
 *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

592 #ifdef 
__USE_MISC


596 
	$˛óªnv
 (Ë
__THROW
;

600 #i‡
deföed
 
__USE_MISC
 \

601 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
)

606 *
	$mkãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

609 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 \

610 || 
deföed
 
__USE_XOPEN2K8


619 #i‚de‡
__USE_FILE_OFFSET64


620 
	$mk°emp
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

622 #ifde‡
__REDIRECT


623 
	`__REDIRECT
 (
mk°emp
, (*
__ãm∂©e
), 
mk°emp64
)

624 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

626 
	#mk°emp
 
mk°emp64


	)

629 #ifde‡
__USE_LARGEFILE64


630 
	$mk°emp64
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

634 #ifde‡
__USE_MISC


641 #i‚de‡
__USE_FILE_OFFSET64


642 
	$mk°emps
 (*
__ãm∂©e
, 
__suffixÀn
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

644 #ifde‡
__REDIRECT


645 
	`__REDIRECT
 (
mk°emps
, (*
__ãm∂©e
, 
__suffixÀn
),

646 
mk°emps64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

648 
	#mk°emps
 
mk°emps64


	)

651 #ifde‡
__USE_LARGEFILE64


652 
	$mk°emps64
 (*
__ãm∂©e
, 
__suffixÀn
)

653 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

657 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K8


663 *
	$mkdãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

666 #ifde‡
__USE_GNU


673 #i‚de‡
__USE_FILE_OFFSET64


674 
	$mko°emp
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

676 #ifde‡
__REDIRECT


677 
	`__REDIRECT
 (
mko°emp
, (*
__ãm∂©e
, 
__Êags
), 
mko°emp64
)

678 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

680 
	#mko°emp
 
mko°emp64


	)

683 #ifde‡
__USE_LARGEFILE64


684 
	$mko°emp64
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

693 #i‚de‡
__USE_FILE_OFFSET64


694 
	$mko°emps
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

695 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

697 #ifde‡
__REDIRECT


698 
	`__REDIRECT
 (
mko°emps
, (*
__ãm∂©e
, 
__suffixÀn
,

699 
__Êags
), 
mko°emps64
)

700 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

702 
	#mko°emps
 
mko°emps64


	)

705 #ifde‡
__USE_LARGEFILE64


706 
	$mko°emps64
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

707 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

712 
__BEGIN_NAMESPACE_STD


717 
	$sy°em
 (
__c⁄°
 *
__comm™d
Ë
__wur
;

718 
__END_NAMESPACE_STD


721 #ifdef 
__USE_GNU


724 *
	$ˇn⁄iˇlize_fûe_«me
 (
__c⁄°
 *
__«me
)

725 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

728 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


734 *
	$ªÆ∑th
 (
__c⁄°
 *
__ª°ri˘
 
__«me
,

735 *
__ª°ri˘
 
__ªsﬁved
Ë
__THROW
 
__wur
;

740 #i‚de‡
__COMPAR_FN_T


741 
	#__COMPAR_FN_T


	)

742 (*
	t__com∑r_‚_t
Ë(
	t__c⁄°
 *, __const *);

744 #ifdef 
__USE_GNU


745 
__com∑r_‚_t
 
	tcom∑ris⁄_‚_t
;

748 #ifde‡
__USE_GNU


749 (*
	t__com∑r_d_‚_t
Ë(
	t__c⁄°
 *, __const *, *);

752 
__BEGIN_NAMESPACE_STD


755 *
	$b£¨ch
 (
__c⁄°
 *
__key
, __c⁄° *
__ba£
,

756 
size_t
 
__nmemb
, size_à
__size
, 
__com∑r_‚_t
 
__com∑r
)

757 
	`__n⁄nuŒ
 ((1, 2, 5)Ë
__wur
;

761 
	$qs‹t
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

762 
__com∑r_‚_t
 
__com∑r
Ë
	`__n⁄nuŒ
 ((1, 4));

763 #ifde‡
__USE_GNU


764 
	$qs‹t_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

765 
__com∑r_d_‚_t
 
__com∑r
, *
__¨g
)

766 
	`__n⁄nuŒ
 ((1, 4));

771 
	$abs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

772 
	$œbs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

773 
__END_NAMESPACE_STD


775 #ifde‡
__USE_ISOC99


776 
__exãnsi⁄__
 
	$Œabs
 (
__x
)

777 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

781 
__BEGIN_NAMESPACE_STD


785 
div_t
 
	$div
 (
__numî
, 
__díom
)

786 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

787 
ldiv_t
 
	$ldiv
 (
__numî
, 
__díom
)

788 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

789 
__END_NAMESPACE_STD


791 #ifde‡
__USE_ISOC99


792 
__BEGIN_NAMESPACE_C99


793 
__exãnsi⁄__
 
Œdiv_t
 
	$Œdiv
 (
__numî
,

794 
__díom
)

795 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

796 
__END_NAMESPACE_C99


800 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

801 || 
deföed
 
__USE_SVID


808 *
	$ecvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

809 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

814 *
	$fcvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

815 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

820 *
	$gcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

821 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

824 #ifde‡
__USE_MISC


826 *
	$qecvt
 (
__vÆue
, 
__ndigô
,

827 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

828 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

829 *
	$qfcvt
 (
__vÆue
, 
__ndigô
,

830 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

831 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

832 *
	$qgcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

833 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

838 
	$ecvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

839 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

840 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

841 
	$fcvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

842 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

843 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

845 
	$qecvt_r
 (
__vÆue
, 
__ndigô
,

846 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

847 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

848 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

849 
	$qfcvt_r
 (
__vÆue
, 
__ndigô
,

850 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

851 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

852 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

857 
__BEGIN_NAMESPACE_STD


860 
	$mbÀn
 (
__c⁄°
 *
__s
, 
size_t
 
__n
Ë
__THROW
 
__wur
;

863 
	$mbtowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

864 
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
 
__wur
;

867 
	$w˘omb
 (*
__s
, 
wch¨_t
 
__wch¨
Ë
__THROW
 
__wur
;

871 
size_t
 
	$mb°owcs
 (
wch¨_t
 *
__ª°ri˘
 
__pwcs
,

872 
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

874 
size_t
 
	$wc°ombs
 (*
__ª°ri˘
 
__s
,

875 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__pwcs
, 
size_t
 
__n
)

876 
__THROW
;

877 
__END_NAMESPACE_STD


880 #ifde‡
__USE_SVID


885 
	$Ωm©ch
 (
__c⁄°
 *
__ª•⁄£
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

889 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


896 
	$gësub›t
 (**
__ª°ri˘
 
__›ti⁄p
,

897 *
__c⁄°
 *
__ª°ri˘
 
__tokís
,

898 **
__ª°ri˘
 
__vÆuï
)

899 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3)Ë
__wur
;

903 #ifde‡
__USE_XOPEN


905 
	$£tkey
 (
__c⁄°
 *
__key
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

911 #ifde‡
__USE_XOPEN2KXSI


913 
	$posix_›í±
 (
__oÊag
Ë
__wur
;

916 #ifde‡
__USE_XOPEN


921 
	$gø¡±
 (
__fd
Ë
__THROW
;

925 
	$u∆ock±
 (
__fd
Ë
__THROW
;

930 *
	$±¢ame
 (
__fd
Ë
__THROW
 
__wur
;

933 #ifde‡
__USE_GNU


937 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

938 
__THROW
 
	`__n⁄nuŒ
 ((2));

941 
	`gë±
 ();

944 #ifde‡
__USE_BSD


948 
	$gëlﬂdavg
 (
__lﬂdavg
[], 
__√Àm
)

949 
__THROW
 
	`__n⁄nuŒ
 ((1));

954 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


955 
	~<bôs/°dlib.h
>

957 #ifde‡
__LDBL_COMPAT


958 
	~<bôs/°dlib-ldbl.h
>

962 #unde‡
__√ed_mÆloc_™d_ˇŒoc


964 
__END_DECLS


	@/usr/include/string.h

24 #i‚def 
_STRING_H


25 
	#_STRING_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


32 
	#__√ed_size_t


	)

33 
	#__√ed_NULL


	)

34 
	~<°ddef.h
>

37 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

38 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

42 
__BEGIN_NAMESPACE_STD


44 *
	$mem˝y
 (*
__ª°ri˘
 
__de°
,

45 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

46 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

49 *
	$memmove
 (*
__de°
, 
__c⁄°
 *
__§c
, 
size_t
 
__n
)

50 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

51 
__END_NAMESPACE_STD


56 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN


57 *
	$memc˝y
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
,

58 
__c
, 
size_t
 
__n
)

59 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

63 
__BEGIN_NAMESPACE_STD


65 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

68 
	$memcmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
, 
size_t
 
__n
)

69 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

72 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


75 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

76 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

77 
__c⁄°
 *
	`memchr
 (__c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

78 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

80 #ifde‡
__OPTIMIZE__


81 
__exã∫_Æways_ölöe
 *

82 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


84  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

87 
__exã∫_Æways_ölöe
 
__c⁄°
 *

88 
	`memchr
 (
__c⁄°
 *
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


90  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

93 
	}
}

95 *
	$memchr
 (
__c⁄°
 *
__s
, 
__c
, 
size_t
 
__n
)

96 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

98 
__END_NAMESPACE_STD


100 #ifde‡
__USE_GNU


103 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


104 "C++" *
	$øwmemchr
 (*
__s
, 
__c
)

105 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

106 "C++" 
__c⁄°
 *
	$øwmemchr
 (
__c⁄°
 *
__s
, 
__c
)

107 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

109 *
	$øwmemchr
 (
__c⁄°
 *
__s
, 
__c
)

110 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

114 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


115 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

116 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

117 "C++" 
__c⁄°
 *
	$memrchr
 (
__c⁄°
 *
__s
, 
__c
, 
size_t
 
__n
)

118 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

120 *
	$memrchr
 (
__c⁄°
 *
__s
, 
__c
, 
size_t
 
__n
)

121 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

126 
__BEGIN_NAMESPACE_STD


128 *
	$°r˝y
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
)

129 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

131 *
	$°∫˝y
 (*
__ª°ri˘
 
__de°
,

132 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

133 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

136 *
	$°rˇt
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
)

137 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

139 *
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
,

140 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

143 
	$°rcmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
)

144 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

146 
	$°∫cmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
, 
size_t
 
__n
)

147 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

150 
	$°rcﬁl
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
)

151 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

153 
size_t
 
	$°rx‰m
 (*
__ª°ri˘
 
__de°
,

154 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

155 
__THROW
 
	`__n⁄nuŒ
 ((2));

156 
__END_NAMESPACE_STD


158 #ifde‡
__USE_XOPEN2K8


162 
	~<xloˇÀ.h
>

165 
	$°rcﬁl_l
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
, 
__loˇÀ_t
 
__l
)

166 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

168 
size_t
 
	$°rx‰m_l
 (*
__de°
, 
__c⁄°
 *
__§c
, 
size_t
 
__n
,

169 
__loˇÀ_t
 
__l
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

172 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 \

173 || 
deföed
 
__USE_XOPEN2K8


175 *
	$°rdup
 (
__c⁄°
 *
__s
)

176 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

182 #i‡
deföed
 
__USE_XOPEN2K8


183 *
	$°∫dup
 (
__c⁄°
 *
__°rög
, 
size_t
 
__n
)

184 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

187 #i‡
deföed
 
__USE_GNU
 && deföed 
__GNUC__


189 
	#°rdu∑
(
s
) \

190 (
__exãnsi⁄__
 \

192 
__c⁄°
 *
__ﬁd
 = (
s
); \

193 
size_t
 
__Àn
 = 
	`°æí
 (
__ﬁd
) + 1; \

194 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
); \

195 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

196 
	}
}))

	)

199 
	#°∫du∑
(
s
, 
n
) \

200 (
__exãnsi⁄__
 \

202 
__c⁄°
 *
__ﬁd
 = (
s
); \

203 
size_t
 
__Àn
 = 
	`°∫Àn
 (
__ﬁd
, (
n
)); \

204 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
 + 1); \

205 
__√w
[
__Àn
] = '\0'; \

206 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

207 }))

	)

210 
	g__BEGIN_NAMESPACE_STD


212 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


215 *
°rchr
 (*
__s
, 
__c
)

216 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

217 
__c⁄°
 *
°rchr
 (__c⁄° *
__s
, 
__c
)

218 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

220 #ifde‡
__OPTIMIZE__


221 
__exã∫_Æways_ölöe
 *

222 
°rchr
 (*
__s
, 
__c
Ë
	g__THROW


224  
__buûtö_°rchr
 (
__s
, 
__c
);

227 
__exã∫_Æways_ölöe
 
__c⁄°
 *

228 
°rchr
 (
__c⁄°
 *
__s
, 
__c
Ë
	g__THROW


230  
__buûtö_°rchr
 (
__s
, 
__c
);

235 *
	$°rchr
 (
__c⁄°
 *
__s
, 
__c
)

236 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

239 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


242 *
	`°ºchr
 (*
__s
, 
__c
)

243 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

244 
__c⁄°
 *
	`°ºchr
 (__c⁄° *
__s
, 
__c
)

245 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

247 #ifde‡
__OPTIMIZE__


248 
__exã∫_Æways_ölöe
 *

249 
	`°ºchr
 (*
__s
, 
__c
Ë
__THROW


251  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

254 
__exã∫_Æways_ölöe
 
__c⁄°
 *

255 
	`°ºchr
 (
__c⁄°
 *
__s
, 
__c
Ë
__THROW


257  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

260 
	}
}

262 *
	$°ºchr
 (
__c⁄°
 *
__s
, 
__c
)

263 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

265 
__END_NAMESPACE_STD


267 #ifde‡
__USE_GNU


270 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


271 "C++" *
	$°rch∫ul
 (*
__s
, 
__c
)

272 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

273 "C++" 
__c⁄°
 *
	$°rch∫ul
 (
__c⁄°
 *
__s
, 
__c
)

274 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

276 *
	$°rch∫ul
 (
__c⁄°
 *
__s
, 
__c
)

277 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

281 
__BEGIN_NAMESPACE_STD


284 
size_t
 
	$°rc•n
 (
__c⁄°
 *
__s
, __c⁄° *
__ªje˘
)

285 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

288 
size_t
 
	$°r•n
 (
__c⁄°
 *
__s
, __c⁄° *
__ac˚±
)

289 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

291 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


294 *
	`°Ωbrk
 (*
__s
, 
__c⁄°
 *
__ac˚±
)

295 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

296 
__c⁄°
 *
	`°Ωbrk
 (__c⁄° *
__s
, __c⁄° *
__ac˚±
)

297 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

299 #ifde‡
__OPTIMIZE__


300 
__exã∫_Æways_ölöe
 *

301 
	`°Ωbrk
 (*
__s
, 
__c⁄°
 *
__ac˚±
Ë
__THROW


303  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

306 
__exã∫_Æways_ölöe
 
__c⁄°
 *

307 
	`°Ωbrk
 (
__c⁄°
 *
__s
, __c⁄° *
__ac˚±
Ë
__THROW


309  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

312 
	}
}

314 *
	$°Ωbrk
 (
__c⁄°
 *
__s
, __c⁄° *
__ac˚±
)

315 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

318 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


321 *
	`°r°r
 (*
__hay°ack
, 
__c⁄°
 *
__√edÀ
)

322 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

323 
__c⁄°
 *
	`°r°r
 (__c⁄° *
__hay°ack
,

324 
__c⁄°
 *
__√edÀ
)

325 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

327 #ifde‡
__OPTIMIZE__


328 
__exã∫_Æways_ölöe
 *

329 
	`°r°r
 (*
__hay°ack
, 
__c⁄°
 *
__√edÀ
Ë
__THROW


331  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

334 
__exã∫_Æways_ölöe
 
__c⁄°
 *

335 
	`°r°r
 (
__c⁄°
 *
__hay°ack
, __c⁄° *
__√edÀ
Ë
__THROW


337  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

340 
	}
}

342 *
	$°r°r
 (
__c⁄°
 *
__hay°ack
, __c⁄° *
__√edÀ
)

343 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

348 *
	$°πok
 (*
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__dñim
)

349 
__THROW
 
	`__n⁄nuŒ
 ((2));

350 
__END_NAMESPACE_STD


354 *
	$__°πok_r
 (*
__ª°ri˘
 
__s
,

355 
__c⁄°
 *
__ª°ri˘
 
__dñim
,

356 **
__ª°ri˘
 
__ßve_±r
)

357 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

358 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


359 *
	$°πok_r
 (*
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__dñim
,

360 **
__ª°ri˘
 
__ßve_±r
)

361 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

364 #ifde‡
__USE_GNU


366 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


367 "C++" *
	$°rˇ£°r
 (*
__hay°ack
, 
__c⁄°
 *
__√edÀ
)

368 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

369 "C++" 
__c⁄°
 *
	$°rˇ£°r
 (
__c⁄°
 *
__hay°ack
,

370 
__c⁄°
 *
__√edÀ
)

371 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

373 *
	$°rˇ£°r
 (
__c⁄°
 *
__hay°ack
, __c⁄° *
__√edÀ
)

374 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

378 #ifde‡
__USE_GNU


382 *
	$memmem
 (
__c⁄°
 *
__hay°ack
, 
size_t
 
__hay°ackÀn
,

383 
__c⁄°
 *
__√edÀ
, 
size_t
 
__√edÀÀn
)

384 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 3));

388 *
	$__memp˝y
 (*
__ª°ri˘
 
__de°
,

389 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

390 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

391 *
	$memp˝y
 (*
__ª°ri˘
 
__de°
,

392 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

393 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

397 
__BEGIN_NAMESPACE_STD


399 
size_t
 
	$°æí
 (
__c⁄°
 *
__s
)

400 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

401 
__END_NAMESPACE_STD


403 #ifdef 
__USE_XOPEN2K8


406 
size_t
 
	$°∫Àn
 (
__c⁄°
 *
__°rög
, 
size_t
 
__maxÀn
)

407 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

411 
__BEGIN_NAMESPACE_STD


413 *
	$°ªº‹
 (
__î∫um
Ë
__THROW
;

414 
__END_NAMESPACE_STD


415 #i‡
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_MISC


423 #i‡
deföed
 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


426 #ifde‡
__REDIRECT_NTH


427 
	`__REDIRECT_NTH
 (
°ªº‹_r
,

428 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
),

429 
__xpg_°ªº‹_r
Ë
	`__n⁄nuŒ
 ((2));

431 
	$__xpg_°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

432 
__THROW
 
	`__n⁄nuŒ
 ((2));

433 
	#°ªº‹_r
 
__xpg_°ªº‹_r


	)

438 *
	$°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

439 
__THROW
 
	`__n⁄nuŒ
 ((2));

443 #ifde‡
__USE_XOPEN2K8


445 *
	$°ªº‹_l
 (
__î∫um
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

451 
	$__bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

453 #ifde‡
__USE_BSD


455 
	$bc›y
 (
__c⁄°
 *
__§c
, *
__de°
, 
size_t
 
__n
)

456 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

459 
	$bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

462 
	$bcmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
, 
size_t
 
__n
)

463 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

466 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


469 *
	`ödex
 (*
__s
, 
__c
)

470 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

471 
__c⁄°
 *
	`ödex
 (__c⁄° *
__s
, 
__c
)

472 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

474 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


475 
__exã∫_Æways_ölöe
 *

476 
	`ödex
 (*
__s
, 
__c
Ë
__THROW


478  
	`__buûtö_ödex
 (
__s
, 
__c
);

481 
__exã∫_Æways_ölöe
 
__c⁄°
 *

482 
	`ödex
 (
__c⁄°
 *
__s
, 
__c
Ë
__THROW


484  
	`__buûtö_ödex
 (
__s
, 
__c
);

487 
	}
}

489 *
	$ödex
 (
__c⁄°
 *
__s
, 
__c
)

490 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

494 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


497 *
	`rödex
 (*
__s
, 
__c
)

498 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

499 
__c⁄°
 *
	`rödex
 (__c⁄° *
__s
, 
__c
)

500 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

502 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


503 
__exã∫_Æways_ölöe
 *

504 
	`rödex
 (*
__s
, 
__c
Ë
__THROW


506  
	`__buûtö_rödex
 (
__s
, 
__c
);

509 
__exã∫_Æways_ölöe
 
__c⁄°
 *

510 
	`rödex
 (
__c⁄°
 *
__s
, 
__c
Ë
__THROW


512  
	`__buûtö_rödex
 (
__s
, 
__c
);

515 
	}
}

517 *
	$rödex
 (
__c⁄°
 *
__s
, 
__c
)

518 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

523 
	$ffs
 (
__i
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

527 #ifdef 
__USE_GNU


528 
	$ff¶
 (
__l
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

529 #ifde‡
__GNUC__


530 
__exãnsi⁄__
 
	$ff¶l
 (
__Œ
)

531 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

536 
	$°rˇ£cmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
)

537 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

540 
	$°∫ˇ£cmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
, 
size_t
 
__n
)

541 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

544 #ifdef 
__USE_GNU


547 
	$°rˇ£cmp_l
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
,

548 
__loˇÀ_t
 
__loc
)

549 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

551 
	$°∫ˇ£cmp_l
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
,

552 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
)

553 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 4));

556 #ifdef 
__USE_BSD


559 *
	$°r£p
 (**
__ª°ri˘
 
__°rögp
,

560 
__c⁄°
 *
__ª°ri˘
 
__dñim
)

561 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

564 #ifdef 
__USE_XOPEN2K8


566 *
	$°rsig«l
 (
__sig
Ë
__THROW
;

569 *
	$__°p˝y
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
)

570 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

571 *
	$°p˝y
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
)

572 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

576 *
	$__°≤˝y
 (*
__ª°ri˘
 
__de°
,

577 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

578 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

579 *
	$°≤˝y
 (*
__ª°ri˘
 
__de°
,

580 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

581 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

584 #ifdef 
__USE_GNU


586 
	$°rvîscmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
)

587 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

590 *
	$°r‰y
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

593 *
	$mem‰ob
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

595 #i‚de‡
ba£«me


600 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


601 "C++" *
	$ba£«me
 (*
__fûíame
)

602 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

603 "C++" 
__c⁄°
 *
	$ba£«me
 (
__c⁄°
 *
__fûíame
)

604 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

606 *
	$ba£«me
 (
__c⁄°
 *
__fûíame
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

612 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

613 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__OPTIMIZE_SIZE__
 \

614 && !
deföed
 
__NO_INLINE__
 && !deföed 
__˝lu•lus


634 
	~<bôs/°rög.h
>

637 
	~<bôs/°rög2.h
>

640 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


642 
	~<bôs/°rög3.h
>

646 
__END_DECLS


	@/usr/include/alloca.h

19 #i‚def 
_ALLOCA_H


20 
	#_ALLOCA_H
 1

	)

22 
	~<„©uªs.h
>

24 
	#__√ed_size_t


	)

25 
	~<°ddef.h
>

27 
	g__BEGIN_DECLS


30 #unde‡
Æloˇ


33 *
	$Æloˇ
 (
size_t
 
__size
Ë
__THROW
;

35 #ifdef 
__GNUC__


36 
	#Æloˇ
(
size
Ë
	`__buûtö_Æloˇ
 (size)

	)

39 
__END_DECLS


	@/usr/include/endian.h

19 #i‚def 
_ENDIAN_H


20 
	#_ENDIAN_H
 1

	)

22 
	~<„©uªs.h
>

32 
	#__LITTLE_ENDIAN
 1234

	)

33 
	#__BIG_ENDIAN
 4321

	)

34 
	#__PDP_ENDIAN
 3412

	)

37 
	~<bôs/ídün.h
>

41 #i‚de‡
__FLOAT_WORD_ORDER


42 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

45 #ifdef 
__USE_BSD


46 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

47 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

48 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

49 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

52 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


53 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËLO, 
	)
HI

54 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


55 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËHI, 
	)
LO

59 #ifde‡
__USE_BSD


61 
	~<bôs/byãsw≠.h
>

63 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


64 
	#htobe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

65 
	#htﬁe16
(
x
Ë(x)

	)

66 
	#be16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

67 
	#À16toh
(
x
Ë(x)

	)

69 
	#htobe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

70 
	#htﬁe32
(
x
Ë(x)

	)

71 
	#be32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

72 
	#À32toh
(
x
Ë(x)

	)

74 
	#htobe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

75 
	#htﬁe64
(
x
Ë(x)

	)

76 
	#be64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

77 
	#À64toh
(
x
Ë(x)

	)

79 
	#htobe16
(
x
Ë(x)

	)

80 
	#htﬁe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

81 
	#be16toh
(
x
Ë(x)

	)

82 
	#À16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

84 
	#htobe32
(
x
Ë(x)

	)

85 
	#htﬁe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

86 
	#be32toh
(
x
Ë(x)

	)

87 
	#À32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

89 
	#htobe64
(
x
Ë(x)

	)

90 
	#htﬁe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

91 
	#be64toh
(
x
Ë(x)

	)

92 
	#À64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

	@/usr/include/features.h

20 #i‚def 
_FEATURES_H


21 
	#_FEATURES_H
 1

	)

97 #unde‡
__USE_ISOC99


98 #unde‡
__USE_ISOC95


99 #unde‡
__USE_POSIX


100 #unde‡
__USE_POSIX2


101 #unde‡
__USE_POSIX199309


102 #unde‡
__USE_POSIX199506


103 #unde‡
__USE_XOPEN


104 #unde‡
__USE_XOPEN_EXTENDED


105 #unde‡
__USE_UNIX98


106 #unde‡
__USE_XOPEN2K


107 #unde‡
__USE_XOPEN2KXSI


108 #unde‡
__USE_XOPEN2K8


109 #unde‡
__USE_XOPEN2K8XSI


110 #unde‡
__USE_LARGEFILE


111 #unde‡
__USE_LARGEFILE64


112 #unde‡
__USE_FILE_OFFSET64


113 #unde‡
__USE_BSD


114 #unde‡
__USE_SVID


115 #unde‡
__USE_MISC


116 #unde‡
__USE_ATFILE


117 #unde‡
__USE_GNU


118 #unde‡
__USE_REENTRANT


119 #unde‡
__USE_FORTIFY_LEVEL


120 #unde‡
__FAVOR_BSD


121 #unde‡
__KERNEL_STRICT_NAMES


125 #i‚de‡
_LOOSE_KERNEL_NAMES


126 
	#__KERNEL_STRICT_NAMES


	)

130 
	#__USE_ANSI
 1

	)

139 #i‡
deföed
 
__GNUC__
 && deföed 
__GNUC_MINOR__


140 
	#__GNUC_PREREQ
(
maj
, 
mö
) \

141 ((
__GNUC__
 << 16Ë+ 
__GNUC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

143 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë0

	)

148 #i‡
deföed
 
_BSD_SOURCE
 && \

149 !(
deföed
 
	g_POSIX_SOURCE
 || deföed 
	g_POSIX_C_SOURCE
 || \

150 
deföed
 
	g_XOPEN_SOURCE
 || deföed 
	g_GNU_SOURCE
 || deföed 
	g_SVID_SOURCE
)

151 
	#__FAVOR_BSD
 1

	)

155 #ifde‡
_GNU_SOURCE


156 #unde‡
_ISOC95_SOURCE


157 
	#_ISOC95_SOURCE
 1

	)

158 #unde‡
_ISOC99_SOURCE


159 
	#_ISOC99_SOURCE
 1

	)

160 #unde‡
_POSIX_SOURCE


161 
	#_POSIX_SOURCE
 1

	)

162 #unde‡
_POSIX_C_SOURCE


163 
	#_POSIX_C_SOURCE
 200809L

	)

164 #unde‡
_XOPEN_SOURCE


165 
	#_XOPEN_SOURCE
 700

	)

166 #unde‡
_XOPEN_SOURCE_EXTENDED


167 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

168 #unde‡
_LARGEFILE64_SOURCE


169 
	#_LARGEFILE64_SOURCE
 1

	)

170 #unde‡
_BSD_SOURCE


171 
	#_BSD_SOURCE
 1

	)

172 #unde‡
_SVID_SOURCE


173 
	#_SVID_SOURCE
 1

	)

174 #unde‡
_ATFILE_SOURCE


175 
	#_ATFILE_SOURCE
 1

	)

180 #i‡(!
deföed
 
__STRICT_ANSI__
 && !deföed 
_ISOC99_SOURCE
 && \

181 !
deföed
 
	g_POSIX_SOURCE
 && !deföed 
	g_POSIX_C_SOURCE
 && \

182 !
deföed
 
	g_XOPEN_SOURCE
 && !deföed 
	g_BSD_SOURCE
 && !deföed 
	g_SVID_SOURCE
)

183 
	#_BSD_SOURCE
 1

	)

184 
	#_SVID_SOURCE
 1

	)

191 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC9X_SOURCE
 \

192 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

193 
	#__USE_ISOC99
 1

	)

197 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC9X_SOURCE
 \

198 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

199 
	#__USE_ISOC95
 1

	)

204 #i‡((!
deföed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

205 !
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE
)

206 
	#_POSIX_SOURCE
 1

	)

207 #i‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

208 
	#_POSIX_C_SOURCE
 2

	)

209 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

210 
	#_POSIX_C_SOURCE
 199506L

	)

211 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

212 
	#_POSIX_C_SOURCE
 200112L

	)

214 
	#_POSIX_C_SOURCE
 200809L

	)

216 
	#__USE_POSIX_IMPLICITLY
 1

	)

219 #i‡
deföed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >1 || deföed 
_XOPEN_SOURCE


220 
	#__USE_POSIX
 1

	)

223 #i‡
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || deföed 
_XOPEN_SOURCE


224 
	#__USE_POSIX2
 1

	)

227 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199309L

228 
	#__USE_POSIX199309
 1

	)

231 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199506L

232 
	#__USE_POSIX199506
 1

	)

235 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200112L

236 
	#__USE_XOPEN2K
 1

	)

237 #unde‡
__USE_ISOC95


238 
	#__USE_ISOC95
 1

	)

239 #unde‡
__USE_ISOC99


240 
	#__USE_ISOC99
 1

	)

243 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200809L

244 
	#__USE_XOPEN2K8
 1

	)

245 #unde‡
_ATFILE_SOURCE


246 
	#_ATFILE_SOURCE
 1

	)

249 #ifdef 
_XOPEN_SOURCE


250 
	#__USE_XOPEN
 1

	)

251 #i‡(
_XOPEN_SOURCE
 - 0) >= 500

252 
	#__USE_XOPEN_EXTENDED
 1

	)

253 
	#__USE_UNIX98
 1

	)

254 #unde‡
_LARGEFILE_SOURCE


255 
	#_LARGEFILE_SOURCE
 1

	)

256 #i‡(
_XOPEN_SOURCE
 - 0) >= 600

257 #i‡(
_XOPEN_SOURCE
 - 0) >= 700

258 
	#__USE_XOPEN2K8
 1

	)

259 
	#__USE_XOPEN2K8XSI
 1

	)

261 
	#__USE_XOPEN2K
 1

	)

262 
	#__USE_XOPEN2KXSI
 1

	)

263 #unde‡
__USE_ISOC95


264 
	#__USE_ISOC95
 1

	)

265 #unde‡
__USE_ISOC99


266 
	#__USE_ISOC99
 1

	)

269 #ifde‡
_XOPEN_SOURCE_EXTENDED


270 
	#__USE_XOPEN_EXTENDED
 1

	)

275 #ifde‡
_LARGEFILE_SOURCE


276 
	#__USE_LARGEFILE
 1

	)

279 #ifde‡
_LARGEFILE64_SOURCE


280 
	#__USE_LARGEFILE64
 1

	)

283 #i‡
deföed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

284 
	#__USE_FILE_OFFSET64
 1

	)

287 #i‡
deföed
 
_BSD_SOURCE
 || deföed 
_SVID_SOURCE


288 
	#__USE_MISC
 1

	)

291 #ifdef 
_BSD_SOURCE


292 
	#__USE_BSD
 1

	)

295 #ifdef 
_SVID_SOURCE


296 
	#__USE_SVID
 1

	)

299 #ifdef 
_ATFILE_SOURCE


300 
	#__USE_ATFILE
 1

	)

303 #ifdef 
_GNU_SOURCE


304 
	#__USE_GNU
 1

	)

307 #i‡
deföed
 
_REENTRANT
 || deföed 
_THREAD_SAFE


308 
	#__USE_REENTRANT
 1

	)

311 #i‡
deföed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

312 && 
__GNUC_PREREQ
 (4, 1Ë&& 
deföed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

313 #i‡
_FORTIFY_SOURCE
 > 1

314 
	#__USE_FORTIFY_LEVEL
 2

	)

316 
	#__USE_FORTIFY_LEVEL
 1

	)

319 
	#__USE_FORTIFY_LEVEL
 0

	)

323 
	~<bôs/¥edefs.h
>

326 
	#__STDC_ISO_10646__
 200009L

	)

334 #unde‡
__GNU_LIBRARY__


335 
	#__GNU_LIBRARY__
 6

	)

339 
	#__GLIBC__
 2

	)

340 
	#__GLIBC_MINOR__
 13

	)

342 
	#__GLIBC_PREREQ
(
maj
, 
mö
) \

343 ((
__GLIBC__
 << 16Ë+ 
__GLIBC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

346 #i‡
deföed
 
__GNUC__
 \

347 || (
deföed
 
	g__PGI
 && deföed 
	g__i386__
 ) \

348 || (
deföed
 
	g__INTEL_COMPILER
 && (deföed 
	g__i386__
 || deföed 
	g__ü64__
)) \

349 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L)

350 
	#__GLIBC_HAVE_LONG_LONG
 1

	)

354 #i‚de‡
__ASSEMBLER__


355 #i‚de‡
_SYS_CDEFS_H


356 
	~<sys/cdefs.h
>

361 #i‡
deföed
 
__USE_FILE_OFFSET64
 && !deföed 
__REDIRECT


362 
	#__USE_LARGEFILE
 1

	)

363 
	#__USE_LARGEFILE64
 1

	)

369 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

370 && !
deföed
 
	g__OPTIMIZE_SIZE__
 && !deföed 
	g__NO_INLINE__
 \

371 && 
deföed
 
	g__exã∫_ölöe


372 
	#__USE_EXTERN_INLINES
 1

	)

377 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

378 && (
deföed
 
	g_LIBC
 || !deföed 
	g__OPTIMIZE_SIZE__
Ë&& !deföed 
	g__NO_INLINE__
 \

379 && 
deföed
 
	g__exã∫_ölöe


380 
	#__USE_EXTERN_INLINES_IN_LIBC
 1

	)

388 
	~<gnu/°ubs.h
>

	@/usr/include/getopt.h

21 #i‚de‡
_GETOPT_H


23 #i‚de‡
__√ed_gë›t


24 
	#_GETOPT_H
 1

	)

34 #i‡!
deföed
 
__GNU_LIBRARY__


35 
	~<˘y≥.h
>

38 #i‚de‡
__THROW


39 #i‚de‡
__GNUC_PREREQ


40 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë(0)

	)

42 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,8)

43 
	#__THROW
 
	`throw
 ()

	)

45 
	#__THROW


	)

49 #ifdef 
__˝lu•lus


59 *
›èrg
;

73 
›töd
;

78 
›ãº
;

82 
›t›t
;

84 #i‚de‡
__√ed_gë›t


106 
	s›ti⁄


108 c⁄° *
	g«me
;

111 
	ghas_¨g
;

112 *
	gÊag
;

113 
	gvÆ
;

118 
	#no_¨gumít
 0

	)

119 
	#ªquúed_¨gumít
 1

	)

120 
	#›ti⁄Æ_¨gumít
 2

	)

148 #ifde‡
__GNU_LIBRARY__


152 
gë›t
 (
___¨gc
, *c⁄° *
___¨gv
, c⁄° *
__sh‹t›ts
)

153 
__THROW
;

155 #i‡
deföed
 
__√ed_gë›t
 && deföed 
__USE_POSIX2
 \

156 && !
deföed
 
	g__USE_POSIX_IMPLICITLY
 && !deföed 
	g__USE_GNU


160 #ifde‡
__REDIRECT


161 
__REDIRECT_NTH
 (
gë›t
, (
___¨gc
, *c⁄° *
___¨gv
,

162 c⁄° *
__sh‹t›ts
),

163 
__posix_gë›t
);

165 
__posix_gë›t
 (
___¨gc
, *c⁄° *
___¨gv
,

166 c⁄° *
__sh‹t›ts
Ë
__THROW
;

167 
	#gë›t
 
__posix_gë›t


	)

171 
gë›t
 ();

174 #i‚de‡
__√ed_gë›t


175 
gë›t_l⁄g
 (
___¨gc
, *c⁄° *
___¨gv
,

176 c⁄° *
__sh‹t›ts
,

177 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

178 
__THROW
;

179 
gë›t_l⁄g_⁄ly
 (
___¨gc
, *c⁄° *
___¨gv
,

180 c⁄° *
__sh‹t›ts
,

181 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

182 
__THROW
;

186 #ifdef 
__˝lu•lus


191 #unde‡
__√ed_gë›t


	@/usr/include/libio.h

29 #i‚de‡
_IO_STDIO_H


30 
	#_IO_STDIO_H


	)

32 
	~<_G_c⁄fig.h
>

34 
	#_IO_pos_t
 
_G_Âos_t


	)

35 
	#_IO_Âos_t
 
_G_Âos_t


	)

36 
	#_IO_Âos64_t
 
_G_Âos64_t


	)

37 
	#_IO_size_t
 
_G_size_t


	)

38 
	#_IO_ssize_t
 
_G_ssize_t


	)

39 
	#_IO_off_t
 
_G_off_t


	)

40 
	#_IO_off64_t
 
_G_off64_t


	)

41 
	#_IO_pid_t
 
_G_pid_t


	)

42 
	#_IO_uid_t
 
_G_uid_t


	)

43 
	#_IO_ic⁄v_t
 
_G_ic⁄v_t


	)

44 
	#_IO_HAVE_SYS_WAIT
 
_G_HAVE_SYS_WAIT


	)

45 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

46 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

47 
	#_IO_va_li°
 
_G_va_li°


	)

48 
	#_IO_wöt_t
 
_G_wöt_t


	)

50 #ifde‡
_G_NEED_STDARG_H


52 
	#__√ed___va_li°


	)

53 
	~<°d¨g.h
>

54 #ifde‡
__GNUC_VA_LIST


55 #unde‡
_IO_va_li°


56 
	#_IO_va_li°
 
__gnuc_va_li°


	)

60 #i‚de‡
__P


61 #i‡
_G_HAVE_SYS_CDEFS


62 
	~<sys/cdefs.h
>

64 #ifde‡
__STDC__


65 
	#__P
(
p
Ë
	)
p

66 
	#__PMT
(
p
Ë
	)
p

68 
	#__P
(
p
Ë()

	)

69 
	#__PMT
(
p
Ë()

	)

75 #i‚de‡
_PARAMS


76 
	#_PARAMS
(
¥Ÿos
Ë
	`__P
’rŸos)

	)

79 #i‚de‡
__STDC__


81 c⁄°

	)

84 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

85 #i‚de‡
_G_HAVE_PRINTF_FP


86 
	#_IO_USE_DTOA
 1

	)

89 #i‚de‡
EOF


90 
	#EOF
 (-1)

	)

92 #i‚de‡
NULL


93 #i‡
deföed
 
__GNUG__
 && \

94 (
	g__GNUC__
 > 2 || (__GNUC__ =2 && 
__GNUC_MINOR__
 >= 8))

95 
	#NULL
 (
__nuŒ
)

	)

97 #i‡!
deföed
(
__˝lu•lus
)

98 
	#NULL
 ((*)0)

	)

100 
	#NULL
 (0)

	)

105 
	#_IOS_INPUT
 1

	)

106 
	#_IOS_OUTPUT
 2

	)

107 
	#_IOS_ATEND
 4

	)

108 
	#_IOS_APPEND
 8

	)

109 
	#_IOS_TRUNC
 16

	)

110 
	#_IOS_NOCREATE
 32

	)

111 
	#_IOS_NOREPLACE
 64

	)

112 
	#_IOS_BIN
 128

	)

120 
	#_IO_MAGIC
 0xFBAD0000

	)

121 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

122 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

123 
	#_IO_USER_BUF
 1

	)

124 
	#_IO_UNBUFFERED
 2

	)

125 
	#_IO_NO_READS
 4

	)

126 
	#_IO_NO_WRITES
 8

	)

127 
	#_IO_EOF_SEEN
 0x10

	)

128 
	#_IO_ERR_SEEN
 0x20

	)

129 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

130 
	#_IO_LINKED
 0x80

	)

131 
	#_IO_IN_BACKUP
 0x100

	)

132 
	#_IO_LINE_BUF
 0x200

	)

133 
	#_IO_TIED_PUT_GET
 0x400

	)

134 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

135 
	#_IO_IS_APPENDING
 0x1000

	)

136 
	#_IO_IS_FILEBUF
 0x2000

	)

137 
	#_IO_BAD_SEEN
 0x4000

	)

138 
	#_IO_USER_LOCK
 0x8000

	)

140 
	#_IO_FLAGS2_MMAP
 1

	)

141 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

142 #ifde‡
_LIBC


143 
	#_IO_FLAGS2_FORTIFY
 4

	)

145 
	#_IO_FLAGS2_USER_WBUF
 8

	)

146 #ifde‡
_LIBC


147 
	#_IO_FLAGS2_SCANF_STD
 16

	)

151 
	#_IO_SKIPWS
 01

	)

152 
	#_IO_LEFT
 02

	)

153 
	#_IO_RIGHT
 04

	)

154 
	#_IO_INTERNAL
 010

	)

155 
	#_IO_DEC
 020

	)

156 
	#_IO_OCT
 040

	)

157 
	#_IO_HEX
 0100

	)

158 
	#_IO_SHOWBASE
 0200

	)

159 
	#_IO_SHOWPOINT
 0400

	)

160 
	#_IO_UPPERCASE
 01000

	)

161 
	#_IO_SHOWPOS
 02000

	)

162 
	#_IO_SCIENTIFIC
 04000

	)

163 
	#_IO_FIXED
 010000

	)

164 
	#_IO_UNITBUF
 020000

	)

165 
	#_IO_STDIO
 040000

	)

166 
	#_IO_DONT_CLOSE
 0100000

	)

167 
	#_IO_BOOLALPHA
 0200000

	)

170 
_IO_jump_t
; 
	g_IO_FILE
;

173 #ifde‡
_IO_MTSAFE_IO


174 #i‡
deföed
 
__GLIBC__
 && __GLIBC__ >= 2

175 
	~<bôs/°dio-lock.h
>

180 
	t_IO_lock_t
;

186 
	s_IO_m¨kî
 {

187 
_IO_m¨kî
 *
	m_√xt
;

188 
_IO_FILE
 *
	m_sbuf
;

192 
	m_pos
;

194 
£t_°ªampos
(
°ªampos
 
•
Ë{ 
	m_•os
 = sp; }

195 
£t_off£t
(
off£t
Ë{ 
	m_pos
 = off£t; 
	m_•os
 = (
°ªampos
)(-2); }

196 
	mpublic
:

197 
°ªamm¨kî
(
°ªambuf
 *
sb
);

198 ~
°ªamm¨kî
();

199 
ßvög
(Ë{  
	m_•os
 == -2; }

200 
dñè
(
°ªamm¨kî
&);

201 
dñè
();

206 
	e__codecvt_ªsu…


208 
	m__codecvt_ok
,

209 
	m__codecvt_∑πül
,

210 
	m__codecvt_îr‹
,

211 
	m__codecvt_noc⁄v


214 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


217 
	s_IO_codecvt


219 (*
	m__codecvt_de°r
Ë(
	m_IO_codecvt
 *);

220 
__codecvt_ªsu…
 (*
__codecvt_do_out
Ë(
	m_IO_codecvt
 *,

221 
	m__mb°©e_t
 *,

222 c⁄° 
	mwch¨_t
 *,

223 c⁄° 
	mwch¨_t
 *,

224 c⁄° 
	mwch¨_t
 **, *,

226 
__codecvt_ªsu…
 (*
__codecvt_do_unshi·
Ë(
	m_IO_codecvt
 *,

227 
	m__mb°©e_t
 *, *,

229 
__codecvt_ªsu…
 (*
__codecvt_do_ö
Ë(
	m_IO_codecvt
 *,

230 
	m__mb°©e_t
 *,

232 c⁄° **, 
	mwch¨_t
 *,

233 
	mwch¨_t
 *, wchar_t **);

234 (*
	m__codecvt_do_ícodög
Ë(
	m_IO_codecvt
 *);

235 (*
	m__codecvt_do_Æways_noc⁄v
Ë(
	m_IO_codecvt
 *);

236 (*
	m__codecvt_do_Àngth
Ë(
	m_IO_codecvt
 *, 
	m__mb°©e_t
 *,

237 c⁄° *, c⁄° *, 
	m_IO_size_t
);

238 (*
	m__codecvt_do_max_Àngth
Ë(
	m_IO_codecvt
 *);

240 
_IO_ic⁄v_t
 
	m__cd_ö
;

241 
_IO_ic⁄v_t
 
	m__cd_out
;

245 
	s_IO_wide_d©a


247 
wch¨_t
 *
	m_IO_ªad_±r
;

248 
wch¨_t
 *
	m_IO_ªad_íd
;

249 
wch¨_t
 *
	m_IO_ªad_ba£
;

250 
wch¨_t
 *
	m_IO_wrôe_ba£
;

251 
wch¨_t
 *
	m_IO_wrôe_±r
;

252 
wch¨_t
 *
	m_IO_wrôe_íd
;

253 
wch¨_t
 *
	m_IO_buf_ba£
;

254 
wch¨_t
 *
	m_IO_buf_íd
;

256 
wch¨_t
 *
	m_IO_ßve_ba£
;

257 
wch¨_t
 *
	m_IO_backup_ba£
;

259 
wch¨_t
 *
	m_IO_ßve_íd
;

261 
__mb°©e_t
 
	m_IO_°©e
;

262 
__mb°©e_t
 
	m_IO_œ°_°©e
;

263 
_IO_codecvt
 
	m_codecvt
;

265 
wch¨_t
 
	m_sh‹tbuf
[1];

267 c⁄° 
_IO_jump_t
 *
	m_wide_vèbÀ
;

271 
	s_IO_FILE
 {

272 
	m_Êags
;

273 
	#_IO_fûe_Êags
 
_Êags


	)

277 * 
	m_IO_ªad_±r
;

278 * 
	m_IO_ªad_íd
;

279 * 
	m_IO_ªad_ba£
;

280 * 
	m_IO_wrôe_ba£
;

281 * 
	m_IO_wrôe_±r
;

282 * 
	m_IO_wrôe_íd
;

283 * 
	m_IO_buf_ba£
;

284 * 
	m_IO_buf_íd
;

286 *
	m_IO_ßve_ba£
;

287 *
	m_IO_backup_ba£
;

288 *
	m_IO_ßve_íd
;

290 
_IO_m¨kî
 *
	m_m¨kîs
;

292 
_IO_FILE
 *
	m_chaö
;

294 
	m_fûío
;

296 
	m_blksize
;

298 
	m_Êags2
;

300 
_IO_off_t
 
	m_ﬁd_off£t
;

302 
	#__HAVE_COLUMN


	)

304 
	m_cur_cﬁumn
;

305 sig√d 
	m_vèbÀ_off£t
;

306 
	m_sh‹tbuf
[1];

310 
_IO_lock_t
 *
	m_lock
;

311 #ifde‡
_IO_USE_OLD_IO_FILE


314 
	s_IO_FILE_com∂ëe


316 
_IO_FILE
 
	m_fûe
;

318 #i‡
deföed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

319 
_IO_off64_t
 
	m_off£t
;

320 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


322 
_IO_codecvt
 *
	m_codecvt
;

323 
_IO_wide_d©a
 *
	m_wide_d©a
;

324 
_IO_FILE
 *
	m_‰ìªs_li°
;

325 *
	m_‰ìªs_buf
;

326 
size_t
 
	m_‰ìªs_size
;

328 *
	m__∑d1
;

329 *
	m__∑d2
;

330 *
	m__∑d3
;

331 *
	m__∑d4
;

332 
size_t
 
	m__∑d5
;

334 
	m_mode
;

336 
	m_unu£d2
[15 *  (Ë- 4 *  (*Ë-  (
size_t
)];

340 #i‚de‡
__˝lu•lus


341 
_IO_FILE
 
	t_IO_FILE
;

344 
	g_IO_FILE_∂us
;

346 
_IO_FILE_∂us
 
_IO_2_1_°dö_
;

347 
_IO_FILE_∂us
 
_IO_2_1_°dout_
;

348 
_IO_FILE_∂us
 
_IO_2_1_°dîr_
;

349 #i‚de‡
_LIBC


350 
	#_IO_°dö
 ((
_IO_FILE
*)(&
_IO_2_1_°dö_
))

	)

351 
	#_IO_°dout
 ((
_IO_FILE
*)(&
_IO_2_1_°dout_
))

	)

352 
	#_IO_°dîr
 ((
_IO_FILE
*)(&
_IO_2_1_°dîr_
))

	)

354 
_IO_FILE
 *
_IO_°dö
 
©åibuã_hiddí
;

355 
_IO_FILE
 *
_IO_°dout
 
©åibuã_hiddí
;

356 
_IO_FILE
 *
_IO_°dîr
 
©åibuã_hiddí
;

364 
__ssize_t
 
	t__io_ªad_‚
 (*
	t__cookõ
, *
	t__buf
, 
	tsize_t
 
	t__nbyãs
);

372 
__ssize_t
 
	t__io_wrôe_‚
 (*
	t__cookõ
, 
	t__c⁄°
 *
	t__buf
,

373 
	tsize_t
 
	t__n
);

381 
	t__io_£ek_‚
 (*
	t__cookõ
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

384 
	t__io_˛o£_‚
 (*
	t__cookõ
);

387 #ifde‡
_GNU_SOURCE


389 
__io_ªad_‚
 
	tcookõ_ªad_fun˘i⁄_t
;

390 
__io_wrôe_‚
 
	tcookõ_wrôe_fun˘i⁄_t
;

391 
__io_£ek_‚
 
	tcookõ_£ek_fun˘i⁄_t
;

392 
__io_˛o£_‚
 
	tcookõ_˛o£_fun˘i⁄_t
;

397 
__io_ªad_‚
 *
	mªad
;

398 
__io_wrôe_‚
 *
	mwrôe
;

399 
__io_£ek_‚
 *
	m£ek
;

400 
__io_˛o£_‚
 *
	m˛o£
;

401 } 
	t_IO_cookõ_io_fun˘i⁄s_t
;

402 
_IO_cookõ_io_fun˘i⁄s_t
 
	tcookõ_io_fun˘i⁄s_t
;

404 
	g_IO_cookõ_fûe
;

407 
_IO_cookõ_öô
 (
_IO_cookõ_fûe
 *
__cfûe
, 
__ªad_wrôe
,

408 *
__cookõ
, 
_IO_cookõ_io_fun˘i⁄s_t
 
__‚s
);

412 #ifde‡
__˝lu•lus


416 
__undîÊow
 (
_IO_FILE
 *);

417 
__uÊow
 (
_IO_FILE
 *);

418 
__ovîÊow
 (
_IO_FILE
 *, );

419 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


420 
_IO_wöt_t
 
__wundîÊow
 (
_IO_FILE
 *);

421 
_IO_wöt_t
 
__wuÊow
 (
_IO_FILE
 *);

422 
_IO_wöt_t
 
__wovîÊow
 (
_IO_FILE
 *, _IO_wint_t);

425 #i‡ 
__GNUC__
 >= 3

426 
	#_IO_BE
(
ex¥
, 
ªs
Ë
	`__buûtö_ex≥˘
 (”x¥),Ñes)

	)

428 
	#_IO_BE
(
ex¥
, 
ªs
Ë”x¥)

	)

431 
	#_IO_gëc_u∆ocked
(
_Â
) \

432 (
	`_IO_BE
 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
, 0) \

433 ? 
	`__uÊow
 (
_Â
Ë: *(*Ë(_Â)->
_IO_ªad_±r
++)

	)

434 
	#_IO_≥ekc_u∆ocked
(
_Â
) \

435 (
	`_IO_BE
 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
, 0) \

436 && 
	`__undîÊow
 (
_Â
Ë=
EOF
 ? EOF \

437 : *(*Ë(
_Â
)->
_IO_ªad_±r
)

	)

438 
	#_IO_putc_u∆ocked
(
_ch
, 
_Â
) \

439 (
	`_IO_BE
 ((
_Â
)->
_IO_wrôe_±r
 >(_Â)->
_IO_wrôe_íd
, 0) \

440 ? 
	`__ovîÊow
 (
_Â
, (Ë(
_ch
)) \

441 : (Ë(*(
_Â
)->
_IO_wrôe_±r
++ = (
_ch
)))

	)

443 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


444 
	#_IO_gëwc_u∆ocked
(
_Â
) \

445 (
	`_IO_BE
 ((
_Â
)->
_wide_d©a
 =
NULL
 \

446 || ((
_Â
)->
_wide_d©a
->
_IO_ªad_±r
 \

447 >(
_Â
)->
_wide_d©a
->
_IO_ªad_íd
), 0) \

448 ? 
	`__wuÊow
 (
_Â
Ë: (
_IO_wöt_t
Ë*(_Â)->
_wide_d©a
->
_IO_ªad_±r
++)

	)

449 
	#_IO_putwc_u∆ocked
(
_wch
, 
_Â
) \

450 (
	`_IO_BE
 ((
_Â
)->
_wide_d©a
 =
NULL
 \

451 || ((
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
 \

452 >(
_Â
)->
_wide_d©a
->
_IO_wrôe_íd
), 0) \

453 ? 
	`__wovîÊow
 (
_Â
, 
_wch
) \

454 : (
_IO_wöt_t
Ë(*(
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
++ = (
_wch
)))

	)

457 
	#_IO_„of_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_EOF_SEEN
Ë!0)

	)

458 
	#_IO_„º‹_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_ERR_SEEN
Ë!0)

	)

460 
_IO_gëc
 (
_IO_FILE
 *
__Â
);

461 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__Â
);

462 
_IO_„of
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

463 
_IO_„º‹
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

465 
_IO_≥ekc_locked
 (
_IO_FILE
 *
__Â
);

468 
	#_IO_PENDING_OUTPUT_COUNT
(
_Â
) \

469 ((
_Â
)->
_IO_wrôe_±r
 - (_Â)->
_IO_wrôe_ba£
)

	)

471 
_IO_Êockfûe
 (
_IO_FILE
 *Ë
__THROW
;

472 
_IO_fu∆ockfûe
 (
_IO_FILE
 *Ë
__THROW
;

473 
_IO_·rylockfûe
 (
_IO_FILE
 *Ë
__THROW
;

475 #ifde‡
_IO_MTSAFE_IO


476 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_locked
 (_Â)

	)

477 
	#_IO_Êockfûe
(
_Â
) \

478 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_Êockfûe
 (_Â)

	)

479 
	#_IO_fu∆ockfûe
(
_Â
) \

480 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_fu∆ockfûe
 (_Â)

	)

482 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_u∆ocked
 (_Â)

	)

483 
	#_IO_Êockfûe
(
_Â
Ë

	)

484 
	#_IO_fu∆ockfûe
(
_Â
Ë

	)

485 
	#_IO_·rylockfûe
(
_Â
Ë

	)

486 
	#_IO_˛ónup_ªgi⁄_°¨t
(
_f˘
, 
_Â
Ë

	)

487 
	#_IO_˛ónup_ªgi⁄_íd
(
_Doô
Ë

	)

490 
_IO_vfsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, const * __restrict,

491 
_IO_va_li°
, *
__ª°ri˘
);

492 
_IO_vÂrötf
 (
_IO_FILE
 *
__ª°ri˘
, const *__restrict,

493 
_IO_va_li°
);

494 
_IO_ssize_t
 
_IO_∑dn
 (
_IO_FILE
 *, , _IO_ssize_t);

495 
_IO_size_t
 
_IO_sgën
 (
_IO_FILE
 *, *, _IO_size_t);

497 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

498 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

500 
_IO_‰ì_backup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

502 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


503 
_IO_wöt_t
 
_IO_gëwc
 (
_IO_FILE
 *
__Â
);

504 
_IO_wöt_t
 
_IO_putwc
 (
wch¨_t
 
__wc
, 
_IO_FILE
 *
__Â
);

505 
_IO_fwide
 (
_IO_FILE
 *
__Â
, 
__mode
Ë
__THROW
;

506 #i‡
__GNUC__
 >= 2

509 #i‡
deföed
 
_LIBC
 && deföed 
SHARED


510 
	~<shlib-com∑t.h
>

511 #i‡
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

512 
	#_IO_fwide_maybe_öcom∑tibÀ
 \

513 (
	`__buûtö_ex≥˘
 (&
_IO_°dö_u£d
 =
NULL
, 0))

	)

514 c⁄° 
_IO_°dö_u£d
;

515 
wók_exã∫
 (
_IO_°dö_u£d
);

518 #i‚de‡
_IO_fwide_maybe_öcom∑tibÀ


519 
	#_IO_fwide_maybe_öcom∑tibÀ
 (0)

	)

523 
	#_IO_fwide
(
__Â
, 
__mode
) \

524 ({ 
__ªsu…
 = (
__mode
); \

525 i‡(
__ªsu…
 < 0 && ! 
_IO_fwide_maybe_öcom∑tibÀ
) \

527 i‡((
__Â
)->
_mode
 == 0) \

529 (
__Â
)->
_mode
 = -1; \

530 
__ªsu…
 = (
__Â
)->
_mode
; \

532 i‡(
	`__buûtö_c⁄°™t_p
 (
__mode
) && (__mode) == 0) \

533 
__ªsu…
 = 
_IO_fwide_maybe_öcom∑tibÀ
 ? -1 : (
__Â
)->
_mode
; \

535 
__ªsu…
 = 
	`_IO_fwide
 (
__Â
, __result); \

536 
__ªsu…
; })

	)

539 
_IO_vfwsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, c⁄° 
wch¨_t
 * __restrict,

540 
_IO_va_li°
, *
__ª°ri˘
);

541 
_IO_vfw¥ötf
 (
_IO_FILE
 *
__ª°ri˘
, c⁄° 
wch¨_t
 *__restrict,

542 
_IO_va_li°
);

543 
_IO_ssize_t
 
_IO_w∑dn
 (
_IO_FILE
 *, 
wöt_t
, _IO_ssize_t);

544 
_IO_‰ì_wbackup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

547 #ifde‡
__LDBL_COMPAT


548 
	~<bôs/libio-ldbl.h
>

551 #ifde‡
__˝lu•lus


	@/usr/include/xlocale.h

21 #i‚de‡
_XLOCALE_H


22 
	#_XLOCALE_H
 1

	)

28 
	s__loˇÀ_°ru˘


31 
__loˇÀ_d©a
 *
	m__loˇÀs
[13];

34 c⁄° *
	m__˘y≥_b
;

35 c⁄° *
	m__˘y≥_tﬁowî
;

36 c⁄° *
	m__˘y≥_touµî
;

39 c⁄° *
	m__«mes
[13];

40 } *
	t__loˇÀ_t
;

43 
__loˇÀ_t
 
	tloˇÀ_t
;

	@/usr/include/_G_config.h

4 #i‚de‡
_G_c⁄fig_h


5 
	#_G_c⁄fig_h
 1

	)

9 
	~<bôs/ty≥s.h
>

10 
	#__√ed_size_t


	)

11 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


12 
	#__√ed_wch¨_t


	)

14 
	#__√ed_NULL


	)

15 
	~<°ddef.h
>

16 
	#__√ed_mb°©e_t


	)

17 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


18 
	#__√ed_wöt_t


	)

20 
	~<wch¨.h
>

21 
	#_G_size_t
 
size_t


	)

24 
__off_t
 
	m__pos
;

25 
__mb°©e_t
 
	m__°©e
;

26 } 
	t_G_Âos_t
;

29 
__off64_t
 
	m__pos
;

30 
__mb°©e_t
 
	m__°©e
;

31 } 
	t_G_Âos64_t
;

32 
	#_G_ssize_t
 
__ssize_t


	)

33 
	#_G_off_t
 
__off_t


	)

34 
	#_G_off64_t
 
__off64_t


	)

35 
	#_G_pid_t
 
__pid_t


	)

36 
	#_G_uid_t
 
__uid_t


	)

37 
	#_G_wch¨_t
 
wch¨_t


	)

38 
	#_G_wöt_t
 
wöt_t


	)

39 
	#_G_°©64
 
°©64


	)

40 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


41 
	~<gc⁄v.h
>

44 
__gc⁄v_öfo
 
	m__cd
;

47 
__gc⁄v_öfo
 
	m__cd
;

48 
__gc⁄v_°ï_d©a
 
	m__d©a
;

49 } 
	m__comböed
;

50 } 
	t_G_ic⁄v_t
;

53 
	t_G_öt16_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__HI__
)));

54 
	t_G_öt32_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__SI__
)));

55 
	t_G_uöt16_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__HI__
)));

56 
	t_G_uöt32_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__SI__
)));

58 
	#_G_HAVE_BOOL
 1

	)

62 
	#_G_HAVE_ATEXIT
 1

	)

63 
	#_G_HAVE_SYS_CDEFS
 1

	)

64 
	#_G_HAVE_SYS_WAIT
 1

	)

65 
	#_G_NEED_STDARG_H
 1

	)

66 
	#_G_va_li°
 
__gnuc_va_li°


	)

68 
	#_G_HAVE_PRINTF_FP
 1

	)

69 
	#_G_HAVE_MMAP
 1

	)

70 
	#_G_HAVE_MREMAP
 1

	)

71 
	#_G_HAVE_LONG_DOUBLE_IO
 1

	)

72 
	#_G_HAVE_IO_FILE_OPEN
 1

	)

73 
	#_G_HAVE_IO_GETLINE_INFO
 1

	)

75 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

77 
	#_G_OPEN64
 
__›í64


	)

78 
	#_G_LSEEK64
 
__l£ek64


	)

79 
	#_G_MMAP64
 
__mm≠64


	)

80 
	#_G_FSTAT64
(
fd
,
buf
Ë
	`__fx°©64
 (
_STAT_VER
, fd, buf)

	)

83 
	#_G_HAVE_ST_BLKSIZE
 
	`deföed
 (
_STATBUF_ST_BLKSIZE
)

	)

85 
	#_G_BUFSIZ
 8192

	)

88 
	#_G_NAMES_HAVE_UNDERSCORE
 0

	)

89 
	#_G_VTABLE_LABEL_HAS_LENGTH
 1

	)

90 
	#_G_USING_THUNKS
 1

	)

91 
	#_G_VTABLE_LABEL_PREFIX
 "__vt_"

	)

92 
	#_G_VTABLE_LABEL_PREFIX_ID
 
__vt_


	)

95 #i‡
deföed
 
__˝lu•lus
 || deföed 
__STDC__


96 
	#_G_ARGS
(
ARGLIST
Ë
	)
ARGLIST

98 
	#_G_ARGS
(
ARGLIST
Ë()

	)

	@/usr/include/gconv.h

23 #i‚de‡
_GCONV_H


24 
	#_GCONV_H
 1

	)

26 
	~<„©uªs.h
>

27 
	#__√ed_mb°©e_t


	)

28 
	#__√ed_wöt_t


	)

29 
	~<wch¨.h
>

30 
	#__√ed_size_t


	)

31 
	#__√ed_wch¨_t


	)

32 
	~<°ddef.h
>

35 
	#__UNKNOWN_10646_CHAR
 ((
wch¨_t
Ë0xfffd)

	)

40 
	m__GCONV_OK
 = 0,

41 
	m__GCONV_NOCONV
,

42 
	m__GCONV_NODB
,

43 
	m__GCONV_NOMEM
,

45 
	m__GCONV_EMPTY_INPUT
,

46 
	m__GCONV_FULL_OUTPUT
,

47 
	m__GCONV_ILLEGAL_INPUT
,

48 
	m__GCONV_INCOMPLETE_INPUT
,

50 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

51 
	m__GCONV_INTERNAL_ERROR


58 
	m__GCONV_IS_LAST
 = 0x0001,

59 
	m__GCONV_IGNORE_ERRORS
 = 0x0002

64 
	g__gc⁄v_°ï
;

65 
	g__gc⁄v_°ï_d©a
;

66 
	g__gc⁄v_lﬂded_obje˘
;

67 
	g__gc⁄v_å™s_d©a
;

71 (*
	t__gc⁄v_f˘
Ë(
	t__gc⁄v_°ï
 *, 
	t__gc⁄v_°ï_d©a
 *,

72 
	t__c⁄°
 **, __const *,

73 **, 
	tsize_t
 *, , );

76 
	$wöt_t
 (*
	t__gc⁄v_btowc_f˘
Ë(
	t__gc⁄v_°ï
 *, );

79 (*
	t__gc⁄v_öô_f˘
Ë(
	t__gc⁄v_°ï
 *);

80 (*
	t__gc⁄v_íd_f˘
Ë(
	t__gc⁄v_°ï
 *);

84 (*
	t__gc⁄v_å™s_f˘
Ë(
	t__gc⁄v_°ï
 *,

85 
	t__gc⁄v_°ï_d©a
 *, *,

86 
	t__c⁄°
 *,

87 
	t__c⁄°
 **,

88 
	t__c⁄°
 *, **,

89 
	tsize_t
 *);

92 (*
	t__gc⁄v_å™s_c⁄ãxt_f˘
Ë(*, 
	t__c⁄°
 *,

93 
	t__c⁄°
 *,

97 (*
	t__gc⁄v_å™s_quîy_f˘
Ë(
	t__c⁄°
 *, __const ***,

98 
	tsize_t
 *);

101 (*
	t__gc⁄v_å™s_öô_f˘
) (**, const *);

102 (*
	t__gc⁄v_å™s_íd_f˘
) (*);

104 
	s__gc⁄v_å™s_d©a


107 
__gc⁄v_å™s_f˘
 
__å™s_f˘
;

108 
__gc⁄v_å™s_c⁄ãxt_f˘
 
__å™s_c⁄ãxt_f˘
;

109 
__gc⁄v_å™s_íd_f˘
 
__å™s_íd_f˘
;

110 *
__d©a
;

111 
__gc⁄v_å™s_d©a
 *
__√xt
;

116 
	s__gc⁄v_°ï


118 
__gc⁄v_lﬂded_obje˘
 *
__shlib_h™dÀ
;

119 
__c⁄°
 *
__mod«me
;

121 
__cou¡î
;

123 *
__‰om_«me
;

124 *
__to_«me
;

126 
__gc⁄v_f˘
 
__f˘
;

127 
__gc⁄v_btowc_f˘
 
__btowc_f˘
;

128 
__gc⁄v_öô_f˘
 
__öô_f˘
;

129 
__gc⁄v_íd_f˘
 
__íd_f˘
;

133 
__mö_√eded_‰om
;

134 
__max_√eded_‰om
;

135 
__mö_√eded_to
;

136 
__max_√eded_to
;

139 
__°©eful
;

141 *
__d©a
;

146 
	s__gc⁄v_°ï_d©a


148 *
__outbuf
;

149 *
__outbu„nd
;

153 
__Êags
;

157 
__övoˇti⁄_cou¡î
;

161 
__öã∫Æ_u£
;

163 
__mb°©e_t
 *
__°©ï
;

164 
__mb°©e_t
 
__°©e
;

168 
__gc⁄v_å™s_d©a
 *
__å™s
;

173 
	s__gc⁄v_öfo


175 
size_t
 
__n°ïs
;

176 
__gc⁄v_°ï
 *
__°ïs
;

177 
__exãnsi⁄__
 
__gc⁄v_°ï_d©a
 
__d©a
 
__Êex¨r
;

178 } *
	t__gc⁄v_t
;

	@/usr/include/wchar.h

24 #i‚de‡
_WCHAR_H


26 #i‡!
deföed
 
__√ed_mb°©e_t
 && !deföed 
__√ed_wöt_t


27 
	#_WCHAR_H
 1

	)

28 
	~<„©uªs.h
>

31 #ifde‡
_WCHAR_H


33 
	#__√ed___FILE


	)

34 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


35 
	#__√ed_FILE


	)

37 
	~<°dio.h
>

39 
	#__√ed___va_li°


	)

40 
	~<°d¨g.h
>

42 
	~<bôs/wch¨.h
>

45 
	#__√ed_size_t


	)

46 
	#__√ed_wch¨_t


	)

47 
	#__√ed_NULL


	)

49 #i‡
deföed
 
_WCHAR_H
 || deföed 
__√ed_wöt_t
 || !deföed 
__WINT_TYPE__


50 #unde‡
__√ed_wöt_t


51 
	#__√ed_wöt_t


	)

52 
	~<°ddef.h
>

56 #i‚de‡
_WINT_T


61 
	#_WINT_T


	)

62 
	twöt_t
;

66 #i‡
deföed
 
__˝lu•lus
 && deföed 
_GLIBCPP_USE_NAMESPACES
 \

67 && 
deföed
 
__WINT_TYPE__


68 
__BEGIN_NAMESPACE_STD


69 
__WINT_TYPE__
 
	twöt_t
;

70 
	g__END_NAMESPACE_STD


75 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

76 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

80 #i‡(
deföed
 
_WCHAR_H
 || deföed 
__√ed_mb°©e_t
Ë&& !deföed 
__mb°©e_t_deföed


81 
	#__mb°©e_t_deföed
 1

	)

85 
	m__cou¡
;

88 #ifde‡
__WINT_TYPE__


89 
__WINT_TYPE__
 
	m__wch
;

91 
wöt_t
 
	m__wch
;

93 
	m__wchb
[4];

94 } 
	m__vÆue
;

95 } 
	t__mb°©e_t
;

97 #unde‡
__√ed_mb°©e_t


102 #ifde‡
_WCHAR_H


104 
__BEGIN_NAMESPACE_C99


106 
__mb°©e_t
 
	tmb°©e_t
;

107 
	g__END_NAMESPACE_C99


108 #ifde‡
__USE_GNU


109 
	$__USING_NAMESPACE_C99
(
mb°©e_t
)

112 #i‚de‡
WCHAR_MIN


114 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

115 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

118 #i‚de‡
WEOF


119 
	#WEOF
 (0xffffffffu)

	)

124 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_UNIX98


125 
	~<w˘y≥.h
>

129 
__BEGIN_DECLS


131 
__BEGIN_NAMESPACE_STD


134 
tm
;

135 
__END_NAMESPACE_STD


139 
	$__USING_NAMESPACE_STD
(
tm
)

142 
__BEGIN_NAMESPACE_STD


144 
wch¨_t
 *
	$wcs˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

145 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

147 
wch¨_t
 *
	$wc¢˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

148 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

149 
__THROW
;

152 
wch¨_t
 *
	$wcsˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

153 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

155 
wch¨_t
 *
	$wc¢ˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

156 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

157 
__THROW
;

160 
	$wcscmp
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
)

161 
__THROW
 
__©åibuã_puª__
;

163 
	$wc¢cmp
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

164 
__THROW
 
__©åibuã_puª__
;

165 
__END_NAMESPACE_STD


167 #ifde‡
__USE_XOPEN2K8


169 
	$wcsˇ£cmp
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
Ë
__THROW
;

172 
	$wc¢ˇ£cmp
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
,

173 
size_t
 
__n
Ë
__THROW
;

177 
	~<xloˇÀ.h
>

179 
	$wcsˇ£cmp_l
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
,

180 
__loˇÀ_t
 
__loc
Ë
__THROW
;

182 
	$wc¢ˇ£cmp_l
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
,

183 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

186 
__BEGIN_NAMESPACE_STD


189 
	$wcscﬁl
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
Ë
__THROW
;

193 
size_t
 
	$wcsx‰m
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

194 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

195 
__END_NAMESPACE_STD


197 #ifde‡
__USE_XOPEN2K8


203 
	$wcscﬁl_l
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
,

204 
__loˇÀ_t
 
__loc
Ë
__THROW
;

209 
size_t
 
	$wcsx‰m_l
 (
wch¨_t
 *
__s1
, 
__c⁄°
 wch¨_à*
__s2
,

210 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

213 
wch¨_t
 *
	$wcsdup
 (
__c⁄°
 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_mÆloc__
;

216 
__BEGIN_NAMESPACE_STD


218 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


219 "C++" 
wch¨_t
 *
	$wcschr
 (
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

220 
__THROW
 
	`__asm
 ("wcschr"Ë
__©åibuã_puª__
;

221 "C++" 
__c⁄°
 
wch¨_t
 *
	$wcschr
 (
__c⁄°
 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

222 
__THROW
 
	`__asm
 ("wcschr"Ë
__©åibuã_puª__
;

224 
wch¨_t
 *
	$wcschr
 (
__c⁄°
 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

225 
__THROW
 
__©åibuã_puª__
;

228 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


229 "C++" 
wch¨_t
 *
	$wc§chr
 (
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

230 
__THROW
 
	`__asm
 ("wc§chr"Ë
__©åibuã_puª__
;

231 "C++" 
__c⁄°
 
wch¨_t
 *
	$wc§chr
 (
__c⁄°
 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

232 
__THROW
 
	`__asm
 ("wc§chr"Ë
__©åibuã_puª__
;

234 
wch¨_t
 *
	$wc§chr
 (
__c⁄°
 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

235 
__THROW
 
__©åibuã_puª__
;

237 
__END_NAMESPACE_STD


239 #ifde‡
__USE_GNU


242 
wch¨_t
 *
	$wcsch∫ul
 (
__c⁄°
 
wch¨_t
 *
__s
, wch¨_à
__wc
)

243 
__THROW
 
__©åibuã_puª__
;

246 
__BEGIN_NAMESPACE_STD


249 
size_t
 
	$wcsc•n
 (
__c⁄°
 
wch¨_t
 *
__wcs
, __c⁄° wch¨_à*
__ªje˘
)

250 
__THROW
 
__©åibuã_puª__
;

253 
size_t
 
	$wcs•n
 (
__c⁄°
 
wch¨_t
 *
__wcs
, __c⁄° wch¨_à*
__ac˚±
)

254 
__THROW
 
__©åibuã_puª__
;

256 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


257 "C++" 
wch¨_t
 *
	$wc•brk
 (
wch¨_t
 *
__wcs
, 
__c⁄°
 wch¨_à*
__ac˚±
)

258 
__THROW
 
	`__asm
 ("wc•brk"Ë
__©åibuã_puª__
;

259 "C++" 
__c⁄°
 
wch¨_t
 *
	$wc•brk
 (
__c⁄°
 
wch¨_t
 *
__wcs
,

260 
__c⁄°
 
wch¨_t
 *
__ac˚±
)

261 
__THROW
 
	`__asm
 ("wc•brk"Ë
__©åibuã_puª__
;

263 
wch¨_t
 *
	$wc•brk
 (
__c⁄°
 
wch¨_t
 *
__wcs
, __c⁄° wch¨_à*
__ac˚±
)

264 
__THROW
 
__©åibuã_puª__
;

267 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


268 "C++" 
wch¨_t
 *
	$wcs°r
 (
wch¨_t
 *
__hay°ack
, 
__c⁄°
 wch¨_à*
__√edÀ
)

269 
__THROW
 
	`__asm
 ("wcs°r"Ë
__©åibuã_puª__
;

270 "C++" 
__c⁄°
 
wch¨_t
 *
	$wcs°r
 (
__c⁄°
 
wch¨_t
 *
__hay°ack
,

271 
__c⁄°
 
wch¨_t
 *
__√edÀ
)

272 
__THROW
 
	`__asm
 ("wcs°r"Ë
__©åibuã_puª__
;

274 
wch¨_t
 *
	$wcs°r
 (
__c⁄°
 
wch¨_t
 *
__hay°ack
, __c⁄° wch¨_à*
__√edÀ
)

275 
__THROW
 
__©åibuã_puª__
;

279 
wch¨_t
 *
	$wc°ok
 (
wch¨_t
 *
__ª°ri˘
 
__s
,

280 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__dñim
,

281 
wch¨_t
 **
__ª°ri˘
 
__±r
Ë
__THROW
;

284 
size_t
 
	$wc¶í
 (
__c⁄°
 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_puª__
;

285 
__END_NAMESPACE_STD


287 #ifde‡
__USE_XOPEN


289 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


290 "C++" 
wch¨_t
 *
	$wcswcs
 (
wch¨_t
 *
__hay°ack
, 
__c⁄°
 wch¨_à*
__√edÀ
)

291 
__THROW
 
	`__asm
 ("wcswcs"Ë
__©åibuã_puª__
;

292 "C++" 
__c⁄°
 
wch¨_t
 *
	$wcswcs
 (
__c⁄°
 
wch¨_t
 *
__hay°ack
,

293 
__c⁄°
 
wch¨_t
 *
__√edÀ
)

294 
__THROW
 
	`__asm
 ("wcswcs"Ë
__©åibuã_puª__
;

296 
wch¨_t
 *
	$wcswcs
 (
__c⁄°
 
wch¨_t
 *
__hay°ack
, __c⁄° wch¨_à*
__√edÀ
)

297 
__THROW
 
__©åibuã_puª__
;

301 #ifde‡
__USE_XOPEN2K8


303 
size_t
 
	$wc¢Àn
 (
__c⁄°
 
wch¨_t
 *
__s
, 
size_t
 
__maxÀn
)

304 
__THROW
 
__©åibuã_puª__
;

308 
__BEGIN_NAMESPACE_STD


310 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


311 "C++" 
wch¨_t
 *
	$wmemchr
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
)

312 
__THROW
 
	`__asm
 ("wmemchr"Ë
__©åibuã_puª__
;

313 "C++" 
__c⁄°
 
wch¨_t
 *
	$wmemchr
 (
__c⁄°
 
wch¨_t
 *
__s
, wch¨_à
__c
,

314 
size_t
 
__n
)

315 
__THROW
 
	`__asm
 ("wmemchr"Ë
__©åibuã_puª__
;

317 
wch¨_t
 *
	$wmemchr
 (
__c⁄°
 
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
)

318 
__THROW
 
__©åibuã_puª__
;

322 
	$wmemcmp
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s1
,

323 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
)

324 
__THROW
 
__©åibuã_puª__
;

327 
wch¨_t
 *
	$wmem˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

328 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

332 
wch¨_t
 *
	$wmemmove
 (
wch¨_t
 *
__s1
, 
__c⁄°
 wch¨_à*
__s2
, 
size_t
 
__n
)

333 
__THROW
;

336 
wch¨_t
 *
	$wmem£t
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
Ë
__THROW
;

337 
__END_NAMESPACE_STD


339 #ifde‡
__USE_GNU


342 
wch¨_t
 *
	$wmemp˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

343 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
)

344 
__THROW
;

348 
__BEGIN_NAMESPACE_STD


351 
wöt_t
 
	$btowc
 (
__c
Ë
__THROW
;

355 
	$w˘ob
 (
wöt_t
 
__c
Ë
__THROW
;

359 
	$mbsöô
 (
__c⁄°
 
mb°©e_t
 *
__ps
Ë
__THROW
 
__©åibuã_puª__
;

363 
size_t
 
	$mbπowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

364 
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

365 
mb°©e_t
 *
__p
Ë
__THROW
;

368 
size_t
 
	$w¸tomb
 (*
__ª°ri˘
 
__s
, 
wch¨_t
 
__wc
,

369 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

372 
size_t
 
	$__mbæí
 (
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

373 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

374 
size_t
 
	$mbæí
 (
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

375 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

376 
__END_NAMESPACE_STD


378 #ifde‡
__USE_EXTERN_INLINES


384 
wöt_t
 
	$__btowc_Æüs
 (
__c
Ë
	`__asm
 ("btowc");

385 
__exã∫_ölöe
 
wöt_t


386 
	`__NTH
 (
	$btowc
 (
__c
))

387 {  (
	`__buûtö_c⁄°™t_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

388 ? (
wöt_t
Ë
__c
 : 
	`__btowc_Æüs
 (__c)); 
	}
}

390 
	$__w˘ob_Æüs
 (
wöt_t
 
__c
Ë
	`__asm
 ("wctob");

391 
__exã∫_ölöe
 

392 
	`__NTH
 (
	$w˘ob
 (
wöt_t
 
__wc
))

393 {  (
	`__buûtö_c⁄°™t_p
 (
__wc
Ë&& __w¯>
L
'\0' && __wc <= L'\x7f'

394 ? (Ë
__wc
 : 
	`__w˘ob_Æüs
 (__wc)); 
	}
}

396 
__exã∫_ölöe
 
size_t


397 
__NTH
 (
	$mbæí
 (
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

398 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

399 {  (
__ps
 !
NULL


400 ? 
	`mbπowc
 (
NULL
, 
__s
, 
__n
, 
__ps
Ë: 
	`__mbæí
 (__s, __n, NULL)); 
	}
}

403 
__BEGIN_NAMESPACE_STD


406 
size_t
 
	$mb§towcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

407 
__c⁄°
 **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

408 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

412 
size_t
 
	$wc§tombs
 (*
__ª°ri˘
 
__d°
,

413 
__c⁄°
 
wch¨_t
 **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

414 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

415 
__END_NAMESPACE_STD


418 #ifdef 
__USE_XOPEN2K8


421 
size_t
 
	$mb¢πowcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

422 
__c⁄°
 **
__ª°ri˘
 
__§c
, 
size_t
 
__nmc
,

423 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

427 
size_t
 
	$wc¢πombs
 (*
__ª°ri˘
 
__d°
,

428 
__c⁄°
 
wch¨_t
 **
__ª°ri˘
 
__§c
,

429 
size_t
 
__nwc
, size_à
__Àn
,

430 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

435 #ifde‡
__USE_XOPEN


437 
	$wcwidth
 (
wch¨_t
 
__c
Ë
__THROW
;

441 
	$wcswidth
 (
__c⁄°
 
wch¨_t
 *
__s
, 
size_t
 
__n
Ë
__THROW
;

445 
__BEGIN_NAMESPACE_STD


448 
	$wc°od
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

449 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

450 
__END_NAMESPACE_STD


452 #ifde‡
__USE_ISOC99


453 
__BEGIN_NAMESPACE_C99


455 
	$wc°of
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

456 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

457 
	$wc°ﬁd
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

458 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

459 
__END_NAMESPACE_C99


463 
__BEGIN_NAMESPACE_STD


466 
	$wc°ﬁ
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

467 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

471 
	$wc°oul
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

472 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

473 
__THROW
;

474 
__END_NAMESPACE_STD


476 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GNUC__
 && deföed 
__USE_GNU
)

477 
__BEGIN_NAMESPACE_C99


480 
__exãnsi⁄__


481 
	$wc°ﬁl
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

482 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

483 
__THROW
;

487 
__exãnsi⁄__


488 
	$wc°ouŒ
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

489 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

490 
__ba£
Ë
__THROW
;

491 
__END_NAMESPACE_C99


494 #i‡
deföed
 
__GNUC__
 && deföed 
__USE_GNU


497 
__exãnsi⁄__


498 
	$wc°oq
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

499 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

500 
__THROW
;

504 
__exãnsi⁄__


505 
	$wc°ouq
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

506 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

507 
__ba£
Ë
__THROW
;

510 #ifde‡
__USE_GNU


524 
	~<xloˇÀ.h
>

528 
	$wc°ﬁ_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

529 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

530 
__loˇÀ_t
 
__loc
Ë
__THROW
;

532 
	$wc°oul_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

533 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

534 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

536 
__exãnsi⁄__


537 
	$wc°ﬁl_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

538 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

539 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

541 
__exãnsi⁄__


542 
	$wc°ouŒ_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

543 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

544 
__ba£
, 
__loˇÀ_t
 
__loc
)

545 
__THROW
;

547 
	$wc°od_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

548 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

549 
__THROW
;

551 
	$wc°of_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

552 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

553 
__THROW
;

555 
	$wc°ﬁd_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

556 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

557 
__loˇÀ_t
 
__loc
Ë
__THROW
;

562 
wch¨_t
 *
	$w˝˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

563 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

567 
wch¨_t
 *
	$w˝n˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

568 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

569 
__THROW
;

575 #ifdef 
__USE_XOPEN2K8


578 
__FILE
 *
	$›í_wmem°ªam
 (
wch¨_t
 **
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
;

581 #i‡
deföed
 
__USE_ISOC95
 || deföed 
__USE_UNIX98


582 
__BEGIN_NAMESPACE_STD


585 
	$fwide
 (
__FILE
 *
__Â
, 
__mode
Ë
__THROW
;

592 
	`fw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

593 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

599 
	`w¥ötf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

602 
	$sw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

603 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

604 
__THROW
 ;

610 
	`vfw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__s
,

611 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

612 
__gnuc_va_li°
 
__¨g
)

618 
	`vw¥ötf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

619 
__gnuc_va_li°
 
__¨g
)

623 
	$vsw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

624 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

625 
__gnuc_va_li°
 
__¨g
)

626 
__THROW
 ;

633 
	`fwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

634 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

640 
	`wsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

643 
	$swsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s
,

644 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

645 
__THROW
 ;

647 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

648 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

649 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

650 #ifde‡
__REDIRECT


654 
	`__REDIRECT
 (
fwsˇnf
, (
__FILE
 *
__ª°ri˘
 
__°ªam
,

655 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...),

656 
__isoc99_fwsˇnf
)

658 
	`__REDIRECT
 (
wsˇnf
, (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...),

659 
__isoc99_wsˇnf
)

661 
	`__REDIRECT_NTH
 (
swsˇnf
, (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s
,

662 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

663 ...), 
__isoc99_swsˇnf
)

666 
	`__isoc99_fwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

667 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

668 
	`__isoc99_wsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

669 
	$__isoc99_swsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s
,

670 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

671 
__THROW
;

672 
	#fwsˇnf
 
__isoc99_fwsˇnf


	)

673 
	#wsˇnf
 
__isoc99_wsˇnf


	)

674 
	#swsˇnf
 
__isoc99_swsˇnf


	)

678 
__END_NAMESPACE_STD


681 #ifde‡
__USE_ISOC99


682 
__BEGIN_NAMESPACE_C99


687 
	`vfwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__s
,

688 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

689 
__gnuc_va_li°
 
__¨g
)

695 
	`vwsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

696 
__gnuc_va_li°
 
__¨g
)

699 
	$vswsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s
,

700 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

701 
__gnuc_va_li°
 
__¨g
)

702 
__THROW
 ;

704 #i‡!
deföed
 
__USE_GNU
 \

705 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

706 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

707 #ifde‡
__REDIRECT


708 
	`__REDIRECT
 (
vfwsˇnf
, (
__FILE
 *
__ª°ri˘
 
__s
,

709 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

710 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vfwsˇnf
)

712 
	`__REDIRECT
 (
vwsˇnf
, (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

713 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vwsˇnf
)

715 
	`__REDIRECT_NTH
 (
vswsˇnf
, (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s
,

716 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

717 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vswsˇnf
)

720 
	`__isoc99_vfwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__s
,

721 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

722 
__gnuc_va_li°
 
__¨g
);

723 
	`__isoc99_vwsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

724 
__gnuc_va_li°
 
__¨g
);

725 
	$__isoc99_vswsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s
,

726 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

727 
__gnuc_va_li°
 
__¨g
Ë
__THROW
;

728 
	#vfwsˇnf
 
__isoc99_vfwsˇnf


	)

729 
	#vwsˇnf
 
__isoc99_vwsˇnf


	)

730 
	#vswsˇnf
 
__isoc99_vswsˇnf


	)

734 
__END_NAMESPACE_C99


738 
__BEGIN_NAMESPACE_STD


743 
wöt_t
 
	`fgëwc
 (
__FILE
 *
__°ªam
);

744 
wöt_t
 
	`gëwc
 (
__FILE
 *
__°ªam
);

750 
wöt_t
 
	`gëwch¨
 ();

757 
wöt_t
 
	`Âutwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

758 
wöt_t
 
	`putwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

764 
wöt_t
 
	`putwch¨
 (
wch¨_t
 
__wc
);

772 
wch¨_t
 *
	`fgëws
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

773 
__FILE
 *
__ª°ri˘
 
__°ªam
);

779 
	`Âutws
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__ws
,

780 
__FILE
 *
__ª°ri˘
 
__°ªam
);

787 
wöt_t
 
	`ungëwc
 (wöt_à
__wc
, 
__FILE
 *
__°ªam
);

788 
__END_NAMESPACE_STD


791 #ifde‡
__USE_GNU


799 
wöt_t
 
	`gëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

800 
wöt_t
 
	`gëwch¨_u∆ocked
 ();

808 
wöt_t
 
	`fgëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

816 
wöt_t
 
	`Âutwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

825 
wöt_t
 
	`putwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

826 
wöt_t
 
	`putwch¨_u∆ocked
 (
wch¨_t
 
__wc
);

835 
wch¨_t
 *
	`fgëws_u∆ocked
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

836 
__FILE
 *
__ª°ri˘
 
__°ªam
);

844 
	`Âutws_u∆ocked
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__ws
,

845 
__FILE
 *
__ª°ri˘
 
__°ªam
);

849 
__BEGIN_NAMESPACE_C99


853 
size_t
 
	$wcs·ime
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

854 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

855 
__c⁄°
 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

856 
__END_NAMESPACE_C99


858 #ifde‡
__USE_GNU


859 
	~<xloˇÀ.h
>

863 
size_t
 
	$wcs·ime_l
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

864 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

865 
__c⁄°
 
tm
 *
__ª°ri˘
 
__ç
,

866 
__loˇÀ_t
 
__loc
Ë
__THROW
;

875 #i‡
deföed
 
__USE_UNIX98
 && !deföed 
__USE_GNU


876 
	#__√ed_iswxxx


	)

877 
	~<w˘y≥.h
>

881 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


882 
	~<bôs/wch¨2.h
>

885 #ifde‡
__LDBL_COMPAT


886 
	~<bôs/wch¨-ldbl.h
>

889 
__END_DECLS


897 #unde‡
__√ed_mb°©e_t


898 #unde‡
__√ed_wöt_t


	@/usr/include/wctype.h

24 #i‚de‡
_WCTYPE_H


26 
	~<„©uªs.h
>

27 
	~<bôs/ty≥s.h
>

29 #i‚de‡
__√ed_iswxxx


30 
	#_WCTYPE_H
 1

	)

33 
	#__√ed_wöt_t


	)

34 
	~<wch¨.h
>

38 #i‚de‡
WEOF


39 
	#WEOF
 (0xffffffffu)

	)

42 #unde‡
__√ed_iswxxx


47 #i‚de‡
__iswxxx_deföed


48 
	#__iswxxx_deföed
 1

	)

50 
__BEGIN_NAMESPACE_C99


53 
	tw˘y≥_t
;

54 
	g__END_NAMESPACE_C99


56 #i‚de‡
_ISwbô


61 
	~<ídün.h
>

62 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


63 
	#_ISwbô
(
bô
Ë(1 << (bô))

	)

65 
	#_ISwbô
(
bô
) \

66 ((
bô
) < 8 ? () ((1UL << (bit)) << 24) \

67 : ((
bô
) < 16 ? () ((1UL << (bit)) << 8) \

68 : ((
bô
) < 24 ? () ((1UL << (bit)) >> 8) \

69 : (Ë((1UL << (
bô
)Ë>> 24))))

	)

74 
	m__ISwuµî
 = 0,

75 
	m__ISwlowî
 = 1,

76 
	m__ISwÆpha
 = 2,

77 
	m__ISwdigô
 = 3,

78 
	m__ISwxdigô
 = 4,

79 
	m__ISw•a˚
 = 5,

80 
	m__ISw¥öt
 = 6,

81 
	m__ISwgøph
 = 7,

82 
	m__ISwbœnk
 = 8,

83 
	m__ISw˙ål
 = 9,

84 
	m__ISwpun˘
 = 10,

85 
	m__ISwÆnum
 = 11,

87 
	m_ISwuµî
 = 
_ISwbô
 (
__ISwuµî
),

88 
	m_ISwlowî
 = 
_ISwbô
 (
__ISwlowî
),

89 
	m_ISwÆpha
 = 
_ISwbô
 (
__ISwÆpha
),

90 
	m_ISwdigô
 = 
_ISwbô
 (
__ISwdigô
),

91 
	m_ISwxdigô
 = 
_ISwbô
 (
__ISwxdigô
),

92 
	m_ISw•a˚
 = 
_ISwbô
 (
__ISw•a˚
),

93 
	m_ISw¥öt
 = 
_ISwbô
 (
__ISw¥öt
),

94 
	m_ISwgøph
 = 
_ISwbô
 (
__ISwgøph
),

95 
	m_ISwbœnk
 = 
_ISwbô
 (
__ISwbœnk
),

96 
	m_ISw˙ål
 = 
_ISwbô
 (
__ISw˙ål
),

97 
	m_ISwpun˘
 = 
_ISwbô
 (
__ISwpun˘
),

98 
	m_ISwÆnum
 = 
_ISwbô
 (
__ISwÆnum
)

103 
__BEGIN_DECLS


105 
__BEGIN_NAMESPACE_C99


112 
	$iswÆnum
 (
wöt_t
 
__wc
Ë
__THROW
;

118 
	$iswÆpha
 (
wöt_t
 
__wc
Ë
__THROW
;

121 
	$isw˙ål
 (
wöt_t
 
__wc
Ë
__THROW
;

125 
	$iswdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

129 
	$iswgøph
 (
wöt_t
 
__wc
Ë
__THROW
;

134 
	$iswlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

137 
	$isw¥öt
 (
wöt_t
 
__wc
Ë
__THROW
;

142 
	$iswpun˘
 (
wöt_t
 
__wc
Ë
__THROW
;

147 
	$isw•a˚
 (
wöt_t
 
__wc
Ë
__THROW
;

152 
	$iswuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

157 
	$iswxdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

162 #ifde‡
__USE_ISOC99


163 
	$iswbœnk
 (
wöt_t
 
__wc
Ë
__THROW
;

172 
w˘y≥_t
 
	$w˘y≥
 (
__c⁄°
 *
__¥›îty
Ë
__THROW
;

176 
	$isw˘y≥
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
Ë
__THROW
;

177 
__END_NAMESPACE_C99


184 
__BEGIN_NAMESPACE_C99


187 
__c⁄°
 
	t__öt32_t
 *
	tw˘øns_t
;

188 
__END_NAMESPACE_C99


189 #ifde‡
__USE_GNU


190 
	$__USING_NAMESPACE_C99
(
w˘øns_t
)

193 
__BEGIN_NAMESPACE_C99


195 
wöt_t
 
	$towlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

198 
wöt_t
 
	$towuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

199 
__END_NAMESPACE_C99


201 
__END_DECLS


208 #ifde‡
_WCTYPE_H


214 
__BEGIN_DECLS


216 
__BEGIN_NAMESPACE_C99


219 
w˘øns_t
 
	$w˘øns
 (
__c⁄°
 *
__¥›îty
Ë
__THROW
;

222 
wöt_t
 
	$tow˘øns
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
Ë
__THROW
;

223 
__END_NAMESPACE_C99


225 #ifde‡
__USE_XOPEN2K8


227 
	~<xloˇÀ.h
>

231 
	$iswÆnum_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

237 
	$iswÆpha_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

240 
	$isw˙ål_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

244 
	$iswdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

248 
	$iswgøph_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

253 
	$iswlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

256 
	$isw¥öt_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

261 
	$iswpun˘_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

266 
	$isw•a˚_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

271 
	$iswuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

276 
	$iswxdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

281 
	$iswbœnk_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

285 
w˘y≥_t
 
	$w˘y≥_l
 (
__c⁄°
 *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

286 
__THROW
;

290 
	$isw˘y≥_l
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
, 
__loˇÀ_t
 
__loˇÀ
)

291 
__THROW
;

299 
wöt_t
 
	$towlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

302 
wöt_t
 
	$towuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

306 
w˘øns_t
 
	$w˘øns_l
 (
__c⁄°
 *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

307 
__THROW
;

310 
wöt_t
 
	$tow˘øns_l
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
,

311 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

315 
__END_DECLS


	@
1
.
1
/usr/include
76
953
anim.c
anim.h
animdata.c
animdata.h
dc6info.c
dc6info.h
dccinfo.c
dccinfo.h
ds1misc.c
ds1misc.h
ds1save.c
ds1save.h
dt1_draw.c
dt1_draw.h
dt1misc.c
dt1misc.h
editobj.c
editobj.h
editpath.c
editpath.h
edittile.c
edittile.h
error.c
error.h
gfx_custom.c
gfx_custom.h
inicreat.c
inicreat.h
iniread.c
iniread.h
interfac.c
interfac.h
main.c
misc.c
misc.h
mpq/Dcl_tbl.c
mpq/Dclib.h
mpq/Explode.c
mpq/MpqView.c
mpq/MpqView.h
mpq/Wav_unp.c
mpq/Wav_unp.h
mpq/mpqtypes.h
msg_quit.c
msg_quit.h
msg_save.c
msg_save.h
structs.h
txtread.c
txtread.h
types.h
undo.c
undo.h
wBits.c
wBits.h
wEdit.c
wEdit.h
wMsg.c
wMsg.h
wPreview.c
wPreview.h
/usr/include/ctype.h
/usr/include/math.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/alloca.h
/usr/include/endian.h
/usr/include/features.h
/usr/include/getopt.h
/usr/include/libio.h
/usr/include/xlocale.h
/usr/include/_G_config.h
/usr/include/gconv.h
/usr/include/wchar.h
/usr/include/wctype.h
